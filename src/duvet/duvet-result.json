{"blob_link": "https://github.com/aws/aws-encryption-sdk-dafny/tree/0361e467b455e7ac4c94f28d5652a4c809c8762e", "issue_link": "https://github.com/aws/aws-encryption-sdk-dafny/issues", "specifications": {"compliance/framework/keyring-interface.txt": {"requirements": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33], "sections": [{"id": "1", "title": "Definitions", "lines": ["1.   Conventions and Definitions", "", "   The key words \"MUST\", \"MUST NOT\", \"REQUIRED\", \"SHALL\", \"SHALL NOT\",", "   \"SHOULD\", \"SHOULD NOT\", \"RECOMMENDED\", \"NOT RECOMMENDED\", \"MAY\", and", "   \"OPTIONAL\" in this document are to be interpreted as described in BCP", "   14 [RFC2119] [RFC8174] when, and only when, they appear in all", "   capitals, as shown here", ""]}, {"id": "2", "title": "Interface", "lines": ["2.   Keyring Interface", ""]}, {"id": "2.1", "title": "Version", "lines": ["2.1.   Version", "", "   0.2.3", ""]}, {"id": "2.1.1", "title": "Changelog", "lines": ["2.1.1.   Changelog", "", "   *  0.2.3", "", "      -  Fix stated behavior if the keyring takes no action to conform", "         with how to fail (../changes/2020-06-04_how-to-fail-with-", "         keyrings/change.md).", "", "   *  0.2.2", "", "      -  Define wrapping key identifier terms (../changes/2020-06-", "         09_wrapping-key-identifiers/change.md)", "", "   *  0.2.1", "", "      -  Clarify naming of KMS to AWS KMS (https://github.com/awslabs/", "         aws-encryption-sdk-specification/issues/67)", "", "   *  0.2.0", "", "      -  Remove Keyring Trace (../changes/2020-05-13_remove-keyring-", "         trace/change.md)", "", "   *  0.1.0-preview", "", "      -  Initial record", ""]}, {"id": "2.2", "title": "Implementations", "lines": ["2.2.   Implementations", "", "   +==========+=============+=========+====================================================================+", "   |Language  |Confirmed    |Minimum  |Implementation                                                      |", "   |          |Compatible   |Version  |                                                                    |", "   |          |with Spec    |Confirmed|                                                                    |", "   |          |Version      |         |                                                                    |", "   +==========+=============+=========+====================================================================+", "   |C         |0.1.0-preview|0.1.0    |materials.c (https://github.com/aws/aws-encryption-sdk-             |", "   |          |             |         |c/blob/master/source/materials.c)                                   |", "   +----------+-------------+---------+--------------------------------------------------------------------+", "   |Javascript|0.1.0-preview|0.1.0    |keyring.ts (https://github.com/awslabs/aws-encryption-sdk-          |", "   |          |             |         |javascript/blob/master/modules/material-management/src/keyring.ts)  |", "   +----------+-------------+---------+--------------------------------------------------------------------+", "   |Python    |0.1.0-preview|n/a      |keyrings/base.py (https://github.com/aws/aws-encryption-sdk-        |", "   |          |             |         |python/blob/master/src/aws_encryption_sdk/keyrings/base.py)         |", "   +----------+-------------+---------+--------------------------------------------------------------------+", "   |Java      |0.1.0-preview|n/a      |Keyring.java (https://github.com/aws/aws-encryption-sdk-            |", "   |          |             |         |java/blob/master/src/main/java/com/amazonaws/encryptionsdk/keyrings/|", "   |          |             |         |Keyring.java)                                                       |", "   +----------+-------------+---------+--------------------------------------------------------------------+", "", "                                  Table 1", ""]}, {"id": "2.3", "title": "Overview", "lines": [[[[0], 224, "The keyring interface specified in this document describes the interface all keyrings MUST implement."]]], "requirements": [0]}, {"id": "2.4", "title": "Definitions", "lines": ["2.4.   Definitions", ""]}, {"id": "2.4.1", "title": "document", "lines": [[[[1], 224, "The key words \"MUST\", \"MUST NOT\", \"REQUIRED\", \"SHALL\", \"SHALL NOT\", \"SHOULD\", \"SHOULD NOT\", \"RECOMMENDED\", \"MAY\", and \"OPTIONAL\" in this document are to be interpreted as described in RFC 2119 (https://tools.ietf.org/html/rfc2119)."]]], "requirements": [1]}, {"id": "2.4.2", "title": "namespace", "lines": [[[[2], 224, "The key namespace MUST be a string value."]]], "requirements": [2]}, {"id": "2.4.3", "title": "name", "lines": [[[[3], 224, "The key name MUST be a string value."]]], "requirements": [3]}, {"id": "2.4.4", "title": "ID", "lines": [[[[4], 224, "The key provider ID MUST be a binary value and SHOULD be equal to a UTF-8 encoding of the key namespace."]], [[[5], 224, "This value MUST NOT be \"aws-kms\" unless this encrypted data key was produced by the AWS KMS Keyring (kms-keyring.md)."]]], "requirements": [4, 5]}, {"id": "2.4.5", "title": "info", "lines": [[[[6], 224, "The key provider info MUST be a binary value and SHOULD be equal to a UTF-8 encoding of the key name."]]], "requirements": [6]}, {"id": "2.5", "title": "Keyrings", "lines": ["2.5.   Supported Keyrings", "", "   *  AWS KMS Keyring (kms-keyring.md)", "", "   *  Multi-Keyring (multi-keyring.md)", "", "   *  Raw AES Keyring (raw-aes-keyring.md)", "", "   *  Raw RSA Keyring (raw-rsa-keyring.md)", ""]}, {"id": "2.6", "title": "Interface", "lines": ["2.6.   Interface", ""]}, {"id": "2.6.1", "title": "OnEncrypt", "lines": [[[[7], 96, "This interface takes encryption materials (structures.md#encryption- materials) as input and MAY modify it with any of the following behaviors:"]], [[[8], 224, "If this keyring attempted any of the above behaviors, and successfully completed those behaviors, it MUST output the modified encryption materials (structures.md#encryption-materials)."]], [[[9], 224, "If the keyring did not attempt any of the above behaviors, it MUST fail and it MUST NOT modify the encryption materials (structures.md#encryption-materials)."]]], "requirements": [7, 8, 9]}, {"id": "2.6.1.1", "title": "Key", "lines": [[[[10], 96, "If the encryption materials (structures.md#encryption-materials) do not contain a plaintext data key, OnEncrypt MAY generate a data key."]], [[[11], 224, "If the encryption materials contain a plaintext data key, OnEncrypt MUST NOT generate a data key."]], [[[12], 96, "Generate Data Key MAY modify the following fields in the encryption materials (structures.md#encryption-materials):"]], [[[13], 224, "The length of the output plaintext data key MUST be equal to the KDF input length of the algorithm suite (algorithm-suites.md) specified in the encryption materials (structures.md#encryption-materials)."]], [[[14], 224, "The value of the plaintext data key MUST consist of cryptographically secure (pseudo-)random bits."]], [[[15], 96, "Note: If the keyring successfully performs this behavior, this means that the keyring MAY then perform the Encrypt Data Key (Section 2.6.1.2) behavior."]]], "requirements": [10, 11, 12, 13, 14, 15]}, {"id": "2.6.1.2", "title": "Key", "lines": [[[[16], 96, "If the encryption materials (structures.md#encryption-materials) contain a plaintext data key, OnEncrypt MAY encrypt a data key."]], [[[17], 224, "If the encryption materials do not contain a plaintext data key, OnEncrypt MUST NOT encrypt a data key."]], [[[18], 96, "Encrypt Data Key MAY modify the following fields in the encryption materials (structures.md#encryption-materials):"]], [[[19], 224, "The encrypted data keys (structures.md#encrypted-data-key) produced by this keyring MUST have ciphertexts (structures.md#ciphertext) that can be decrypted to the plaintext data key in the encryption materials (structures.md#encryption-materials)."]]], "requirements": [16, 17, 18, 19]}, {"id": "2.6.2", "title": "OnDecrypt", "lines": [[[[20], 96, "This interface takes decryption materials (structures.md#decryption- materials) and a list of encrypted data keys (structures.md#encrypted-data-key) as input and MAY modify it with the following behavior:"]], [[[21], 224, "If the decryption materials already contain a plaintext data key, the keyring MUST fail and MUST NOT modify the decryption materials (structures.md#decryption-materials)."]], [[[22], 224, "If this keyring attempted the above behavior, and succeeded, it MUST output the modified decryption materials (structures.md#decryption- materials)."]], [[[23], 224, "If the keyring did not attempt the above behavior, the keyring MUST fail and MUST NOT modify the decryption materials (structures.md#decryption-materials)."]]], "requirements": [20, 21, 22, 23]}, {"id": "2.6.2.1", "title": "Key", "lines": [[[[24], 224, "If the encryption materials do contain a plaintext data key, OnDecrypt MUST NOT decrypt a data key."]], [[[25], 96, "If the decryption materials (structures.md#decryption-materials) do not include a plaintext data key, OnDecrypt MAY decrypt a data key."]], [[[26], 96, "The decrypt data key MAY modify the following fields in the decryption materials (structures.md#decryption-materials):"]], [[[27], 160, "If the keyring is able to succesfully get at least one plaintext data key from any encrypted data key (structures.md#encrypted-data-key) and the decryption materials (structures.md#decryption-materials) still do not include a plaintext data key, it SHOULD set one resulting plaintext data key on the decryption materials (structures.md#decryption-materials)."]], [[[28], 224, "If the keyring is unable to get any plaintext data key using the input encrypted data keys (structures.md#encrypted-data-key), the keyring MUST NOT not update the decryption materials (structures.md#decryption-materials) and MUST return failure."]]], "requirements": [24, 25, 26, 27, 28]}, {"id": "2.7", "title": "Considerations", "lines": [[[[29], 160, "Keyring implementations SHOULD provide integrity guarantees for the encrypted data keys (structures.md#encrypted-data-key) they return on Section 2.6.1 such that tampered versions of those encrypted data keys, if input into Section 2.6.2, are overwhelmingly likely to cause a decryption failure (i.e. the chance of a successful decryption in this case is negligible)."]], [[[30], 160, "Such integrity guarantees SHOULD include the integrity of the encryption context (structures.md#encryption-context) such that, if the encryption context used as input to OnEncrypt to produce an encrypted data key is different than the encryption context input to OnDecrypt to decrypt that encrypted data key, the decryption is overwhelmingly likely to fail."]], [[[31], 160, "Users SHOULD use a keyring that protects wrapping keys and performs cryptographic operations within a secure boundary."]], [[[32], 96, "The raw AES keyring (raw-aes-keyring.md) and raw RSA keyring (raw- rsa-keyring.md) MAY be used, however users should refer to their specification for notes on their respective security considerations."]]], "requirements": [29, 30, 31, 32]}, {"id": "2.8", "title": "Appendix", "lines": ["2.8.   Appendix", ""]}, {"id": "2.8.1", "title": "Compatability", "lines": ["2.8.1.   Keyring and Master Key Provider/Master Key Compatability", "", "   The following keyrings are compatible with the referenced master key", "   providers (master-key-provider-interface.md) or master keys (master-", "   key-interface.md) when configured to use the same wrapping key.", "", "          +=========+===========================================+", "          | Keyring | Master Key Provider: Java and Python      |", "          +=========+===========================================+", "          | AWS KMS | KMS master key (Java), KMS master key     |", "          | keyring | provider (Java), KMS master key (Python), |", "          |         | KMS master key provider (Python)          |", "          +---------+-------------------------------------------+", "          | Raw AES | When they are used with symmetric         |", "          | keyring | encryption keys: JceMasterKey (Java),     |", "          |         | RawMasterKey (Python)                     |", "          +---------+-------------------------------------------+", "          | Raw RSA | When they are used with asymmetric        |", "          | keyring | encryption keys: JceMasterKey (Java),     |", "          |         | RawMasterKey (Python)                     |", "          +---------+-------------------------------------------+", "", "                                  Table 2", ""]}, {"id": "2.8.2", "title": "and", "lines": [[[[33], 160, "Due to this simplified architecture, master keys and master key providers are going to be deprecated in the future, and new implementations SHOULD use keyrings."]]], "requirements": [33]}, {"id": "3", "title": "References", "lines": ["3.   Normative References", "", "   [RFC2119]  Bradner, S., \"Key words for use in RFCs to Indicate", "              Requirement Levels\", BCP 14, RFC 2119,", "              DOI 10.17487/RFC2119, March 1997,", "              <https://www.rfc-editor.org/info/rfc2119>.", "", "   [RFC8174]  Leiba, B., \"Ambiguity of Uppercase vs Lowercase in RFC", "              2119 Key Words\", BCP 14, RFC 8174, DOI 10.17487/RFC8174,", "              May 2017, <https://www.rfc-editor.org/info/rfc8174>.", "", "Acknowledgments", "", "Author's Address", "", "   Amazon AWS", "   Amazon AWS", "", "   Email: cryptools+rfc@amazon.com"]}]}, "compliance/framework/local-cryptographic-materials-cache.txt": {"requirements": [34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50], "sections": [{"id": "1", "title": "Definitions", "lines": ["1.   Conventions and Definitions", "", "   The key words \"MUST\", \"MUST NOT\", \"REQUIRED\", \"SHALL\", \"SHALL NOT\",", "   \"SHOULD\", \"SHOULD NOT\", \"RECOMMENDED\", \"NOT RECOMMENDED\", \"MAY\", and", "   \"OPTIONAL\" in this document are to be interpreted as described in BCP", "   14 [RFC2119] [RFC8174] when, and only when, they appear in all", "   capitals, as shown here", ""]}, {"id": "2", "title": "Cache", "lines": ["2.   Local Cryptographic Materials Cache", ""]}, {"id": "2.1", "title": "Version", "lines": ["2.1.   Version", ""]}, {"id": "2.1.1", "title": "Changelog", "lines": ["2.1.1.   Changelog", "", "   *  0.1.0", "", "      -  Initial record", "", "      -  Refactor Cryptographic Materials Cache Specification", "         (../changes/2020-07-14_refactor-cmc-spec/change.md)", ""]}, {"id": "2.2", "title": "Implementations", "lines": ["2.2.   Implementations", "", "   +==========+==========+=========+===================================================================+", "   |Language  |Confirmed |Minimum  |Implementation                                                     |", "   |          |Compatible|Version  |                                                                   |", "   |          |with Spec |Confirmed|                                                                   |", "   |          |Version   |         |                                                                   |", "   +==========+==========+=========+===================================================================+", "   |C         |n/a       |n/a      |local_cache.c (https://github.com/aws/aws-encryption-sdk-          |", "   |          |          |         |c/blob/master/source/local_cache.c)                                |", "   +----------+----------+---------+-------------------------------------------------------------------+", "   |Javascript|0.1.0     |0.1.0    |get_local_cryptographic_materials_cache.ts (https://github.com/aws/|", "   |          |          |         |aws-encryption-sdk-javascript/blob/master/modules/cache-           |", "   |          |          |         |material/src/get_local_cryptographic_materials_cache.ts)           |", "   +----------+----------+---------+-------------------------------------------------------------------+", "   |Python    |n/a       |n/a      |caches/local.py (https://github.com/aws/aws-encryption-sdk-        |", "   |          |          |         |python/blob/master/src/aws_encryption_sdk/caches/local.py)         |", "   +----------+----------+---------+-------------------------------------------------------------------+", "   |Java      |0.1.0     |1.3.0    |LocalCryptoMaterialsCache.java (https://github.com/aws/aws-        |", "   |          |          |         |encryption-sdk-                                                    |", "   |          |          |         |java/blob/master/src/main/java/com/amazonaws/encryptionsdk/caching/|", "   |          |          |         |LocalCryptoMaterialsCache.java)                                    |", "   +----------+----------+---------+-------------------------------------------------------------------+", "", "                                  Table 1", ""]}, {"id": "2.3", "title": "Overview", "lines": ["2.3.   Overview", "", "   The local Cryptographic Materials Cache (local CMC) is a built-in", "   implementation of the CMC interface (cryptographic-materials-", "   cache.md) provided by the AWS Encryption SDK.  The local CMC is a", "   configurable, in-memory, least recently used (LRU) cache.  It", "   provides atomic access to cache entries (cryptographic-materials-", "   cache.md#cache-entry) per cache identifier (cryptographic-materials-", "   cache.md#cache-identifier).", ""]}, {"id": "2.4", "title": "Definitions", "lines": ["2.4.   Definitions", ""]}, {"id": "2.4.1", "title": "document", "lines": [[[[34], 224, "The key words \"MUST\", \"MUST NOT\", \"REQUIRED\", \"SHALL\", \"SHALL NOT\", \"SHOULD\", \"SHOULD NOT\", \"RECOMMENDED\", \"MAY\", and \"OPTIONAL\" in this document are to be interpreted as described in RFC 2119 (https://tools.ietf.org/html/rfc2119)."]]], "requirements": [34]}, {"id": "2.4.2", "title": "(TTL)", "lines": [[[[35], 224, "Each cache entry has a time-to-live (TTL) field that represents a point in time at which the cache entry MUST be considered invalid."]], [[[36], 224, "After a cache entry's TTL has elapsed, we say that the entry is _TTL- expired_, and the local CMC MUST NOT return the entry to any caller."]]], "requirements": [35, 36]}, {"id": "2.5", "title": "Initialization", "lines": [[[[37], 224, "On initialization of the local CMC, the caller MUST provide the following:"]], [[[38], 224, "The local CMC MUST also define the following:"]]], "requirements": [37, 38]}, {"id": "2.5.1", "title": "Capacity", "lines": [[[[39], 224, "The local CMC MUST NOT store more entries than this value, except temporarily while performing a Put Cache Entry operation."]], [[[40], 224, "The local CMC MUST accept entry capacity values between zero and an implementation-defined maximum, inclusive."]]], "requirements": [39, 40]}, {"id": "2.5.2", "title": "Size", "lines": [[[[41], 224, "The _entry pruning tail size_ is the number of least recently used entries that the local CMC MUST check during Section 2.7 for TTL- expired entries to evict."]]], "requirements": [41]}, {"id": "2.6", "title": "Behaviors", "lines": ["2.6.   Behaviors", ""]}, {"id": "2.6.1", "title": "Entry", "lines": [[[[42], 224, "When calling the Put Cache Entry operation, the caller MUST provide a time delta value, which the local CMC uses to derive the cache entry's time-to-live (TTL) value."]], [[[43], 224, "The local CMC MUST NOT return any TTL-expired entry."]], [[[44], 224, "When performing a Put Cache Entry operation, the local CMC MUST prune TTL-expired cache entries (Section 2.7)."]], [[[45], 96, "While performing a Put Cache Entry operation, the local CMC MAY store more entries than the entry capacity."]], [[[46], 224, "However, before returning the inserted cache entry, the local CMC MUST evict least-recently used entries until the number of stored entries does not exceed the entry capacity."]]], "requirements": [42, 43, 44, 45, 46]}, {"id": "2.6.2", "title": "Entry", "lines": [[[[47], 224, "When performing a Get Cache Entry operation, the local CMC MUST prune TTL-expired cache entries (Section 2.7)."]], [[[48], 224, "The local CMC MUST NOT return any TTL-expired entry."]]], "requirements": [47, 48]}, {"id": "2.7", "title": "Pruning", "lines": [[[[49], 224, "To prune TTL-expired cache entries, the local CMC MUST evict all TTL- expired entries among the \"N\" least recently used entries, where \"N\" is the Entry Pruning Tail Size (Section 2.5.2)."]], [[[50], 160, "The local CMC SHOULD also periodically evict all TTL-expired entries among the \"N\" least recently used entries."]]], "requirements": [49, 50]}, {"id": "3", "title": "References", "lines": ["3.   Normative References", "", "   [RFC2119]  Bradner, S., \"Key words for use in RFCs to Indicate", "              Requirement Levels\", BCP 14, RFC 2119,", "              DOI 10.17487/RFC2119, March 1997,", "              <https://www.rfc-editor.org/info/rfc2119>.", "", "   [RFC8174]  Leiba, B., \"Ambiguity of Uppercase vs Lowercase in RFC", "              2119 Key Words\", BCP 14, RFC 8174, DOI 10.17487/RFC8174,", "              May 2017, <https://www.rfc-editor.org/info/rfc8174>.", "", "Acknowledgments", "", "Author's Address", "", "   Amazon AWS", "   Amazon AWS", "", "   Email: cryptools+rfc@amazon.com"]}]}, "compliance/framework/cryptographic-materials-cache.txt": {"requirements": [51, 52, 53, 54], "sections": [{"id": "1", "title": "Definitions", "lines": ["1.   Conventions and Definitions", "", "   The key words \"MUST\", \"MUST NOT\", \"REQUIRED\", \"SHALL\", \"SHALL NOT\",", "   \"SHOULD\", \"SHOULD NOT\", \"RECOMMENDED\", \"NOT RECOMMENDED\", \"MAY\", and", "   \"OPTIONAL\" in this document are to be interpreted as described in BCP", "   14 [RFC2119] [RFC8174] when, and only when, they appear in all", "   capitals, as shown here", ""]}, {"id": "2", "title": "Interface", "lines": ["2.   Cryptographic Materials Cache Interface", ""]}, {"id": "2.1", "title": "Version", "lines": ["2.1.   Version", "", "   0.3.0", ""]}, {"id": "2.1.1", "title": "Changelog", "lines": ["2.1.1.   Changelog", "", "   *  0.3.0", "", "      -  Return Nothing from Put Cache Entry in Cryptographic Materials", "         Cache (../changes/2020-07-20_put-cache-entry-returns-nothing/", "         change.md)", "", "   *  0.2.0", "", "      -  Refactor Cryptographic Materials Cache Specification", "         (../changes/2020-07-14_refactor-cmc-spec/change.md)", "", "   *  0.1.0-preview", "", "      -  Initial record", ""]}, {"id": "2.2", "title": "Implementations", "lines": ["2.2.   Implementations", "", "   +==========+=============+=========+===================================================================+", "   |Language  |Confirmed    |Minimum  |Implementation                                                     |", "   |          |Compatible   |Version  |                                                                   |", "   |          |with Spec    |Confirmed|                                                                   |", "   |          |Version      |         |                                                                   |", "   +==========+=============+=========+===================================================================+", "   |C         |0.1.0-preview|0.1.0    |cache.h (https://github.com/aws/aws-encryption-sdk-                |", "   |          |             |         |c/blob/master/include/aws/cryptosdk/cache.h)                       |", "   +----------+-------------+---------+-------------------------------------------------------------------+", "   |Javascript|0.1.0-preview|0.1.0    |cryptographic_materials_cache.ts (https://github.com/awslabs/aws-  |", "   |          |             |         |encryption-sdk-javascript/blob/master/modules/cache-material/src/  |", "   |          |             |         |cryptographic_materials_cache.ts)                                  |", "   +----------+-------------+---------+-------------------------------------------------------------------+", "   |Python    |0.1.0-preview|1.3.0    |caches/base.py (https://github.com/aws/aws-encryption-sdk-         |", "   |          |             |         |python/blob/master/src/aws_encryption_sdk/caches/base.py)          |", "   +----------+-------------+---------+-------------------------------------------------------------------+", "   |Java      |0.1.0-preview|1.3.0    |CryptoMaterialsCache.java (https://github.com/aws/aws-encryption-  |", "   |          |             |         |sdk-                                                               |", "   |          |             |         |java/blob/master/src/main/java/com/amazonaws/encryptionsdk/caching/|", "   |          |             |         |CryptoMaterialsCache.java)                                         |", "   +----------+-------------+---------+-------------------------------------------------------------------+", "", "                                  Table 1", ""]}, {"id": "2.3", "title": "Overview", "lines": [[[[51], 224, "This document describes the interface that all CMCs MUST implement."]]], "requirements": [51]}, {"id": "2.4", "title": "Definitions", "lines": ["2.4.   Definitions", ""]}, {"id": "2.4.1", "title": "document", "lines": [[[[52], 224, "The key words \"MUST\", \"MUST NOT\", \"REQUIRED\", \"SHALL\", \"SHALL NOT\", \"SHOULD\", \"SHOULD NOT\", \"RECOMMENDED\", \"MAY\", and \"OPTIONAL\" in this document are to be interpreted as described in RFC 2119 (https://tools.ietf.org/html/rfc2119)."]]], "requirements": [52]}, {"id": "2.5", "title": "Concepts", "lines": ["2.5.   Concepts", ""]}, {"id": "2.5.1", "title": "Identifier", "lines": ["2.5.1.   Cache Identifier", "", "   The cache identifier used to uniquely identify a single cache entry", "   in the cryptographic materials cache.", ""]}, {"id": "2.5.2", "title": "Entry", "lines": ["2.5.2.   Cache Entry", "", "   A cache entry represents an entry in the cryptographic materials", "   cache.  A cache entry contains the cryptographic materials,", "   encryption (structures.md#encryption-materials) or decryption", "   (structures.md#decryption-materials) materials to be cached along", "   with other metadata.  Some implementations of the CMC have the", "   following metadata:", "", "   *  Creation Time (Section 2.5.2.1)", "", "   *  Expiry Time (Section 2.5.2.2)", "", "   *  Usage Metadata (Section 2.5.2.3)", ""]}, {"id": "2.5.2.1", "title": "Time", "lines": ["2.5.2.1.   Creation Time", "", "   Timestamp when the cache entry was created.", ""]}, {"id": "2.5.2.2", "title": "Time", "lines": ["2.5.2.2.   Expiry Time", "", "   Timestamp when the cache entry expires.", ""]}, {"id": "2.5.2.3", "title": "Metadata", "lines": ["2.5.2.3.   Usage Metadata", "", "   The usage metadata is of the following two types:", "", "   *  Messages Usage (Section 2.5.2.3.1)", "", "   *  Bytes Usage (Section 2.5.2.3.2)", "", "2.5.2.3.1.  Message Usage", "", "   The number of messages encrypted by the encryption", "   (structures.md#encryption-materials) materials cached in this cache", "   entry.", "", "2.5.2.3.2.  Bytes Usage", "", "   The number of bytes encrypted by the encryption", "   (structures.md#encryption-materials) materials cached in this cache", "   entry.", ""]}, {"id": "2.6", "title": "CMCs", "lines": ["2.6.   Supported CMCs", "", "   The AWS Encryption SDK provides a built-in local cryptographic", "   materials cache (local-cryptographic-materials-cache.md) (local CMC).", "   The local CMC is a configurable, in-memory, least recently used (LRU)", "   cache.  It provides non-blocking, locking, cache entries", "   (Section 2.5.2) per cache identifier (Section 2.5.1).", ""]}, {"id": "2.7", "title": "Behaviors", "lines": ["2.7.   Behaviors", "", "   The Cryptographic Materials Cache provides behaviours for putting", "   cache entries, getting cache entries and deleting cache entries.", ""]}, {"id": "2.7.1", "title": "Entry", "lines": [[[[53], 224, "This operation MUST NOT return the inserted cache entry."]]], "requirements": [53]}, {"id": "2.7.2", "title": "Entry", "lines": [[[[54], 224, "The CMC MUST validate that the cache entry is valid prior to returning the cache entry."]]], "requirements": [54]}, {"id": "2.7.3", "title": "Entry", "lines": ["2.7.3.   Delete Cache Entry", "", "   Attempts to delete a cache entry from the CMC.", ""]}, {"id": "3", "title": "References", "lines": ["3.   Normative References", "", "   [RFC2119]  Bradner, S., \"Key words for use in RFCs to Indicate", "              Requirement Levels\", BCP 14, RFC 2119,", "              DOI 10.17487/RFC2119, March 1997,", "              <https://www.rfc-editor.org/info/rfc2119>.", "", "   [RFC8174]  Leiba, B., \"Ambiguity of Uppercase vs Lowercase in RFC", "              2119 Key Words\", BCP 14, RFC 8174, DOI 10.17487/RFC8174,", "              May 2017, <https://www.rfc-editor.org/info/rfc8174>.", "", "Acknowledgments", "", "Author's Address", "", "   Amazon AWS", "   Amazon AWS", "", "   Email: cryptools+rfc@amazon.com"]}]}, "compliance/framework/algorithm-suites.txt": {"requirements": [55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70], "sections": [{"id": "1", "title": "Definitions", "lines": ["1.   Conventions and Definitions", "", "   The key words \"MUST\", \"MUST NOT\", \"REQUIRED\", \"SHALL\", \"SHALL NOT\",", "   \"SHOULD\", \"SHOULD NOT\", \"RECOMMENDED\", \"NOT RECOMMENDED\", \"MAY\", and", "   \"OPTIONAL\" in this document are to be interpreted as described in BCP", "   14 [RFC2119] [RFC8174] when, and only when, they appear in all", "   capitals, as shown here", ""]}, {"id": "2", "title": "Suites", "lines": ["2.   Algorithm Suites", ""]}, {"id": "2.1", "title": "Version", "lines": ["2.1.   Version", "", "   0.2.0", ""]}, {"id": "2.10", "title": "Structure", "lines": ["2.10.   Structure", "", "   The fields described below are REQUIRED to be specified by algorithm", "   suites, unless otherwise specified.", ""]}, {"id": "2.10.1", "title": "ID", "lines": ["2.10.1.   Algorithm Suite ID", "", "   A 2-byte hex value that uniquely identifies an algorithm suite.", ""]}, {"id": "2.10.10", "title": "Key", "lines": ["2.10.10.   Commit Key", "", "   A key that is used to provide key commitment (Section 2.10.9) to AES-", "   GCM.", ""]}, {"id": "2.10.11", "title": "Algorithm", "lines": [[[[69], 224, "The specified KDF algorithm MUST be used to generate the commit key (Section 2.10.10)."]]], "requirements": [69]}, {"id": "2.10.11.1", "title": "Algorithm", "lines": ["2.10.11.1.   Supported Commit Key Derivation Algorithm", "", "   *  HKDF (Section 2.4.5.2)", ""]}, {"id": "2.10.12", "title": "Length", "lines": ["2.10.12.   Commit Key Length", "", "   The length of the commit key used to verify key commitment", "   (Section 2.10.9).", ""]}, {"id": "2.10.13", "title": "Algorithm", "lines": ["2.10.13.   Signature Algorithm", "", "   This field is OPTIONAL.", "", "   The signature algorithm defines what algorithm to use for signature", "   generation and verification.", "", "   If the algorithm suite includes a signature algorithm:", "", "   *  Signatures MUST be generated using the specified signature", "      algorithm.", "", "   *  Signatures MUST be verified using the specified signature", "      algorithm.", "", "   If the algorithm suite does not include a signature algorithm:", "", "   *  Signatures MUST NOT be generated.", "", "   *  Signatures MUST NOT be verified.", ""]}, {"id": "2.10.13.1", "title": "Algorithms", "lines": ["2.10.13.1.   Supported Signature Algorithms", "", "   *  ECDSA with P256 and SHA256 (Section 2.4.6)", "", "   *  ECDSA with P384 and SHA384 (Section 2.4.6)", ""]}, {"id": "2.10.14", "title": "Version", "lines": ["2.10.14.   Message Format Version", "", "   Indicates the message format version for the supported algorithm", "   suite.", ""]}, {"id": "2.10.14.1", "title": "Version", "lines": ["2.10.14.1.   Supported Message Format Version", "", "   *  1.0", "", "   *  2.0", ""]}, {"id": "2.10.15", "title": "Data", "lines": ["2.10.15.   Algorithm Suite Data", "", "   Algorithm suites may capture a variable-per-algorithm-suite length of", "   data relevant to that algorithm suite's mode of operation.", ""]}, {"id": "2.10.15.1", "title": "Data", "lines": ["2.10.15.1.   Supported Algorithm Suite Data", "", "   *  Algorithm Suite 05 78 MUST store the commit key in the suite data", "", "   *  Algorithm Suite 04 78 MUST store the commit key in the suite data", ""]}, {"id": "2.10.16", "title": "Length", "lines": [[[[70], 96, "The field MAY be length 0."]]], "requirements": [70]}, {"id": "2.10.16.1", "title": "Lengths", "lines": ["2.10.16.1.   Supported Algorithm Suite Data Lengths", "", "   *  32", ""]}, {"id": "2.10.2", "title": "Algorithm", "lines": [[[[65], 224, "The length of the input encryption key MUST equal the encryption key length (Section 2.10.4) specified by the algorithm suite."]]], "requirements": [65]}, {"id": "2.10.2.1", "title": "Algorithms", "lines": ["2.10.2.1.   Supported Encryption Algorithms", "", "   *  Section 2.4.2", ""]}, {"id": "2.10.3", "title": "Mode", "lines": [[[[66], 224, "The length of the input IV MUST equal the IV length specified by the algorithm suite."]], [[[67], 224, "The length of the authentication tag MUST equal the authentication tag length specified by the algorithm suite."]]], "requirements": [66, 67]}, {"id": "2.10.3.1", "title": "Modes", "lines": ["2.10.3.1.   Supported Encryption Algorithm Modes", "", "   *  Section 2.4.3", ""]}, {"id": "2.10.4", "title": "Length", "lines": ["2.10.4.   Encryption Key Length", "", "   The length of the encryption key used as input to the encryption", "   algorithm.", ""]}, {"id": "2.10.5", "title": "Length", "lines": ["2.10.5.   IV Length", "", "   The length of the initialization vector (IV) used with the encryption", "   algorithm.", ""]}, {"id": "2.10.6", "title": "Length", "lines": ["2.10.6.   Authentication Tag Length", "", "   The length of the authentication tag used with AEAD.", ""]}, {"id": "2.10.7", "title": "Algorithm", "lines": [[[[68], 224, "The specified KDF algorithm MUST be used to generate the encryption algorithm encryption key input."]]], "requirements": [68]}, {"id": "2.10.7.1", "title": "Algorithms", "lines": ["2.10.7.1.   Supported Encryption Key Derivation Algorithms", "", "   *  Identity KDF (Section 2.4.4)", "", "   *  HKDF (Section 2.4.5.1)", ""]}, {"id": "2.10.8", "title": "Length", "lines": ["2.10.8.   Key Derivation Input Length", "", "   The length of the input to the Key Derivation Algorithm.", ""]}, {"id": "2.10.9", "title": "Commitment", "lines": ["2.10.9.   Key Commitment", "", "   AES-GCM is not key committing by default.  Key commitment is a", "   property, which ensures that exactly one data key can be used to", "   decrypt a ciphertext.  However, not all algorithm suites provide this", "   property.", ""]}, {"id": "2.10.9.1", "title": "Values", "lines": ["2.10.9.1.   Supported Key Commitment Values", "", "   *  True", "", "   *  False", ""]}, {"id": "2.11", "title": "Considerations", "lines": ["2.11.   Security Considerations", ""]}, {"id": "2.11.1", "title": "use?", "lines": ["2.11.1.   Which algorithm suite should I use?", "", "   You should use the default algorithm suite.", "", "   You should use an algorithm suite that supports key commitment.", "", "   You may use the non-default AES-GCM with key derivation and signing", "   key algorithm suites if key derivation input lengths of other sizes", "   are required.", "", "   If the users who encrypt and the users who decrypt are equally", "   trusted, you may use AES-GCM with only key derivation algorithm", "   suites.", "", "   You should not use AES-GCM with only key derivation algorithm suites", "   if the users who encrypt and the users who decrypt are not equally", "   trusted.", "", "   You should not use AES-GCM without key Derivation or signing, except", "   for backwards compatibility.", ""]}, {"id": "2.2", "title": "Implementations", "lines": ["2.2.   Implementations", "", "   *  C (https://github.com/awslabs/aws-encryption-sdk-", "      c/blob/master/source/cipher.c)", "", "   *  NodeJS (https://github.com/awslabs/aws-encryption-sdk-", "      javascript/blob/master/modules/material-management/src/", "      node_algorithms.ts)", "", "   *  Browser JS (https://github.com/awslabs/aws-encryption-sdk-", "      javascript/blob/master/modules/material-management/src/", "      web_crypto_algorithms.ts)", "", "   *  Python (https://github.com/aws/aws-encryption-sdk-", "      python/blob/master/src/aws_encryption_sdk/identifiers.py)", "", "   *  Java (https://github.com/aws/aws-encryption-sdk-", "      java/blob/master/src/main/java/com/amazonaws/encryptionsdk/", "      CryptoAlgorithm.java)", ""]}, {"id": "2.3", "title": "Overview", "lines": [[[[55], 224, "The algorithm suite defines the behaviors the AWS Encryption SDK MUST follow for cryptographic operations."]]], "requirements": [55]}, {"id": "2.4", "title": "Definitions", "lines": ["2.4.   Definitions", ""]}, {"id": "2.4.1", "title": "document", "lines": [[[[56], 224, "The key words \"MUST\", \"MUST NOT\", \"REQUIRED\", \"SHALL\", \"SHALL NOT\", \"SHOULD\", \"SHOULD NOT\", \"RECOMMENDED\", \"MAY\", and \"OPTIONAL\" in this document are to be interpreted as described in RFC 2119 (https://tools.ietf.org/html/rfc2119)."]]], "requirements": [56]}, {"id": "2.4.2", "title": "AES", "lines": ["2.4.2.   AES", "", "   Specification: NIST FIPS 297 (https://nvlpubs.nist.gov/nistpubs/FIPS/", "   NIST.FIPS.197.pdf)", "", "   The Advanced Encryption Standard (AES) is a symmetric block cipher", "   encryption algorithm.", ""]}, {"id": "2.4.3", "title": "GCM", "lines": [[[[57], 224, "If specified to use GCM, the AWS Encryption SDK MUST use GCM with the following specifics:"]]], "requirements": [57]}, {"id": "2.4.4", "title": "KDF", "lines": [[[[58], 224, "The Identity KDF MUST take a byte sequence as input, and MUST return the input, unchanged, as output."]], [[[59], 224, "If included in the algorithm suite, the algorithm suite's encryption key length MUST equal the algorithm suite's key derivation input length (Section 2.10.8)."]]], "requirements": [58, 59]}, {"id": "2.4.5", "title": "HKDF", "lines": ["2.4.5.   HKDF", "", "   Specification: RFC 5869 (https://tools.ietf.org/html/rfc5869)", "", "   The HMAC-based extract-and-expand key derivation function (HKDF) is a", "   key derivation algorithm.", ""]}, {"id": "2.4.5.1", "title": "Key", "lines": [[[[60], 224, "If an algorithm suite uses HKDF to derive the encryption key the AWS Encryption SDK MUST use HKDF with the following specifics:"]]], "requirements": [60]}, {"id": "2.4.5.2", "title": "Key", "lines": [[[[61], 224, "If an algorithm suite uses HKDF to derive the commitment key the AWS Encryption SDK MUST use HKDF with the following specifics:"]], [[[62], 160, "For algorithm suites that support commitment, the AWS Encryption SDK SHOULD only perform the extract step once and use the same output from the extract step for both the encryption key and the commitment key."]], [[[63], 224, "Verification of the commitment key MUST be a constant time comparison."]]], "requirements": [61, 62, 63]}, {"id": "2.4.6", "title": "ECDSA", "lines": [[[[64], 224, "If specified to use ECDSA, the AWS Encryption SDK MUST use ECDSA with the following specifics:"]]], "requirements": [64]}, {"id": "2.5", "title": "Suites", "lines": ["2.5.   Supported Algorithm Suites", "", "   The following table includes the algorithm suites supported by the", "   AWS Encryption SDK.  The value \"00 00\" is reserved and MUST NOT be", "   used as an Algorithm Suite ID in the future.", "", "    +==========================+================+=====================+", "    | Algorithm Suite ID (hex) | Message Format | Algorithm Suite     |", "    |                          | Version        | Data Length (bytes) |", "    +==========================+================+=====================+", "    | 05 78                    | 2.0            | 32                  |", "    +--------------------------+----------------+---------------------+", "    | 04 78                    | 2.0            | 32                  |", "    +--------------------------+----------------+---------------------+", "    | 03 78                    | 1.0            | N/A                 |", "    +--------------------------+----------------+---------------------+", "    | 03 46                    | 1.0            | N/A                 |", "    +--------------------------+----------------+---------------------+", "    | 02 14                    | 1.0            | N/A                 |", "    +--------------------------+----------------+---------------------+", "    | 01 78                    | 1.0            | N/A                 |", "    +--------------------------+----------------+---------------------+", "    | 01 46                    | 1.0            | N/A                 |", "    +--------------------------+----------------+---------------------+", "    | 01 14                    | 1.0            | N/A                 |", "    +--------------------------+----------------+---------------------+", "    | 00 78                    | 1.0            | N/A                 |", "    +--------------------------+----------------+---------------------+", "    | 00 46                    | 1.0            | N/A                 |", "    +--------------------------+----------------+---------------------+", "    | 00 14                    | 1.0            | N/A                 |", "    +--------------------------+----------------+---------------------+", "", "                                  Table 1", ""]}, {"id": "2.6", "title": "Settings", "lines": ["2.6.   Algorithm Suites Encryption Key Derivation Settings", "", "   The following table includes key derivation information for supported", "   algorithm suites.", "", "   +===========+============+===========+==========+======+============+", "   | Algorithm |Key         | Algorithm | Hash     |Salt  | Key        |", "   | Suite ID  |Derivation  |           | Function |Length| Commitment |", "   | (hex)     |Input Length|           |          |(bits)|            |", "   |           |(bits)      |           |          |      |            |", "   +===========+============+===========+==========+======+============+", "   | 05 78     |256         | HKDF      | SHA-512  |256   | True       |", "   +-----------+------------+-----------+----------+------+------------+", "   | 04 78     |256         | HKDF      | SHA-512  |256   | True       |", "   +-----------+------------+-----------+----------+------+------------+", "   | 03 78     |256         | HKDF      | SHA-384  |0     | False      |", "   +-----------+------------+-----------+----------+------+------------+", "   | 03 46     |192         | HKDF      | SHA-384  |0     | False      |", "   +-----------+------------+-----------+----------+------+------------+", "   | 02 14     |128         | HKDF      | SHA-256  |0     | False      |", "   +-----------+------------+-----------+----------+------+------------+", "   | 01 78     |256         | HKDF      | SHA-256  |0     | False      |", "   +-----------+------------+-----------+----------+------+------------+", "   | 01 46     |192         | HKDF      | SHA-256  |0     | False      |", "   +-----------+------------+-----------+----------+------+------------+", "   | 01 14     |128         | HKDF      | SHA-256  |0     | False      |", "   +-----------+------------+-----------+----------+------+------------+", "   | 00 78     |256         | Identity  | N/A      |0     | False      |", "   |           |            | KDF       |          |      |            |", "   +-----------+------------+-----------+----------+------+------------+", "   | 00 46     |192         | Identity  | N/A      |0     | False      |", "   |           |            | KDF       |          |      |            |", "   +-----------+------------+-----------+----------+------+------------+", "   | 00 14     |128         | Identity  | N/A      |0     | False      |", "   |           |            | KDF       |          |      |            |", "   +-----------+------------+-----------+----------+------+------------+", "", "                                  Table 2", ""]}, {"id": "2.7", "title": "Settings", "lines": ["2.7.   Algorithm Suites Encryption Settings", "", "   The following table includes the encryption settings for supported", "   algorithm suites.", "", "   +=========+==========+==========+==========+=======+================+", "   |Algorithm|Encryption|Encryption|Encryption|IV     | Authentication |", "   |Suite ID |Algorithm |Algorithm |Key Length|Length | Tag Length     |", "   |(hex)    |          |Mode      |(bits)    |(bytes)| (bytes)        |", "   +=========+==========+==========+==========+=======+================+", "   |05 78    |AES       |GCM       |256       |12     | 16             |", "   +---------+----------+----------+----------+-------+----------------+", "   |04 78    |AES       |GCM       |256       |12     | 16             |", "   +---------+----------+----------+----------+-------+----------------+", "   |03 78    |AES       |GCM       |256       |12     | 16             |", "   +---------+----------+----------+----------+-------+----------------+", "   |03 46    |AES       |GCM       |192       |12     | 16             |", "   +---------+----------+----------+----------+-------+----------------+", "   |02 14    |AES       |GCM       |128       |12     | 16             |", "   +---------+----------+----------+----------+-------+----------------+", "   |01 78    |AES       |GCM       |256       |12     | 16             |", "   +---------+----------+----------+----------+-------+----------------+", "   |01 46    |AES       |GCM       |192       |12     | 16             |", "   +---------+----------+----------+----------+-------+----------------+", "   |01 14    |AES       |GCM       |128       |12     | 16             |", "   +---------+----------+----------+----------+-------+----------------+", "   |00 78    |AES       |GCM       |256       |12     | 16             |", "   +---------+----------+----------+----------+-------+----------------+", "   |00 46    |AES       |GCM       |192       |12     | 16             |", "   +---------+----------+----------+----------+-------+----------------+", "   |00 14    |AES       |GCM       |128       |12     | 16             |", "   +---------+----------+----------+----------+-------+----------------+", "", "                                  Table 3", ""]}, {"id": "2.8", "title": "Settings", "lines": ["2.8.   Algorithm Suites Commit Key Derivation Settings", "", "   The following table includes commitment information for supported", "   algorithm suites.  These values are only relevant to algorithm suites", "   that support key commitment (Section 2.10.9).", "", "    +================+================+===========+==========+========+", "    | Algorithm      | Key Derivation | Algorithm | Hash     | Salt   |", "    | Suite ID (hex) | Input Length   |           | Function | Length |", "    |                | (bits)         |           |          | (bits) |", "    +================+================+===========+==========+========+", "    | 05 78          | 256            | HKDF      | SHA-512  | 256    |", "    +----------------+----------------+-----------+----------+--------+", "    | 04 78          | 256            | HKDF      | SHA-512  | 256    |", "    +----------------+----------------+-----------+----------+--------+", "    | 03 78          | N/A            | N/A       | N/A      | N/A    |", "    +----------------+----------------+-----------+----------+--------+", "    | 03 46          | N/A            | N/A       | N/A      | N/A    |", "    +----------------+----------------+-----------+----------+--------+", "    | 02 14          | N/A            | N/A       | N/A      | N/A    |", "    +----------------+----------------+-----------+----------+--------+", "    | 01 78          | N/A            | N/A       | N/A      | N/A    |", "    +----------------+----------------+-----------+----------+--------+", "    | 01 46          | N/A            | N/A       | N/A      | N/A    |", "    +----------------+----------------+-----------+----------+--------+", "    | 01 14          | N/A            | N/A       | N/A      | N/A    |", "    +----------------+----------------+-----------+----------+--------+", "    | 00 78          | N/A            | N/A       | N/A      | N/A    |", "    +----------------+----------------+-----------+----------+--------+", "    | 00 46          | N/A            | N/A       | N/A      | N/A    |", "    +----------------+----------------+-----------+----------+--------+", "    | 00 14          | N/A            | N/A       | N/A      | N/A    |", "    +----------------+----------------+-----------+----------+--------+", "", "                                  Table 4", ""]}, {"id": "2.9", "title": "Settings", "lines": ["2.9.   Algorithm Suites Signature Settings", "", "   The following table includes signature information for supported", "   algorithm suites.", "", "        +==========================+==============================+", "        | Algorithm Suite ID (hex) | Signature Algorithm          |", "        +==========================+==============================+", "        | 05 78                    | ECDSA with P-384 and SHA-384 |", "        +--------------------------+------------------------------+", "        | 04 78                    | Not applicable               |", "        +--------------------------+------------------------------+", "        | 03 78                    | ECDSA with P-384 and SHA-384 |", "        +--------------------------+------------------------------+", "        | 03 46                    | ECDSA with P-384 and SHA-384 |", "        +--------------------------+------------------------------+", "        | 02 14                    | ECDSA with P-256 and SHA-256 |", "        +--------------------------+------------------------------+", "        | 01 78                    | Not applicable               |", "        +--------------------------+------------------------------+", "        | 01 46                    | Not applicable               |", "        +--------------------------+------------------------------+", "        | 01 14                    | Not applicable               |", "        +--------------------------+------------------------------+", "        | 00 78                    | Not applicable               |", "        +--------------------------+------------------------------+", "        | 00 46                    | Not applicable               |", "        +--------------------------+------------------------------+", "        | 00 14                    | Not applicable               |", "        +--------------------------+------------------------------+", "", "                                  Table 5", ""]}, {"id": "3", "title": "References", "lines": ["3.   Normative References", "", "   [RFC2119]  Bradner, S., \"Key words for use in RFCs to Indicate", "              Requirement Levels\", BCP 14, RFC 2119,", "              DOI 10.17487/RFC2119, March 1997,", "              <https://www.rfc-editor.org/info/rfc2119>.", "", "   [RFC8174]  Leiba, B., \"Ambiguity of Uppercase vs Lowercase in RFC", "              2119 Key Words\", BCP 14, RFC 8174, DOI 10.17487/RFC8174,", "              May 2017, <https://www.rfc-editor.org/info/rfc8174>.", "", "Acknowledgments", "", "Author's Address", "", "   Amazon AWS", "   Amazon AWS", "", "   Email: cryptools+rfc@amazon.com"]}]}, "compliance/framework/default-cmm.txt": {"requirements": [71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93], "sections": [{"id": "1", "title": "Definitions", "lines": ["1.   Conventions and Definitions", "", "   The key words \"MUST\", \"MUST NOT\", \"REQUIRED\", \"SHALL\", \"SHALL NOT\",", "   \"SHOULD\", \"SHOULD NOT\", \"RECOMMENDED\", \"NOT RECOMMENDED\", \"MAY\", and", "   \"OPTIONAL\" in this document are to be interpreted as described in BCP", "   14 [RFC2119] [RFC8174] when, and only when, they appear in all", "   capitals, as shown here", ""]}, {"id": "2", "title": "Manager", "lines": ["2.   Default Cryptographic Materials Manager", ""]}, {"id": "2.1", "title": "Version", "lines": ["2.1.   Version", "", "   0.3.0", ""]}, {"id": "2.1.1", "title": "Changelog", "lines": ["2.1.1.   Changelog", "", "   *  0.3.0", "", "      -  Clarify handling of the \"aws-crypto-public-key\" encryption", "         context key.", "", "   *  0.2.1", "", "      -  Record how the default CMM uses master key providers", "         (https://github.com/awslabs/aws-encryption-sdk-specification/", "         issues/98)", "", "   *  0.2.0", "", "      -  Remove Keyring Trace (../changes/2020-05-13_remove-keyring-", "         trace/change.md)", "", "   *  0.1.0-preview", "", "      -  Initial record", ""]}, {"id": "2.2", "title": "Implementations", "lines": ["2.2.   Implementations", "", "   +========+=============+=========+=============================================================+", "   |Language|Confirmed    |Minimum  |Implementation                                               |", "   |        |Compatible   |Version  |                                                             |", "   |        |with Spec    |Confirmed|                                                             |", "   |        |Version      |         |                                                             |", "   +========+=============+=========+=============================================================+", "   |C       |0.1.0-preview|0.1.0    |default_cmm.h (https://github.com/aws/aws-encryption-sdk-    |", "   |        |             |         |c/blob/master/include/aws/cryptosdk/default_cmm.h)           |", "   +--------+-------------+---------+-------------------------------------------------------------+", "   |NodeJS  |0.1.0-preview|0.1.0    |node_cryptographic_materials_manager.ts                      |", "   |        |             |         |(https://github.com/awslabs/aws-encryption-sdk-              |", "   |        |             |         |javascript/blob/master/modules/material-management-node/src/ |", "   |        |             |         |node_cryptographic_materials_manager.ts)                     |", "   +--------+-------------+---------+-------------------------------------------------------------+", "   |Browser |0.1.0-preview|0.1.0    |browser_cryptographic_materials_manager.ts                   |", "   |JS      |             |         |(https://github.com/awslabs/aws-encryption-sdk-              |", "   |        |             |         |javascript/blob/master/modules/material-management-          |", "   |        |             |         |browser/src/browser_cryptographic_materials_manager.ts)      |", "   +--------+-------------+---------+-------------------------------------------------------------+", "   |Python  |0.1.0-preview|1.3.0    |materials_managers/default.py (https://github.com/aws/aws-   |", "   |        |             |         |encryption-sdk-                                              |", "   |        |             |         |python/blob/master/src/aws_encryption_sdk/materials_managers/|", "   |        |             |         |default.py)                                                  |", "   +--------+-------------+---------+-------------------------------------------------------------+", "   |Java    |0.1.0-preview|1.3.0    |DefaultCryptoMaterialsManager.java (https://github.com/aws/  |", "   |        |             |         |aws-encryption-sdk-                                          |", "   |        |             |         |java/blob/master/src/main/java/com/amazonaws/encryptionsdk/  |", "   |        |             |         |DefaultCryptoMaterialsManager.java)                          |", "   +--------+-------------+---------+-------------------------------------------------------------+", "", "                                  Table 1", ""]}, {"id": "2.3", "title": "Overview", "lines": ["2.3.   Overview", "", "   The Default Cryptographic Materials Manager (CMM) is a built-in", "   implementation of the CMM interface (cmm-interface.md) provided by", "   the AWS Encryption SDK.", "", "   It is used by default to wrap the key provider.", ""]}, {"id": "2.4", "title": "Definitions", "lines": ["2.4.   Definitions", ""]}, {"id": "2.4.1", "title": "document", "lines": [[[[71], 224, "The key words \"MUST\", \"MUST NOT\", \"REQUIRED\", \"SHALL\", \"SHALL NOT\", \"SHOULD\", \"SHOULD NOT\", \"RECOMMENDED\", \"MAY\", and \"OPTIONAL\" in this document are to be interpreted as described in RFC 2119 (https://tools.ietf.org/html/rfc2119)."]]], "requirements": [71]}, {"id": "2.5", "title": "Initialization", "lines": [[[[72], 224, "On default CMM initialization, the caller MUST provide the following value:"]]], "requirements": [72]}, {"id": "2.5.1", "title": "Keyring", "lines": ["2.5.1.   Keyring", "", "   The keyring (keyring-interface.md) this CMM uses to get encryption", "   materials (Section 2.6.1) or decrypt materials (Section 2.6.2).", ""]}, {"id": "2.6", "title": "Behaviors", "lines": ["2.6.   Behaviors", ""]}, {"id": "2.6.1", "title": "Materials", "lines": [[[[73], 160, "Adding the key \"aws-crypto-public-key\" SHOULD be done to a copy of the encryption context so that the caller's encryption context is not mutated."]], [[[74], 224, "If the encryption context included in the encryption materials request (cmm-interface.md#encryption-materials- request) already contains the \"aws-crypto-public-key\" key, this operation MUST fail rather than overwrite the associated value."]], [[[75], 224, "If the algorithm suite contains a signing algorithm (algorithm- suites.md#signature-algorithm), the default CMM MUST Generate a signing key (structures.md#signing-key)."]], [[[76], 224, "If the algorithm suite contains a signing algorithm (algorithm- suites.md#signature-algorithm), the default CMM MUST Add the key- value pair of key \"aws-crypto-public-key\", value \"base64-encoded public verification key\" to the encryption context (structures.md#encryption-context)."]], [[[77], 224, "On each call to Get Encryption Materials, the default CMM MUST make a call to its keyring's (Section 2.5.1) On Encrypt (keyring- interface.md#onencrypt) operation."]], [[[78], 224, "The default CMM MUST obtain the Plaintext Data Key from the On Encrypt Response and include it in the encryption materials (structures.md#encryption-materials) returned."]], [[[79], 224, "The default CMM MUST obtain the Encrypted Data Keys (structures.md#encrypted-data-keys) from the On Encrypt Response and include it in the encryption materials (structures.md#encryption- materials) returned."]]], "requirements": [73, 74, 75, 76, 77, 78, 79]}, {"id": "2.6.2", "title": "Materials", "lines": [[[[80], 224, "If the algorithm suite contains a signing algorithm (algorithm- suites.md#signature-algorithm), the default CMM MUST extract the verification key from the encryption context under the reserved \"aws- crypto-public-key\" key."]], [[[81], 224, "If this key is not present in the encryption context, the operation MUST fail without returning any decryption materials."]], [[[82], 224, "If the algorithm suite does not contain a signing algorithm (algorithm-suites.md#signature-algorithm), but the encryption context includes the reserved \"aws-crypto-public-key\" key, the operation MUST fail without returning any decryption materials."]], [[[83, 84], 232, "The request MUST fail if the algorithm suite on the request is not supported by the commitment policy (../client-apis/ client.md#commitment-policy) on the request."]], [[[85], 224, "On each call to Decrypt Materials, the default CMM MUST make a call to its keyring's (Section 2.5.1) On Decrypt (keyring- interface.md#ondecrypt) operation."]], [[[86], 224, "The default CMM MUST obtain the Plaintext Data Key from the On Decrypt response and include it in the decrypt materials returned."]]], "requirements": [80, 81, 82, 84, 85, 86]}, {"id": "2.7", "title": "Providers", "lines": [[[[87], 224, "For implementations that support master key providers (master-key- provider-interface.md), the default CMM MUST support generating, encrypting, and decrypting data keys using master key providers."]]], "requirements": [87]}, {"id": "2.7.1", "title": "Legacy", "lines": [[[[88], 160, "Master key providers SHOULD NOT be included in any additional implementations."]]], "requirements": [88]}, {"id": "2.7.2", "title": "Initialization", "lines": ["2.7.2.   Initialization", "", "   In place of requiring the caller to provide a keyring (keyring-", "   interface.md) on initialization:", "", "   On default CMM initialization, the caller MUST provide the following", "   value:", "", "   *  Master Key Provider (master-key-provider-interface.md)", ""]}, {"id": "2.7.3", "title": "provider)", "lines": [[[[89], 224, "In place of calling its keyring's On Encrypt (keyring- interface.md#onencrypt) operation: The default CMM MUST call its master key provider's Get Master Keys for Encryption (master-key-provider-interface.md#get-master-keys-for- encryption) operation to obtain a list of master keys to use."]], [[[90], 224, "If the master key provider does not identify which master key MUST generate the data key, the default CMM MUST use the first master key in the list for that purpose."]], [[[91], 224, "The default CMM MUST generate the data key using this master key's Generate Data Key (master-key- interface.md#generate-data-key) operation."]], [[[92], 224, "For each remaining master key, the default CMM MUST call the master key's Encrypt Data Key (master-key-interface.md#encrypt-data-key) operation with the plaintext data key."]]], "requirements": [89, 90, 91, 92]}, {"id": "2.7.4", "title": "provider)", "lines": [[[[93], 224, "In place of calling its keyring's On Decrypt (keyring- interface.md#ondecrypt) operation: The default CMM MUST call its master key provider's Decrypt Data Key (master-key-provider-interface.md#decrypt-data-key) operation."]]], "requirements": [93]}, {"id": "3", "title": "References", "lines": ["3.   Normative References", "", "   [RFC2119]  Bradner, S., \"Key words for use in RFCs to Indicate", "              Requirement Levels\", BCP 14, RFC 2119,", "              DOI 10.17487/RFC2119, March 1997,", "              <https://www.rfc-editor.org/info/rfc2119>.", "", "   [RFC8174]  Leiba, B., \"Ambiguity of Uppercase vs Lowercase in RFC", "              2119 Key Words\", BCP 14, RFC 8174, DOI 10.17487/RFC8174,", "              May 2017, <https://www.rfc-editor.org/info/rfc8174>.", "", "Acknowledgments", "", "Author's Address", "", "   Amazon AWS", "   Amazon AWS", "", "   Email: cryptools+rfc@amazon.com"]}]}, "compliance/framework/raw-aes-keyring.txt": {"requirements": [94, 96, 98, 100, 102, 103, 104, 106, 108, 110, 113, 116, 119, 121, 122, 125, 128, 130, 131, 133, 135, 137, 138, 141, 143], "sections": [{"id": "1", "title": "Definitions", "lines": ["1.   Conventions and Definitions", "", "   The key words \"MUST\", \"MUST NOT\", \"REQUIRED\", \"SHALL\", \"SHALL NOT\",", "   \"SHOULD\", \"SHOULD NOT\", \"RECOMMENDED\", \"NOT RECOMMENDED\", \"MAY\", and", "   \"OPTIONAL\" in this document are to be interpreted as described in BCP", "   14 [RFC2119] [RFC8174] when, and only when, they appear in all", "   capitals, as shown here", ""]}, {"id": "2", "title": "Keyring", "lines": ["2.   Raw AES Keyring", ""]}, {"id": "2.1", "title": "Version", "lines": ["2.1.   Version", "", "   0.4.1", ""]}, {"id": "2.1.1", "title": "Changelog", "lines": ["2.1.1.   Changelog", "", "   *  0.4.1", "", "      -  Clarify keyring failure on decrypt (../changes/2020-06-04_how-", "         to-fail-with-keyrings/change.md)", "", "   *  0.4.0", "", "      -  Specify behavior for RawAESKeyring for invalid input EC", "         (../changes/2020-07-15_specify-behavior-for-raw-aes-keyring-", "         for-invalid-EC/change.md)", "", "   *  0.3.0", "", "      -  Raw AES keyring MUST NOT accept a key namespace of \"aws-kms\".", "         (https://github.com/awslabs/aws-encryption-sdk-specification/", "         issues/101)", "", "   *  0.2.0", "", "      -  Remove Keyring Trace (../changes/2020-05-13_remove-keyring-", "         trace/change.md)", "", "   *  0.1.0-preview", "", "      -  Initial record", ""]}, {"id": "2.2", "title": "Implementations", "lines": ["2.2.   Implementations", "", "   +========+=============+=========+====================================================================+", "   |Language|Confirmed    |Minimum  |Implementation                                                      |", "   |        |Compatible   |Version  |                                                                    |", "   |        |with Spec    |Confirmed|                                                                    |", "   |        |Version      |         |                                                                    |", "   +========+=============+=========+====================================================================+", "   |C       |0.1.0-preview|0.1.0    |raw_aes_keyring.c (https://github.com/aws/aws-encryption-sdk-       |", "   |        |             |         |c/blob/master/source/raw_aes_keyring.c)                             |", "   +--------+-------------+---------+--------------------------------------------------------------------+", "   |NodeJS  |0.1.0-preview|0.1.0    |raw_aes_keyring_node.ts (https://github.com/awslabs/aws-encryption- |", "   |        |             |         |sdk-javascript/blob/master/modules/raw-aes-keyring-node/src/        |", "   |        |             |         |raw_aes_keyring_node.ts)                                            |", "   +--------+-------------+---------+--------------------------------------------------------------------+", "   |Browser |0.1.0-preview|0.1.0    |raw_aes_keyring_browser.ts (https://github.com/awslabs/aws-         |", "   |JS      |             |         |encryption-sdk-javascript/blob/master/modules/raw-aes-keyring-      |", "   |        |             |         |browser/src/raw_aes_keyring_browser.ts)                             |", "   +--------+-------------+---------+--------------------------------------------------------------------+", "   |Python  |0.1.0-preview|n/a      |keyrings/raw.py (https://github.com/aws/aws-encryption-sdk-         |", "   |        |             |         |python/blob/master/src/aws_encryption_sdk/keyrings/raw.py)          |", "   +--------+-------------+---------+--------------------------------------------------------------------+", "   |Java    |0.1.0-preview|n/a      |RawAesKeyring.java (https://github.com/aws/aws-encryption-sdk-      |", "   |        |             |         |java/blob/master/src/main/java/com/amazonaws/encryptionsdk/keyrings/|", "   |        |             |         |RawAesKeyring.java)                                                 |", "   +--------+-------------+---------+--------------------------------------------------------------------+", "", "                                  Table 1", ""]}, {"id": "2.3", "title": "Overview", "lines": ["2.3.   Overview", "", "   A keyring which does local AES-GCM encryption and decryption of data", "   keys using a local wrapping key.", ""]}, {"id": "2.4", "title": "Definitions", "lines": ["2.4.   Definitions", ""]}, {"id": "2.4.1", "title": "document", "lines": [[[[94], 224, "The key words \"MUST\", \"MUST NOT\", \"REQUIRED\", \"SHALL\", \"SHALL NOT\", \"SHOULD\", \"SHOULD NOT\", \"RECOMMENDED\", \"MAY\", and \"OPTIONAL\" in this document are to be interpreted as described in RFC 2119 (https://tools.ietf.org/html/rfc2119)."]]], "requirements": [94]}, {"id": "2.4.2", "title": "AES-GCM", "lines": ["2.4.2.   AES-GCM", "", "   Advanced Encryption Standard in Galois/Counter Mode (AES-GCM) is an", "   Authenticated Encryption with Associated Data (AEAD) cipher.", "", "   Advanced Encryption Standard (AES) Specification: NIST FIPS 297", "   (https://nvlpubs.nist.gov/nistpubs/FIPS/NIST.FIPS.197.pdf)", "", "   Galois/Counter Mode (GCM) Specification: NIST Special Publication", "   800-38D (https://nvlpubs.nist.gov/nistpubs/Legacy/SP/", "   nistspecialpublication800-38d.pdf)", ""]}, {"id": "2.5", "title": "Initialization", "lines": [[[[95, 96], 232, "On keyring initialization, the caller MUST provide the following:"]]], "requirements": [96]}, {"id": "2.5.1", "title": "Key", "lines": [[[[97, 98], 240, "The wrapping key MUST be a secret value consisting of cryptographically secure pseudo-random bytes."]], [[[99, 100], 240, "It MUST be randomly generated from a cryptographically secure entropy source."]], [[[101, 102], 232, "The length of the wrapping key MUST be 128, 192, or 256."]]], "requirements": [98, 100, 102]}, {"id": "2.5.2", "title": "Algorithm", "lines": [[[[103], 224, "The keyring MUST support the following algorithm configurations:"]], [[[104], 224, "Initialization MUST fail if the length of the wrapping key (Section 2.5.1) does not match the length specified by the wrapping algorithm."]]], "requirements": [103, 104]}, {"id": "2.6", "title": "Structure", "lines": ["2.6.   Structure", ""]}, {"id": "2.6.1", "title": "Information", "lines": ["2.6.1.   Key Provider Information", "", "   This structure is a sequence of bytes in big-endian format to be used", "   as the key provider information (structures.md#key-provider-", "   information) field in encrypted data keys (structures.md#encrypted-", "   data-keys) produced by raw AES keyrings.", "", "   The following table describes the fields that form the raw AES", "   keyring key provider information.  The bytes are appended in the", "   order shown.", "", "   +================+===================================+=============+", "   | Field          | Length (bytes)                    | Interpreted |", "   |                |                                   | as          |", "   +================+===================================+=============+", "   | Key Name       | length of Key Name (./keyring-    | UTF-8       |", "   |                | interface.md#key-name)            | encoded     |", "   |                |                                   | bytes       |", "   +----------------+-----------------------------------+-------------+", "   | Authentication | 4                                 | UInt32      |", "   | Tag Length     |                                   |             |", "   +----------------+-----------------------------------+-------------+", "   | IV Length      | 4                                 | UInt32      |", "   +----------------+-----------------------------------+-------------+", "   | IV             | IV Length (Section 2.6.1.3)       | Bytes       |", "   +----------------+-----------------------------------+-------------+", "", "                                 Table 2", ""]}, {"id": "2.6.1.1", "title": "Name", "lines": ["2.6.1.1.   Key Name", "", "   The Key Name (./keyring-interface.md#key-name) of this keyring.", ""]}, {"id": "2.6.1.2", "title": "Length", "lines": [[[[105, 106], 232, "This value MUST match the authentication tag length of the keyring's configured wrapping algorithm (Section 2.5.2)."]]], "requirements": [106]}, {"id": "2.6.1.3", "title": "Length", "lines": [[[[107, 108], 232, "This value MUST match the IV length of the keyring's configured wrapping algorithm (Section 2.5.2)."]]], "requirements": [108]}, {"id": "2.6.1.4", "title": "IV", "lines": ["2.6.1.4.   IV", "", "   The bytes to use as the IV in the AES-GCM encryption.", ""]}, {"id": "2.6.2", "title": "Ciphertext", "lines": ["2.6.2.   Ciphertext", "", "   This structure is a sequence of bytes in big-endian format to be used", "   as the ciphertext (structures.md#ciphertext) field in encrypted data", "   keys (structures.md#encrypted-data-key) produced by raw AES keyrings.", "", "   The following table describes the fields that form the ciphertext for", "   this keyring.  The bytes are appended in the order shown.", "", "     +================+============================+================+", "     | Field          | Length (bytes)             | Interpreted as |", "     +================+============================+================+", "     | Encrypted Key  | length of AES-GCM          | Bytes          |", "     |                | ciphertext output          |                |", "     +----------------+----------------------------+----------------+", "     | Authentication | Authentication Tag Length  | Bytes          |", "     | Tag            | (Section 2.6.1.2) as Bytes |                |", "     +----------------+----------------------------+----------------+", "", "                                 Table 3", ""]}, {"id": "2.6.2.1", "title": "Key", "lines": ["2.6.2.1.   Encrypted Key", "", "   The ciphertext returned by the AES-GCM encryption of the plaintext", "   data key.", ""]}, {"id": "2.6.2.2", "title": "Tag", "lines": ["2.6.2.2.   Authentication Tag", "", "   The authentication tag returned by the AES-GCM encryption.", ""]}, {"id": "2.7", "title": "Operation", "lines": ["2.7.   Operation", ""]}, {"id": "2.7.1", "title": "OnEncrypt", "lines": [[[[109, 110], 232, "OnEncrypt MUST take encryption materials (structures.md#encryption- materials) as input."]], [[[111, 112, 113], 244, "If the encryption materials (structures.md#encryption-materials) do not contain a plaintext data key, OnEncrypt MUST generate a random plaintext data key and set it on the encryption materials (structures.md#encryption-materials)."]], [[[114, 115, 116], 244, "The keyring MUST encrypt the plaintext data key in the encryption materials (structures.md#encryption-materials) using AES-GCM."]], [[[117, 118, 119], 244, "The keyring MUST attempt to serialize the encryption materials' (structures.md#encryption-materials) encryption context (structures.md#encryption-context-1) in the same format as the serialization of message header AAD key value pairs (../data-format/ message-header.md#key-value-pairs)."]], [[[120, 121], 232, "If the keyring cannot serialize the encryption context, OnEncrypt MUST fail."]], [[[122], 224, "Based on the ciphertext output of the AES-GCM decryption, the keyring MUST construct an encrypted data key (structures.md#encrypted-data- key) with the following specifics:"]], [[[123, 124, 125], 244, "The keyring MUST append the constructed encrypted data key to the encrypted data key list in the encryption materials (structures.md#encryption-materials)."]], [[[126, 127, 128], 244, "OnEncrypt MUST output the modified encryption materials (structures.md#encryption-materials)."]]], "requirements": [110, 113, 116, 119, 121, 122, 125, 128]}, {"id": "2.7.2", "title": "OnDecrypt", "lines": [[[[129, 130], 232, "OnDecrypt MUST take decryption materials (structures.md#decryption- materials) and a list of encrypted data keys (structures.md#encrypted-data-key) as input."]], [[[131], 224, "If the decryption materials already contain a plaintext data key, the keyring MUST fail and MUST NOT modify the decryption materials (structures.md#decryption-materials)."]], [[[132, 133], 228, "The keyring MUST attempt to serialize the decryption materials' (structures.md#decryption-materials) encryption context (structures.md#encryption-context-1) in the same format as the serialization of the message header AAD key value pairs (../data- format/message-header.md#key-value-pairs)."]], [[[134, 135], 232, "If the keyring cannot serialize the encryption context, OnDecrypt MUST fail."]], [[[136, 137], 240, "The keyring MUST perform the following actions on each encrypted data key (structures.md#encrypted-data-key) in the input encrypted data key list, serially, until it successfully decrypts one."]], [[[138], 224, "For each encrypted data key (structures.md#encrypted-data-key), the keyring MUST first attempt to deserialize the serialized ciphertext (Section 2.6.2) to obtain the encrypted key (Section 2.6.2.1) and authentication tag (Section 2.6.2.2), and deserialize the serialized key provider info (Section 2.6.1) to obtain the key name (./keyring- interface.md#key-name), Section 2.6.1.4, IV length (Section 2.6.1.3), and authentication tag length (Section 2.6.1.2)."]], [[[139, 140, 141], 244, "If a decryption succeeds, this keyring MUST add the resulting plaintext data key to the decryption materials and return the modified materials."]], [[[142, 143], 240, "If no decryption succeeds, the keyring MUST fail and MUST NOT modify the decryption materials (structures.md#decryption-materials)."]]], "requirements": [130, 131, 133, 135, 137, 138, 141, 143]}, {"id": "3", "title": "References", "lines": ["3.   Normative References", "", "   [RFC2119]  Bradner, S., \"Key words for use in RFCs to Indicate", "              Requirement Levels\", BCP 14, RFC 2119,", "              DOI 10.17487/RFC2119, March 1997,", "              <https://www.rfc-editor.org/info/rfc2119>.", "", "   [RFC8174]  Leiba, B., \"Ambiguity of Uppercase vs Lowercase in RFC", "              2119 Key Words\", BCP 14, RFC 8174, DOI 10.17487/RFC8174,", "              May 2017, <https://www.rfc-editor.org/info/rfc8174>.", "", "Acknowledgments", "", "Author's Address", "", "   Amazon AWS", "   Amazon AWS", "", "   Email: cryptools+rfc@amazon.com"]}]}, "compliance/framework/cmm-interface.txt": {"requirements": [144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165], "sections": [{"id": "1", "title": "Definitions", "lines": ["1.   Conventions and Definitions", "", "   The key words \"MUST\", \"MUST NOT\", \"REQUIRED\", \"SHALL\", \"SHALL NOT\",", "   \"SHOULD\", \"SHOULD NOT\", \"RECOMMENDED\", \"NOT RECOMMENDED\", \"MAY\", and", "   \"OPTIONAL\" in this document are to be interpreted as described in BCP", "   14 [RFC2119] [RFC8174] when, and only when, they appear in all", "   capitals, as shown here", ""]}, {"id": "2", "title": "Interface", "lines": ["2.   Cryptographic Materials Manager Interface", ""]}, {"id": "2.1", "title": "Version", "lines": ["2.1.   Version", "", "   0.3.0", ""]}, {"id": "2.1.1", "title": "Changelog", "lines": ["2.1.1.   Changelog", "", "   *  0.3.0", "", "      -  Clarify handling of the \"aws-crypto-public-key\" encryption", "         context key.", "", "   *  0.2.0", "", "      -  Remove Keyring Trace (../changes/2020-05-13_remove-keyring-", "         trace/change.md)", "", "   *  0.1.0-preview", "", "      -  Initial record", ""]}, {"id": "2.2", "title": "Implementations", "lines": ["2.2.   Implementations", "", "   +==========+=============+=========+===========================================================+", "   |Language  |Confirmed    |Minimum  |Implementation                                             |", "   |          |Compatible   |Version  |                                                           |", "   |          |with Spec    |Confirmed|                                                           |", "   |          |Version      |         |                                                           |", "   +==========+=============+=========+===========================================================+", "   |C         |0.1.0-preview|0.1.0    |materials.h (https://github.com/aws/aws-encryption-sdk-    |", "   |          |             |         |c/blob/master/include/aws/cryptosdk/materials.h)           |", "   +----------+-------------+---------+-----------------------------------------------------------+", "   |Javascript|0.1.0-preview|0.1.0    |materials_manager.ts (https://github.com/awslabs/aws-      |", "   |          |             |         |encryption-sdk-javascript/blob/master/modules/material-    |", "   |          |             |         |management/src/materials_manager.ts)                       |", "   +----------+-------------+---------+-----------------------------------------------------------+", "   |Python    |0.1.0-preview|1.3.0    |materials_managers (https://github.com/aws/aws-encryption- |", "   |          |             |         |sdk-python/blob/master/src/aws_encryption_sdk/             |", "   |          |             |         |materials_managers/__init__.py)                            |", "   +----------+-------------+---------+-----------------------------------------------------------+", "   |Java      |0.1.0-preview|1.3.0    |CryptoMaterialsManager.java (https://github.com/aws/aws-   |", "   |          |             |         |encryption-sdk-                                            |", "   |          |             |         |java/blob/master/src/main/java/com/amazonaws/encryptionsdk/|", "   |          |             |         |CryptoMaterialsManager.java)                               |", "   +----------+-------------+---------+-----------------------------------------------------------+", "", "                                  Table 1", ""]}, {"id": "2.3", "title": "Overview", "lines": [[[[144], 224, "The CMM interface describes the interface that all CMMs MUST implement."]]], "requirements": [144]}, {"id": "2.4", "title": "Definitions", "lines": ["2.4.   Definitions", ""]}, {"id": "2.4.1", "title": "document", "lines": [[[[145], 224, "The key words \"MUST\", \"MUST NOT\", \"REQUIRED\", \"SHALL\", \"SHALL NOT\", \"SHOULD\", \"SHOULD NOT\", \"RECOMMENDED\", \"MAY\", and \"OPTIONAL\" in this document are to be interpreted as described in RFC 2119 (https://tools.ietf.org/html/rfc2119)."]]], "requirements": [145]}, {"id": "2.5", "title": "CMMs", "lines": [[[[146], 96, "Note: A user MAY create their own custom CMM."]]], "requirements": [146]}, {"id": "2.6", "title": "Interface", "lines": ["2.6.   Interface", ""]}, {"id": "2.6.1", "title": "Inputs", "lines": ["2.6.1.   Inputs", "", "   The inputs to the CMM are groups of related fields, referred to as:", "", "   *  Encryption Materials Request (Section 2.6.1.1)", "", "   *  Decrypt Materials Request (Section 2.6.1.2)", ""]}, {"id": "2.6.1.1", "title": "Request", "lines": [[[[147], 224, "The encryption materials request MUST include the following:"]], [[[148], 96, "The encryption request MAY include the following:"]]], "requirements": [147, 148]}, {"id": "2.6.1.2", "title": "Request", "lines": [[[[149], 224, "The decrypt materials request MUST include the following:"]]], "requirements": [149]}, {"id": "2.6.2", "title": "Behaviors", "lines": [[[[150], 224, "The CMM Interface MUST support the following behaviors:"]]], "requirements": [150]}, {"id": "2.6.2.1", "title": "Materials", "lines": [[[[151], 224, "When the CMM gets an encryption materials request (Section 2.6.1.1), it MUST return encryption materials (structures.md#encryption- materials) appropriate for the request."]], [[[152], 224, "The encryption materials returned MUST include the following:"]], [[[153], 160, "If the algorithm suite does not contain a signing algorithm (algorithm-suites.md#signature-algorithm): * The CMM SHOULD NOT add a key-value pair using the reserved key \"aws-crypto-public-key\" to the encryption context."]], [[[154], 224, "The CMM MUST ensure that the encryption materials returned are valid."]], [[[155], 224, "* The encryption materials returned MUST follow the specification for encryption-materials (structures.md#encryption-materials)."]], [[[156], 224, "* The value of the plaintext data key MUST be non-NULL."]], [[[157], 224, "* The plaintext data key length MUST be equal to the key derivation input length (algorithm-suites.md#key-derivation-input-length)."]], [[[158], 224, "* The encrypted data keys list MUST contain at least one encrypted data key."]], [[[159], 224, "* If the algorithm suite contains a signing algorithm, the encryption materials returned MUST include the generated signing key."]]], "requirements": [151, 152, 153, 154, 155, 156, 157, 158, 159]}, {"id": "2.6.2.2", "title": "Materials", "lines": [[[[160], 224, "When the CMM gets a decrypt materials request (Section 2.6.1.2), it MUST return decryption materials (structures.md#decryption-materials) appropriate for the request."]], [[[161], 160, "If the requested algorithm suite does not include a signing algorithm but the encryption context includes the reserved \"aws-crypto-public- key\" key, the operation SHOULD fail."]], [[[162], 160, "Likewise, if the requested algorithm suite includes a signing algorithm but the encryption context does not include the reserved \"aws-crypto-public-key\" key, the operation SHOULD fail."]], [[[163], 224, "The decryption materials returned MUST include the following:"]], [[[164], 224, "If the algorithm suite obtained from the decryption request contains a signing algorithm (algorithm-suites.md#signature-algorithm), the decryption materials MUST include the signature verification key (structures.md#verification-key)."]], [[[165], 224, "The CMM MUST ensure that the decryption materials returned are valid."]]], "requirements": [160, 161, 162, 163, 164, 165]}, {"id": "2.7", "title": "Customization", "lines": ["2.7.   Customization", "", "   The CMM is an ideal point for customization and extension.", "", "   Example scenarios include:", "", "   *  Interacting with other CMMs", "", "   *  Using Keyring(s) (keyring-interface.md)", "", "   *  Modifying the encryption context", "", "   *  Managing the signing/verification keys", "", "   *  Data key Caching", "", "   *  Providing support for policy enforcement", ""]}, {"id": "3", "title": "References", "lines": ["3.   Normative References", "", "   [RFC2119]  Bradner, S., \"Key words for use in RFCs to Indicate", "              Requirement Levels\", BCP 14, RFC 2119,", "              DOI 10.17487/RFC2119, March 1997,", "              <https://www.rfc-editor.org/info/rfc2119>.", "", "   [RFC8174]  Leiba, B., \"Ambiguity of Uppercase vs Lowercase in RFC", "              2119 Key Words\", BCP 14, RFC 8174, DOI 10.17487/RFC8174,", "              May 2017, <https://www.rfc-editor.org/info/rfc8174>.", "", "Acknowledgments", "", "Author's Address", "", "   Amazon AWS", "   Amazon AWS", "", "   Email: cryptools+rfc@amazon.com"]}]}, "compliance/framework/caching-cmm.txt": {"requirements": [166, 167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 180, 181, 182, 183, 184, 185, 186, 187, 188, 189, 190, 191, 192, 193, 194, 195, 196], "sections": [{"id": "1", "title": "Definitions", "lines": ["1.   Conventions and Definitions", "", "   The key words \"MUST\", \"MUST NOT\", \"REQUIRED\", \"SHALL\", \"SHALL NOT\",", "   \"SHOULD\", \"SHOULD NOT\", \"RECOMMENDED\", \"NOT RECOMMENDED\", \"MAY\", and", "   \"OPTIONAL\" in this document are to be interpreted as described in BCP", "   14 [RFC2119] [RFC8174] when, and only when, they appear in all", "   capitals, as shown here", ""]}, {"id": "2", "title": "Manager", "lines": ["2.   Caching Cryptographic Materials Manager", ""]}, {"id": "2.1", "title": "Version", "lines": ["2.1.   Version", "", "   0.3.0", ""]}, {"id": "2.1.1", "title": "Changelog", "lines": ["2.1.1.   Changelog", "", "   *  0.3.0", "", "      -  Specify Cache Entry Identifier Formulas for Caching", "         Cryptographic Materials Manager (../changes/2020-07-17_cache-", "         entry-identifier-formulas/change.md)", "", "   *  0.2.0", "", "      -  Clarify Caching Cryptographic Materials Manager Initialization", "         Parameters (../changes/2020-07-15_clarify-caching-cmm-init-", "         params/change.md)", "", "   *  0.1.0-preview", "", "      -  Initial record", ""]}, {"id": "2.2", "title": "Implementations", "lines": ["2.2.   Implementations", "", "   +========+==========+=========+===================================================================+", "   |Language|Confirmed |Minimum  |Implementation                                                     |", "   |        |Compatible|Version  |                                                                   |", "   |        |with Spec |Confirmed|                                                                   |", "   |        |Version   |         |                                                                   |", "   +========+==========+=========+===================================================================+", "   |C       |0.2.0     |0.1.0    |cache.h (https://github.com/aws/aws-encryption-sdk-                |", "   |        |          |         |c/blob/master/include/aws/cryptosdk/cache.h)                       |", "   +--------+----------+---------+-------------------------------------------------------------------+", "   |NodeJS  |0.2.0     |0.1.0    |caching_materials_manager_node.ts (https://github.com/awslabs/aws- |", "   |        |          |         |encryption-sdk-javascript/blob/master/modules/caching-materials-   |", "   |        |          |         |manager-node/src/caching_materials_manager_node.ts)                |", "   +--------+----------+---------+-------------------------------------------------------------------+", "   |Browser |0.2.0     |0.1.0    |caching_materials_manager_browser.ts (https://github.com/awslabs/  |", "   |JS      |          |         |aws-encryption-sdk-javascript/blob/master/modules/caching-         |", "   |        |          |         |materials-manager-browser/src/caching_materials_manager_browser.ts)|", "   +--------+----------+---------+-------------------------------------------------------------------+", "   |Python  |0.2.0     |1.3.0    |materials_managers/caching.py (https://github.com/aws/aws-         |", "   |        |          |         |encryption-sdk-                                                    |", "   |        |          |         |python/blob/master/src/aws_encryption_sdk/materials_managers/      |", "   |        |          |         |caching.py)                                                        |", "   +--------+----------+---------+-------------------------------------------------------------------+", "   |Java    |0.2.0     |1.3.0    |CachingCryptoMaterialsManager.java (https://github.com/aws/aws-    |", "   |        |          |         |encryption-sdk-                                                    |", "   |        |          |         |java/blob/master/src/main/java/com/amazonaws/encryptionsdk/caching/|", "   |        |          |         |CachingCryptoMaterialsManager.java)                                |", "   +--------+----------+---------+-------------------------------------------------------------------+", "", "                                  Table 1", ""]}, {"id": "2.3", "title": "Overview", "lines": ["2.3.   Overview", "", "   The Caching Cryptographic Materials Manager (CMM) is a built-in", "   implementation of the CMM interface (cmm-interface.md) provided by", "   the AWS Encryption SDK.  The caching CMM wraps around another CMM and", "   caches the results of its underlying key provider's encryption and", "   decryption operations.  A caching CMM reduces the number of calls", "   made to the underlying key provider, thereby reducing cost and/or", "   improving performance.", ""]}, {"id": "2.4", "title": "Definitions", "lines": ["2.4.   Definitions", ""]}, {"id": "2.4.1", "title": "document", "lines": [[[[166], 224, "The key words \"MUST\", \"MUST NOT\", \"REQUIRED\", \"SHALL\", \"SHALL NOT\", \"SHOULD\", \"SHOULD NOT\", \"RECOMMENDED\", \"MAY\", and \"OPTIONAL\" in this document are to be interpreted as described in RFC 2119 (https://tools.ietf.org/html/rfc2119)."]]], "requirements": [166]}, {"id": "2.5", "title": "Initialization", "lines": [[[[167], 224, "On caching CMM initialization, the caller MUST provide the following values:"]], [[[168], 224, "Additionally, the caller MUST provide one of the following values:"]]], "requirements": [167, 168]}, {"id": "2.5.1", "title": "Cache", "lines": [[[[169], 224, "Multiple caching CMMs MAY share the same cryptographic materials cache, but by default MUST NOT use each other's cache entries."]]], "requirements": [169]}, {"id": "2.5.2", "title": "Manager", "lines": ["2.5.2.   Underlying Cryptographic Materials Manager", "", "   The underlying Cryptographic Materials Manager (CMM) (cmm-", "   interface.md#supported-cmms) to query for encryption/decryption", "   materials on a cache miss.", ""]}, {"id": "2.5.3", "title": "TTL", "lines": [[[[170], 224, "The Caching CMM MUST set a time-to-live (TTL) for data keys in the CMC."]]], "requirements": [170]}, {"id": "2.5.4", "title": "ID", "lines": [[[[171], 224, "A string that is used to avoid collisions with other CMMs. If this parameter is not set, the caching CMM MUST set a partition ID that uniquely identifies the respective caching CMM."]], [[[172], 224, "The Partition ID MUST NOT be changed after initialization."]]], "requirements": [171, 172]}, {"id": "2.5.5", "title": "Bytes", "lines": [[[[173], 96, "The maximum number of bytes that MAY be encrypted by a single data key."]], [[[174], 224, "If this parameter is not set, the caching CMM MUST set it to a value no more than 2^63-1."]]], "requirements": [173, 174]}, {"id": "2.5.6", "title": "Messages", "lines": [[[[175], 96, "The maximum number of messages that MAY be encrypted by a single data key."]], [[[176], 224, "If this parameter is not set, the caching CMM MUST set it to 2^32."]], [[[177], 224, "The caching CMM MUST provide a structure as defined below, to track usage statistics."]]], "requirements": [175, 176, 177]}, {"id": "2.5.7", "title": "Stats", "lines": [[[[178], 224, "When the caching CMM stores encryption materials into the cryptographic materials cache, the caching CMM MUST set the initial usage stats for the cache entry."]], [[[179], 224, "When the caching CMM obtains encryption materials from the cryptographic materials cache, the caching CMM MUST update the usage stats for the cache entry retrieved."]]], "requirements": [178, 179]}, {"id": "2.5.7.1", "title": "Encrypted", "lines": ["2.5.7.1.   Messages Encrypted", "", "   The number of messages encrypted by the encryption", "   (structures.md#encryption-materials) materials.", ""]}, {"id": "2.5.7.2", "title": "Encrypted", "lines": ["2.5.7.2.   Bytes Encrypted", "", "   The number of bytes encrypted by the encryption", "   (structures.md#encryption-materials) materials.", ""]}, {"id": "2.6", "title": "Behaviors", "lines": ["2.6.   Behaviors", ""]}, {"id": "2.6.1", "title": "Materials", "lines": [[[[180], 224, "If the algorithm suite (algorithm-suites.md) requested contains a Identity KDF (algorithm-suites.md#identity-kdf), the caching CMM MUST obtain the encryption materials by making a call to the underlying CMM's Get Encryption Materials (cmm-interface.md#get-encryption- materials) function."]], [[[181], 224, "Otherwise, the caching CMM MUST attempt to find the encryption materials (structures.md#encryption-materials) from the underlying cryptographic materials cache (CMC) (Section 2.5.1)."]], [[[182], 224, "The caching CMM MUST use the formulas specified in Appendix A (Section 2.7) in order to compute the cache entry identifier (cryptographic-materials- cache.md#cache-identifier)."]], [[[183], 224, "If a cache entry is found, the caching CMM MUST return the encryption materials retrieved."]], [[[184], 224, "If a cache entry is not found or the cache entry is expired, the caching CMM MUST then attempt to obtain the encryption materials by making a call to the underlying CMM's Get Encryption Materials (cmm-interface.md#get-encryption-materials)."]], [[[185], 224, "If the algorithm suite (algorithm-suites.md) requested does not contain an Identity KDF (algorithm-suites.md#identity-kdf), the caching CMM MUST add the encryption materials obtained from the underlying CMM into the underlying CMC."]], [[[186], 224, "If the algorithm suite (algorithm-suites.md) requested contains an Identity KDF, the caching CMM MUST NOT store the encryption materials in the underlying CMC."]]], "requirements": [180, 181, 182, 183, 184, 185, 186]}, {"id": "2.6.2", "title": "Materials", "lines": [[[[187], 224, "If the algorithm suite (algorithm-suites.md) requested contains a Identity KDF (algorithm-suites.md#identity-kdf), the caching CMM MUST obtain the decryption materials by making a call to the underlying CMM's Decrypt Materials (cmm-interface.md#decrypt-materials) function."]], [[[188], 224, "Otherwise, the caching CMM MUST attempt to find the decryption materials (structures.md#decryption-materials) from the underlying CMC (Section 2.5.1)."]], [[[189], 224, "The caching CMM MUST use the formulas specified in Appendix A (Section 2.7) in order to compute the cache entry identifier (cryptographic-materials-cache.md#cache-identifier)."]], [[[190], 224, "If a cache entry is found, the caching CMM MUST return the decryption materials retrieved."]], [[[191], 224, "If a cache entry is not found or the cache entry is expired, the caching CMM MUST attempt to obtain the decryption materials by making a call to the underlying CMM's Decrypt Materials (cmm-interface.md#decrypt-materials)."]], [[[192], 224, "If the algorithm suite (algorithm-suites.md) requested does not contain an Identity KDF (algorithm-suites.md#identity-kdf), the caching CMM MUST add the decryption materials obtained from the underlying CMM into the underlying CMC."]], [[[193], 224, "If the algorithm suite (algorithm-suites.md) requested contains an Identity KDF, the caching CMM MUST NOT store the decryption materials in the underlying CMC."]]], "requirements": [187, 188, 189, 190, 191, 192, 193]}, {"id": "2.7", "title": "Formulas", "lines": [[[[194], 224, "When accessing the underlying CMC, the caching CMM MUST use the formulas specified in this appendix in order to compute the cache entry identifier (cryptographic-materials-cache.md#cache-identifier)."]]], "requirements": [194]}, {"id": "2.7.1", "title": "Preliminaries", "lines": ["2.7.1.   Preliminaries", "", "   Each of the cache entry identifier formulas includes a serialized", "   encryption context, as defined in the Key Value Pairs specification", "   (../data-format/message-header.md#key-value-pairs).  In the following", "   appendix sections we use \"SerializeEncryptionContext\" to denote the", "   function that, given an encryption context, returns the serialization", "   of the encryption context.", "", "   Some of the cache entry identifier formulas include the two-byte", "   algorithm suite ID for the algorithm suite in a materials request.", "   The algorithm suite IDs are defined in the Supported Algorithm Suites", "   specification (../framework/algorithm-suites.md#supported-algorithm-", "   suites).  In the following appendix sections we use", "   \"AlgorithmSuiteId\" to the denote the function that, given an", "   algorithm suite as specified in a materials request, returns the", "   corresponding two-byte algorithm suite ID.", ""]}, {"id": "2.7.2", "title": "Suite", "lines": [[[[195], 224, "If the Get Encryption Materials request does not specify an algorithm suite, then the cache entry identifier MUST be calculated as the SHA-512 hash of the concatenation of the following byte strings, in the order listed:"]]], "requirements": [195]}, {"id": "2.7.3", "title": "Suite", "lines": [[[[196], 224, "If the Get Encryption Materials request does specify an algorithm suite, then the cache entry identifier MUST be calculated as the SHA-512 hash of the concatenation of the following byte strings, in the order listed:"]]], "requirements": [196]}, {"id": "2.7.4", "title": "Materials", "lines": ["2.7.4.   Decryption Materials", "", "   When the caching CMM receives a Decrypt Materials request, it MUST", "   calculate the cache entry identifier as the SHA-512 hash of the", "   concatenation of the following byte strings, in the order listed:", "", "   1.  The SHA-512 hash of a UTF-8 encoding of the caching CMM's", "       Partition ID", "", "   2.  The two-byte algorithm suite ID corresponding to the algorithm", "       suite in the request", "", "   3.  The concatenation of the lexicographically-sorted SHA-512 hashes", "       of the serialized encrypted data keys, where serialization is as", "       defined in the Encrypted Data Key Entries specification", "       (../../data-format/message-header.md#encrypted-data-key-entries).", "", "   4.  A sentinel field of 512 zero bits (or equivalently, 64 null", "       bytes), indicating the end of the key hashes", "", "   5.  The SHA-512 hash of the serialized encryption context", "", "   As a formula:", "", "   \"EDK_HASHES = [SHA512(SerializeEncryptedDataKey(key)) for key in", "   decryptMaterialsRequest.encryptedDataKeys] ENTRY_ID = SHA512(", "   SHA512(UTF8Encode(cachingCMM.partitionId)) +", "   AlgorithmSuiteId(decryptMaterialsRequest.algorithmSuite) +", "   CONCATENATE(SORTED(EDK_HASHES)) + PADDING_OF_512_ZERO_BITS + SHA512(S", "   erializeEncryptionContext(decryptMaterialsRequest.encryptionContext))", "   )\"", ""]}, {"id": "3", "title": "References", "lines": ["3.   Normative References", "", "   [RFC2119]  Bradner, S., \"Key words for use in RFCs to Indicate", "              Requirement Levels\", BCP 14, RFC 2119,", "              DOI 10.17487/RFC2119, March 1997,", "              <https://www.rfc-editor.org/info/rfc2119>.", "", "   [RFC8174]  Leiba, B., \"Ambiguity of Uppercase vs Lowercase in RFC", "              2119 Key Words\", BCP 14, RFC 8174, DOI 10.17487/RFC8174,", "              May 2017, <https://www.rfc-editor.org/info/rfc8174>.", "", "Acknowledgments", "", "Author's Address", "", "   Amazon AWS", "   Amazon AWS", "", "   Email: cryptools+rfc@amazon.com"]}]}, "compliance/framework/raw-rsa-keyring.txt": {"requirements": [197, 199, 201, 203, 205, 207, 209, 211, 212, 214, 216, 218, 220, 223, 226, 229, 231, 233, 235, 238, 240, 243, 246], "sections": [{"id": "1", "title": "Definitions", "lines": ["1.   Conventions and Definitions", "", "   The key words \"MUST\", \"MUST NOT\", \"REQUIRED\", \"SHALL\", \"SHALL NOT\",", "   \"SHOULD\", \"SHOULD NOT\", \"RECOMMENDED\", \"NOT RECOMMENDED\", \"MAY\", and", "   \"OPTIONAL\" in this document are to be interpreted as described in BCP", "   14 [RFC2119] [RFC8174] when, and only when, they appear in all", "   capitals, as shown here", ""]}, {"id": "2", "title": "Keyring", "lines": ["2.   Raw RSA Keyring", ""]}, {"id": "2.1", "title": "Version", "lines": ["2.1.   Version", "", "   0.3.2", ""]}, {"id": "2.1.1", "title": "Changelog", "lines": ["2.1.1.   Changelog", "", "   *  0.3.2", "", "      -  Clarify keyring failure on decrypt (../changes/2020-06-04_how-", "         to-fail-with-keyrings/change.md)", "", "   *  0.3.1", "", "      -  Clarify failure language when only one key is defined", "         (https://github.com/awslabs/aws-encryption-sdk-specification/", "         issues/91)", "", "   *  0.3.0", "", "      -  Raw RSA keyring MUST NOT accept a key namespace of \"aws-kms\".", "         (https://github.com/awslabs/aws-encryption-sdk-specification/", "         issues/101)", "", "   *  0.2.0", "", "      -  Remove Keyring Trace (../changes/2020-05-13_remove-keyring-", "         trace/change.md)", "", "   *  0.1.0-preview", "", "      -  Initial record", ""]}, {"id": "2.2", "title": "Implementations", "lines": ["2.2.   Implementations", "", "   +========+=============+=========+====================================================================+", "   |Language|Confirmed    |Minimum  |Implementation                                                      |", "   |        |Compatible   |Version  |                                                                    |", "   |        |with Spec    |Confirmed|                                                                    |", "   |        |Version      |         |                                                                    |", "   +========+=============+=========+====================================================================+", "   |C       |0.1.0-preview|0.1.0    |raw_rsa_keyring.h (https://github.com/aws/aws-encryption-sdk-       |", "   |        |             |         |c/blob/master/include/aws/cryptosdk/raw_rsa_keyring.h)              |", "   +--------+-------------+---------+--------------------------------------------------------------------+", "   |NodeJS  |0.1.0-preview|0.1.0    |raw_rsa_keyring_node.ts (https://github.com/awslabs/aws-encryption- |", "   |        |             |         |sdk-javascript/blob/master/modules/raw-rsa-keyring-node/src/        |", "   |        |             |         |raw_rsa_keyring_node.ts)                                            |", "   +--------+-------------+---------+--------------------------------------------------------------------+", "   |Browser |0.1.0-preview|0.1.0    |raw_rsa_keyring_web_crypto.ts (https://github.com/aws/aws-          |", "   |JS      |             |         |encryption-sdk-javascript/blob/master/modules/raw-rsa-keyring-      |", "   |        |             |         |browser/src/raw_rsa_keyring_web_crypto.ts)                          |", "   +--------+-------------+---------+--------------------------------------------------------------------+", "   |Python  |0.1.0-preview|n/a      |keyrings/raw.py (https://github.com/aws/aws-encryption-sdk-         |", "   |        |             |         |python/blob/master/src/aws_encryption_sdk/keyrings/raw.py)          |", "   +--------+-------------+---------+--------------------------------------------------------------------+", "   |Java    |0.1.0-preview|n/a      |RawRsaKeyring.java (https://github.com/aws/aws-encryption-sdk-      |", "   |        |             |         |java/blob/master/src/main/java/com/amazonaws/encryptionsdk/keyrings/|", "   |        |             |         |RawRsaKeyring.java)                                                 |", "   +--------+-------------+---------+--------------------------------------------------------------------+", "", "                                  Table 1", ""]}, {"id": "2.3", "title": "Overview", "lines": ["2.3.   Overview", "", "   A keyring which does local RSA encryption and decryption of data keys", "   using a local wrapping key.", ""]}, {"id": "2.4", "title": "Definitions", "lines": ["2.4.   Definitions", ""]}, {"id": "2.4.1", "title": "document", "lines": [[[[197], 224, "The key words \"MUST\", \"MUST NOT\", \"REQUIRED\", \"SHALL\", \"SHALL NOT\", \"SHOULD\", \"SHOULD NOT\", \"RECOMMENDED\", \"MAY\", and \"OPTIONAL\" in this document are to be interpreted as described in RFC 2119 (https://tools.ietf.org/html/rfc2119)."]]], "requirements": [197]}, {"id": "2.4.2", "title": "RSA", "lines": ["2.4.2.   RSA", "", "   RSA (Rivest-Shamir-Adleman) is an asymmteric cryptographic cipher.", "", "   RSA Implementation Specification: RFC 3447", "   (https://tools.ietf.org/html/rfc8017)", ""]}, {"id": "2.5", "title": "Initialization", "lines": [[[[198, 199], 232, "On keyring initialization, the caller MUST provide the following:"]]], "requirements": [199]}, {"id": "2.5.1", "title": "Scheme", "lines": [[[[200, 201], 232, "This value MUST correspond with one of the supported padding schemes (Section 2.5.1.1)."]], [[[202, 203], 225, "If the padding scheme uses MGF1 Padding, the hash function used as part of MGF1 MUST be the same hash function used to hash the plaintext data key."]]], "requirements": [201, 203]}, {"id": "2.5.1.1", "title": "Schemes", "lines": [[[[204, 205], 232, "This keyring MUST NOT use a padding scheme outside those defined above."]]], "requirements": [205]}, {"id": "2.5.2", "title": "Key", "lines": [[[[206, 207], 225, "The public key MUST follow the RSA specification for public keys (Section 2.4.2)."]], [[[208, 209], 161, "The raw RSA keyring SHOULD support loading PEM encoded X.509 SubjectPublicKeyInfo structures (https://tools.ietf.org/html/rfc5280#section-4.1) as public keys."]]], "requirements": [207, 209]}, {"id": "2.5.3", "title": "Key", "lines": [[[[210, 211], 225, "The private key MUST follow the RSA specification for private keys (Section 2.4.2)."]], [[[212], 160, "The raw RSA keyring SHOULD support loading PEM encoded PKCS #8 PrivateKeyInfo structures (https://tools.ietf.org/html/rfc5958#section-2) as private keys."]], [[[213, 214], 161, "The private key SHOULD contain all Chinese Remainder Theorem (CRT) components (public exponent, prime factors, CRT exponents, and CRT coefficient)."]]], "requirements": [211, 212, 214]}, {"id": "2.6", "title": "Operation", "lines": ["2.6.   Operation", ""]}, {"id": "2.6.1", "title": "OnEncrypt", "lines": [[[[215, 216], 232, "OnEncrypt MUST fail if this keyring does not have a specified public key (Section 2.5.2)."]], [[[217, 218], 232, "The keyring MUST NOT derive a public key from a specified private key (Section 2.5.3)."]], [[[219, 220], 232, "OnEncrypt MUST take encryption materials (structures.md#encryption- materials) as input."]], [[[221, 222, 223], 248, "If the encryption materials (structures.md#encryption-materials) do not contain a plaintext data key, OnEncrypt MUST generate a random plaintext data key and set it on the encryption materials (structures.md#encryption-materials)."]], [[[224, 225, 226], 244, "The keyring MUST attempt to encrypt the plaintext data key in the encryption materials (structures.md#encryption-materials) using RSA."]], [[[227, 228, 229], 248, "If RSA encryption was successful, OnEncrypt MUST return the input encryption materials (structures.md#encryption-materials), modified in the following ways:"]]], "requirements": [216, 218, 220, 223, 226, 229]}, {"id": "2.6.2", "title": "OnDecrypt", "lines": [[[[230, 231], 232, "OnDecrypt MUST fail if this keyring does not have a specified private key (Section 2.5.3)."]], [[[232, 233], 232, "OnDecrypt MUST take decryption materials (structures.md#decryption- materials) and a list of encrypted data keys (structures.md#encrypted-data-key) as input."]], [[[234, 235], 232, "If the decryption materials already contain a plaintext data key, the keyring MUST fail and MUST NOT modify the decryption materials (structures.md#decryption-materials)."]], [[[236, 237, 238], 244, "The keyring MUST attempt to decrypt the input encrypted data keys, in list order, until it successfully decrypts one."]], [[[239, 240], 232, "For each encrypted data key, the keyring MUST attempt to decrypt the encrypted data key into plaintext using RSA if and only if the following is true:"]], [[[241, 242, 243], 244, "If any decryption succeeds, this keyring MUST immediately return the input decryption materials (structures.md#decryption-materials), modified in the following ways: * The output of RSA decryption is set as the decryption material's plaintext data key."]], [[[244, 245, 246], 244, "If no decryption succeeds, the keyring MUST fail and MUST NOT modify the decryption materials (structures.md#decryption-materials)."]]], "requirements": [231, 233, 235, 238, 240, 243, 246]}, {"id": "3", "title": "References", "lines": ["3.   Normative References", "", "   [RFC2119]  Bradner, S., \"Key words for use in RFCs to Indicate", "              Requirement Levels\", BCP 14, RFC 2119,", "              DOI 10.17487/RFC2119, March 1997,", "              <https://www.rfc-editor.org/info/rfc2119>.", "", "   [RFC8174]  Leiba, B., \"Ambiguity of Uppercase vs Lowercase in RFC", "              2119 Key Words\", BCP 14, RFC 8174, DOI 10.17487/RFC8174,", "              May 2017, <https://www.rfc-editor.org/info/rfc8174>.", "", "Acknowledgments", "", "Author's Address", "", "   Amazon AWS", "   Amazon AWS", "", "   Email: cryptools+rfc@amazon.com"]}]}, "compliance/framework/multi-keyring.txt": {"requirements": [247, 249, 251, 253, 255, 257, 260, 262, 265, 268, 271, 273, 276, 279, 282, 285, 288, 291, 293], "sections": [{"id": "1", "title": "Definitions", "lines": ["1.   Conventions and Definitions", "", "   The key words \"MUST\", \"MUST NOT\", \"REQUIRED\", \"SHALL\", \"SHALL NOT\",", "   \"SHOULD\", \"SHOULD NOT\", \"RECOMMENDED\", \"NOT RECOMMENDED\", \"MAY\", and", "   \"OPTIONAL\" in this document are to be interpreted as described in BCP", "   14 [RFC2119] [RFC8174] when, and only when, they appear in all", "   capitals, as shown here", ""]}, {"id": "2", "title": "Multi-Keyring", "lines": ["2.   Multi-Keyring", ""]}, {"id": "2.1", "title": "Version", "lines": ["2.1.   Version", "", "   0.1.1", ""]}, {"id": "2.2", "title": "Changelog", "lines": ["2.2.   Changelog", "", "   *  0.1.1", "", "      -  Clarify keyring failure on decrypt (../changes/2020-06-04_how-", "         to-fail-with-keyrings/change.md)", "", "   *  0.1.0-preview", "", "      -  Initial record", ""]}, {"id": "2.3", "title": "Implementations", "lines": ["2.3.   Implementations", "", "   *  C (https://github.com/aws/aws-encryption-sdk-c/blob/master/source/", "      multi_keyring.c)", "", "   *  Javascript (https://github.com/awslabs/aws-encryption-sdk-", "      javascript/blob/master/modules/material-management/src/", "      multi_keyring.ts)", "", "   *  Python (https://github.com/aws/aws-encryption-sdk-", "      python/blob/master/src/aws_encryption_sdk/keyrings/multi.py)", "", "   *  Java (https://github.com/aws/aws-encryption-sdk-", "      java/blob/master/src/main/java/com/amazonaws/encryptionsdk/", "      keyrings/MultiKeyring.java)", ""]}, {"id": "2.4", "title": "Overview", "lines": ["2.4.   Overview", "", "   A keyring which combines other keyrings, allowing one Section 2.7.1", "   or Section 2.7.2 call to modify the encryption", "   (structures.md#encryption-materials) or decryption", "   (structures.md#decryption-materials) materials using more than one", "   keyring.", "", "   A multi-keyring is capable of producing encrypted data keys that can", "   be decrypted by multiple keyrings.  A multi-keyring can decrypt an", "   encrypted data key as long as the multi-keyring contains at least one", "   keyring capable of decrypting that encrypted data key.", ""]}, {"id": "2.5", "title": "Definitions", "lines": ["2.5.   Definitions", ""]}, {"id": "2.5.1", "title": "document", "lines": [[[[247], 224, "The key words \"MUST\", \"MUST NOT\", \"REQUIRED\", \"SHALL\", \"SHALL NOT\", \"SHOULD\", \"SHOULD NOT\", \"RECOMMENDED\", \"MAY\", and \"OPTIONAL\" in this document are to be interpreted as described in RFC 2119 (https://tools.ietf.org/html/rfc2119)."]]], "requirements": [247]}, {"id": "2.6", "title": "Inputs", "lines": [[[[248, 249], 232, "On keyring initialization, a keyring MUST define at least one of the following:"]]], "requirements": [249]}, {"id": "2.6.1", "title": "Keyring", "lines": [[[[250, 251], 232, "This keyring MUST implement the Generate Data Key (keyring- interface.md#generate-data-key) behavior during OnEncrypt (keyring- interface.md#onencrypt)."]], [[[252, 253], 232, "This means that this keyring MUST return encryption materials (structures.md#encryption-materials) containing a plaintext data key on OnEncrypt (keyring-interface.md#onencrypt)."]], [[[254, 255], 232, "If the list of child keyrings (Section 2.6.2) is empty, a generator keyring (Section 2.6.1) MUST be defined for the keyring."]]], "requirements": [251, 253, 255]}, {"id": "2.6.2", "title": "Keyrings", "lines": [[[[256, 257], 232, "If this keyring does not have a generator keyring (Section 2.6.1), this list MUST NOT be empty."]]], "requirements": [257]}, {"id": "2.7", "title": "Operation", "lines": ["2.7.   Operation", ""]}, {"id": "2.7.1", "title": "OnEncrypt", "lines": [[[[258, 259, 260], 244, "If this keyring has a generator keyring, this keyring MUST first generate a plaintext data key using the generator keyring:"]], [[[261, 262], 232, "If this keyring does not have a generator keyring (Section 2.6.1), and the input encryption materials (structures.md#encryption- materials) does not include a plaintext data key, OnEncrypt MUST fail."]], [[[263, 264, 265], 244, "Next, for each keyring (keyring-interface.md) in this keyring's list of child keyrings (Section 2.6.2), the keyring MUST call OnEncrypt (keyring-interface.md#onencrypt)."]], [[[266, 267, 268], 244, "If the child keyring's OnEncrypt (keyring- interface.md#onencrypt) fails, this OnEncrypt MUST also fail."]], [[[269, 270, 271], 244, "If all previous OnEncrypt (keyring-interface.md#onencrypt) calls succeeded, this keyring MUST return the encryption materials (structures.md#encryption-materials) returned by the last OnEncrypt call."]]], "requirements": [260, 262, 265, 268, 271]}, {"id": "2.7.2", "title": "OnDecrypt", "lines": [[[[272, 273], 232, "If the decryption materials already contain a plaintext data key, the keyring MUST fail and MUST NOT modify the decryption materials (structures.md#decryption-materials)."]], [[[274, 275, 276], 244, "Otherwise, OnDecrypt MUST first attempt to decrypt the encrypted data keys (structures.md#encrypted-data-keys-1) in the input decryption materials (structures.md#decryption-materials) using its generator keyring (Section 2.6.1)."]], [[[277, 278, 279], 244, "If the generator keyring is unable to decrypt the materials, the multi-keyring MUST attempt to decrypt using its child keyrings, until one either succeeds in decryption or all have failed."]], [[[280, 281, 282], 241, "For each keyring (keyring-interface.md) to be used for decryption, the multi-keyring MUST call that keyring's OnDecrypt (keyring- interface.md#ondecrypt) using the unmodified decryption materials (structures.md#decryption-materials) and the input encrypted data key (structures.md#encrypted-data-key) list."]], [[[283, 284, 285], 241, "If OnDecrypt (keyring- interface.md#ondecrypt) returns decryption materials (structures.md#decryption-materials) containing a plaintext data key, the multi-keyring MUST immediately return the modified decryption materials."]], [[[286, 287, 288], 244, "If the child keyring's OnDecrypt call fails, the multi- keyring MUST collect the error and continue to the next keyring, if any."]], [[[289, 290, 291], 244, "If, after calling OnDecrypt (keyring-interface.md#ondecrypt) on every child keyring (Section 2.6.2) (and possibly the generator keyring (Section 2.6.1)), the decryption materials (structures.md#decryption- materials) still do not contain a plaintext data key, OnDecrypt MUST return a failure message containing the collected failure messages from the child keyrings."]]], "requirements": [273, 276, 279, 282, 285, 288, 291]}, {"id": "2.8", "title": "Considerations", "lines": [[[[292, 293], 162, "Users SHOULD examine the keyrings (keyring-interface.md) they include in a multi-keyring to ensure that they understand what set of keyrings will be capable of obtaining the plaintext data key from the returned set of encrypted data keys."]]], "requirements": [293]}, {"id": "3", "title": "References", "lines": ["3.   Normative References", "", "   [RFC2119]  Bradner, S., \"Key words for use in RFCs to Indicate", "              Requirement Levels\", BCP 14, RFC 2119,", "              DOI 10.17487/RFC2119, March 1997,", "              <https://www.rfc-editor.org/info/rfc2119>.", "", "   [RFC8174]  Leiba, B., \"Ambiguity of Uppercase vs Lowercase in RFC", "              2119 Key Words\", BCP 14, RFC 8174, DOI 10.17487/RFC8174,", "              May 2017, <https://www.rfc-editor.org/info/rfc8174>.", "", "Acknowledgments", "", "Author's Address", "", "   Amazon AWS", "   Amazon AWS", "", "   Email: cryptools+rfc@amazon.com"]}]}, "compliance/framework/structures.txt": {"requirements": [294, 296, 298, 300, 302, 303, 305, 307, 309, 310, 311, 312, 313, 314, 315, 316, 317, 318, 319, 320, 322, 323, 324, 325, 326, 327, 328, 329], "sections": [{"id": "1", "title": "Definitions", "lines": ["1.   Conventions and Definitions", "", "   The key words \"MUST\", \"MUST NOT\", \"REQUIRED\", \"SHALL\", \"SHALL NOT\",", "   \"SHOULD\", \"SHOULD NOT\", \"RECOMMENDED\", \"NOT RECOMMENDED\", \"MAY\", and", "   \"OPTIONAL\" in this document are to be interpreted as described in BCP", "   14 [RFC2119] [RFC8174] when, and only when, they appear in all", "   capitals, as shown here", ""]}, {"id": "2", "title": "Structures", "lines": ["2.   Structures", ""]}, {"id": "2.1", "title": "Version", "lines": ["2.1.   Version", "", "   0.3.0", ""]}, {"id": "2.1.1", "title": "Changelog", "lines": ["2.1.1.   Changelog", "", "   *  0.3.0", "", "      -  Clarify handling of the \"aws-crypto-public-key\" encryption", "         context key.", "", "   *  0.2.1", "", "      -  Clarify naming of KMS to AWS KMS (https://github.com/awslabs/", "         aws-encryption-sdk-specification/issues/67)", "", "   *  0.2.0", "", "      -  Remove Keyring Trace (../changes/2020-05-13_remove-keyring-", "         trace/change.md)", "", "   *  0.1.0-preview", "", "      -  Initial record", ""]}, {"id": "2.2", "title": "Definitions", "lines": ["2.2.   Definitions", ""]}, {"id": "2.2.1", "title": "document", "lines": [[[[294], 224, "The key words \"MUST\", \"MUST NOT\", \"REQUIRED\", \"SHALL\", \"SHALL NOT\", \"SHOULD\", \"SHOULD NOT\", \"RECOMMENDED\", \"MAY\", and \"OPTIONAL\" in this document are to be interpreted as described in RFC 2119 (https://tools.ietf.org/html/rfc2119)."]]], "requirements": [294]}, {"id": "2.3", "title": "Overview", "lines": [[[[295, 296], 226, "These structures define a group of related fields that MUST hold certain properties."]], [[[297, 298], 226, "Wherever these structures are referenced in this specification, implementations MUST ensure that all properties of a structure's fields are upheld."]], [[[299, 300], 98, "While these structures will usually be represented as objects, lower level languages MAY represent these fields in a less strictly defined way as long as all field properties are still upheld."]]], "requirements": [296, 298, 300]}, {"id": "2.3.1", "title": "Key", "lines": ["2.3.1.   Encrypted Data Key", ""]}, {"id": "2.3.1.1", "title": "Implementations", "lines": ["2.3.1.1.   Implementations", "", "   *  C (https://github.com/aws/aws-encryption-sdk-", "      c/blob/master/include/aws/cryptosdk/edk.h)", "", "   *  Javascript (https://github.com/awslabs/aws-encryption-sdk-", "      javascript/blob/master/modules/material-management/src/", "      encrypted_data_key.ts)", "", "   *  Python (https://github.com/aws/aws-encryption-sdk-", "      python/blob/master/src/aws_encryption_sdk/structures.py)", "", "   *  Java (https://github.com/aws/aws-encryption-sdk-", "      java/blob/master/src/main/java/com/amazonaws/encryptionsdk/", "      EncryptedDataKey.java)", ""]}, {"id": "2.3.1.2", "title": "Structure", "lines": [[[[301, 302], 98, "This specification uses the terms \"encrypt\" and \"decrypt\" for simplicity, but the actual process by which a key provider obtains the plaintext data key from the ciphertext and vice versa MAY be any reversible operation, though we expect that most will use encryption."]], [[[303], 224, "Some key provider MUST be capable of deterministically obtaining the plaintext key from the ciphertext."]]], "requirements": [302, 303]}, {"id": "2.3.2", "title": "Context", "lines": ["2.3.2.   Encryption Context", ""]}, {"id": "2.3.2.1", "title": "Implementations", "lines": ["2.3.2.1.   Implementations", "", "   *  C (https://github.com/aws/aws-encryption-sdk-", "      c/blob/master/include/aws/cryptosdk/enc_ctx.h)", "", "   *  Javascript (https://github.com/awslabs/aws-encryption-sdk-", "      javascript/blob/master/modules/material-management/src/types.ts)", "", "   *  Python (https://github.com/aws/aws-encryption-sdk-", "      python/blob/master/src/aws_encryption_sdk/internal/formatting/", "      encryption_context.py)", "", "   *  Java (https://github.com/aws/aws-encryption-sdk-", "      java/blob/master/src/main/java/com/amazonaws/encryptionsdk/", "      internal/EncryptionContextSerializer.java)", ""]}, {"id": "2.3.2.2", "title": "Structure", "lines": [[[[304, 305], 162, "Users SHOULD use the encryption context to store:"]], [[[306, 307], 226, "Users MUST NOT use the encryption context to store secret data."]]], "requirements": [305, 307]}, {"id": "2.3.3", "title": "Materials", "lines": ["2.3.3.   Encryption Materials", ""]}, {"id": "2.3.3.1", "title": "Implementations", "lines": ["2.3.3.1.   Implementations", "", "   +==========+=============+=========+=================================================================+", "   |Language  |Confirmed    |Minimum  |Implementation                                                   |", "   |          |Compatible   |Version  |                                                                 |", "   |          |with Spec    |Confirmed|                                                                 |", "   |          |Version      |         |                                                                 |", "   +==========+=============+=========+=================================================================+", "   |C         |0.1.0-preview|0.1.0    |materials.h (https://github.com/aws/aws-encryption-sdk-          |", "   |          |             |         |c/blob/master/include/aws/cryptosdk/materials.h)                 |", "   +----------+-------------+---------+-----------------------------------------------------------------+", "   |Javascript|0.1.0-preview|0.1.0    |cryptographic_material.ts (https://github.com/awslabs/aws-       |", "   |          |             |         |encryption-sdk-javascript/blob/master/modules/material-          |", "   |          |             |         |management/src/cryptographic_material.ts)                        |", "   +----------+-------------+---------+-----------------------------------------------------------------+", "   |Python    |0.1.0-preview|n/a      |materials_managers (https://github.com/aws/aws-encryption-sdk-   |", "   |          |             |         |python/blob/master/src/aws_encryption_sdk/                       |", "   |          |             |         |materials_managers/__init__.py)                                  |", "   +----------+-------------+---------+-----------------------------------------------------------------+", "   |Java      |0.1.0-preview|n/a      |EncryptionMaterials.java (https://github.com/aws/aws-encryption- |", "   |          |             |         |sdk-                                                             |", "   |          |             |         |java/blob/master/src/main/java/com/amazonaws/encryptionsdk/model/|", "   |          |             |         |EncryptionMaterials.java)                                        |", "   +----------+-------------+---------+-----------------------------------------------------------------+", "", "                                  Table 1", ""]}, {"id": "2.3.3.2", "title": "Structure", "lines": [[[[308, 309], 104, "This structure MAY include any of the following fields:"]], [[[310], 224, "The Section 2.3.1.2.3 of each encrypted data key in this list MUST be an opaque form of the plaintext data key from this set of encryption materials."]], [[[311], 224, "If the plaintext data key is not included in this set of encryption materials, this list MUST be empty."]], [[[312], 160, "If an encryption material (Section 2.3.3) contains a signing key (Section 2.3.3.2.5), the encryption context (Section 2.3.2) SHOULD include the reserved key \"aws-crypto-public-key\"."]], [[[313], 160, "The mapped value from the reserved key \"aws-crypto-public-key\" SHOULD be the signature verification key corresponding to the signing key (Section 2.3.3.2.5) stored on the encryption material (Section 2.3.3)."]], [[[314], 160, "If an encryption material (Section 2.3.3) does not contains a signing key (Section 2.3.3.2.5), the encryption context (Section 2.3.2) SHOULD NOT include the reserved key \"aws-crypto-public-key\"."]], [[[315], 224, "The plaintext data key MUST:"]], [[[316], 160, "The plaintext data key SHOULD be stored as immutable data."]], [[[317], 160, "The plaintext data key SHOULD offer an interface to zero the plaintext data key."]], [[[318], 224, "The signing key MUST fit the specification described by the signature algorithm (algorithm-suites.md#signature-algorithm) included in this encryption material's algorithm suite (Section 2.3.3.2.1)."]], [[[319], 224, "If the algorithm suite does not contain a signing algorithm, the signing key MUST NOT be present."]], [[[320], 224, "The value of this key MUST be kept secret."]]], "requirements": [309, 310, 311, 312, 313, 314, 315, 316, 317, 318, 319, 320]}, {"id": "2.3.4", "title": "Materials", "lines": ["2.3.4.   Decryption Materials", ""]}, {"id": "2.3.4.1", "title": "Implementations", "lines": ["2.3.4.1.   Implementations", "", "   +==========+=============+=========+=================================================================+", "   |Language  |Confirmed    |Minimum  |Implementation                                                   |", "   |          |Compatible   |Version  |                                                                 |", "   |          |with Spec    |Confirmed|                                                                 |", "   |          |Version      |         |                                                                 |", "   +==========+=============+=========+=================================================================+", "   |C         |0.1.0-preview|0.1.0    |materials.h (https://github.com/aws/aws-encryption-sdk-          |", "   |          |             |         |c/blob/master/include/aws/cryptosdk/materials.h)                 |", "   +----------+-------------+---------+-----------------------------------------------------------------+", "   |Javascript|0.1.0-preview|0.1.0    |cryptographic_material.ts (https://github.com/awslabs/aws-       |", "   |          |             |         |encryption-sdk-javascript/blob/master/modules/material-          |", "   |          |             |         |management/src/cryptographic_material.ts)                        |", "   +----------+-------------+---------+-----------------------------------------------------------------+", "   |Python    |0.1.0-preview|n/a      |materials_managers (https://github.com/aws/aws-encryption-sdk-   |", "   |          |             |         |python/blob/master/src/aws_encryption_sdk/                       |", "   |          |             |         |materials_managers/__init__.py)                                  |", "   +----------+-------------+---------+-----------------------------------------------------------------+", "   |Java      |0.1.0-preview|n/a      |DecryptionMaterials.java (https://github.com/aws/aws-encryption- |", "   |          |             |         |sdk-                                                             |", "   |          |             |         |java/blob/master/src/main/java/com/amazonaws/encryptionsdk/model/|", "   |          |             |         |DecryptionMaterials.java)                                        |", "   +----------+-------------+---------+-----------------------------------------------------------------+", "", "                                  Table 2", ""]}, {"id": "2.3.4.2", "title": "Structure", "lines": [[[[321, 322], 104, "This structure MAY include any of the following fields:"]], [[[323], 160, "If a decryption materials (Section 2.3.4) contains a verification key (Section 2.3.4.2.4), the encryption context (Section 2.3.2) SHOULD include the reserved key \"aws-crypto-public-key\"."]], [[[324], 160, "The mapped value from the reserved key \"aws-crypto-public-key\" SHOULD be the signature verification key stored on the decryption materials (Section 2.3.4)."]], [[[325], 160, "If a decryption materials (Section 2.3.4) does not contain a verification key (Section 2.3.4.2.4), the encryption context (Section 2.3.2) SHOULD NOT include the reserved key \"aws-crypto- public-key\"."]], [[[326], 224, "The plaintext data key MUST:"]], [[[327], 160, "The plaintext data key SHOULD be stored as immutable data."]], [[[328], 160, "The plaintext data key SHOULD offer an interface to zero the plaintext data key."]], [[[329], 224, "The verification key MUST fit the specification for the signature algorithm (algorithm-suites.md#signature-algorithm) included in this decryption material's algorithm suite (Section 2.3.4.2.1)."]]], "requirements": [322, 323, 324, 325, 326, 327, 328, 329]}, {"id": "3", "title": "References", "lines": ["3.   Normative References", "", "   [RFC2119]  Bradner, S., \"Key words for use in RFCs to Indicate", "              Requirement Levels\", BCP 14, RFC 2119,", "              DOI 10.17487/RFC2119, March 1997,", "              <https://www.rfc-editor.org/info/rfc2119>.", "", "   [RFC8174]  Leiba, B., \"Ambiguity of Uppercase vs Lowercase in RFC", "              2119 Key Words\", BCP 14, RFC 8174, DOI 10.17487/RFC8174,", "              May 2017, <https://www.rfc-editor.org/info/rfc8174>.", "", "Acknowledgments", "", "Author's Address", "", "   Amazon AWS", "   Amazon AWS", "", "   Email: cryptools+rfc@amazon.com"]}]}, "compliance/framework/master-key-provider-interface.txt": {"requirements": [330, 331, 332, 333, 334, 335, 336, 337, 338, 339, 340, 341, 342, 343, 344, 345], "sections": [{"id": "1", "title": "Definitions", "lines": ["1.   Conventions and Definitions", "", "   The key words \"MUST\", \"MUST NOT\", \"REQUIRED\", \"SHALL\", \"SHALL NOT\",", "   \"SHOULD\", \"SHOULD NOT\", \"RECOMMENDED\", \"NOT RECOMMENDED\", \"MAY\", and", "   \"OPTIONAL\" in this document are to be interpreted as described in BCP", "   14 [RFC2119] [RFC8174] when, and only when, they appear in all", "   capitals, as shown here", ""]}, {"id": "2", "title": "Interface", "lines": ["2.   Master Key Provider Interface", ""]}, {"id": "2.1", "title": "Version", "lines": ["2.1.   Version", "", "   0.1.0-preview", ""]}, {"id": "2.2", "title": "Implementations", "lines": ["2.2.   Implementations", "", "   *  Python (https://github.com/aws/aws-encryption-sdk-", "      python/blob/master/src/aws_encryption_sdk/key_providers/base.py)", "", "   *  Java (https://github.com/aws/aws-encryption-sdk-", "      java/blob/master/src/main/java/com/amazonaws/encryptionsdk/", "      MasterKeyProvider.java)", ""]}, {"id": "2.3", "title": "Overview", "lines": ["2.3.   Overview", "", "   Master key providers are responsible for managing master keys", "   (./master-key-interface.md), determining which master keys should be", "   used for encryption, and for decrypting data keys using available", "   master keys.", ""]}, {"id": "2.3.1", "title": "Legacy", "lines": [[[[330], 160, "Master key providers SHOULD NOT be included in any additional implementations."]], [[[331], 224, "Any new implementations MUST include Keyrings (./keyring-interface.md) instead."]]], "requirements": [330, 331]}, {"id": "2.3.2", "title": "Consistency", "lines": ["2.3.2.   Consistency", "", "   This specification defines the common behavior between the two", "   implementations that determine the REQUIRED functionality.", "", "   Other specifics of behavior and API vary between the two", "   implementations.", ""]}, {"id": "2.4", "title": "Definitions", "lines": ["2.4.   Definitions", ""]}, {"id": "2.4.1", "title": "document", "lines": [[[[332], 224, "The key words \"MUST\", \"MUST NOT\", \"REQUIRED\", \"SHALL\", \"SHALL NOT\", \"SHOULD\", \"SHOULD NOT\", \"RECOMMENDED\", \"MAY\", and \"OPTIONAL\" in this document are to be interpreted as described in RFC 2119 (https://tools.ietf.org/html/rfc2119)."]]], "requirements": [332]}, {"id": "2.4.2", "title": "Terms", "lines": ["2.4.2.   Terms", "", "   *  Provider ID: A value that identifies a master key provider.  This", "      concept is equivalent to \"key namespace\" for Keyrings.", "", "   *  Key ID: A value that identifies a master key within the context of", "      a master key provider.  This concept is equivalent to \"key name\"", "      for Keyrings.", "", "   *  Provider Info: The value that is written to a serialized encrypted", "      data key that identifies a master key within the context of a", "      master key provider.  This MUST always be equal to the master", "      key's key ID with the exception of the raw AES master key.  For a", "      detailed description of this exception, see the Raw AES Keyring", "      specification (./raw-aes-keyring.md).", ""]}, {"id": "2.5", "title": "Interface", "lines": ["2.5.   Interface", ""]}, {"id": "2.5.1", "title": "Key", "lines": [[[[333], 224, "An implementation MUST support master key selection by key ID."]], [[[334], 96, "An implementation MAY support master key selection by provider info or provider ID."]], [[[335], 224, "The output of this interface MUST be a master key."]], [[[336], 224, "If the master key provider cannot locate an appropriate master key, the call MUST result in an error."]]], "requirements": [333, 334, 335, 336]}, {"id": "2.5.2", "title": "Encryption", "lines": [[[[337], 160, "This interface provides a way for a master key provider to indicate which master keys SHOULD be used for encryption."]], [[[338], 224, "Inputs to this interface MUST include the encryption context."]], [[[339], 96, "Inputs MAY include the plaintext body and plaintext size."]], [[[340], 224, "The output of this interface MUST include a list of all master keys that SHOULD be used for encryption."]], [[[341], 224, "The output of this interface MUST indicate which one of those master keys MUST be used to generate the data key."]]], "requirements": [337, 338, 339, 340, 341]}, {"id": "2.5.3", "title": "Key", "lines": [[[[342], 160, "The master key provider SHOULD attempt to decrypt the data key by passing the request to any master keys that it has access to until it has either exhausted available master keys or obtained a plaintext data key."]], [[[343], 224, "Inputs to this interface MUST include the algorithm suite, the encryption context, and a list of encrypted data keys."]], [[[344], 224, "The output of this interface MUST include the decrypted data key and information that can identify which master key decrypted the data key."]], [[[345], 224, "If the master key provider cannot decrypt the data key, the call MUST result in an error."]]], "requirements": [342, 343, 344, 345]}, {"id": "3", "title": "References", "lines": ["3.   Normative References", "", "   [RFC2119]  Bradner, S., \"Key words for use in RFCs to Indicate", "              Requirement Levels\", BCP 14, RFC 2119,", "              DOI 10.17487/RFC2119, March 1997,", "              <https://www.rfc-editor.org/info/rfc2119>.", "", "   [RFC8174]  Leiba, B., \"Ambiguity of Uppercase vs Lowercase in RFC", "              2119 Key Words\", BCP 14, RFC 8174, DOI 10.17487/RFC8174,", "              May 2017, <https://www.rfc-editor.org/info/rfc8174>.", "", "Acknowledgments", "", "Author's Address", "", "   Amazon AWS", "   Amazon AWS", "", "   Email: cryptools+rfc@amazon.com"]}]}, "compliance/framework/master-key-interface.txt": {"requirements": [346, 347, 348, 349, 350, 351, 352, 353, 354, 355, 356, 357, 358, 359, 360], "sections": [{"id": "1", "title": "Definitions", "lines": ["1.   Conventions and Definitions", "", "   The key words \"MUST\", \"MUST NOT\", \"REQUIRED\", \"SHALL\", \"SHALL NOT\",", "   \"SHOULD\", \"SHOULD NOT\", \"RECOMMENDED\", \"NOT RECOMMENDED\", \"MAY\", and", "   \"OPTIONAL\" in this document are to be interpreted as described in BCP", "   14 [RFC2119] [RFC8174] when, and only when, they appear in all", "   capitals, as shown here", ""]}, {"id": "2", "title": "Interface", "lines": ["2.   Master Key Interface", ""]}, {"id": "2.1", "title": "Version", "lines": ["2.1.   Version", "", "   0.1.0-preview", ""]}, {"id": "2.2", "title": "Implementations", "lines": ["2.2.   Implementations", "", "   *  Python (https://github.com/aws/aws-encryption-sdk-", "      python/blob/master/src/aws_encryption_sdk/key_providers/base.py)", "", "   *  Java (https://github.com/aws/aws-encryption-sdk-", "      java/blob/master/src/main/java/com/amazonaws/encryptionsdk/", "      MasterKey.java)", ""]}, {"id": "2.3", "title": "Overview", "lines": ["2.3.   Overview", "", "   Master keys are master key providers that only provide themselves.", "   They also support generating and encrypting data keys.", ""]}, {"id": "2.3.1", "title": "Legacy", "lines": [[[[346], 160, "Master keys SHOULD NOT be included in any additional implementations."]], [[[347], 224, "Any new implementations MUST include Keyrings (./keyring-interface.md) instead."]]], "requirements": [346, 347]}, {"id": "2.3.2", "title": "Consistency", "lines": ["2.3.2.   Consistency", "", "   This specification defines the common behavior between the two", "   implementations that determine the REQUIRED functionality.", "", "   Other specifics of behavior and API vary between the two", "   implementations.", ""]}, {"id": "2.4", "title": "Definitions", "lines": ["2.4.   Definitions", ""]}, {"id": "2.4.1", "title": "document", "lines": [[[[348], 224, "The key words \"MUST\", \"MUST NOT\", \"REQUIRED\", \"SHALL\", \"SHALL NOT\", \"SHOULD\", \"SHOULD NOT\", \"RECOMMENDED\", \"MAY\", and \"OPTIONAL\" in this document are to be interpreted as described in RFC 2119 (https://tools.ietf.org/html/rfc2119)."]]], "requirements": [348]}, {"id": "2.5", "title": "Interface", "lines": ["2.5.   Interface", ""]}, {"id": "2.5.1", "title": "Key", "lines": [[[[349], 224, "A master key MUST supply itself and MUST NOT supply any other master keys."]]], "requirements": [349]}, {"id": "2.5.2", "title": "Encryption", "lines": [[[[350], 224, "A master key MUST supply itself and MUST NOT supply any other master keys."]]], "requirements": [350]}, {"id": "2.5.3", "title": "Key", "lines": [[[[351], 160, "A master key SHOULD attempt to decrypt a data key using itself."]], [[[352], 224, "A master key MUST not attempt to use any other master keys."]]], "requirements": [351, 352]}, {"id": "2.5.4", "title": "Key", "lines": [[[[353], 224, "The master key MUST generate a data key and MUST then encrypt that data key."]], [[[354], 224, "Inputs to this interface MUST include the algorithm suite and the encryption context."]], [[[355], 224, "The output of this interface MUST include the plaintext data key, the data key encrypted under the master key, and information that can identify which master key was used to generate and encrypt the data key."]], [[[356], 224, "If the master key cannot generate or encrypt the data key, the call MUST result in an error."]]], "requirements": [353, 354, 355, 356]}, {"id": "2.5.5", "title": "Key", "lines": [[[[357], 224, "The master key MUST encrypt the data key."]], [[[358], 224, "Inputs to this interface MUST include the algorithm suite, the encryption context, the encrypted data key, and information that can identify which master key was used to encrypt the data key."]], [[[359], 224, "The output of this interface MUST include a value that this master key can use to obtain the plaintext data key."]], [[[360], 224, "If the master key cannot encrypt the data key, the call MUST result in an error."]]], "requirements": [357, 358, 359, 360]}, {"id": "3", "title": "References", "lines": ["3.   Normative References", "", "   [RFC2119]  Bradner, S., \"Key words for use in RFCs to Indicate", "              Requirement Levels\", BCP 14, RFC 2119,", "              DOI 10.17487/RFC2119, March 1997,", "              <https://www.rfc-editor.org/info/rfc2119>.", "", "   [RFC8174]  Leiba, B., \"Ambiguity of Uppercase vs Lowercase in RFC", "              2119 Key Words\", BCP 14, RFC 8174, DOI 10.17487/RFC8174,", "              May 2017, <https://www.rfc-editor.org/info/rfc8174>.", "", "Acknowledgments", "", "Author's Address", "", "   Amazon AWS", "   Amazon AWS", "", "   Email: cryptools+rfc@amazon.com"]}]}, "compliance/framework/aws-kms/aws-kms-discovery-keyring.txt": {"requirements": [361, 363, 365, 367, 369, 371, 374, 376, 378, 380, 381, 383, 385, 387], "sections": [{"id": "1", "title": "Definitions", "lines": ["1.   Conventions and Definitions", "", "   The key words \"MUST\", \"MUST NOT\", \"REQUIRED\", \"SHALL\", \"SHALL NOT\",", "   \"SHOULD\", \"SHOULD NOT\", \"RECOMMENDED\", \"NOT RECOMMENDED\", \"MAY\", and", "   \"OPTIONAL\" in this document are to be interpreted as described in BCP", "   14 [RFC2119] [RFC8174] when, and only when, they appear in all", "   capitals, as shown here", ""]}, {"id": "2", "title": "Keyring", "lines": ["2.   AWS KMS Discovery Keyring", ""]}, {"id": "2.1", "title": "Version", "lines": ["2.1.   Version", "", "   0.3.0", ""]}, {"id": "2.1.1", "title": "Changelog", "lines": ["2.1.1.   Changelog", "", "   *  0.3.0", "", "      -  Incorporate KMS Keyring Redesign (https://github.com/awslabs/", "         aws-encryption-sdk-specification/tree/master/proposals/2020-07-", "         01_aws-kms-keyring-redesign)", "", "   *  0.2.2", "", "      -  Rename Key IDs to Key Names for increased clarity", "", "      -  Update Key Names and Generator sections to reinforce support", "         for all AWS KMS key identifiers", "", "      -  Pull request link for discussions (https://github.com/awslabs/", "         aws-encryption-sdk-specification/pull/123)", "", "   *  0.2.1", "", "      -  Clarify naming of KMS to AWS KMS (https://github.com/awslabs/", "         aws-encryption-sdk-specification/issues/67)", "", "   *  0.2.0", "", "      -  Remove Keyring Trace (../changes/2020-05-13_remove-keyring-", "         trace/change.md)", "", "   *  0.1.0-preview", "", "      -  Initial record", ""]}, {"id": "2.2", "title": "Implementations", "lines": ["2.2.   Implementations", "", "   | Language | Confirmed Compatible with Spec Version | Minimum Version", "   Confirmed | Implementation | | -------- |", "   -------------------------------------- | ------------------------- |", "   -------------- |", ""]}, {"id": "2.3", "title": "Overview", "lines": ["2.3.   Overview", "", "   A keyring which interacts with AWS Key Management Service (AWS KMS)", "   to decrypt data keys using a filter to identify Customer Master Keys", "   (CMKs).", ""]}, {"id": "2.4", "title": "Definitions", "lines": ["2.4.   Definitions", ""]}, {"id": "2.4.1", "title": "document", "lines": [[[[361], 224, "The key words \"MUST\", \"MUST NOT\", \"REQUIRED\", \"SHALL\", \"SHALL NOT\", \"SHOULD\", \"SHOULD NOT\", \"RECOMMENDED\", \"MAY\", and \"OPTIONAL\" in this document are to be interpreted as described in RFC 2119 (https://tools.ietf.org/html/rfc2119)."]]], "requirements": [361]}, {"id": "2.5", "title": "Interface", "lines": ["2.5.   Interface", "", "   MUST implement that AWS Encryption SDK Keyring interface (../keyring-", "   interface.md#interface)", ""]}, {"id": "2.6", "title": "Initialization", "lines": [[[[362, 363], 232, "On initialization the caller MUST provide:"]], [[[364, 365], 232, "The AWS KMS SDK client MUST NOT be null."]]], "requirements": [363, 365]}, {"id": "2.7", "title": "OnEncrypt", "lines": [[[[366, 367], 232, "This function MUST fail."]]], "requirements": [367]}, {"id": "2.8", "title": "OnDecrypt", "lines": [[[[368, 369], 232, "OnDecrypt MUST take decryption materials (../structures.md#decryption-materials) and a list of encrypted data keys (../structures.md#encrypted-data-key) as input."]], [[[370, 371], 232, "If the decryption materials (../structures.md#decryption-materials) already contained a valid plaintext data key, they keyring MUST fail and MUST NOT modify the decryption materials (../structures.md#decryption-materials)."]], [[[372, 373, 374], 244, "The set of encrypted data keys MUST first be filtered to match this keyring's configuration."]], [[[375, 376], 240, "For each encrypted data key in the filtered set, one at a time, the OnDecrypt MUST attempt to decrypt the data key."]], [[[377, 378], 232, "To attempt to decrypt a particular encrypted data key (../structures.md#encrypted-data-key), OnDecrypt MUST call AWS KMS Decrypt (https://docs.aws.amazon.com/kms/latest/APIReference/ API_Decrypt.html) with the configured AWS KMS client."]], [[[379, 380], 232, "When calling AWS KMS Decrypt (https://docs.aws.amazon.com/kms/latest/APIReference/ API_Decrypt.html), the keyring MUST call with a request constructed as follows:"]], [[[381], 224, "If the call to AWS KMS Decrypt (https://docs.aws.amazon.com/kms/latest/APIReference/ API_Decrypt.html) succeeds OnDecrypt verifies * The \"KeyId\" field in the response MUST equal the AWS KMS ARN from the provider info * The length of the response's \"Plaintext\" MUST equal the key derivation input length (../algorithm-suites.md#key-derivation- input-length) specified by the algorithm suite (../algorithm- suites.md) included in the input decryption materials (../structures.md#decryption-materials)."]], [[[382, 383], 240, "If the response does not satisfy these requirements then an error is collected and the next encrypted data key in the filtered set MUST be attempted."]], [[[384, 385], 232, "If the response does satisfy these requirements then OnDecrypt MUST do the following with the response: * set the plaintext data key on the decryption materials (../structures.md#decryption-materials) as the response \"Plaintext\"."]], [[[386, 387], 240, "If OnDecrypt fails to successfully decrypt any encrypted data key (../structures.md#encrypted-data-key), then it MUST yield an error that includes all collected errors."]]], "requirements": [369, 371, 374, 376, 378, 380, 381, 383, 385, 387]}, {"id": "3", "title": "References", "lines": ["3.   Normative References", "", "   [RFC2119]  Bradner, S., \"Key words for use in RFCs to Indicate", "              Requirement Levels\", BCP 14, RFC 2119,", "              DOI 10.17487/RFC2119, March 1997,", "              <https://www.rfc-editor.org/info/rfc2119>.", "", "   [RFC8174]  Leiba, B., \"Ambiguity of Uppercase vs Lowercase in RFC", "              2119 Key Words\", BCP 14, RFC 8174, DOI 10.17487/RFC8174,", "              May 2017, <https://www.rfc-editor.org/info/rfc8174>.", "", "Acknowledgments", "", "Author's Address", "", "   Amazon AWS", "   Amazon AWS", "", "   Email: cryptools+rfc@amazon.com"]}]}, "compliance/framework/aws-kms/aws-kms-mrk-discovery-keyring.txt": {"requirements": [388, 390, 392, 394, 396, 398, 400, 402, 404, 406, 408, 409, 411, 413, 415], "sections": [{"id": "1", "title": "Definitions", "lines": ["1.   Conventions and Definitions", "", "   The key words \"MUST\", \"MUST NOT\", \"REQUIRED\", \"SHALL\", \"SHALL NOT\",", "   \"SHOULD\", \"SHOULD NOT\", \"RECOMMENDED\", \"NOT RECOMMENDED\", \"MAY\", and", "   \"OPTIONAL\" in this document are to be interpreted as described in BCP", "   14 [RFC2119] [RFC8174] when, and only when, they appear in all", "   capitals, as shown here", ""]}, {"id": "2", "title": "Keyring", "lines": ["2.   AWS KMS MRK Discovery Keyring", ""]}, {"id": "2.1", "title": "Version", "lines": ["2.1.   Version", "", "   0.2.2", ""]}, {"id": "2.1.1", "title": "Changelog", "lines": ["2.1.1.   Changelog", "", "   *  0.2.2", "", "      -  Initial record", ""]}, {"id": "2.2", "title": "Implementations", "lines": ["2.2.   Implementations", "", "   | Language | Confirmed Compatible with Spec Version | Minimum Version", "   Confirmed | Implementation | | -------- |", "   -------------------------------------- | ------------------------- |", "   -------------- |", ""]}, {"id": "2.3", "title": "Overview", "lines": ["2.3.   Overview", "", "   A keyring which interacts with AWS Key Management Service (AWS KMS)", "   to decrypt data keys using a filter to identify Customer Master Keys", "   (CMKs).", ""]}, {"id": "2.4", "title": "Definitions", "lines": ["2.4.   Definitions", ""]}, {"id": "2.4.1", "title": "document", "lines": [[[[388], 224, "The key words \"MUST\", \"MUST NOT\", \"REQUIRED\", \"SHALL\", \"SHALL NOT\", \"SHOULD\", \"SHOULD NOT\", \"RECOMMENDED\", \"MAY\", and \"OPTIONAL\" in this document are to be interpreted as described in RFC 2119 (https://tools.ietf.org/html/rfc2119)."]]], "requirements": [388]}, {"id": "2.5", "title": "Interface", "lines": ["2.5.   Interface", "", "   MUST implement that AWS Encryption SDK Keyring interface (../keyring-", "   interface.md#interface)", ""]}, {"id": "2.6", "title": "Initialization", "lines": [[[[389, 390], 232, "On initialization the keyring MUST accept the following parameters:"]], [[[391, 392], 232, "They keyring MUST fail initialization if any required parameters are missing or null."]], [[[393, 394], 168, "The keyring SHOULD fail initialization if the provided region does not match the region of the KMS client."]]], "requirements": [390, 392, 394]}, {"id": "2.7", "title": "OnEncrypt", "lines": [[[[395, 396], 232, "This function MUST fail."]]], "requirements": [396]}, {"id": "2.8", "title": "OnDecrypt", "lines": [[[[397, 398], 232, "OnDecrypt MUST take decryption materials (../structures.md#decryption-materials) and a list of encrypted data keys (../structures.md#encrypted-data-key) as input."]], [[[399, 400], 232, "If the decryption materials (../structures.md#decryption-materials) already contained a valid plaintext data key, they keyring MUST fail and MUST NOT modify the decryption materials (../structures.md#decryption-materials)."]], [[[401, 402], 240, "The set of encrypted data keys MUST first be filtered to match this keyring's configuration."]], [[[403, 404], 240, "For each encrypted data key in the filtered set, one at a time, the OnDecrypt MUST attempt to decrypt the data key."]], [[[405, 406], 232, "To attempt to decrypt a particular encrypted data key (../structures.md#encrypted-data-key), OnDecrypt MUST call AWS KMS Decrypt (https://docs.aws.amazon.com/kms/latest/APIReference/ API_Decrypt.html) with the configured AWS KMS client."]], [[[407, 408], 232, "When calling AWS KMS Decrypt (https://docs.aws.amazon.com/kms/latest/APIReference/ API_Decrypt.html), the keyring MUST call with a request constructed as follows:"]], [[[409], 224, "If the call to AWS KMS Decrypt (https://docs.aws.amazon.com/kms/latest/APIReference/ API_Decrypt.html) succeeds OnDecrypt verifies * The \"KeyId\" field in the response MUST equal the requested \"KeyId\" * The length of the response's \"Plaintext\" MUST equal the key derivation input length (../algorithm-suites.md#key-derivation- input-length) specified by the algorithm suite (../algorithm- suites.md) included in the input decryption materials (../structures.md#decryption-materials)."]], [[[410, 411], 240, "If the response does not satisfies these requirements then an error is collected and the next encrypted data key in the filtered set MUST be attempted."]], [[[412, 413], 232, "Since the response does satisfies these requirements then OnDecrypt MUST do the following with the response: * set the plaintext data key on the decryption materials (../structures.md#decryption-materials) as the response \"Plaintext\"."]], [[[414, 415], 240, "If OnDecrypt fails to successfully decrypt any encrypted data key (../structures.md#encrypted-data-key), then it MUST yield an error that includes all collected errors."]]], "requirements": [398, 400, 402, 404, 406, 408, 409, 411, 413, 415]}, {"id": "3", "title": "References", "lines": ["3.   Normative References", "", "   [RFC2119]  Bradner, S., \"Key words for use in RFCs to Indicate", "              Requirement Levels\", BCP 14, RFC 2119,", "              DOI 10.17487/RFC2119, March 1997,", "              <https://www.rfc-editor.org/info/rfc2119>.", "", "   [RFC8174]  Leiba, B., \"Ambiguity of Uppercase vs Lowercase in RFC", "              2119 Key Words\", BCP 14, RFC 8174, DOI 10.17487/RFC8174,", "              May 2017, <https://www.rfc-editor.org/info/rfc8174>.", "", "Acknowledgments", "", "Author's Address", "", "   Amazon AWS", "   Amazon AWS", "", "   Email: cryptools+rfc@amazon.com"]}]}, "compliance/framework/aws-kms/aws-kms-mrk-aware-master-key.txt": {"requirements": [416, 417, 418, 419, 420, 421, 422, 423, 424, 425, 426, 427, 428, 429, 430, 431, 432, 433, 434, 435, 436, 437, 438, 439, 440, 441, 442, 443, 444, 445, 446, 447, 448], "sections": [{"id": "1", "title": "Definitions", "lines": ["1.   Conventions and Definitions", "", "   The key words \"MUST\", \"MUST NOT\", \"REQUIRED\", \"SHALL\", \"SHALL NOT\",", "   \"SHOULD\", \"SHOULD NOT\", \"RECOMMENDED\", \"NOT RECOMMENDED\", \"MAY\", and", "   \"OPTIONAL\" in this document are to be interpreted as described in BCP", "   14 [RFC2119] [RFC8174] when, and only when, they appear in all", "   capitals, as shown here", ""]}, {"id": "2", "title": "Key", "lines": ["2.   AWS KMS MRK Aware Master Key", ""]}, {"id": "2.1", "title": "Version", "lines": ["2.1.   Version", "", "   0.2.2", ""]}, {"id": "2.1.1", "title": "Changelog", "lines": ["2.1.1.   Changelog", "", "   *  0.2.2", "", "      -  Initial record", ""]}, {"id": "2.10", "title": "Key", "lines": [[[[437], 224, "The inputs MUST be the same as the Master Key Generate Data Key (../master-key-interface.md#generate-data-key) interface."]], [[[438], 224, "This master key MUST use the configured AWS KMS client to make an AWS KMS GenerateDatakey (https://docs.aws.amazon.com/kms/latest/APIReference/ API_GenerateDataKey.html) request constructed as follows:"]], [[[439], 224, "If the call succeeds the AWS KMS Generate Data Key response's \"Plaintext\" MUST match the key derivation input length specified by the algorithm suite included in the input."]], [[[440], 224, "The response's \"KeyId\" MUST be valid."]], [[[441], 224, "The response's \"Plaintext\" MUST be the plaintext in the output."]], [[[442], 224, "The response's cipher text blob MUST be used as the returned as the ciphertext for the encrypted data key in the output."]], [[[443], 224, "The output MUST be the same as the Master Key Generate Data Key (../master-key-interface.md#generate-data-key) interface."]]], "requirements": [437, 438, 439, 440, 441, 442, 443]}, {"id": "2.11", "title": "Key", "lines": [[[[444], 224, "The inputs MUST be the same as the Master Key Encrypt Data Key (../master-key-interface.md#encrypt-data-key) interface."]], [[[445], 224, "The master key MUST use the configured AWS KMS client to make an AWS KMS Encrypt (https://docs.aws.amazon.com/kms/latest/APIReference/ API_Encrypt.html) request constructed as follows:"]], [[[446], 224, "The AWS KMS Encrypt response MUST contain a valid \"KeyId\"."]], [[[447], 224, "The response's cipher text blob MUST be used as the \"ciphertext\" for the encrypted data key."]], [[[448], 224, "The output MUST be the same as the Master Key Encrypt Data Key (../master-key-interface.md#encrypt-data-key) interface."]]], "requirements": [444, 445, 446, 447, 448]}, {"id": "2.2", "title": "Implementations", "lines": ["2.2.   Implementations", "", "   | Language | Confirmed Compatible with Spec Version | Minimum Version", "   Confirmed | Implementation | | -------- |", "   -------------------------------------- | ------------------------- |", "   -------------- |", ""]}, {"id": "2.3", "title": "Overview", "lines": ["2.3.   Overview", "", "   A Master Key which interacts with AWS Key Management Service (AWS", "   KMS) to create, encrypt, and decrypt data keys using AWS KMS defined", "   Customer Master Keys (CMKs).", ""]}, {"id": "2.4", "title": "Definitions", "lines": ["2.4.   Definitions", ""]}, {"id": "2.4.1", "title": "document", "lines": [[[[416], 224, "The key words \"MUST\", \"MUST NOT\", \"REQUIRED\", \"SHALL\", \"SHALL NOT\", \"SHOULD\", \"SHOULD NOT\", \"RECOMMENDED\", \"MAY\", and \"OPTIONAL\" in this document are to be interpreted as described in RFC 2119 (https://tools.ietf.org/html/rfc2119)."]]], "requirements": [416]}, {"id": "2.5", "title": "Interface", "lines": ["2.5.   Interface", "", "   MUST implement the Master Key Interface (../master-key-", "   interface.md#interface)", ""]}, {"id": "2.6", "title": "Initialization", "lines": [[[[417], 224, "On initialization, the caller MUST provide:"]], [[[418], 224, "The AWS KMS key identifier MUST NOT be null or empty."]], [[[419], 224, "The AWS KMS key identifier MUST be a valid identifier (aws-kms-key-arn.md#a- valid-aws-kms-identifier)."]], [[[420], 224, "The AWS KMS SDK client MUST not be null."]], [[[421], 224, "The master key MUST be able to be configured with an optional list of Grant Tokens."]], [[[422], 160, "This configuration SHOULD be on initialization and SHOULD be immutable."]]], "requirements": [417, 418, 419, 420, 421, 422]}, {"id": "2.7", "title": "Key", "lines": [[[[423], 224, "MUST be unchanged from the Master Key interface."]]], "requirements": [423]}, {"id": "2.8", "title": "Encryption", "lines": [[[[424], 224, "MUST be unchanged from the Master Key interface."]]], "requirements": [424]}, {"id": "2.9", "title": "Key", "lines": [[[[425], 224, "The inputs MUST be the same as the Master Key Decrypt Data Key (../master-key-interface.md#decrypt-data-key) interface."]], [[[426], 224, "The set of encrypted data keys MUST first be filtered to match this master key's configuration."]], [[[427], 224, "To match the encrypted data key's provider ID MUST exactly match the value \"aws-kms\" and the the function AWS KMS MRK Match for Decrypt (aws-kms-mrk-match-for- decrypt.md#implementation) called with the configured AWS KMS key identifier and the encrypted data key's provider info MUST return \"true\"."]], [[[428], 224, "Additionally each provider info MUST be a valid AWS KMS ARN (aws-kms-key-arn.md#a-valid-aws-kms-arn) with a resource type of \"key\"."]], [[[429], 224, "For each encrypted data key in the filtered set, one at a time, the master key MUST attempt to decrypt the data key."]], [[[430], 224, "If this attempt results in an error, then these errors MUST be collected."]], [[[431], 224, "To decrypt the encrypted data key this master key MUST use the configured AWS KMS client to make an AWS KMS Decrypt (https://docs.aws.amazon.com/kms/latest/APIReference/ API_Decrypt.html) request constructed as follows:"]], [[[432], 224, "If the call succeeds then the response's \"KeyId\" MUST be equal to the configured AWS KMS key identifier otherwise the function MUST collect an error."]], [[[433], 224, "The response's \"Plaintext\"'s length MUST equal the length required by the requested algorithm suite otherwise the function MUST collect an error."]], [[[434], 224, "If the AWS KMS response satisfies the requirements then it MUST be use and this function MUST return and not attempt to decrypt any more encrypted data keys."]], [[[435], 224, "If all the input encrypted data keys have been processed then this function MUST yield an error that includes all the collected errors."]], [[[436], 224, "The output MUST be the same as the Master Key Decrypt Data Key (../master-key-interface.md#decrypt-data-key) interface."]]], "requirements": [425, 426, 427, 428, 429, 430, 431, 432, 433, 434, 435, 436]}, {"id": "3", "title": "References", "lines": ["3.   Normative References", "", "   [RFC2119]  Bradner, S., \"Key words for use in RFCs to Indicate", "              Requirement Levels\", BCP 14, RFC 2119,", "              DOI 10.17487/RFC2119, March 1997,", "              <https://www.rfc-editor.org/info/rfc2119>.", "", "   [RFC8174]  Leiba, B., \"Ambiguity of Uppercase vs Lowercase in RFC", "              2119 Key Words\", BCP 14, RFC 8174, DOI 10.17487/RFC8174,", "              May 2017, <https://www.rfc-editor.org/info/rfc8174>.", "", "Acknowledgments", "", "Author's Address", "", "   Amazon AWS", "   Amazon AWS", "", "   Email: cryptools+rfc@amazon.com"]}]}, "compliance/framework/aws-kms/aws-kms-mrk-aware-master-key-provider.txt": {"requirements": [449, 450, 451, 452, 453, 454, 455, 456, 457, 458, 459, 460, 461, 462, 463, 464, 465, 466, 467, 468, 469, 470, 471, 472, 473, 474, 475, 476, 477, 478, 479, 480, 481, 482, 483, 484, 485], "sections": [{"id": "1", "title": "Definitions", "lines": ["1.   Conventions and Definitions", "", "   The key words \"MUST\", \"MUST NOT\", \"REQUIRED\", \"SHALL\", \"SHALL NOT\",", "   \"SHOULD\", \"SHOULD NOT\", \"RECOMMENDED\", \"NOT RECOMMENDED\", \"MAY\", and", "   \"OPTIONAL\" in this document are to be interpreted as described in BCP", "   14 [RFC2119] [RFC8174] when, and only when, they appear in all", "   capitals, as shown here", ""]}, {"id": "2", "title": "Provider", "lines": ["2.   AWS KMS MRK Aware Master Key Provider", ""]}, {"id": "2.1", "title": "Version", "lines": ["2.1.   Version", "", "   0.2.2", ""]}, {"id": "2.1.1", "title": "Changelog", "lines": ["2.1.1.   Changelog", "", "   *  0.2.2", "", "      -  Initial record", ""]}, {"id": "2.2", "title": "Implementations", "lines": ["2.2.   Implementations", "", "   | Language | Confirmed Compatible with Spec Version | Minimum Version", "   Confirmed | Implementation | | -------- |", "   -------------------------------------- | ------------------------- |", "   -------------- |", ""]}, {"id": "2.3", "title": "Overview", "lines": ["2.3.   Overview", "", "   A Master Key Provider which interacts with AWS Key Management Service", "   (AWS KMS) to create, encrypt, and decrypt data keys using AWS KMS", "   defined Customer Master Keys (CMKs).", ""]}, {"id": "2.4", "title": "Definitions", "lines": ["2.4.   Definitions", ""]}, {"id": "2.4.1", "title": "document", "lines": [[[[449], 224, "The key words \"MUST\", \"MUST NOT\", \"REQUIRED\", \"SHALL\", \"SHALL NOT\", \"SHOULD\", \"SHOULD NOT\", \"RECOMMENDED\", \"MAY\", and \"OPTIONAL\" in this document are to be interpreted as described in RFC 2119 (https://tools.ietf.org/html/rfc2119)."]]], "requirements": [449]}, {"id": "2.5", "title": "Interface", "lines": ["2.5.   Interface", "", "   MUST implement the Master Key Provider Interface (../master-key-", "   provider-interface.md#interface)", ""]}, {"id": "2.6", "title": "Initialization", "lines": [[[[450], 224, "On initialization the caller MUST provide:"]], [[[451], 224, "The key id list MUST NOT be empty or null in strict mode."]], [[[452], 224, "The key id list MUST NOT contain any null or empty string values."]], [[[453], 224, "All AWS KMS key identifiers are be passed to Assert AWS KMS MRK are unique (aws- kms-mrk-are-unique.md#Implementation) and the function MUST return success."]], [[[454], 224, "A discovery filter MUST NOT be configured in strict mode."]], [[[455], 224, "A default MRK Region MUST NOT be configured in strict mode."]], [[[456], 224, "In discovery mode if a default MRK Region is not configured the AWS SDK Default Region MUST be used."]], [[[457], 224, "If an AWS SDK Default Region can not be obtained initialization MUST fail."]], [[[458], 224, "The key id list MUST be empty in discovery mode."]], [[[459], 224, "The regional client supplier MUST be defined in discovery mode."]]], "requirements": [450, 451, 452, 453, 454, 455, 456, 457, 458, 459]}, {"id": "2.7", "title": "Key", "lines": [[[[460], 224, "The input MUST be the same as the Master Key Provider Get Master Key (../master-key-provider-interface.md#get-master-key) interface."]], [[[461], 224, "The function MUST only provide master keys if the input provider id equals \"aws-kms\"."]], [[[462], 224, "In strict mode, the requested AWS KMS key ARN MUST match a member of the configured key ids by using AWS KMS MRK Match for Decrypt (aws-kms-mrk-match-for-decrypt.md#implementation) otherwise this function MUST error."]], [[[463], 224, "In discovery mode, the requested AWS KMS key identifier MUST be a well formed AWS KMS ARN."]], [[[464], 224, "In discovery mode if a discovery filter is configured the requested AWS KMS key ARN's \"partition\" MUST match the discovery filter's \"partition\" and the AWS KMS key ARN's \"account\" MUST exist in the discovery filter's account id set."]], [[[465], 224, "If the requested AWS KMS key identifier is not a well formed ARN the AWS Region MUST be the configured default region this SHOULD be obtained from the AWS SDK."]], [[[466], 224, "Otherwise if the requested AWS KMS key identifier is identified as a multi-Region key (aws-kms-key- arn.md#identifying-an-aws-kms-multi-region-key), then AWS Region MUST be the region from the AWS KMS key ARN stored in the provider info from the encrypted data key."]], [[[467], 224, "Otherwise if the mode is discovery then the AWS Region MUST be the discovery MRK region."]], [[[468], 224, "Finally if the provider info is identified as a multi-Region key (aws-kms-key- arn.md#identifying-an-aws-kms-multi-region-key) the AWS Region MUST be the region from the AWS KMS key in the configured key ids matched to the requested AWS KMS key by using AWS KMS MRK Match for Decrypt (aws-kms-mrk-match-for-decrypt.md#implementation)."]], [[[469], 224, "An AWS KMS client MUST be obtained by calling the regional client supplier with this AWS Region."]], [[[470], 224, "In strict mode a AWS KMS MRK Aware Master Key (aws-kms-mrk-aware- master-key.md) MUST be returned configured with"]], [[[471], 224, "In discovery mode a AWS KMS MRK Aware Master Key (aws-kms-mrk-aware- master-key.md) MUST be returned configured with"]], [[[472], 224, "The output MUST be the same as the Master Key Provider Get Master Key (../master-key-provider-interface.md#get-master-key) interface."]]], "requirements": [460, 461, 462, 463, 464, 465, 466, 467, 468, 469, 470, 471, 472]}, {"id": "2.8", "title": "Encryption", "lines": [[[[473], 224, "The input MUST be the same as the Master Key Provider Get Master Keys For Encryption (../master-key-provider-interface.md#get-master-keys- for-encryption) interface."]], [[[474], 224, "If the configured mode is discovery the function MUST return an empty list."]], [[[475], 224, "If the configured mode is strict this function MUST return a list of master keys obtained by calling Get Master Key (aws-kms-mrk- aware-master-key-provider.md#get-master-key) for each AWS KMS key identifier in the configured key ids The output MUST be the same as the Master Key Provider Get Master Keys For Encryption (../master-key-provider-interface.md#get-master- keys-for-encryption) interface."]]], "requirements": [473, 474, 475]}, {"id": "2.9", "title": "Key", "lines": [[[[476], 224, "The input MUST be the same as the Master Key Provider Decrypt Data Key (../master-key-provider-interface.md#decrypt-data-key) interface."]], [[[477], 224, "The set of encrypted data keys MUST first be filtered to match this master key's configuration."]], [[[478], 224, "To match the encrypted data key's provider ID MUST exactly match the value \"aws-kms\"."]], [[[479], 224, "Additionally each provider info MUST be a valid AWS KMS ARN (aws-kms-key-arn.md#a- valid-aws-kms-arn) with a resource type of \"key\"."]], [[[480], 224, "For each encrypted data key in the filtered set, one at a time, the master key provider MUST call Get Master Key (aws-kms-mrk-aware- master-key-provider.md#get-master-key) with the encrypted data key's provider info as the AWS KMS key ARN."]], [[[481], 224, "It MUST call Decrypt Data Key (aws-kms-mrk-aware-master-key.md#decrypt-data-key) on this master key with the input algorithm, this single encrypted data key, and the input encryption context."]], [[[482], 224, "If this attempt results in an error, then these errors MUST be collected."]], [[[483], 224, "If the decrypt data key call is successful, then this function MUST return this result and not attempt to decrypt any more encrypted data keys."]], [[[484], 224, "If all the input encrypted data keys have been processed then this function MUST yield an error that includes all the collected errors."]], [[[485], 224, "The output MUST be the same as the Master Key Provider Decrypt Data Key (../master-key-provider-interface.md#decrypt-data-key) interface."]]], "requirements": [476, 477, 478, 479, 480, 481, 482, 483, 484, 485]}, {"id": "3", "title": "References", "lines": ["3.   Normative References", "", "   [RFC2119]  Bradner, S., \"Key words for use in RFCs to Indicate", "              Requirement Levels\", BCP 14, RFC 2119,", "              DOI 10.17487/RFC2119, March 1997,", "              <https://www.rfc-editor.org/info/rfc2119>.", "", "   [RFC8174]  Leiba, B., \"Ambiguity of Uppercase vs Lowercase in RFC", "              2119 Key Words\", BCP 14, RFC 8174, DOI 10.17487/RFC8174,", "              May 2017, <https://www.rfc-editor.org/info/rfc8174>.", "", "Acknowledgments", "", "Author's Address", "", "   Amazon AWS", "   Amazon AWS", "", "   Email: cryptools+rfc@amazon.com"]}]}, "compliance/framework/aws-kms/aws-kms-keyring.txt": {"requirements": [486, 488, 490, 492, 494, 496, 498, 500, 502, 504, 506, 509, 512, 514, 516, 518, 520, 522, 524, 526, 528, 530, 532, 533, 535, 537, 538, 540, 541, 543, 545], "sections": [{"id": "1", "title": "Definitions", "lines": ["1.   Conventions and Definitions", "", "   The key words \"MUST\", \"MUST NOT\", \"REQUIRED\", \"SHALL\", \"SHALL NOT\",", "   \"SHOULD\", \"SHOULD NOT\", \"RECOMMENDED\", \"NOT RECOMMENDED\", \"MAY\", and", "   \"OPTIONAL\" in this document are to be interpreted as described in BCP", "   14 [RFC2119] [RFC8174] when, and only when, they appear in all", "   capitals, as shown here", ""]}, {"id": "2", "title": "Keyring", "lines": ["2.   AWS KMS Keyring", ""]}, {"id": "2.1", "title": "Version", "lines": ["2.1.   Version", "", "   0.3.0", ""]}, {"id": "2.1.1", "title": "Changelog", "lines": ["2.1.1.   Changelog", "", "   *  0.3.0", "", "      -  Incorporate KMS Keyring Redesign (https://github.com/awslabs/", "         aws-encryption-sdk-specification/tree/master/proposals/2020-07-", "         01_aws-kms-keyring-redesign)", "", "   *  0.2.2", "", "      -  Rename Key IDs to Key Names for increased clarity", "", "      -  Update Key Names and Generator sections to reinforce support", "         for all AWS KMS key identifiers", "", "      -  Pull request link for discussions (https://github.com/awslabs/", "         aws-encryption-sdk-specification/pull/123)", "", "   *  0.2.1", "", "      -  Clarify naming of KMS to AWS KMS (https://github.com/awslabs/", "         aws-encryption-sdk-specification/issues/67)", "", "   *  0.2.0", "", "      -  Remove Keyring Trace (../changes/2020-05-13_remove-keyring-", "         trace/change.md)", "", "   *  0.1.0-preview", "", "      -  Initial record", ""]}, {"id": "2.2", "title": "Implementations", "lines": ["2.2.   Implementations", "", "   | Language | Confirmed Compatible with Spec Version | Minimum Version", "   Confirmed | Implementation | | -------- |", "   -------------------------------------- | ------------------------- |", "   -------------- |", ""]}, {"id": "2.3", "title": "Overview", "lines": ["2.3.   Overview", "", "   A keyring which interacts with AWS Key Management Service (AWS KMS)", "   to create, encrypt, and decrypt data keys using AWS KMS keys.", ""]}, {"id": "2.4", "title": "Definitions", "lines": ["2.4.   Definitions", ""]}, {"id": "2.4.1", "title": "document", "lines": [[[[486], 224, "The key words \"MUST\", \"MUST NOT\", \"REQUIRED\", \"SHALL\", \"SHALL NOT\", \"SHOULD\", \"SHOULD NOT\", \"RECOMMENDED\", \"MAY\", and \"OPTIONAL\" in this document are to be interpreted as described in RFC 2119 (https://tools.ietf.org/html/rfc2119)."]]], "requirements": [486]}, {"id": "2.5", "title": "Interface", "lines": ["2.5.   Interface", "", "   MUST implement the AWS Encryption SDK Keyring interface (../keyring-", "   interface.md#interface)", ""]}, {"id": "2.6", "title": "Initialization", "lines": [[[[487, 488], 232, "The AWS KMS key identifier MUST NOT be null or empty."]], [[[489, 490], 232, "The AWS KMS key identifier MUST be a valid identifier (aws-kms-key-arn.md#a- valid-aws-kms-identifier)."]], [[[491, 492], 232, "The AWS KMS SDK client MUST NOT be null."]]], "requirements": [488, 490, 492]}, {"id": "2.7", "title": "OnEncrypt", "lines": [[[[493, 494], 232, "OnEncrypt MUST take encryption materials (../structures.md#encryption-materials) as input."]], [[[495, 496], 232, "If the input encryption materials (../structures.md#encryption- materials) do not contain a plaintext data key OnEncrypt MUST attempt to generate a new plaintext data key by calling AWS KMS GenerateDataKey (https://docs.aws.amazon.com/kms/latest/APIReference/ API_GenerateDataKey.html)."]], [[[497, 498], 232, "If the keyring calls AWS KMS GenerateDataKeys, it MUST use the configured AWS KMS client to make the call."]], [[[499, 500], 232, "The keyring MUST call AWS KMS GenerateDataKeys with a request constructed as follows:"]], [[[501, 502], 240, "If the call to AWS KMS GenerateDataKey (https://docs.aws.amazon.com/kms/latest/APIReference/ API_GenerateDataKey.html) does not succeed, OnEncrypt MUST NOT modify the encryption materials (../structures.md#encryption-materials) and MUST fail."]], [[[503, 504], 232, "If the Generate Data Key call succeeds, OnEncrypt MUST verify that the response \"Plaintext\" length matches the specification of the algorithm suite (../algorithm-suites.md)'s Key Derivation Input Length field."]], [[[505, 506], 240, "The Generate Data Key response's \"KeyId\" MUST be a valid AWS KMS key ARN (aws-kms-key-arn.md#a-valid-aws-kms-arn)."]], [[[507, 508, 509], 248, "* \"EncryptionContext\" MUST be the encryption context (../structures.md#encryption-context) included in the input encryption materials (../structures.md#encryption-materials)."]], [[[510, 511, 512], 248, "* \"GrantTokens\" MUST be this keyring's grant tokens (https://docs.aws.amazon.com/kms/latest/developerguide/ concepts.html#grant_token)."]], [[[513, 514], 232, "If the call to AWS KMS Encrypt (https://docs.aws.amazon.com/kms/latest/APIReference/ API_Encrypt.html) does not succeed, OnEncrypt MUST fail."]], [[[515, 516], 240, "If the Encrypt call succeeds the response's \"KeyId\" MUST be A valid AWS KMS key ARN (aws-kms-key-arn.md#a-valid-aws-kms-arn)."]], [[[517, 518], 232, "If verified, OnEncrypt MUST append a new encrypted data key (../structures.md#encrypted-data-key) to the encrypted data key list in the encryption materials (../structures.md#encryption-materials), constructed as follows: * The ciphertext (../structures.md#ciphertext) MUST be the response \"CiphertextBlob\"."]], [[[519, 520], 240, "* The key provider id (../structures.md#key-provider-id) MUST be \"aws-kms\"."]], [[[521, 522], 240, "* The key provider information (../structures.md#key-provider- information) MUST be the response \"KeyId\"."]], [[[523, 524], 232, "If all Encrypt calls succeed, OnEncrypt MUST output the modified encryption materials (../structures.md#encryption-materials)."]]], "requirements": [494, 496, 498, 500, 502, 504, 506, 509, 512, 514, 516, 518, 520, 522, 524]}, {"id": "2.8", "title": "OnDecrypt", "lines": [[[[525, 526], 232, "OnDecrypt MUST take decryption materials (../structures.md#decryption-materials) and a list of encrypted data keys (../structures.md#encrypted-data-key) as input."]], [[[527, 528], 232, "If the decryption materials (../structures.md#decryption-materials) already contained a valid plaintext data key OnDecrypt MUST return an error."]], [[[529, 530], 240, "The set of encrypted data keys MUST first be filtered to match this keyring's configuration."]], [[[531, 532], 240, "For each encrypted data key in the filtered set, one at a time, the OnDecrypt MUST attempt to decrypt the data key."]], [[[533], 224, "If this attempt results in an error, then these errors MUST be collected."]], [[[534, 535], 232, "To attempt to decrypt a particular encrypted data key (../structures.md#encrypted-data-key), OnDecrypt MUST call AWS KMS Decrypt (https://docs.aws.amazon.com/kms/latest/APIReference/ API_Decrypt.html) with the configured AWS KMS client."]], [[[536, 537], 232, "When calling AWS KMS Decrypt (https://docs.aws.amazon.com/kms/latest/APIReference/ API_Decrypt.html), the keyring MUST call with a request constructed as follows:"]], [[[538], 224, "\"Plaintext\" MUST equal the key derivation input length (../algorithm-suites.md#key-derivation- input-length) specified by the algorithm suite (../algorithm- suites.md) included in the input decryption materials (../structures.md#decryption-materials)."]], [[[539, 540], 240, "If the response does not satisfies these requirements then an error MUST be collected and the next encrypted data key in the filtered set MUST be attempted."]], [[[541], 224, "If the response does satisfy these requirements then OnDecrypt: * MUST set the plaintext data key on the decryption materials (../structures.md#decryption-materials) as the response \"Plaintext\"."]], [[[542, 543], 232, "* MUST immediately return the modified decryption materials (../structures.md#decryption-materials)."]], [[[544, 545], 240, "If OnDecrypt fails to successfully decrypt any encrypted data key (../structures.md#encrypted-data-key), then it MUST yield an error that includes all the collected errors."]]], "requirements": [526, 528, 530, 532, 533, 535, 537, 538, 540, 541, 543, 545]}, {"id": "3", "title": "References", "lines": ["3.   Normative References", "", "   [RFC2119]  Bradner, S., \"Key words for use in RFCs to Indicate", "              Requirement Levels\", BCP 14, RFC 2119,", "              DOI 10.17487/RFC2119, March 1997,", "              <https://www.rfc-editor.org/info/rfc2119>.", "", "   [RFC8174]  Leiba, B., \"Ambiguity of Uppercase vs Lowercase in RFC", "              2119 Key Words\", BCP 14, RFC 8174, DOI 10.17487/RFC8174,", "              May 2017, <https://www.rfc-editor.org/info/rfc8174>.", "", "Acknowledgments", "", "Author's Address", "", "   Amazon AWS", "   Amazon AWS", "", "   Email: cryptools+rfc@amazon.com"]}]}, "compliance/framework/aws-kms/aws-kms-mrk-match-for-decrypt.txt": {"requirements": [546, 548, 550, 552, 554], "sections": [{"id": "1", "title": "Definitions", "lines": ["1.   Conventions and Definitions", "", "   The key words \"MUST\", \"MUST NOT\", \"REQUIRED\", \"SHALL\", \"SHALL NOT\",", "   \"SHOULD\", \"SHOULD NOT\", \"RECOMMENDED\", \"NOT RECOMMENDED\", \"MAY\", and", "   \"OPTIONAL\" in this document are to be interpreted as described in BCP", "   14 [RFC2119] [RFC8174] when, and only when, they appear in all", "   capitals, as shown here", ""]}, {"id": "2", "title": "Decrypt", "lines": ["2.   AWS KMS MRK Match for Decrypt", ""]}, {"id": "2.1", "title": "Version", "lines": ["2.1.   Version", "", "   0.2.2", ""]}, {"id": "2.1.1", "title": "Changelog", "lines": ["2.1.1.   Changelog", "", "   *  0.2.2", "", "      -  Initial record", ""]}, {"id": "2.2", "title": "Implementations", "lines": ["2.2.   Implementations", "", "   | Language | Confirmed Compatible with Spec Version | Minimum Version", "   Confirmed | Implementation | | -------- |", "   -------------------------------------- | ------------------------- |", "   -------------- |", ""]}, {"id": "2.3", "title": "Overview", "lines": ["2.3.   Overview", "", "   Since the AWS Encryption SDK stores the AWS KMS key ARN in the", "   encrypted data key of the message format an AWS KMS component needs", "   to be able to evaluate if a configured ARN matches a stored ARN.", "   This is especially important for multi-Region keys because the match", "   does not need to be exact.", ""]}, {"id": "2.4", "title": "Definitions", "lines": ["2.4.   Definitions", ""]}, {"id": "2.4.1", "title": "document", "lines": [[[[546], 224, "The key words \"MUST\", \"MUST NOT\", \"REQUIRED\", \"SHALL\", \"SHALL NOT\", \"SHOULD\", \"SHOULD NOT\", \"RECOMMENDED\", \"MAY\", and \"OPTIONAL\" in this document are to be interpreted as described in RFC 2119 (https://tools.ietf.org/html/rfc2119)."]]], "requirements": [546]}, {"id": "2.5", "title": "Implementation", "lines": [[[[547, 548], 232, "The caller MUST provide:"]], [[[549, 550], 232, "If both identifiers are identical, this function MUST return \"true\"."]], [[[551, 552], 232, "Otherwise if either input is not identified as a multi-Region key (aws-kms-key-arn.md#identifying-an-aws-kms-multi-region-key), then this function MUST return \"false\"."]], [[[553, 554], 232, "Otherwise if both inputs are identified as a multi-Region keys (aws-kms-key-arn.md#identifying-an- aws-kms-multi-region-key), this function MUST return the result of comparing the \"partition\", \"service\", \"accountId\", \"resourceType\", and \"resource\" parts of both ARN inputs."]]], "requirements": [548, 550, 552, 554]}, {"id": "3", "title": "References", "lines": ["3.   Normative References", "", "   [RFC2119]  Bradner, S., \"Key words for use in RFCs to Indicate", "              Requirement Levels\", BCP 14, RFC 2119,", "              DOI 10.17487/RFC2119, March 1997,", "              <https://www.rfc-editor.org/info/rfc2119>.", "", "   [RFC8174]  Leiba, B., \"Ambiguity of Uppercase vs Lowercase in RFC", "              2119 Key Words\", BCP 14, RFC 8174, DOI 10.17487/RFC8174,", "              May 2017, <https://www.rfc-editor.org/info/rfc8174>.", "", "Acknowledgments", "", "Author's Address", "", "   Amazon AWS", "   Amazon AWS", "", "   Email: cryptools+rfc@amazon.com"]}]}, "compliance/framework/aws-kms/aws-kms-multi-keyrings.txt": {"requirements": [555, 556, 558, 560, 562, 563, 564, 566, 568, 570, 572, 574, 576, 578, 580, 582, 583], "sections": [{"id": "1", "title": "Definitions", "lines": ["1.   Conventions and Definitions", "", "   The key words \"MUST\", \"MUST NOT\", \"REQUIRED\", \"SHALL\", \"SHALL NOT\",", "   \"SHOULD\", \"SHOULD NOT\", \"RECOMMENDED\", \"NOT RECOMMENDED\", \"MAY\", and", "   \"OPTIONAL\" in this document are to be interpreted as described in BCP", "   14 [RFC2119] [RFC8174] when, and only when, they appear in all", "   capitals, as shown here", ""]}, {"id": "2", "title": "Keyrings", "lines": ["2.   AWS KMS Multi Keyrings", ""]}, {"id": "2.1", "title": "Version", "lines": ["2.1.   Version", "", "   0.3.0", ""]}, {"id": "2.1.1", "title": "Changelog", "lines": ["2.1.1.   Changelog", "", "   *  0.3.0", "", "      -  Incorporate KMS Keyring Redesign (https://github.com/awslabs/", "         aws-encryption-sdk-specification/tree/master/proposals/2020-07-", "         01_aws-kms-keyring-redesign)", "", "   *  0.2.2", "", "      -  Rename Key IDs to Key Names for increased clarity", "", "      -  Update Key Names and Generator sections to reinforce support", "         for all AWS KMS key identifiers", "", "      -  Pull request link for discussions (https://github.com/awslabs/", "         aws-encryption-sdk-specification/pull/123)", "", "   *  0.2.1", "", "      -  Clarify naming of KMS to AWS KMS (https://github.com/awslabs/", "         aws-encryption-sdk-specification/issues/67)", "", "   *  0.2.0", "", "      -  Remove Keyring Trace (../changes/2020-05-13_remove-keyring-", "         trace/change.md)", "", "   *  0.1.0-preview", "", "      -  Initial record", ""]}, {"id": "2.2", "title": "Implementations", "lines": ["2.2.   Implementations", "", "   | Language | Confirmed Compatible with Spec Version | Minimum Version", "   Confirmed | Implementation | | -------- |", "   -------------------------------------- | ------------------------- |", "   -------------- |", ""]}, {"id": "2.3", "title": "Overview", "lines": ["2.3.   Overview", "", "   The AWS KMS MRK keyrings only operate on a single AWS KMS key ARN.", "   However customers want to easily configure multiple AWS KMS key ARNs.", "   These functions compose multiple AWS KMS key ARNs and return a single", "   Multi Keyring.", ""]}, {"id": "2.4", "title": "Definitions", "lines": ["2.4.   Definitions", ""]}, {"id": "2.4.1", "title": "document", "lines": [[[[555], 224, "The key words \"MUST\", \"MUST NOT\", \"REQUIRED\", \"SHALL\", \"SHALL NOT\", \"SHOULD\", \"SHOULD NOT\", \"RECOMMENDED\", \"MAY\", and \"OPTIONAL\" in this document are to be interpreted as described in RFC 2119 (https://tools.ietf.org/html/rfc2119)."]]], "requirements": [555]}, {"id": "2.5", "title": "Multi-Keyring", "lines": [[[[556], 224, "The caller MUST provide:"]], [[[557, 558], 232, "If any of the AWS KMS key identifiers is not a valid AWS KMS key ARN (aws-kms-key-arn.md#a-valid-aws-kms-arn), this function MUST fail."]], [[[559, 560], 240, "If a regional client supplier is not passed, then a default MUST be created that takes a region string and generates a default AWS SDK client for the given region."]], [[[561, 562], 232, "If there is a generator input then the generator keyring MUST be a AWS KMS Keyring (aws-kms-keyring.md) initialized with"]], [[[563], 224, "* The AWS KMS client that MUST be created by the regional client supplier when called with the region part of the AWS KMS key identifier or a signal for the AWS SDK to select the default region."]], [[[564], 160, "* The input list of AWS KMS grant tokens NOTE: The AWS Encryption SDK SHOULD NOT attempt to evaluate its own default region."]], [[[565, 566], 232, "Then a Multi-Keyring (../multi-keyring.md#inputs) MUST be initialize by using this generator keyring as the generator keyring (../multi- keyring.md#generator-keyring) and this set of child keyrings as the child keyrings (../multi-keyring.md#child-keyrings)."]], [[[567, 568], 232, "This Multi- Keyring MUST be this function's output."]]], "requirements": [556, 558, 560, 562, 563, 564, 566, 568]}, {"id": "2.6", "title": "Multi-Keyring", "lines": [[[[569, 570], 232, "The caller MUST provide:"]], [[[571, 572], 232, "If an empty set of Region is provided this function MUST fail."]], [[[573, 574], 232, "If any element of the set of regions is null or an empty string this function MUST fail."]], [[[575, 576], 240, "If a regional client supplier is not passed, then a default MUST be created that takes a region string and generates a default AWS SDK client for the given region."]], [[[577, 578], 240, "A set of AWS KMS clients MUST be created by calling regional client supplier for each region in the input set of regions."]], [[[579, 580], 232, "Then a set of AWS KMS Discovery Keyring (aws-kms-discovery- keyring.md) MUST be created for each AWS KMS client by initializing each keyring with"]], [[[581, 582], 232, "Then a Multi-Keyring (../multi-keyring.md#inputs) MUST be initialize by using this set of discovery keyrings as the child keyrings (../multi-keyring.md#child-keyrings)."]], [[[583], 224, "This Multi-Keyring MUST be this functions output."]]], "requirements": [570, 572, 574, 576, 578, 580, 582, 583]}, {"id": "3", "title": "References", "lines": ["3.   Normative References", "", "   [RFC2119]  Bradner, S., \"Key words for use in RFCs to Indicate", "              Requirement Levels\", BCP 14, RFC 2119,", "              DOI 10.17487/RFC2119, March 1997,", "              <https://www.rfc-editor.org/info/rfc2119>.", "", "   [RFC8174]  Leiba, B., \"Ambiguity of Uppercase vs Lowercase in RFC", "              2119 Key Words\", BCP 14, RFC 8174, DOI 10.17487/RFC8174,", "              May 2017, <https://www.rfc-editor.org/info/rfc8174>.", "", "Acknowledgments", "", "Author's Address", "", "   Amazon AWS", "   Amazon AWS", "", "   Email: cryptools+rfc@amazon.com"]}]}, "compliance/framework/aws-kms/aws-kms-key-arn.txt": {"requirements": [584, 586, 588, 590, 592, 594, 596, 598, 600], "sections": [{"id": "1", "title": "Definitions", "lines": ["1.   Conventions and Definitions", "", "   The key words \"MUST\", \"MUST NOT\", \"REQUIRED\", \"SHALL\", \"SHALL NOT\",", "   \"SHOULD\", \"SHOULD NOT\", \"RECOMMENDED\", \"NOT RECOMMENDED\", \"MAY\", and", "   \"OPTIONAL\" in this document are to be interpreted as described in BCP", "   14 [RFC2119] [RFC8174] when, and only when, they appear in all", "   capitals, as shown here", ""]}, {"id": "2", "title": "ARN", "lines": ["2.   AWS KMS Key ARN", ""]}, {"id": "2.1", "title": "Version", "lines": ["2.1.   Version", "", "   0.2.2", ""]}, {"id": "2.1.1", "title": "Changelog", "lines": ["2.1.1.   Changelog", "", "   *  0.2.2", "", "      -  Initial record", ""]}, {"id": "2.2", "title": "Implementations", "lines": ["2.2.   Implementations", "", "   | Language | Confirmed Compatible with Spec Version | Minimum Version", "   Confirmed | Implementation | | -------- |", "   -------------------------------------- | ------------------------- |", "   -------------- |", ""]}, {"id": "2.3", "title": "Overview", "lines": ["2.3.   Overview", "", "   AWS KMS Key ARNs generally follow AWS ARN", "   (https://docs.aws.amazon.com/general/latest/gr/aws-arns-and-", "   namespaces.html)) but there are a few subtle differences.  This is", "   NOT the authoritative source for these rules, it is just a", "   specification for how the ESDK processes AWS KMS CMK ARNs.", ""]}, {"id": "2.4", "title": "Definitions", "lines": ["2.4.   Definitions", ""]}, {"id": "2.4.1", "title": "document", "lines": [[[[584], 224, "The key words \"MUST\", \"MUST NOT\", \"REQUIRED\", \"SHALL\", \"SHALL NOT\", \"SHOULD\", \"SHOULD NOT\", \"RECOMMENDED\", \"MAY\", and \"OPTIONAL\" in this document are to be interpreted as described in RFC 2119 (https://tools.ietf.org/html/rfc2119)."]]], "requirements": [584]}, {"id": "2.5", "title": "ARN", "lines": ["2.5.   A valid AWS KMS ARN", "", "   A string with 5 \":\" that delimit following 6 parts:", "", "   1.  MUST start with string \"arn\"", "", "   2.  The partition MUST be a non-empty", "", "   3.  The service MUST be the string \"kms\"", "", "   4.  The region MUST be a non-empty string", "", "   5.  The account MUST be a non-empty string", "", "   6.  The resource section MUST be non-empty and MUST be split by a", "       single \"/\" any additional \"/\" are included in the resource id", "", "       1.  The resource type MUST be either \"alias\" or \"key\"", "", "       2.  The resource id MUST be a non-empty string", ""]}, {"id": "2.6", "title": "identifier", "lines": ["2.6.   A valid AWS KMS identifier", "", "   An AWS KMS identifer can be any of the following", "", "   *  A valid AWS KMS ARN", "", "   *  AWS KMS alias, the resource section of an AWS KMS alias ARN", "", "   *  AWS KMS key id, the resource id of an AWS KMS key ARN", ""]}, {"id": "2.7", "title": "keys", "lines": ["2.7.   AWS KMS multi-Region keys", "", "   AWS KMS multi-Region keys can be distinguished from a single-Region", "   key because the key id begins with \"mrk-\".  AWS KMS MRK aware", "   components can take as input any AWS KMS identifier:", "", "   *  AWS KMS key ARN (\"arn:aws:kms:us-east-", "      1:2222222222222:key/1234abcd-12ab-34cd-56ef-1234567890ab\")", "", "   *  AWS KMS multi-Region key ARN (\"arn:aws:kms:us-east-", "      1:2222222222222:key/mrk-4321abcd12ab34cd56ef1234567890ab\")", "", "   *  AWS KMS alias ARN (\"arn:aws:kms:us-west-2:111122223333:alias/test-", "      key\")", "", "   *  AWS KMS key id (\"1234abcd-12ab-34cd-56ef-1234567890ab\")", "", "   *  AWS KMS multi-Region key id (\"mrk-", "      4321abcd12ab34cd56ef1234567890ab\")", "", "   *  AWS KMS alias (\"alias/test-key\")", "", "   Since the alias is can be any string a customer can create an alias", "   that started with \"mrk-\".  But an alias is not a multi-Region key.", ""]}, {"id": "2.8", "title": "ARN", "lines": [[[[585, 586], 232, "This function MUST take a single AWS KMS ARN If the input is an invalid AWS KMS ARN this function MUST error."]], [[[587, 588], 232, "If resource type is \"alias\", this is an AWS KMS alias ARN and MUST return false."]], [[[589, 590], 232, "If resource type is \"key\" and resource ID starts with \"mrk-\", this is a AWS KMS multi-Region key ARN and MUST return true."]], [[[591, 592], 232, "If resource type is \"key\" and resource ID does not start with \"mrk-\", this is a (single-region) AWS KMS key ARN and MUST return false."]]], "requirements": [586, 588, 590, 592]}, {"id": "2.9", "title": "identifier", "lines": [[[[593, 594], 232, "This function MUST take a single AWS KMS identifier If the input starts with \"arn:\", this MUST return the output of identifying an an AWS KMS multi-Region ARN (aws-kms-key- arn.md#identifying-an-an-aws-kms-multi-region-arn) called with this input."]], [[[595, 596], 232, "If the input starts with \"alias/\", this an AWS KMS alias and not a multi-Region key id and MUST return false."]], [[[597, 598], 232, "If the input starts with \"mrk-\", this is a multi-Region key id and MUST return true."]], [[[599, 600], 232, "If the input does not start with any of the above, this is not a multi- Region key id and MUST return false."]]], "requirements": [594, 596, 598, 600]}, {"id": "3", "title": "References", "lines": ["3.   Normative References", "", "   [RFC2119]  Bradner, S., \"Key words for use in RFCs to Indicate", "              Requirement Levels\", BCP 14, RFC 2119,", "              DOI 10.17487/RFC2119, March 1997,", "              <https://www.rfc-editor.org/info/rfc2119>.", "", "   [RFC8174]  Leiba, B., \"Ambiguity of Uppercase vs Lowercase in RFC", "              2119 Key Words\", BCP 14, RFC 8174, DOI 10.17487/RFC8174,", "              May 2017, <https://www.rfc-editor.org/info/rfc8174>.", "", "Acknowledgments", "", "Author's Address", "", "   Amazon AWS", "   Amazon AWS", "", "   Email: cryptools+rfc@amazon.com"]}]}, "compliance/framework/aws-kms/aws-kms-mrk-are-unique.txt": {"requirements": [601, 603, 605, 607], "sections": [{"id": "1", "title": "Definitions", "lines": ["1.   Conventions and Definitions", "", "   The key words \"MUST\", \"MUST NOT\", \"REQUIRED\", \"SHALL\", \"SHALL NOT\",", "   \"SHOULD\", \"SHOULD NOT\", \"RECOMMENDED\", \"NOT RECOMMENDED\", \"MAY\", and", "   \"OPTIONAL\" in this document are to be interpreted as described in BCP", "   14 [RFC2119] [RFC8174] when, and only when, they appear in all", "   capitals, as shown here", ""]}, {"id": "2", "title": "unique", "lines": ["2.   Assert AWS KMS MRK are unique", ""]}, {"id": "2.1", "title": "Version", "lines": ["2.1.   Version", "", "   0.2.2", ""]}, {"id": "2.1.1", "title": "Changelog", "lines": ["2.1.1.   Changelog", "", "   *  0.2.2", "", "      -  Initial record", ""]}, {"id": "2.2", "title": "Implementations", "lines": ["2.2.   Implementations", "", "   | Language | Confirmed Compatible with Spec Version | Minimum Version", "   Confirmed | Implementation | | -------- |", "   -------------------------------------- | ------------------------- |", "   -------------- |", ""]}, {"id": "2.3", "title": "Overview", "lines": ["2.3.   Overview", "", "   Duplicate multi-region key ids create ambiguity about which Region to", "   contact.  This is better resolved outside of the AWS Encryption SDK.", "   While preferring the \"local\" Region is a seductive solution, this can", "   not be 100% correct.  First, because not all code runs in an AWS", "   Region, and second because customers may want create privacy controls", "   around their data.  In this case nearby region may exists and store", "   ciphertext, but may be restricted from having the AWS KMS keys.  In", "   any complicated deployment determining the closest, or preferred", "   region is itself a complicated task.  It will be easier for customers", "   to reason about this criteria and ensure their code is correct if the", "   AWS Encryption SDK offers one and only one configuration for a", "   behavior. e.g.  If the preferred region logic results in an ambiguous", "   configuration is informed and they can resolve the ambiguity.  Rather", "   than attempting to resolve it ourselves.", "", "   Preferring the local region does not suffice: not all code runs in an", "   AWS Region boundary, and customers need to assert intentions to use a", "   region.", ""]}, {"id": "2.4", "title": "Definitions", "lines": ["2.4.   Definitions", ""]}, {"id": "2.4.1", "title": "document", "lines": [[[[601], 224, "The key words \"MUST\", \"MUST NOT\", \"REQUIRED\", \"SHALL\", \"SHALL NOT\", \"SHOULD\", \"SHOULD NOT\", \"RECOMMENDED\", \"MAY\", and \"OPTIONAL\" in this document are to be interpreted as described in RFC 2119 (https://tools.ietf.org/html/rfc2119)."]]], "requirements": [601]}, {"id": "2.5", "title": "Implementation", "lines": [[[[602, 603], 232, "The caller MUST provide:"]], [[[604, 605], 232, "If the list does not contain any multi-Region keys (aws-kms-key- arn.md#identifying-an-aws-kms-multi-region-key) this function MUST exit successfully."]], [[[606, 607], 232, "If there are zero duplicate resource ids between the multi-region keys, this function MUST exit successfully If any duplicate multi-region resource ids exist, this function MUST yield an error that includes all identifiers with duplicate resource ids not only the first duplicate found."]]], "requirements": [603, 605, 607]}, {"id": "3", "title": "References", "lines": ["3.   Normative References", "", "   [RFC2119]  Bradner, S., \"Key words for use in RFCs to Indicate", "              Requirement Levels\", BCP 14, RFC 2119,", "              DOI 10.17487/RFC2119, March 1997,", "              <https://www.rfc-editor.org/info/rfc2119>.", "", "   [RFC8174]  Leiba, B., \"Ambiguity of Uppercase vs Lowercase in RFC", "              2119 Key Words\", BCP 14, RFC 8174, DOI 10.17487/RFC8174,", "              May 2017, <https://www.rfc-editor.org/info/rfc8174>.", "", "Acknowledgments", "", "Author's Address", "", "   Amazon AWS", "   Amazon AWS", "", "   Email: cryptools+rfc@amazon.com"]}]}, "compliance/framework/aws-kms/aws-kms-mrk-keyring.txt": {"requirements": [608, 609, 611, 612, 614, 616, 618, 620, 622, 624, 626, 628, 630, 631, 633, 635, 637, 639, 640, 642, 644, 645, 647, 649, 650, 652, 654, 656, 658], "sections": [{"id": "1", "title": "Definitions", "lines": ["1.   Conventions and Definitions", "", "   The key words \"MUST\", \"MUST NOT\", \"REQUIRED\", \"SHALL\", \"SHALL NOT\",", "   \"SHOULD\", \"SHOULD NOT\", \"RECOMMENDED\", \"NOT RECOMMENDED\", \"MAY\", and", "   \"OPTIONAL\" in this document are to be interpreted as described in BCP", "   14 [RFC2119] [RFC8174] when, and only when, they appear in all", "   capitals, as shown here", ""]}, {"id": "2", "title": "Keyring", "lines": ["2.   AWS KMS MRK Keyring", ""]}, {"id": "2.1", "title": "Version", "lines": ["2.1.   Version", "", "   0.2.2", ""]}, {"id": "2.1.1", "title": "Changelog", "lines": ["2.1.1.   Changelog", "", "   *  0.2.2", "", "      -  Initial record", ""]}, {"id": "2.2", "title": "Implementations", "lines": ["2.2.   Implementations", "", "   | Language | Confirmed Compatible with Spec Version | Minimum Version", "   Confirmed | Implementation | | -------- |", "   -------------------------------------- | ------------------------- |", "   -------------- |", ""]}, {"id": "2.3", "title": "Overview", "lines": ["2.3.   Overview", "", "   A keyring which interacts with AWS Key Management Service (AWS KMS)", "   to create, encrypt, and decrypt data keys using AWS KMS defined", "   Customer Master Keys (CMKs).", ""]}, {"id": "2.4", "title": "Definitions", "lines": ["2.4.   Definitions", ""]}, {"id": "2.4.1", "title": "document", "lines": [[[[608], 224, "The key words \"MUST\", \"MUST NOT\", \"REQUIRED\", \"SHALL\", \"SHALL NOT\", \"SHOULD\", \"SHOULD NOT\", \"RECOMMENDED\", \"MAY\", and \"OPTIONAL\" in this document are to be interpreted as described in RFC 2119 (https://tools.ietf.org/html/rfc2119)."]]], "requirements": [608]}, {"id": "2.5", "title": "Interface", "lines": ["2.5.   Interface", "", "   MUST implement the AWS Encryption SDK Keyring interface (../keyring-", "   interface.md#interface)", ""]}, {"id": "2.6", "title": "Initialization", "lines": [[[[609], 224, "On initialization the caller MUST provide:"]], [[[610, 611], 232, "The AWS KMS key identifier MUST NOT be null or empty."]], [[[612], 224, "The AWS KMS key identifier MUST be a valid identifier (aws-kms-key-arn.md#a- valid-aws-kms-identifier)."]], [[[613, 614], 232, "The AWS KMS SDK client MUST NOT be null."]]], "requirements": [609, 611, 612, 614]}, {"id": "2.7", "title": "OnEncrypt", "lines": [[[[615, 616], 232, "OnEncrypt MUST take encryption materials (../structures.md#encryption-materials) as input."]], [[[617, 618], 232, "If the input encryption materials (../structures.md#encryption- materials) do not contain a plaintext data key OnEncrypt MUST attempt to generate a new plaintext data key by calling AWS KMS GenerateDataKey (https://docs.aws.amazon.com/kms/latest/APIReference/ API_GenerateDataKey.html)."]], [[[619, 620], 232, "If the keyring calls AWS KMS GenerateDataKeys, it MUST use the configured AWS KMS client to make the call."]], [[[621, 622], 232, "The keyring MUST call AWS KMS GenerateDataKeys with a request constructed as follows:"]], [[[623, 624], 240, "If the call to AWS KMS GenerateDataKey (https://docs.aws.amazon.com/kms/latest/APIReference/ API_GenerateDataKey.html) does not succeed, OnEncrypt MUST NOT modify the encryption materials (../structures.md#encryption-materials) and MUST fail."]], [[[625, 626], 232, "If the Generate Data Key call succeeds, OnEncrypt MUST verify that the response \"Plaintext\" length matches the specification of the algorithm suite (../algorithm-suites.md)'s Key Derivation Input Length field."]], [[[627, 628], 240, "The Generate Data Key response's \"KeyId\" MUST be A valid AWS KMS key ARN (aws-kms-key-arn.md#identifying-an-aws-kms- multi-region-key)."]], [[[629, 630], 232, "If verified, OnEncrypt MUST do the following with the response from AWS KMS GenerateDataKey (https://docs.aws.amazon.com/kms/latest/APIReference/ API_GenerateDataKey.html):"]], [[[631], 224, "* \"GrantTokens\": this keyring's grant tokens (https://docs.aws.amazon.com/kms/latest/developerguide/ concepts.html#grant_token) If the call to AWS KMS Encrypt (https://docs.aws.amazon.com/kms/latest/APIReference/ API_Encrypt.html) does not succeed, OnEncrypt MUST fail."]], [[[632, 633], 240, "If the Encrypt call succeeds the response's \"KeyId\" MUST be A valid AWS KMS key ARN (aws-kms-key-arn.md#a-valid-aws-kms-arn)."]], [[[634, 635], 232, "If verified, OnEncrypt MUST do the following with the response from AWS KMS Encrypt (https://docs.aws.amazon.com/kms/latest/APIReference/ API_Encrypt.html): * append a new encrypted data key (../structures.md#encrypted-data- key) to the encrypted data key list in the encryption materials (../structures.md#encryption-materials), constructed as follows: - The ciphertext (../structures.md#ciphertext) is the response \"CiphertextBlob\"."]], [[[636, 637], 232, "If all Encrypt calls succeed, OnEncrypt MUST output the modified encryption materials (../structures.md#encryption-materials)."]]], "requirements": [616, 618, 620, 622, 624, 626, 628, 630, 631, 633, 635, 637]}, {"id": "2.8", "title": "OnDecrypt", "lines": [[[[638, 639], 232, "OnDecrypt MUST take decryption materials (../structures.md#decryption-materials) and a list of encrypted data keys (../structures.md#encrypted-data-key) as input."]], [[[640], 224, "If the decryption materials (../structures.md#decryption-materials) already contained a valid plaintext data key OnDecrypt MUST immediately return the unmodified decryption materials (../structures.md#decryption-materials)."]], [[[641, 642], 240, "The set of encrypted data keys MUST first be filtered to match this keyring's configuration."]], [[[643, 644], 240, "For each encrypted data key in the filtered set, one at a time, the OnDecrypt MUST attempt to decrypt the data key."]], [[[645], 224, "If this attempt results in an error, then these errors MUST be collected."]], [[[646, 647], 232, "To attempt to decrypt a particular encrypted data key (../structures.md#encrypted-data-key), OnDecrypt MUST call AWS KMS Decrypt (https://docs.aws.amazon.com/kms/latest/APIReference/ API_Decrypt.html) with the configured AWS KMS client."]], [[[648, 649], 232, "When calling AWS KMS Decrypt (https://docs.aws.amazon.com/kms/latest/APIReference/ API_Decrypt.html), the keyring MUST call with a request constructed as follows:"]], [[[650], 224, "If the call to AWS KMS Decrypt (https://docs.aws.amazon.com/kms/latest/APIReference/ API_Decrypt.html) succeeds OnDecrypt verifies * The \"KeyId\" field in the response MUST equal the configured AWS KMS key identifier."]], [[[651, 652], 232, "* The length of the response's \"Plaintext\" MUST equal the key derivation input length (../algorithm-suites.md#key-derivation- input-length) specified by the algorithm suite (../algorithm- suites.md) included in the input decryption materials (../structures.md#decryption-materials)."]], [[[653, 654], 240, "If the response does not satisfies these requirements then an error MUST be collected and the next encrypted data key in the filtered set MUST be attempted."]], [[[655, 656], 232, "If the response does satisfies these requirements then OnDecrypt MUST do the following with the response: * set the plaintext data key on the decryption materials (../structures.md#decryption-materials) as the response \"Plaintext\"."]], [[[657, 658], 240, "If OnDecrypt fails to successfully decrypt any encrypted data key (../structures.md#encrypted-data-key), then it MUST yield an error that includes all the collected errors."]]], "requirements": [639, 640, 642, 644, 645, 647, 649, 650, 652, 654, 656, 658]}, {"id": "3", "title": "References", "lines": ["3.   Normative References", "", "   [RFC2119]  Bradner, S., \"Key words for use in RFCs to Indicate", "              Requirement Levels\", BCP 14, RFC 2119,", "              DOI 10.17487/RFC2119, March 1997,", "              <https://www.rfc-editor.org/info/rfc2119>.", "", "   [RFC8174]  Leiba, B., \"Ambiguity of Uppercase vs Lowercase in RFC", "              2119 Key Words\", BCP 14, RFC 8174, DOI 10.17487/RFC8174,", "              May 2017, <https://www.rfc-editor.org/info/rfc8174>.", "", "Acknowledgments", "", "Author's Address", "", "   Amazon AWS", "   Amazon AWS", "", "   Email: cryptools+rfc@amazon.com"]}]}, "compliance/framework/aws-kms/aws-kms-mrk-multi-keyrings.txt": {"requirements": [659, 660, 662, 664, 666, 667, 668, 670, 671, 673, 675, 677, 679, 681, 683, 685, 686], "sections": [{"id": "1", "title": "Definitions", "lines": ["1.   Conventions and Definitions", "", "   The key words \"MUST\", \"MUST NOT\", \"REQUIRED\", \"SHALL\", \"SHALL NOT\",", "   \"SHOULD\", \"SHOULD NOT\", \"RECOMMENDED\", \"NOT RECOMMENDED\", \"MAY\", and", "   \"OPTIONAL\" in this document are to be interpreted as described in BCP", "   14 [RFC2119] [RFC8174] when, and only when, they appear in all", "   capitals, as shown here", ""]}, {"id": "2", "title": "Keyrings", "lines": ["2.   AWS KMS MRK Multi Keyrings", ""]}, {"id": "2.1", "title": "Version", "lines": ["2.1.   Version", "", "   0.2.2", ""]}, {"id": "2.1.1", "title": "Changelog", "lines": ["2.1.1.   Changelog", "", "   *  0.2.2", "", "      -  Initial record", ""]}, {"id": "2.2", "title": "Implementations", "lines": ["2.2.   Implementations", "", "   | Language | Confirmed Compatible with Spec Version | Minimum Version", "   Confirmed | Implementation | | -------- |", "   -------------------------------------- | ------------------------- |", "   -------------- |", ""]}, {"id": "2.3", "title": "Overview", "lines": ["2.3.   Overview", "", "   The AWS KMS MRK keyrings only operate on a single AWS KMS key ARN.", "   However customers want to easily configure multiple AWS KMS key ARNs.", "   These functions compose multiple AWS KMS key ARNs and return a single", "   Multi Keyring.", ""]}, {"id": "2.4", "title": "Definitions", "lines": ["2.4.   Definitions", ""]}, {"id": "2.4.1", "title": "document", "lines": [[[[659], 224, "The key words \"MUST\", \"MUST NOT\", \"REQUIRED\", \"SHALL\", \"SHALL NOT\", \"SHOULD\", \"SHOULD NOT\", \"RECOMMENDED\", \"MAY\", and \"OPTIONAL\" in this document are to be interpreted as described in RFC 2119 (https://tools.ietf.org/html/rfc2119)."]]], "requirements": [659]}, {"id": "2.5", "title": "Multi-Keyring", "lines": [[[[660], 224, "The caller MUST provide:"]], [[[661, 662], 232, "If any of the AWS KMS key identifiers is not a valid AWS KMS key ARN (aws-kms-key-arn.md#a-valid-aws-kms-arn), this function MUST fail All AWS KMS identifiers are passed to Assert AWS KMS MRK are unique (aws- kms-mrk-are-unique.md#Implementation) and the function MUST return success otherwise this MUST fail."]], [[[663, 664], 240, "If a regional client supplier is not passed, then a default MUST be created that takes a region string and generates a default AWS SDK client for the given region."]], [[[665, 666], 232, "If there is a generator input then the generator keyring MUST be a AWS KMS MRK Keyring (aws-kms-mrk-keyring.md) initialized with"]], [[[667], 224, "* The AWS KMS client that MUST be created by the regional client supplier when called with the region part of the AWS KMS key identifier or a signal for the AWS SDK to select the default region."]], [[[668], 160, "* The input list of AWS KMS grant tokens NOTE: The AWS Encryption SDK SHOULD NOT attempt to evaluate its own default region."]], [[[669, 670], 232, "Then a Multi-Keyring (../multi-keyring.md#inputs) MUST be initialize by using this generator keyring as the generator keyring (../multi- keyring.md#generator-keyring) and this set of child keyrings as the child keyrings (../multi-keyring.md#child-keyrings)."]], [[[671], 224, "This Multi- Keyring MUST be this functions output."]]], "requirements": [660, 662, 664, 666, 667, 668, 670, 671]}, {"id": "2.6", "title": "Multi-Keyring", "lines": [[[[672, 673], 232, "The caller MUST provide:"]], [[[674, 675], 232, "If an empty set of Region is provided this function MUST fail."]], [[[676, 677], 232, "If any element of the set of regions is null or an empty string this function MUST fail."]], [[[678, 679], 240, "If a regional client supplier is not passed, then a default MUST be created that takes a region string and generates a default AWS SDK client for the given region."]], [[[680, 681], 240, "A set of AWS KMS clients MUST be created by calling regional client supplier for each region in the input set of regions."]], [[[682, 683], 232, "Then a set of AWS KMS MRK Discovery Keyring (aws-kms-mrk-discovery- keyring.md) MUST be created for each AWS KMS client by initializing each keyring with"]], [[[684, 685], 232, "Then a Multi-Keyring (../multi-keyring.md#inputs) MUST be initialize by using this set of discovery keyrings as the child keyrings (../multi-keyring.md#child-keyrings)."]], [[[686], 224, "This Multi-Keyring MUST be this functions output."]]], "requirements": [673, 675, 677, 679, 681, 683, 685, 686]}, {"id": "3", "title": "References", "lines": ["3.   Normative References", "", "   [RFC2119]  Bradner, S., \"Key words for use in RFCs to Indicate", "              Requirement Levels\", BCP 14, RFC 2119,", "              DOI 10.17487/RFC2119, March 1997,", "              <https://www.rfc-editor.org/info/rfc2119>.", "", "   [RFC8174]  Leiba, B., \"Ambiguity of Uppercase vs Lowercase in RFC", "              2119 Key Words\", BCP 14, RFC 8174, DOI 10.17487/RFC8174,", "              May 2017, <https://www.rfc-editor.org/info/rfc8174>.", "", "Acknowledgments", "", "Author's Address", "", "   Amazon AWS", "   Amazon AWS", "", "   Email: cryptools+rfc@amazon.com"]}]}, "compliance/client-apis/streaming.txt": {"requirements": [687, 688, 689, 690, 691, 692, 693, 694, 695], "sections": [{"id": "1", "title": "Definitions", "lines": ["1.   Conventions and Definitions", "", "   The key words \"MUST\", \"MUST NOT\", \"REQUIRED\", \"SHALL\", \"SHALL NOT\",", "   \"SHOULD\", \"SHOULD NOT\", \"RECOMMENDED\", \"NOT RECOMMENDED\", \"MAY\", and", "   \"OPTIONAL\" in this document are to be interpreted as described in BCP", "   14 [RFC2119] [RFC8174] when, and only when, they appear in all", "   capitals, as shown here", ""]}, {"id": "2", "title": "Streaming", "lines": ["2.   Streaming", ""]}, {"id": "2.1", "title": "Version", "lines": ["2.1.   Version", "", "   0.1.0", ""]}, {"id": "2.1.1", "title": "Changelog", "lines": ["2.1.1.   Changelog", "", "   *  0.1.0", "", "      -  Clarify Streaming Encrypt and Decrypt (../changes/2020-07-", "         06_clarify-streaming-encrypt-decrypt/change.md)", ""]}, {"id": "2.2", "title": "Overview", "lines": [[[[687], 96, "The AWS Encryption SDK MAY provide APIs that enable streamed encryption (encrypt.md) and decryption (decrypt.md)."]], [[[688], 160, "If an implementation requires holding the entire input in memory in order to perform the operation, that implementation SHOULD NOT provide an API that allows the caller to stream the operation."]], [[[689], 160, "APIs that support streaming of the encrypt or decrypt operation SHOULD allow customers to be able to process arbitrarily large inputs with a finite amount of working memory."]]], "requirements": [687, 688, 689]}, {"id": "2.3", "title": "Definitions", "lines": ["2.3.   Definitions", ""]}, {"id": "2.3.1", "title": "document", "lines": [[[[690], 224, "The key words \"MUST\", \"MUST NOT\", \"REQUIRED\", \"SHALL\", \"SHALL NOT\", \"SHOULD\", \"SHOULD NOT\", \"RECOMMENDED\", \"MAY\", and \"OPTIONAL\" in this document are to be interpreted as described in RFC2119 (https://tools.ietf.org/html/rfc2119)."]]], "requirements": [690]}, {"id": "2.3.2", "title": "Bytes", "lines": ["2.3.2.   Consumable Bytes", "", "   In the scope of an operation, bytes are considered consumable if:", "", "   *  The operation has not yet processed those bytes.", "", "   *  The operation has access to those bytes.", "", "   *  Those bytes are intended to be processed.  This intention is", "      expressed through the specific streaming interface.", "", "   For example, in a framework where a customer is sending input bytes", "   to an operation and that operation must write the output bytes to", "   some sink, the input bytes received from the customer are considered", "   consumable.  Here the customer is expressing intent to process their", "   supplied bytes.", "", "   For a framework where a customer is requesting output bytes from an", "   operation and that operation must read from some source in order to", "   produce bytes, this is slightly more complicated.  Bytes are", "   considered consumable if:", "", "   *  Those bytes have not yet been processed.", "", "   *  Those bytes are able to be read by the operation from the source.", "", "   *  Those bytes are required to be processed in order for the", "      operation to release the output requested by the customer.  Here", "      the customer expresses intent for the operation to process", "      whatever the operation needs to consume to produce its complete", "      output", ""]}, {"id": "2.3.3", "title": "Release", "lines": [[[[691], 224, "The decrypt and encrypt operations specify when output bytes MUST NOT be released and when they SHOULD be released."]]], "requirements": [691]}, {"id": "2.4", "title": "Inputs", "lines": [[[[692], 224, "In order to support streaming, the operation MUST accept some input within a streaming framework."]]], "requirements": [692]}, {"id": "2.5", "title": "Outputs", "lines": [[[[693], 224, "In order to support streaming, the operation MUST produce some output within a streaming framework."]], [[[694], 224, "Operations MUST NOT indicate completion or success until an end to the output has been indicated."]]], "requirements": [693, 694]}, {"id": "2.6", "title": "Behavior", "lines": [[[[695], 224, "The behavior of the operation specifies how the operation processes consumable bytes, and specifies when processed bytes MUST NOT and SHOULD be released."]]], "requirements": [695]}, {"id": "3", "title": "References", "lines": ["3.   Normative References", "", "   [RFC2119]  Bradner, S., \"Key words for use in RFCs to Indicate", "              Requirement Levels\", BCP 14, RFC 2119,", "              DOI 10.17487/RFC2119, March 1997,", "              <https://www.rfc-editor.org/info/rfc2119>.", "", "   [RFC8174]  Leiba, B., \"Ambiguity of Uppercase vs Lowercase in RFC", "              2119 Key Words\", BCP 14, RFC 8174, DOI 10.17487/RFC8174,", "              May 2017, <https://www.rfc-editor.org/info/rfc8174>.", "", "Acknowledgments", "", "Author's Address", "", "   Amazon AWS", "   Amazon AWS", "", "   Email: cryptools+rfc@amazon.com"]}]}, "compliance/client-apis/encrypt.txt": {"requirements": [697, 699, 701, 703, 705, 707, 709, 711, 712, 715, 717, 719, 721, 724, 726, 728, 730, 732, 734, 736, 738, 739, 741, 743, 745, 747, 749, 751, 752, 754, 756, 758, 760, 762, 764, 766, 768, 770, 772, 774, 775, 777, 779, 780, 782, 784, 786, 788, 790, 791, 793, 795, 797, 799, 801, 803, 805, 807, 809, 811, 813, 815, 817, 819], "sections": [{"id": "1", "title": "Definitions", "lines": ["1.   Conventions and Definitions", "", "   The key words \"MUST\", \"MUST NOT\", \"REQUIRED\", \"SHALL\", \"SHALL NOT\",", "   \"SHOULD\", \"SHOULD NOT\", \"RECOMMENDED\", \"NOT RECOMMENDED\", \"MAY\", and", "   \"OPTIONAL\" in this document are to be interpreted as described in BCP", "   14 [RFC2119] [RFC8174] when, and only when, they appear in all", "   capitals, as shown here", ""]}, {"id": "2", "title": "Encrypt", "lines": ["2.   Encrypt", ""]}, {"id": "2.1", "title": "Version", "lines": ["2.1.   Version", "", "   0.4.0", ""]}, {"id": "2.1.1", "title": "Changelog", "lines": ["2.1.1.   Changelog", "", "   *  0.3.0", "", "      -  Clarify Streaming Encrypt and Decrypt (../changes/2020-07-", "         06_clarify-streaming-encrypt-decrypt/change.md)", "", "   *  0.2.0", "", "      -  Remove Keyring Trace (../changes/2020-05-13_remove-keyring-", "         trace/change.md)", "", "   *  0.1.0-preview", "", "      -  Initial record", ""]}, {"id": "2.2", "title": "Implementations", "lines": ["2.2.   Implementations", "", "   +========+=============+=========+====================================================================+", "   |Language|Confirmed    |Minimum  |Implementation                                                      |", "   |        |Compatible   |Version  |                                                                    |", "   |        |with Spec    |Confirmed|                                                                    |", "   |        |Version      |         |                                                                    |", "   +========+=============+=========+====================================================================+", "   |C       |0.1.0-preview|0.1.0    |session_encrypt.c (https://github.com/aws/aws-encryption-sdk-       |", "   |        |             |         |c/blob/master/source/session_encrypt.c)                             |", "   +--------+-------------+---------+--------------------------------------------------------------------+", "   |NodeJS  |0.1.0-preview|0.1.0    |encrypt.ts (https://github.com/awslabs/aws-encryption-sdk-          |", "   |        |             |         |javascript/blob/master/modules/encrypt-node/src/encrypt.ts)         |", "   +--------+-------------+---------+--------------------------------------------------------------------+", "   |Browser |0.1.0-preview|0.1.0    |encrypt.ts (https://github.com/awslabs/aws-encryption-sdk-          |", "   |JS      |             |         |javascript/blob/master/modules/encrypt-browser/src/encrypt.ts)      |", "   +--------+-------------+---------+--------------------------------------------------------------------+", "   |Python  |0.1.0-preview|1.2.0    |streaming_client.py (https://github.com/aws/aws-encryption-sdk-     |", "   |        |             |         |python/blob/master/src/aws_encryption_sdk/streaming_client.py)      |", "   +--------+-------------+---------+--------------------------------------------------------------------+", "   |Java    |0.1.0-preview|0.0.1    |EncryptionHandler.java (https://github.com/aws/aws-encryption-sdk-  |", "   |        |             |         |java/blob/master/src/main/java/com/amazonaws/encryptionsdk/internal/|", "   |        |             |         |EncryptionHandler.java)                                             |", "   +--------+-------------+---------+--------------------------------------------------------------------+", "", "                                  Table 1", ""]}, {"id": "2.3", "title": "Overview", "lines": [[[[696, 697], 226, "Any client provided by the AWS Encryption SDK that performs encryption of caller plaintext MUST follow this specification for encryption."]]], "requirements": [697]}, {"id": "2.4", "title": "Input", "lines": [[[[698, 699], 240, "The following inputs to this behavior MUST be OPTIONAL:"]], [[[700, 701], 98, "If the plaintext (Section 2.4.1) is of unknown length, the caller MAY also input a Plaintext Length Bound (Section 2.4.7)."]], [[[702, 703], 162, "Implementations SHOULD ensure that a caller is not able to specify both a plaintext (Section 2.4.1) with known length and a Plaintext Length Bound (Section 2.4.7) by construction."]], [[[704, 705], 226, "If a caller is able to specify both an input plaintext (Section 2.4.1) with known length and a Plaintext Length Bound (Section 2.4.7), the Plaintext Length Bound (Section 2.4.7) MUST NOT be used during the Encrypt operation and MUST be ignored."]]], "requirements": [699, 701, 703, 705]}, {"id": "2.4.1", "title": "Plaintext", "lines": [[[[706, 707], 232, "This MUST be a sequence of bytes."]], [[[708, 709], 98, "This input MAY be streamed (streaming.md) to this operation."]], [[[710, 711], 168, "If an implementation requires holding the input entire plaintext in memory in order to perform this operation, that implementation SHOULD NOT provide an API that allows this input to be streamed."]]], "requirements": [707, 709, 711]}, {"id": "2.4.2", "title": "Context", "lines": [[[[712], 224, "If the input encryption context contains any entries with a key beginning with this prefix, the encryption operation MUST fail."]]], "requirements": [712]}, {"id": "2.4.3", "title": "CMM", "lines": ["2.4.3.   CMM", "", "   A CMM that implements the CMM interface (../framework/cmm-", "   interface.md).", ""]}, {"id": "2.4.4", "title": "Keyring", "lines": ["2.4.4.   Keyring", "", "   A Keyring that implements the keyring interface (../framework/", "   keyring-interface.md).", ""]}, {"id": "2.4.5", "title": "Suite", "lines": [[[[713, 714, 715], 180, "The algorithm suite (../framework/algorithm-suite.md) that SHOULD be used for encryption."]]], "requirements": [715]}, {"id": "2.4.6", "title": "Length", "lines": [[[[716, 717], 232, "This value MUST be greater than 0 and MUST NOT exceed the value 2^32 - 1."]], [[[718, 719], 232, "This value MUST default to 4096 bytes."]]], "requirements": [717, 719]}, {"id": "2.4.7", "title": "Bound", "lines": [[[[720, 721], 226, "If this input is provided, this operation MUST NOT encrypt a plaintext with length greater than this value."]]], "requirements": [721]}, {"id": "2.5", "title": "Output", "lines": [[[[722, 723, 724], 244, "This behavior MUST output the following if the behavior is successful:"]], [[[725, 726], 162, "The client SHOULD return as an output:"]]], "requirements": [724, 726]}, {"id": "2.5.1", "title": "Message", "lines": [[[[727, 728], 240, "This MUST be a sequence of bytes and conform to the message format specification (../data-format/message.md)."]], [[[729, 730], 98, "This operation MAY stream (streaming.md) the encrypted message."]], [[[731, 732], 168, "If an implementation requires holding the entire input plaintext in memory in order to perform this operation, that implementation SHOULD NOT provide an API that allows this output to be streamed."]]], "requirements": [728, 730, 732]}, {"id": "2.5.2", "title": "Context", "lines": [[[[733, 734], 98, "This output MAY be satisfied by outputting a parsed header (Section 2.5.4) containing this value."]]], "requirements": [734]}, {"id": "2.5.3", "title": "Suite", "lines": [[[[735, 736], 98, "This output MAY be satisfied by outputting a parsed header (Section 2.5.4) containing this value."]]], "requirements": [736]}, {"id": "2.5.4", "title": "Header", "lines": ["2.5.4.   Parsed Header", "", "   A collection of deserialized fields of the encrypted message's", "   (Section 2.5.1) header.", ""]}, {"id": "2.6", "title": "Behavior", "lines": [[[[737, 738], 226, "This operation MUST perform all the above steps unless otherwise specified, and it MUST perform them in the above order."]], [[[739], 224, "Any data that is not specified within the message format (../data-format/message.md) MUST NOT be added to the output message."]], [[[740, 741], 226, "If any of these steps fails, this operation MUST halt and indicate a failure to the caller."]]], "requirements": [738, 739, 741]}, {"id": "2.6.1", "title": "materials", "lines": [[[[742, 743], 232, "If an input algorithm suite (Section 2.4.5) is provided that is not supported by the commitment policy (client.md#commitment-policy) configured in the client (client.md) encrypt MUST yield an error."]], [[[744, 745], 226, "To construct the encrypted message (Section 2.5.1), some fields MUST be constructed using information obtained from a set of valid encryption materials (../framework/structures.md#encryption- materials)."]], [[[746, 747], 240, "This operation MUST obtain this set of encryption materials (../framework/structures.md#encryption-materials) by calling Get Encryption Materials (../framework/cmm-interface.md#get- encryption-materials) on a CMM (../framework/cmm-interface.md)."]], [[[748, 749], 232, "The CMM used MUST be the input CMM, if supplied."]], [[[750, 751], 240, "If instead the caller supplied a keyring (../framework/keyring-interface.md), this behavior MUST use a default CMM (../framework/default-cmm.md) constructed using the caller-supplied keyring as input."]], [[[752], 224, "The call to Get Encryption Materials (../framework/cmm-interface.md#get-encryption- materials) on that CMM MUST be constructed as follows:"]], [[[753, 754], 240, "The algorithm suite (../framework/algorithm-suites.md) used in all aspects of this operation MUST be the algorithm suite in the encryption materials (../framework/structures.md#encryption- materials) returned from the Get Encryption Materials (../framework/ cmm-interface.md#get-encryption-materials) call."]], [[[755, 756], 98, "Note that the algorithm suite in the retrieved encryption materials MAY be different from the input algorithm suite (Section 2.4.5)."]], [[[757, 758], 240, "If this algorithm suite (../framework/algorithm-suites.md) is not supported by the commitment policy (client.md#commitment-policy) configured in the client (client.md) encrypt MUST yield an error."]], [[[759, 760], 232, "If the number of encrypted data keys (../framework/structures.md#encrypted-data-keys) on the encryption materials (../framework/structures.md#encryption- materials) is greater than the maximum number of encrypted data keys (client.md#maximum-number-of-encrypted-data-keys) configured in the client (client.md) encrypt MUST yield an error."]], [[[761, 762], 240, "The algorithm used to derive a data key from the plaintext data key MUST be the key derivation algorithm (../framework/algorithm-suites.md#key-derivation-algorithm) included in the algorithm suite (../framework/algorithm-suites.md) defined above."]]], "requirements": [743, 745, 747, 749, 751, 752, 754, 756, 758, 760, 762]}, {"id": "2.6.2", "title": "header", "lines": [[[[763, 764], 240, "Before encrypting input plaintext, this operation MUST serialize the message header body (../data-format/message-header.md)."]], [[[765, 766], 232, "The message format version (../data-format/message-header.md#supported-versions) MUST be associated with the algorithm suite (../framework/algorithm- suites.md#supported-algorithm-suites)."]], [[[767, 768], 240, "If the message format version associated with the algorithm suite (../framework/algorithm-suites.md#supported-algorithm-suites) is 2.0 then the message header body (../data-format/message- header.md#header-body-version-1-0) MUST be serialized with the following specifics:"]], [[[769, 770], 240, "If the message format version associated with the algorithm suite (../framework/algorithm-suites.md#supported-algorithm-suites) is 1.0 then the message header body (../data-format/message- header.md#header-body-version-1-0) MUST be serialized with the following specifics:"]], [[[771, 772], 240, "After serializing the message header body, this operation MUST calculate an authentication tag (../data-format/message- header.md#authentication-tag) over the message header body."]], [[[773, 774], 240, "The value of this MUST be the output of the authenticated encryption algorithm (../framework/algorithm-suites.md#encryption-algorithm) specified by the algorithm suite (../framework/algorithm-suites.md), with the following inputs: * The AAD is the serialized message header body (../data-format/ message-header.md#header-body)."]], [[[775], 224, "* The cipherkey is the derived data key * The plaintext is an empty byte array With the authentication tag calculated, if the message format version associated with the algorithm suite (../framework/algorithm- suites.md#supported-algorithm-suites) is 2.0, this operation MUST serialize the message header authentication (../data-format/message- header.md#header-authentication-version-2-0) with the following specifics: * Authentication Tag (../data-format/message- header.md#authentication-tag): MUST have the value of the authentication tag calculated above."]], [[[776, 777], 240, "If the message format version associated with the algorithm suite (../framework/algorithm-suites.md#supported-algorithm-suites) is 1.0 this operation MUST serialize the message header authentication (../data-format/message-header.md#header-authentication-version-1-0) with the following specifics: * IV (../data-format/message-header.md#iv): MUST have the value of the IV used in the calculation above, padded to the IV length (../data-format/message-header.md#iv-length) with 0."]], [[[778, 779], 240, "* Authentication Tag (../data-format/message- header.md#authentication-tag): MUST have the value of the authentication tag calculated above."]], [[[780], 224, "The serialized bytes MUST NOT be released until the entire message header has been serialized If this operation is streaming the encrypted message and the entire message header has been serialized, the serialized message header SHOULD be released."]], [[[781, 782], 240, "The encrypted message output by this operation MUST have a message header equal to the message header calculated in this step."]], [[[783, 784], 226, "If the algorithm suite contains a signature algorithm and this operation is streaming (streaming.md) the encrypted message output to the caller, this operation MUST input the serialized header to the signature algorithm as soon as it is serialized, such that the serialized header isn't required to remain in memory to construct the signature (Section 2.7.2)."]]], "requirements": [764, 766, 768, 770, 772, 774, 775, 777, 779, 780, 782, 784]}, {"id": "2.7", "title": "body", "lines": [[[[785, 786], 226, "The encrypted message output by this operation MUST have a message body equal to the message body calculated in this step."]], [[[787, 788], 226, "If Plaintext Length Bound (Section 2.4.7) was specified on input and this operation determines at any time that the plaintext being encrypted has a length greater than this value, this operation MUST immediately fail."]], [[[789, 790], 240, "Before the end of the input is indicated, this operation MUST process as much of the consumable bytes as possible by constructing regular frames (Section 2.7.1)."]], [[[791], 224, "When the end of the input is indicated, this operation MUST perform the following until all consumable plaintext bytes are processed:"]], [[[792, 793], 240, "If an end to the input has been indicated, there are no more consumable plaintext bytes to process, and a final frame has not yet been constructed, this operation MUST construct an empty final frame (Section 2.7.1)."]]], "requirements": [786, 788, 790, 791, 793]}, {"id": "2.7.1", "title": "frame", "lines": [[[[794, 795], 240, "To construct a regular or final frame that represents the next frame in the encrypted message's body, this operation MUST calculate the encrypted content and an authentication tag using the authenticated encryption algorithm (../framework/algorithm-suites.md#encryption- algorithm) specified by the algorithm suite (../framework/algorithm- suites.md), with the following inputs:"]], [[[796, 797], 240, "This operation MUST serialize a regular frame or final frame with the following specifics:"]], [[[798, 799], 226, "The above serialized bytes MUST NOT be released until the entire frame has been serialized."]], [[[800, 801], 162, "If this operation is streaming the encrypted message and the entire frame has been serialized, the serialized frame SHOULD be released."]], [[[802, 803], 226, "If the algorithm suite contains a signature algorithm and this operation is streaming (streaming.md) the encrypted message output to the caller, this operation MUST input the serialized frame to the signature algorithm as soon as it is serialized, such that the serialized frame isn't required to remain in memory to construct the signature (Section 2.7.2)."]]], "requirements": [795, 797, 799, 801, 803]}, {"id": "2.7.2", "title": "signature", "lines": [[[[804, 805], 240, "If the algorithm suite (../framework/algorithm-suites.md) contains a signature algorithm (../framework/algorithm-suites.md#signature- algorithm), this operation MUST calculate a signature over the message, and the output encrypted message (Section 2.5.1) MUST contain a message footer (../data-format/message-footer.md)."]], [[[806, 807], 240, "To calculate a signature, this operation MUST use the signature algorithm (../framework/algorithm-suites.md#signature-algorithm) specified by the algorithm suite (../framework/algorithm-suites.md), with the following input:"]], [[[808, 809], 98, "Note that the message header and message body MAY have already been input during previous steps."]], [[[810, 811], 240, "This operation MUST then serialize a message footer with the following specifics:"]], [[[812, 813], 226, "The above serialized bytes MUST NOT be released until the entire message footer has been serialized."]], [[[814, 815], 226, "Once the entire message footer has been serialized, this operation MUST release any previously unreleased serialized bytes from previous steps and MUST release the message footer."]], [[[816, 817], 240, "The encrypted message output by this operation MUST have a message footer equal to the message footer calculated in this step."]]], "requirements": [805, 807, 809, 811, 813, 815, 817]}, {"id": "2.8", "title": "Appendix", "lines": ["2.8.   Appendix", ""]}, {"id": "2.8.1", "title": "Encryption", "lines": [[[[818, 819], 240, "Implementations of the AWS Encryption SDK MUST NOT encrypt using the Non-Framed content type."]]], "requirements": [819]}, {"id": "3", "title": "References", "lines": ["3.   Normative References", "", "   [RFC2119]  Bradner, S., \"Key words for use in RFCs to Indicate", "              Requirement Levels\", BCP 14, RFC 2119,", "              DOI 10.17487/RFC2119, March 1997,", "              <https://www.rfc-editor.org/info/rfc2119>.", "", "   [RFC8174]  Leiba, B., \"Ambiguity of Uppercase vs Lowercase in RFC", "              2119 Key Words\", BCP 14, RFC 8174, DOI 10.17487/RFC8174,", "              May 2017, <https://www.rfc-editor.org/info/rfc8174>.", "", "Acknowledgments", "", "Author's Address", "", "   Amazon AWS", "   Amazon AWS", "", "   Email: cryptools+rfc@amazon.com"]}]}, "compliance/client-apis/client.txt": {"requirements": [821, 823, 825, 827, 829, 831, 833, 835], "sections": [{"id": "1", "title": "Definitions", "lines": ["1.   Conventions and Definitions", "", "   The key words \"MUST\", \"MUST NOT\", \"REQUIRED\", \"SHALL\", \"SHALL NOT\",", "   \"SHOULD\", \"SHOULD NOT\", \"RECOMMENDED\", \"NOT RECOMMENDED\", \"MAY\", and", "   \"OPTIONAL\" in this document are to be interpreted as described in BCP", "   14 [RFC2119] [RFC8174] when, and only when, they appear in all", "   capitals, as shown here", ""]}, {"id": "2", "title": "Client", "lines": ["2.   Client", ""]}, {"id": "2.1", "title": "Version", "lines": ["2.1.   Version", "", "   0.1.0", ""]}, {"id": "2.2", "title": "Implementations", "lines": ["2.2.   Implementations", "", "   +========+==========+=========+===========================================================+", "   |Language|Confirmed |Minimum  |Implementation                                             |", "   |        |Compatible|Version  |                                                           |", "   |        |with Spec |Confirmed|                                                           |", "   |        |Version   |         |                                                           |", "   +========+==========+=========+===========================================================+", "   |C       |0.1.0     |0.1.0    |session.c (https://github.com/aws/aws-encryption-sdk-      |", "   |        |          |         |c/blob/master/source/session.c)                            |", "   +--------+----------+---------+-----------------------------------------------------------+", "   |NodeJS  |0.1.0     |0.1.0    |index.ts (https://github.com/aws/aws-encryption-sdk-       |", "   |        |          |         |javascript/blob/master/modules/client-node/src/index.ts)   |", "   +--------+----------+---------+-----------------------------------------------------------+", "   |Browser |0.1.0     |0.1.0    |index.ts (https://github.com/aws/aws-encryption-sdk-       |", "   |JS      |          |         |javascript/blob/master/modules/client-browser/src/index.ts)|", "   +--------+----------+---------+-----------------------------------------------------------+", "   |Python  |0.1.0     |0.1.0    |__init__.py (https://github.com/aws/aws-encryption-sdk-    |", "   |        |          |         |python/blob/master/src/aws_encryption_sdk/__init__.py)     |", "   +--------+----------+---------+-----------------------------------------------------------+", "   |Java    |0.1.0     |0.1.0    |AwsCrypto.java (https://github.com/aws/aws-encryption-sdk- |", "   |        |          |         |java/blob/master/src/main/java/com/amazonaws/encryptionsdk/|", "   |        |          |         |AwsCrypto.java)                                            |", "   +--------+----------+---------+-----------------------------------------------------------+", "", "                                  Table 1", ""]}, {"id": "2.3", "title": "Overview", "lines": ["2.3.   Overview", "", "   This document describes the client experience for the AWS Encryption", "   SDK.", "", "   The top level client supports configuration settings that need to be", "   coordinated between encrypt and decrypt.  Coordinating static", "   settings between encrypt and decrypt across hosts is complicated.  It", "   is important that all messages that could be sent to a host can be", "   decrypted by that host.  A top level client makes such settings hard", "   to misuse (https://github.com/awslabs/aws-encryption-sdk-", "   specification/blob/master/tenets.md#hard-to-misuse) because anything", "   a client encrypts can be decrypted by the same client.", ""]}, {"id": "2.4", "title": "Initialization", "lines": [[[[820, 821], 232, "On client initialization, the caller MUST have the option to provide a:"]], [[[822, 823], 232, "If no commitment policy (Section 2.4.1) is provided the default MUST be REQUIRE_ENCRYPT_REQUIRE_DECRYPT (../framework/algorithm- suites.md#require_encrypt_require_decrypt)."]], [[[824, 825], 240, "If no maximum number of encrypted data keys (Section 2.4.2) is provided the default MUST result in no limit on the number of encrypted data keys (aside from the limit imposed by the message format (../format/message- header.md))."]], [[[826, 827], 168, "Once a commitment policy (Section 2.4.1) has been set it SHOULD be immutable."]]], "requirements": [821, 823, 825, 827]}, {"id": "2.4.1", "title": "Policy", "lines": [[[[828, 829], 232, "The AWS Encryption SDK MUST provide the following commitment policies:"]]], "requirements": [829]}, {"id": "2.4.2", "title": "Keys", "lines": [[[[830, 831], 232, "Callers MUST have a way to disable this limit."]]], "requirements": [831]}, {"id": "2.4.2.1", "title": "FORBID_ENCRYPT_ALLOW_DECRYPT", "lines": ["2.4.2.1.   FORBID_ENCRYPT_ALLOW_DECRYPT", "", "   When the commitment policy \"FORBID_ENCRYPT_ALLOW_DECRYPT\" is", "   configured:", "", "   *  \"03 78\" MUST be the default algorithm suite", "", "   *  encrypt (encrypt.md) MUST only support algorithm suites that have", "      a Key Commitment (../framework/algorithm-suites.md#algorithm-", "      suites-encryption-key-derivation-settings) value of False", "", "   *  decrypt (decrypt.md) MUST support all algorithm suites", ""]}, {"id": "2.4.2.2", "title": "REQUIRE_ENCRYPT_ALLOW_DECRYPT", "lines": ["2.4.2.2.   REQUIRE_ENCRYPT_ALLOW_DECRYPT", "", "   When the commitment policy \"REQUIRE_ENCRYPT_ALLOW_DECRYPT\" is", "   configured:", "", "   *  \"05 78\" MUST be the default algorithm suite", "", "   *  encrypt (encrypt.md) MUST only support algorithm suites that have", "      a Key Commitment (../framework/algorithm-suites.md#algorithm-", "      suites-encryption-key-derivation-settings) value of True", "", "   *  decrypt (decrypt.md) MUST support all algorithm suites", ""]}, {"id": "2.4.2.3", "title": "REQUIRE_ENCRYPT_REQUIRE_DECRYPT", "lines": ["2.4.2.3.   REQUIRE_ENCRYPT_REQUIRE_DECRYPT", "", "   When the commitment policy \"REQUIRE_ENCRYPT_REQUIRE_DECRYPT\" is", "   configured:", "", "   *  \"05 78\" MUST be the default algorithm suite", "", "   *  encrypt (encrypt.md) MUST only support algorithm suites that have", "      a Key Commitment (../framework/algorithm-suites.md#algorithm-", "      suites-encryption-key-derivation-settings) value of True", "", "   *  decrypt (decrypt.md) MUST only support algorithm suites that have", "      a Key Commitment (../framework/algorithm-suites.md#algorithm-", "      suites-encryption-key-derivation-settings) value of True", ""]}, {"id": "2.5", "title": "Operation", "lines": ["2.5.   Operation", ""]}, {"id": "2.5.1", "title": "Encrypt", "lines": [[[[832, 833], 226, "The AWS Encryption SDK Client MUST provide an encrypt (./encrypt.md#input) function that adheres to encrypt (./encrypt.md)."]]], "requirements": [833]}, {"id": "2.5.2", "title": "Decrypt", "lines": [[[[834, 835], 226, "The AWS Encryption SDK Client MUST provide an decrypt (./decrypt.md#input) function that adheres to decrypt (./decrypt.md)."]]], "requirements": [835]}, {"id": "3", "title": "References", "lines": ["3.   Normative References", "", "   [RFC2119]  Bradner, S., \"Key words for use in RFCs to Indicate", "              Requirement Levels\", BCP 14, RFC 2119,", "              DOI 10.17487/RFC2119, March 1997,", "              <https://www.rfc-editor.org/info/rfc2119>.", "", "   [RFC8174]  Leiba, B., \"Ambiguity of Uppercase vs Lowercase in RFC", "              2119 Key Words\", BCP 14, RFC 8174, DOI 10.17487/RFC8174,", "              May 2017, <https://www.rfc-editor.org/info/rfc8174>.", "", "Acknowledgments", "", "Author's Address", "", "   Amazon AWS", "   Amazon AWS", "", "   Email: cryptools+rfc@amazon.com"]}]}, "compliance/client-apis/decrypt.txt": {"requirements": [837, 838, 840, 842, 844, 846, 848, 850, 852, 854, 856, 859, 861, 863, 865, 867, 869, 872, 874, 876, 878, 880, 882, 884, 886, 888, 890, 892, 893, 896, 898, 900, 903, 905, 907, 909, 911, 913, 915, 917, 919, 922, 925, 929, 931, 933, 935, 937, 939, 941, 943, 945, 947, 949], "sections": [{"id": "1", "title": "Definitions", "lines": ["1.   Conventions and Definitions", "", "   The key words \"MUST\", \"MUST NOT\", \"REQUIRED\", \"SHALL\", \"SHALL NOT\",", "   \"SHOULD\", \"SHOULD NOT\", \"RECOMMENDED\", \"NOT RECOMMENDED\", \"MAY\", and", "   \"OPTIONAL\" in this document are to be interpreted as described in BCP", "   14 [RFC2119] [RFC8174] when, and only when, they appear in all", "   capitals, as shown here", ""]}, {"id": "2", "title": "Decrypt", "lines": ["2.   Decrypt", ""]}, {"id": "2.1", "title": "Version", "lines": ["2.1.   Version", "", "   0.4.0", ""]}, {"id": "2.1.1", "title": "Changelog", "lines": ["2.1.1.   Changelog", "", "   *  0.4.0", "", "      -  Add unsigned streaming decryption option", "", "   *  0.3.0", "", "      -  Clarify Streaming Encrypt and Decrypt (../changes/2020-07-", "         06_clarify-streaming-encrypt-decrypt/change.md)", "", "   *  0.2.0", "", "      -  Detect Base64-encoded Messages (../changes/2020-07-13_detect-", "         base64-encoded-messages/change.md)", "", "   *  0.1.0-preview", "", "      -  Initial record", ""]}, {"id": "2.2", "title": "Implementations", "lines": ["2.2.   Implementations", "", "   +========+==========+=========+====================================================================+", "   |Language|Confirmed |Minimum  |Implementation                                                      |", "   |        |Compatible|Version  |                                                                    |", "   |        |with Spec |Confirmed|                                                                    |", "   |        |Version   |         |                                                                    |", "   +========+==========+=========+====================================================================+", "   |C       |0.2.0     |0.1.0    |session_decrypt.c (https://github.com/aws/aws-encryption-sdk-       |", "   |        |          |         |c/blob/master/source/session_decrypt.c)                             |", "   +--------+----------+---------+--------------------------------------------------------------------+", "   |NodeJS  |0.2.0     |0.1.0    |decrypt.ts (https://github.com/awslabs/aws-encryption-sdk-          |", "   |        |          |         |javascript/blob/master/modules/encrypt-node/src/decrypt.ts)         |", "   +--------+----------+---------+--------------------------------------------------------------------+", "   |Browser |0.2.0     |0.1.0    |decrypt.ts (https://github.com/awslabs/aws-encryption-sdk-          |", "   |JS      |          |         |javascript/blob/master/modules/encrypt-browser/src/decrypt.ts)      |", "   +--------+----------+---------+--------------------------------------------------------------------+", "   |Python  |0.2.0     |1.2.0    |streaming_client.py (https://github.com/aws/aws-encryption-sdk-     |", "   |        |          |         |python/blob/master/src/aws_encryption_sdk/streaming_client.py)      |", "   +--------+----------+---------+--------------------------------------------------------------------+", "   |Java    |0.2.0     |0.0.1    |DecryptionHandler.java (https://github.com/aws/aws-encryption-sdk-  |", "   |        |          |         |java/blob/master/src/main/java/com/amazonaws/encryptionsdk/internal/|", "   |        |          |         |DecryptionHandler.java)                                             |", "   +--------+----------+---------+--------------------------------------------------------------------+", "", "                                  Table 1", ""]}, {"id": "2.3", "title": "Overview", "lines": [[[[836, 837], 226, "Any client provided by the AWS Encryption SDK that performs decryption of encrypted messages MUST follow this specification for decryption."]]], "requirements": [837]}, {"id": "2.4", "title": "Definitions", "lines": ["2.4.   Definitions", ""]}, {"id": "2.4.1", "title": "document", "lines": [[[[838], 224, "The key words \"MUST\", \"MUST NOT\", \"REQUIRED\", \"SHALL\", \"SHALL NOT\", \"SHOULD\", \"SHOULD NOT\", \"RECOMMENDED\", \"MAY\", and \"OPTIONAL\" in this document are to be interpreted as described in RFC2119 (https://tools.ietf.org/html/rfc2119)."]]], "requirements": [838]}, {"id": "2.4.2", "title": "Data", "lines": [[[[839, 840], 240, "This operation MUST NOT release any unauthenticated plaintext or unauthenticated associated data."]]], "requirements": [840]}, {"id": "2.4.3", "title": "Data", "lines": ["2.4.3.   Signed Data", "", "   Plaintext and associated data is considered signed if the associated", "   message signature (../data-format/message-footer.md) is successfully", "   verified using the signature algorithm (../framework/algorithm-", "   suites.md#signature-algorithm) of the algorithm suite indicated in", "   the message header.", ""]}, {"id": "2.5", "title": "Input", "lines": [[[[841, 842], 232, "The client MUST require the following as inputs to this operation:"]], [[[843, 844], 232, "The client MUST require exactly one of the following types of inputs:"]]], "requirements": [842, 844]}, {"id": "2.5.1", "title": "Message", "lines": [[[[845, 846], 232, "The input encrypted message MUST be a sequence of bytes in the message format (../data-format/ message.md) specified by the AWS Encryption SDK."]], [[[847, 848], 98, "This input MAY be streamed (streaming.md) to this operation."]], [[[849, 850], 168, "If an implementation requires holding the entire encrypted message in memory in order to perform this operation, that implementation SHOULD NOT provide an API that allows the caller to stream the encrypted message."]]], "requirements": [846, 848, 850]}, {"id": "2.5.1.1", "title": "Format", "lines": ["2.5.1.1.   Encrypted Message Format", "", "   The message format is a binary format, but it is a common mistake for", "   users to attempt decryption on the Base64 encoding of this data", "   instead.  Because the first two bytes of the message format have a", "   very limited set of possible values (currently they are in fact", "   fixed), the first two bytes of the Base64 encoding of a valid message", "   are also simple to recognize.", "", "   To make diagnosing this mistake easier, implementations SHOULD detect", "   the first two bytes of the Base64 encoding of any supported message", "   versions (../data-format/message-header.md#version-1) and types", "   (../data-format/message-header.md#type) and fail with a more specific", "   error message.  In particular, the hex values to detect for the", "   current set of versions and types are:", "", "   +========================+=========================+================+", "   | Version and type (hex) | Base64 encoding         | Base64         |", "   |                        | (ascii)                 | encoding (hex) |", "   +========================+=========================+================+", "   | 01 80                  | A Y ...                 | 41 59 ...      |", "   +------------------------+-------------------------+----------------+", "", "                                  Table 2", "", "   Note that the bytes that follow the initial two in the Base64", "   encoding partially depend on subsequent bytes in the binary message", "   format and hence are not as predictable.", ""]}, {"id": "2.5.2", "title": "Manager", "lines": [[[[851, 852], 240, "This CMM MUST obtain the decryption materials (../framework/ structures.md#decryption-materials) required for decryption."]]], "requirements": [852]}, {"id": "2.5.3", "title": "Keyring", "lines": [[[[853, 854], 240, "If the Keyring is provided as the input, the client MUST construct a default CMM (../framework/default-cmm.md) that uses this keyring, to obtain the decryption materials (../framework/ structures.md#decryption-materials) that is required for decryption."]], [[[855, 856], 240, "This default CMM MUST obtain the decryption materials required for decryption."]]], "requirements": [854, 856]}, {"id": "2.6", "title": "Output", "lines": [[[[857, 858, 859], 232, "The client MUST return as output to this operation:"]], [[[860, 861], 162, "The client SHOULD return as an output:"]]], "requirements": [859, 861]}, {"id": "2.6.1", "title": "Plaintext", "lines": [[[[862, 863], 98, "This operation MAY stream (streaming.md) the plaintext as output."]], [[[864, 865], 168, "If an implementation requires holding the entire encrypted message in memory in order to perform this operation, that implementation SHOULD NOT provide an API that allows the caller to stream the encrypted message."]]], "requirements": [863, 865]}, {"id": "2.6.2", "title": "Context", "lines": [[[[866, 867], 98, "This output MAY be satisfied by outputting a parsed header (Section 2.6.4) containing this value."]]], "requirements": [867]}, {"id": "2.6.3", "title": "Suite", "lines": [[[[868, 869], 98, "This output MAY be satisfied by outputting a parsed header (Section 2.6.4) containing this value."]]], "requirements": [869]}, {"id": "2.6.4", "title": "Header", "lines": ["2.6.4.   Parsed Header", "", "   A collection of deserialized fields of the encrypted message's", "   (Section 2.5.1) header.", ""]}, {"id": "2.7", "title": "Behavior", "lines": [[[[870, 871, 872], 227, "This operation MUST perform all the above steps unless otherwise specified, and it MUST perform them in the above order."]], [[[873, 874], 240, "If the input encrypted message is not being streamed (streaming.md) to this operation, all output MUST NOT be released until after these steps complete successfully."]]], "requirements": [872, 874]}, {"id": "2.7.1", "title": "header", "lines": [[[[875, 876], 240, "Given encrypted message bytes, this operation MUST process those bytes sequentially, deserializing those bytes according to the message format (../data-format/message.md)."]], [[[877, 878], 240, "This operation MUST attempt to deserialize all consumable encrypted message bytes until it has successfully deserialized a valid message header (../data-format/message-header.md)."]], [[[879, 880], 240, "If the number of encrypted data keys (../framework/ structures.md#encrypted-data-keys) deserialized from the message header (../data-format/message-header.md) is greater than the maximum number of encrypted data keys (client.md#maximum-number-of-encrypted- data-keys) configured in the client (client.md), then as soon as that can be determined during deserializing decrypt MUST process no more bytes and yield an error."]], [[[881, 882], 226, "This operation MUST wait if it doesn't have enough consumable encrypted message bytes to deserialize the next field of the message header until enough input bytes become consumable or the caller indicates an end to the encrypted message."]], [[[883, 884], 240, "Until the header is verified (Section 2.7.3), this operation MUST NOT release any parsed information from the header."]]], "requirements": [876, 878, 880, 882, 884]}, {"id": "2.7.2", "title": "materials", "lines": [[[[885, 886], 232, "If the parsed algorithm suite ID (../data-format/message- header.md#algorithm-suite-id) is not supported by the commitment policy (client.md#commitment-policy) configured in the client (client.md) decrypt MUST yield an error."]], [[[887, 888], 240, "This operation MUST obtain this set of decryption materials (../framework/structures.md#decryption-materials), by calling Decrypt Materials (../framework/cmm-interface.md#decrypt-materials) on a CMM (../framework/cmm-interface.md)."]], [[[889, 890], 232, "The CMM used MUST be the input CMM, if supplied."]], [[[891, 892], 240, "If a CMM is not supplied as the input, the decrypt operation MUST construct a default CMM (../framework/default-cmm.md) from the input keyring (../framework/keyring-interface.md)."]], [[[893], 224, "The call to the CMM's Decrypt Materials (../framework/cmm- interface.md#decrypt-materials) operation MUST be constructed as follows:"]], [[[894, 895, 896], 248, "If the algorithm suite is not supported by the commitment policy (client.md#commitment-policy) configured in the client (client.md) decrypt MUST yield an error."]], [[[897, 898], 232, "If the algorithm suite (../framework/ algorithm-suites.md#algorithm-suites-encryption-key-derivation- settings) supports key commitment (../framework/algorithm- suites.md#key-commitment) then the commit key (../framework/ algorithm-suites.md#commit-key) MUST be derived from the plaintext data key using the commit key derivation (../framework/algorithm- suites.md#algorithm-suites-commit-key-derivation-settings)."]], [[[899, 900], 232, "The derived commit key MUST equal the commit key stored in the message header."]], [[[901, 902, 903], 248, "The algorithm suite used to derive a data key from the plaintext data key MUST be the key derivation algorithm (../framework/algorithm-suites.md#key-derivation-algorithm) included in the algorithm suite (../framework/algorithm-suites.md) associated with the returned decryption materials."]]], "requirements": [886, 888, 890, 892, 893, 896, 898, 900, 903]}, {"id": "2.7.3", "title": "header", "lines": [[[[904, 905], 240, "Once a valid message header is deserialized and decryption materials are available, this operation MUST validate the message header body (../data-format/message-header.md#header-body) by using the authenticated encryption algorithm (../framework/algorithm- suites.md#encryption-algorithm) to decrypt with the following inputs:"]], [[[906, 907], 240, "If this tag verification fails, this operation MUST immediately halt and fail."]]], "requirements": [905, 907]}, {"id": "2.7.4", "title": "body", "lines": [[[[908, 909], 240, "Once the message header is successfully parsed, the next sequential bytes MUST be deserialized according to the message body spec (../data-format/message-body.md)."]], [[[910, 911], 226, "While there MAY still be message body left to deserialize and decrypt, this operation MUST either wait for more of the encrypted message bytes to become consumable, wait for the end to the encrypted message to be indicated, or to deserialize and/or decrypt the consumable bytes."]], [[[912, 913], 240, "The content type (../data-format/message-header.md#content-type) field parsed from the message header above determines whether these bytes MUST be deserialized as framed data (../data-format/message- body.md#framed-data) or un-framed data (../data-format/message- body.md#un-framed-data)."]], [[[914, 915], 240, "If deserializing framed data (../data-format/message-body.md#framed- data), this operation MUST use the first 4 bytes of a frame to determine if the frame MUST be deserialized as a final frame (../data-format/message-body.md#final-frame) or regular frame (../fata-format/message-body/md#regular-frame)."]], [[[916, 917], 240, "If the first 4 bytes have a value of 0xFFFF, then this MUST be deserialized as the sequence number end (../data-format/message-header.md#sequence- number-end) and the following bytes according to the final frame spec (../data-format/message-body.md#final-frame)."]], [[[918, 919], 240, "Otherwise, this MUST be deserialized as the sequence number (../data-format/message- header.md#sequence-number) and the following bytes according to the regular frame spec (../data-format/message-body.md#regular-frame)."]], [[[920, 921, 922], 248, "If deserializing a final frame (../data-format/message-body.md#final- frame), this operation MUST ensure that the length of the encrypted content field is less than or equal to the frame length deserialized in the message header."]], [[[923, 924, 925], 226, "Once at least a single frame is deserialized (or the entire body in the un-framed case), this operation MUST decrypt and authenticate the frame (or body) using the authenticated encryption algorithm (../framework/algorithm-suites.md#encryption-algorithm) specified by the algorithm suite (../framework/algorithm-suites.md), with the following inputs:"]], [[[926, 927, 928, 929], 240, "If this decryption fails, this operation MUST immediately halt and fail."]], [[[930, 931], 240, "This operation MUST NOT release any unauthenticated plaintext."]]], "requirements": [909, 911, 913, 915, 917, 919, 922, 925, 929, 931]}, {"id": "2.7.5", "title": "signature", "lines": [[[[932, 933], 240, "If the algorithm suite has a signature algorithm, this operation MUST verify the message footer using the specified signature algorithm."]], [[[934, 935], 240, "After deserializing the body, this operation MUST deserialize the next encrypted message bytes as the message footer (../data-format/ message-footer.md)."]], [[[936, 937], 226, "If there are not enough consumable bytes to deserialize the message footer and the caller has not yet indicated an end to the encrypted message, this operation MUST wait for enough bytes to become consumable or for the caller to indicate an end to the encrypted message."]], [[[938, 939], 240, "Once the message footer is deserialized, this operation MUST use the signature algorithm (../framework/algorithm-suites.md#signature- algorithm) from the algorithm suite (../framework/algorithm- suites.md) in the decryption materials to verify the encrypted message, with the following inputs:"]], [[[940, 941], 98, "Note that the message header and message body MAY have already been input during previous steps."]], [[[942, 943], 240, "If this verification is not successful, this operation MUST immediately halt and fail."]]], "requirements": [933, 935, 937, 939, 941, 943]}, {"id": "2.8", "title": "Considerations", "lines": [[[[944, 945], 226, "If this operation is streaming (streaming.md) output to the caller and is decrypting messages created with an algorithm suite including a signature algorithm, any released plaintext MUST NOT be considered signed data until this operation finishes successfully."]], [[[946, 947], 226, "This means that callers that process such released plaintext MUST NOT consider any processing successful until this operation completes successfully."]], [[[948, 949], 226, "Additionally, if this operation fails, callers MUST discard the released plaintext and encryption context and MUST rollback any processing done due to the released plaintext or encryption context."]]], "requirements": [945, 947, 949]}, {"id": "3", "title": "References", "lines": ["3.   Normative References", "", "   [RFC2119]  Bradner, S., \"Key words for use in RFCs to Indicate", "              Requirement Levels\", BCP 14, RFC 2119,", "              DOI 10.17487/RFC2119, March 1997,", "              <https://www.rfc-editor.org/info/rfc2119>.", "", "   [RFC8174]  Leiba, B., \"Ambiguity of Uppercase vs Lowercase in RFC", "              2119 Key Words\", BCP 14, RFC 8174, DOI 10.17487/RFC8174,", "              May 2017, <https://www.rfc-editor.org/info/rfc8174>.", "", "Acknowledgments", "", "Author's Address", "", "   Amazon AWS", "   Amazon AWS", "", "   Email: cryptools+rfc@amazon.com"]}]}, "compliance/data-format/message-body.txt": {"requirements": [950, 952, 954, 955, 956, 957, 958, 959, 960, 961, 962, 963, 964, 965], "sections": [{"id": "1", "title": "Definitions", "lines": ["1.   Conventions and Definitions", "", "   The key words \"MUST\", \"MUST NOT\", \"REQUIRED\", \"SHALL\", \"SHALL NOT\",", "   \"SHOULD\", \"SHOULD NOT\", \"RECOMMENDED\", \"NOT RECOMMENDED\", \"MAY\", and", "   \"OPTIONAL\" in this document are to be interpreted as described in BCP", "   14 [RFC2119] [RFC8174] when, and only when, they appear in all", "   capitals, as shown here", ""]}, {"id": "2", "title": "Body", "lines": ["2.   Message Body", ""]}, {"id": "2.1", "title": "Version", "lines": ["2.1.   Version", "", "   See Message Version (message.md#version).", ""]}, {"id": "2.2", "title": "Implementations", "lines": ["2.2.   Implementations", "", "   *  C (https://github.com/awslabs/aws-encryption-sdk-", "      c/blob/master/include/aws/cryptosdk/private/framefmt.h)", "", "   *  JavaScript (https://github.com/awslabs/aws-encryption-sdk-", "      javascript/blob/master/modules/serialize/src/types.ts)", "", "   *  Python (https://github.com/aws/aws-encryption-sdk-", "      python/blob/master/src/aws_encryption_sdk/structures.py)", "", "   *  Java (https://github.com/aws/aws-encryption-sdk-", "      java/blob/master/src/main/java/com/amazonaws/encryptionsdk/model/", "      ContentType.java)", ""]}, {"id": "2.3", "title": "Overview", "lines": ["2.3.   Overview", "", "   The message body is a component of the message (message.md).", "   The message body contains the encrypted data, called the encrypted", "   content (Section 2.5.1.3).", "   The purpose of the message body is to define the structure containing", "   the encrypted content (Section 2.5.1.3).", "", "   The structure of the body depends on the content type:", "", "   *  Non-Framed Data (Section 2.5.1)", "", "   *  Framed Data (Section 2.5.2)", ""]}, {"id": "2.4", "title": "Definitions", "lines": ["2.4.   Definitions", ""]}, {"id": "2.4.1", "title": "document", "lines": [[[[950], 224, "The key words \"MUST\", \"MUST NOT\", \"REQUIRED\", \"SHALL\", \"SHALL NOT\", \"SHOULD\", \"SHOULD NOT\", \"RECOMMENDED\", \"MAY\", and \"OPTIONAL\" in this document are to be interpreted as described in RFC 2119 (https://tools.ietf.org/html/rfc2119)."]]], "requirements": [950]}, {"id": "2.5", "title": "Structure", "lines": ["2.5.   Structure", "", "   The following sections describe the format of the message body for", "   each content type.", ""]}, {"id": "2.5.1", "title": "Data", "lines": ["2.5.1.   Non-Framed Data", "", "   Non-framed data is a sequence of encrypted bytes along with the", "   initialization vector (IV) (Section 2.5.1.1) and body authentication", "   tag (Section 2.5.1.4).", "", "   The following describes the fields that form non-framed data.", "   The bytes are appended in the order shown.", "", "    +===================+===============================+=============+", "    | Field             | Length (bytes)                | Interpreted |", "    |                   |                               | as          |", "    +===================+===============================+=============+", "    | Section 2.5.1.1   | IV Length (message-           | Bytes       |", "    |                   | header.md#iv-length)          |             |", "    +-------------------+-------------------------------+-------------+", "    | Encrypted Content | 8                             | Uint64      |", "    | Length            |                               |             |", "    | (Section 2.5.1.2) |                               |             |", "    +-------------------+-------------------------------+-------------+", "    | Encrypted Content | Variable                      | Bytes       |", "    | (Section 2.5.1.3) |                               |             |", "    +-------------------+-------------------------------+-------------+", "    | Authentication    | Variable                      | Bytes       |", "    | Tag               |                               |             |", "    | (Section 2.5.1.4) |                               |             |", "    +-------------------+-------------------------------+-------------+", "", "                                  Table 1", ""]}, {"id": "2.5.1.1", "title": "IV", "lines": [[[[951, 952], 232, "The IV MUST be a unique IV within the message."]]], "requirements": [952]}, {"id": "2.5.1.2", "title": "Length", "lines": [[[[953, 954], 232, "The length MUST NOT be greater than \"2^36 - 32\", or 64 gibibytes (64 GiB), due to restrictions imposed by the implemented algorithms (../framework/algorithm-suites.md)."]]], "requirements": [954]}, {"id": "2.5.1.3", "title": "Content", "lines": ["2.5.1.3.   Encrypted Content", "", "   The encrypted data as returned by the encryption algorithm", "   (../framework/algorithm-suites.md#encryption-algorithm).", ""]}, {"id": "2.5.1.4", "title": "Tag", "lines": ["2.5.1.4.   Authentication Tag", "", "   The authentication value for the body.", "   It is used to authenticate the message body.", ""]}, {"id": "2.5.2", "title": "Data", "lines": ["2.5.2.   Framed Data", "", "   Framed data is a sequence of bytes divided into equal-length parts", "   called frames.", "   Each frame is encrypted separately with a unique Section 2.5.1.1 and", "   body authentication tag (Section 2.5.1.4).", "   There are two kinds of frames:", "", "   *  Regular Frame (Section 2.5.2.1)", "", "   *  Final Frame (Section 2.5.2.2)", "", "   Note:", "", "   *  The total bytes allowed in a single frame MUST be less than or", "      equal to \"2^32 - 1\".", "", "   *  The number of frames in a single message MUST be less than or", "      equal to \"2^32 - 1\".", ""]}, {"id": "2.5.2.1", "title": "Frame", "lines": [[[[955], 224, "Framed Data MUST start at Sequence Number 1."]], [[[956], 224, "Subsequent frames MUST be in order and MUST contain an increment of 1 from the previous frame."]], [[[957], 224, "Each frame in the Framed Data (Section 2.5.2) MUST include an IV that is unique within the message."]], [[[958], 224, "The IV length MUST be equal to the IV length of the algorithm suite specified by the Algorithm Suite ID (message-header.md#algorithm-suite-id) field."]], [[[959], 224, "The length of the encrypted content of a Regular Frame MUST be equal to the Frame Length."]], [[[960], 224, "The authentication tag length MUST be equal to the authentication tag length of the algorithm suite specified by the Algorithm Suite ID (message-header.md#algorithm-suite-id) field."]]], "requirements": [955, 956, 957, 958, 959, 960]}, {"id": "2.5.2.2", "title": "Frame", "lines": [[[[961], 224, "The value MUST be encoded as the 4 bytes \"FF FF FF FF\" in hexadecimal notation."]], [[[962], 224, "The Final Frame Sequence number MUST be equal to the total number of frames in the Framed Data."]], [[[963], 224, "The IV MUST be a unique IV within the message."]], [[[964], 224, "The IV length MUST be equal to the IV length of the algorithm suite (../framework/algorithm-suites.md) that generated the message."]], [[[965], 224, "The authentication tag length MUST be equal to the authentication tag length of the algorithm suite specified by the Algorithm Suite ID (message-header.md#algorithm-suite-id) field."]]], "requirements": [961, 962, 963, 964, 965]}, {"id": "2.6", "title": "Usage", "lines": ["2.6.   Example Usage", "", "   The following section contains examples of the message body for", "   Non-Framed Data (Section 2.5.1) and Framed Data (Section 2.5.2).", ""]}, {"id": "2.6.1", "title": "Data", "lines": ["2.6.1.   Non-Framed Data", "", "   The following example shows the message body format for Non-Framed", "   Data (Section 2.5.1).", ""]}, {"id": "2.6.1.1", "title": "Structure", "lines": ["2.6.1.1.   Example Pseudo-ASN.1 Structure", "", "   \"DEFINITIONS ::= BEGIN NonFramedBody SEQUENCE (SIZE(4)) { IV OCTET", "   STRING (SIZE(IvLength)), EncryptedContentLength UINT64,", "   EncryptedContent OCTET STRING (SIZE(EncryptedContentLength)), AuthTag", "   OCTET STRING (SIZE(TagLength)), }\"", ""]}, {"id": "2.6.1.2", "title": "Bytes", "lines": ["2.6.1.2.   Example Bytes", "", "   \"39DD3E5 915E0201 77A4AB11 IV 00000000 0000028E Encrypted Content", "   Length (654) E8B6F955 B5F22FE4 FD890224 4E1D5155 Encrypted Content", "   5871BA4C 93F78436 1085E4F8 D61ECE28 59455BD8 D76479DF C28D2E0B", "   BDB3D5D3 E4159DFE C8A944B6 685643FC EA24122B 6766ECD5 E3F54653", "   DF205D30 0081D2D8 55FCDA5B 9F5318BC F4265B06 2FE7C741 C7D75BCC", "   10F05EA5 0E2F2F40 47A60344 ECE10AA7 559AF633 9DE2C21B 12AC8087", "   95FE9C58 C65329D1 377C4CD7 EA103EC1 31E4F48A 9B1CC047 EE5A0719", "   704211E5 B48A2068 8060DF60 B492A737 21B0DB21 C9B21A10 371E6179", "   78FAFB0B BAAEC3F4 9D86E334 701E1442 EA5DA288 64485077 54C0C231", "   AD43571A B9071925 609A4E59 B8178484 7EB73A4F AAE46B26 F5B374B8", "   12B0000C 8429F504 936B2492 AAF47E94 A5BA804F 7F190927 5D2DF651", "   B59D4C2F A15D0551 DAEBA4AF 2060D0D5 CB1DA4E6 5E2034DB 4D19E7CD", "   EEA6CF7E 549C86AC 46B2C979 AB84EE12 202FD6DF E7E3C09F C2394012", "   AF20A97E 369BCBDA 62459D3E C6FFB914 FEFD4DE5 88F5AFE1 98488557", "   1BABBAE4 BE55325E 4FB7E602 C1C04BEE F3CB6B86 71666C06 6BF74E1B", "   0F881F31 B731839B CF711F6A 84CA95F5 958D3B44 E3862DF6 338E02B5", "   C345CFF8 A31D54F3 6920AA76 0BF8E903 552C5A04 917CCD11 D4E5DF5C", "   491EE86B 20C33FE1 5D21F0AD 6932E67C C64B3A26 B8988B25 CFA33E2B", "   63490741 3AB79D60 D8AEFBE9 2F48E25A 978A019C FE49EE0A 0E96BF0D", "   D6074DDB 66DFF333 0E10226F 0A1B219C BE54E4C2 2C15100C 6A2AA3F1", "   88251874 FDC94F6B 9247EF61 3E7B7E0D 29F3AD89 FA14A29C 76E08E9B", "   9ADCDF8C C886D4FD A69F6CB4 E24FDE26 3044C856 BF08F051 1ADAD329", "   C4A46A1E B5AB72FE 096041F1 F3F3571B 2EAFD9CB B9EB8B83 AE05885A", "   8F2D2793 1E3305D9 0C9E2294 E8AD7E3B 8E4DEC96 6276C5F1 A3B7E51E", "   422D365D E4C0259C 50715406 822D1682 80B0F2E5 5C94 65B2E942 24BEEA6E", "   A513F918 CCEC1DE3 Authentication Tag\"", ""]}, {"id": "2.6.2", "title": "Data", "lines": ["2.6.2.   Framed Data", "", "   The following example shows the message body format for Framed Data", "   (Section 2.5.2).", ""]}, {"id": "2.6.2.1", "title": "Structure", "lines": ["2.6.2.1.   Example Pseudo-ASN.1 Structure", "", "   ``` DEFINITIONS ::= BEGIN RegularFrame SEQUENCE (SIZE(4)) {", "   SequenceNumber UINT32, IV OCTET STRING (SIZE(IvLength)),", "   EncryptedContent OCTET STRING (SIZE(FrameLength)), AuthTag OCTET", "   STRING (SIZE(TagLength)), }", "", "   FinalFrame SEQUENCE (SIZE(6)) { SequenceNumberEnd OCTET STRING (0xFF", "   0xFF 0xFF 0xFF), SequenceNumber UINT32, IV OCTET STRING", "   (SIZE(IvLength)), EncryptedContentLength UINT32, EncryptedContent", "   OCTET STRING (SIZE(EncryptedContentLength)), AuthTag OCTET STRING", "   (SIZE(TagLength)), } ```", ""]}, {"id": "2.6.2.2", "title": "Bytes", "lines": ["2.6.2.2.   Example Bytes", "", "   \"00000001 Frame 1, Sequence Number (1) 6BD3FE9C ADBCB213 5B89E8F1", "   Frame 1, IV 1F6471E0 A51AF310 10FA9EF6 F0C76EDF Frame 1, Encrypted", "   Content F5AFA33C 7D2E8C6C 9C5D5175 A212AF8E FBD9A0C3 C6E3FB59", "   C125DBF2 89AC7939 BDEE43A8 0F00F49E ACBBD8B2 1C785089 A90DB923", "   699A1495 C3B31B50 0A48A830 201E3AD9 1EA6DA14 7F6496DB 6BC104A4", "   DEB7F372 375ECB28 9BF84B6D 2863889F CB80A167 9C361C4B 5EC07438", "   7A4822B4 A7D9D2CC 5150D414 AF75F509 FCE118BD 6D1E798B AEBA4CDB", "   AD009E5F 1A571B77 0041BC78 3E5F2F41 8AF157FD 461E959A BB732F27", "   D83DC36D CC9EBC05 00D87803 57F2BB80 066971C2 DEEA062F 4F36255D", "   E866C042 E1382369 12E9926B BA40E2FC A820055F FB47E428 41876F14", "   3B6261D9 5262DB34 59F5D37E 76E46522 E8213640 04EE3CC5 379732B5", "   F56751FA 8E5F26AD Frame 1, Authentication Tag 00000002 Frame 2,", "   Sequence Number (2) F1140984 FF25F943 959BE514 Frame 2, IV 216C7C6A", "   2234F395 F0D2D9B9 304670BF Frame 2, Encrypted Content A1042608", "   8A8BCB3F B58CF384 D72EC004 A41455B4 9A78BAC9 36E54E68 2709B7BD", "   A884C1E1 705FF696 E540D297 446A8285 23DFEE28 E74B225A 732F2C0C", "   27C6BDA2 7597C901 65EF3502 546575D4 6D5EBF22 1FF787AB 2E38FD77", "   125D129C 43D44B96 778D7CEE 3C36625F FF3A985C 76F7D320 ED70B1F3", "   79729B47 E7D9B5FC 02FCE9F5 C8760D55 7779520A 81D54F9B EC45219D", "   95941F7E 5CBAEAC8 CEC13B62 1464757D AC65B6EF 08262D74 44670624", "   A3657F7F 2A57F1FD E7060503 AC37E197 2F297A84 DF1172C2 FA63CF54", "   E6E2B9B6 A86F582B 3B16F868 1BBC5E4D 0B6919B3 08D5ABCF FECDC4A4", "   8577F08B 99D766A1 E5545670 A61F0A3B A3E45A84 4D151493 63ECA38F Frame", "   2, Authentication Tag FFFFFFFF Final Frame, Sequence Number End", "   00000003 Final Frame, Sequence Number (3) 35F74F11 25410F01 DD9E04BF", "   Final Frame, IV 0000008E Final Frame, Encrypted Content Length (142)", "   F7A53D37 2F467237 6FBD0B57 D1DFE830 Final Frame, Encrypted Content", "   B965AD1F A910AA5F 5EFFFFF4 BC7D431C BA9FA7C4 B25AF82E 64A04E3A", "   A0915526 88859500 7096FABB 3ACAD32A 75CFED0C 4A4E52A3 8E41484D", "   270B7A0F ED61810C 3A043180 DF25E5C5 3676E449 0986557F C051AD55", "   A437F6BC 139E9E55 6199FD60 6ADC017D BA41CDA4 C9F17A83 3823F9EC", "   B66B6A5A 80FDB433 8A48D6A4 21CB 811234FD 8D589683 51F6F39A 040B3E3B", "   Final Frame, Authentication Tag\"", ""]}, {"id": "3", "title": "References", "lines": ["3.   Normative References", "", "   [RFC2119]  Bradner, S., \"Key words for use in RFCs to Indicate", "              Requirement Levels\", BCP 14, RFC 2119,", "              DOI 10.17487/RFC2119, March 1997,", "              <https://www.rfc-editor.org/info/rfc2119>.", "", "   [RFC8174]  Leiba, B., \"Ambiguity of Uppercase vs Lowercase in RFC", "              2119 Key Words\", BCP 14, RFC 8174, DOI 10.17487/RFC8174,", "              May 2017, <https://www.rfc-editor.org/info/rfc8174>.", "", "Acknowledgments", "", "Author's Address", "", "   Amazon AWS", "   Amazon AWS", "", "   Email: cryptools+rfc@amazon.com"]}]}, "compliance/data-format/message.txt": {"requirements": [966], "sections": [{"id": "1", "title": "Definitions", "lines": ["1.   Conventions and Definitions", "", "   The key words \"MUST\", \"MUST NOT\", \"REQUIRED\", \"SHALL\", \"SHALL NOT\",", "   \"SHOULD\", \"SHOULD NOT\", \"RECOMMENDED\", \"NOT RECOMMENDED\", \"MAY\", and", "   \"OPTIONAL\" in this document are to be interpreted as described in BCP", "   14 [RFC2119] [RFC8174] when, and only when, they appear in all", "   capitals, as shown here", ""]}, {"id": "2", "title": "Message", "lines": ["2.   Message", ""]}, {"id": "2.1", "title": "Version", "lines": ["2.1.   Version", "", "   0.2.0", "", "   Note: This is the version of the message specification, not the", "   message format.", ""]}, {"id": "2.2", "title": "Overview", "lines": ["2.2.   Overview", "", "   A message is a formatted structure that contains encrypted data and", "   associated metadata.", ""]}, {"id": "2.3", "title": "Structure", "lines": [[[[966], 224, "If the message header (message-header.md) contains an algorithm suite (../framework/algorithm-suites.md) in the algorithm suite ID (message-header.md#algorithm-suite-id) field that contains a signature algorithm (../framework/algorithm-suites.md#signature- algorithm), the message MUST also contain a message footer (message- footer.md), serialized after the message body (message-body.md)."]]], "requirements": [966]}, {"id": "3", "title": "References", "lines": ["3.   Normative References", "", "   [RFC2119]  Bradner, S., \"Key words for use in RFCs to Indicate", "              Requirement Levels\", BCP 14, RFC 2119,", "              DOI 10.17487/RFC2119, March 1997,", "              <https://www.rfc-editor.org/info/rfc2119>.", "", "   [RFC8174]  Leiba, B., \"Ambiguity of Uppercase vs Lowercase in RFC", "              2119 Key Words\", BCP 14, RFC 8174, DOI 10.17487/RFC8174,", "              May 2017, <https://www.rfc-editor.org/info/rfc8174>.", "", "Acknowledgments", "", "Author's Address", "", "   Amazon AWS", "   Amazon AWS", "", "   Email: cryptools+rfc@amazon.com"]}]}, "compliance/data-format/message-body-aad.txt": {"requirements": [969, 971], "sections": [{"id": "1", "title": "Definitions", "lines": ["1.   Conventions and Definitions", "", "   The key words \"MUST\", \"MUST NOT\", \"REQUIRED\", \"SHALL\", \"SHALL NOT\",", "   \"SHOULD\", \"SHOULD NOT\", \"RECOMMENDED\", \"NOT RECOMMENDED\", \"MAY\", and", "   \"OPTIONAL\" in this document are to be interpreted as described in BCP", "   14 [RFC2119] [RFC8174] when, and only when, they appear in all", "   capitals, as shown here", ""]}, {"id": "2", "title": "AAD", "lines": ["2.   Message Body AAD", ""]}, {"id": "2.1", "title": "Version", "lines": ["2.1.   Version", "", "   See Message Version (message.md#version).", ""]}, {"id": "2.2", "title": "Implementations", "lines": ["2.2.   Implementations", "", "   *  C (https://github.com/aws/aws-encryption-sdk-c/blob/master/source/", "      cipher.c)", "", "   *  JavaScript (https://github.com/awslabs/aws-encryption-sdk-", "      javascript/blob/master/modules/serialize/src/aad_factory.ts)", "", "   *  Python (https://github.com/aws/aws-encryption-sdk-", "      python/blob/master/src/aws_encryption_sdk/internal/formatting/", "      encryption_context.py)", "", "   *  Java (https://github.com/aws/aws-encryption-sdk-", "      java/blob/master/src/main/java/com/amazonaws/encryptionsdk/", "      internal/Utils.java)", ""]}, {"id": "2.3", "title": "Overview", "lines": ["2.3.   Overview", "", "   The message body AAD is the serialization of the AAD to be used as", "   input to encryption of the message body.", ""]}, {"id": "2.4", "title": "Structure", "lines": ["2.4.   Structure", "", "   The following describes the fields that form the message body AAD.", "   The bytes are appended in the order shown.", "", "          +==================+================+================+", "          | Field            | Length (bytes) | Interpreted as |", "          +==================+================+================+", "          | Message ID       | 16             | Bytes          |", "          +------------------+----------------+----------------+", "          | Body AAD Content | Variable.      | UTF-8 Bytes    |", "          +------------------+----------------+----------------+", "          | Sequence Number  | 4              | Uint32         |", "          +------------------+----------------+----------------+", "          | Content Length   | 8              | Uint64         |", "          +------------------+----------------+----------------+", "", "                                 Table 1", ""]}, {"id": "2.4.1", "title": "ID", "lines": ["2.4.1.   Message ID", "", "   An identifier for the message (message.md) this message body AAD is", "   associated with.", ""]}, {"id": "2.4.2", "title": "Content", "lines": ["2.4.2.   Body AAD Content", "", "   An identifier for the content type of the data this message body AAD", "   is associated with.", "", "   This value depends on the content type (message-header.md#content-", "   type) of the message (message.md):", "", "   *  Non-framed data (message-body.md#non-framed-data) MUST use the", "      value \"AWSKMSEncryptionClient Single Block\".", "", "   *  The regular frames (message-body.md#regular-frame) in framed data", "      (message-body.md#framed-data) MUST use the value", "      \"AWSKMSEncryptionClient Frame\".", "", "   *  The final frame (message-body.md#final-frame) in framed data", "      (message-body.md#framed-data) MUST use the value", "      \"AWSKMSEncryptionClient Final Frame\".", ""]}, {"id": "2.4.3", "title": "Number", "lines": [[[[967, 968, 969], 240, "For framed data (message-body.md#framed-data), the value of this field MUST be the frame sequence number (message-body.md#sequence- number)."]], [[[970, 971], 240, "For non-framed data (message-body.md#non-framed-data), the value of this field MUST be \"1\"."]]], "requirements": [969, 971]}, {"id": "2.4.4", "title": "Length", "lines": ["2.4.4.   Content Length", "", "   The length, in bytes, of the plaintext data being encrypted that this", "   message body AAD is associated with.", "", "   More specifically, depending on the content type (message-", "   header.md#content-type) of the message (message.md):", "", "   *  For non-framed data (message-body.md#non-framed-data), this value", "      MUST equal the length, in bytes, of the plaintext data provided to", "      the algorithm for encryption.", "", "   *  For framed data (message-body.md#framed-data), this value MUST", "      equal the length, in bytes, of the plaintext being encrypted in", "      this frame.", "", "      -  For regular frames (message-body.md#regular-frame), this value", "         MUST equal the value of the frame length (message-", "         header.md#frame-length) field in the message header.", "", "      -  For the final frame (message-body.md#final-frame), this value", "         MUST be greater than or equal to 0 and less than or equal to", "         the value of the frame length (message-header.md#frame-length)", "         field in the message header.", ""]}, {"id": "3", "title": "References", "lines": ["3.   Normative References", "", "   [RFC2119]  Bradner, S., \"Key words for use in RFCs to Indicate", "              Requirement Levels\", BCP 14, RFC 2119,", "              DOI 10.17487/RFC2119, March 1997,", "              <https://www.rfc-editor.org/info/rfc2119>.", "", "   [RFC8174]  Leiba, B., \"Ambiguity of Uppercase vs Lowercase in RFC", "              2119 Key Words\", BCP 14, RFC 8174, DOI 10.17487/RFC8174,", "              May 2017, <https://www.rfc-editor.org/info/rfc8174>.", "", "Acknowledgments", "", "Author's Address", "", "   Amazon AWS", "   Amazon AWS", "", "   Email: cryptools+rfc@amazon.com"]}]}, "compliance/data-format/message-footer.txt": {"requirements": [973, 974, 976], "sections": [{"id": "1", "title": "Definitions", "lines": ["1.   Conventions and Definitions", "", "   The key words \"MUST\", \"MUST NOT\", \"REQUIRED\", \"SHALL\", \"SHALL NOT\",", "   \"SHOULD\", \"SHOULD NOT\", \"RECOMMENDED\", \"NOT RECOMMENDED\", \"MAY\", and", "   \"OPTIONAL\" in this document are to be interpreted as described in BCP", "   14 [RFC2119] [RFC8174] when, and only when, they appear in all", "   capitals, as shown here", ""]}, {"id": "2", "title": "Structure", "lines": ["2.   Footer Structure", ""]}, {"id": "2.1", "title": "Version", "lines": ["2.1.   Version", "", "   See Message Version (message.md#version).", ""]}, {"id": "2.2", "title": "Implementations", "lines": ["2.2.   Implementations", "", "   *  C (https://github.com/awslabs/aws-encryption-sdk-", "      c/blob/master/source/session_encrypt.c)", "", "   *  JavaScript (https://github.com/awslabs/aws-encryption-sdk-", "      javascript/blob/master/modules/serialize/src/signature_info.ts)", "", "   *  Python (https://github.com/aws/aws-encryption-sdk-", "      python/blob/master/src/aws_encryption_sdk/internal/structures.py)", "", "   *  Java (https://github.com/aws/aws-encryption-sdk-", "      java/blob/master/src/main/java/com/amazonaws/encryptionsdk/model/", "      CiphertextFooters.java)", ""]}, {"id": "2.3", "title": "Overview", "lines": [[[[972, 973], 240, "When an algorithm suite (../framework/algorithm-suites.md) includes a signature algorithm (../framework/algorithm-suites.md#signature- algorithm), the message (message.md) MUST contain a footer."]]], "requirements": [973]}, {"id": "2.4", "title": "Definitions", "lines": ["2.4.   Definitions", ""]}, {"id": "2.4.1", "title": "document", "lines": [[[[974], 224, "The key words \"MUST\", \"MUST NOT\", \"REQUIRED\", \"SHALL\", \"SHALL NOT\", \"SHOULD\", \"SHOULD NOT\", \"RECOMMENDED\", \"MAY\", and \"OPTIONAL\" in this document are to be interpreted as described in RFC 2119 (https://tools.ietf.org/html/rfc2119)."]]], "requirements": [974]}, {"id": "2.5", "title": "Structure", "lines": ["2.5.   Structure", "", "   The following describes the fields that form the footer.", "   The bytes are appended in the order shown.", "", "          +==================+================+================+", "          | Field            | Length (bytes) | Interpreted as |", "          +==================+================+================+", "          | Signature Length | 2              | Uint16         |", "          +------------------+----------------+----------------+", "          | Signature        | Variable.      | Bytes          |", "          +------------------+----------------+----------------+", "", "                                 Table 1", ""]}, {"id": "2.5.1", "title": "Length", "lines": ["2.5.1.   Signature Length", "", "   The length of the signature.", ""]}, {"id": "2.5.2", "title": "Signature", "lines": [[[[975, 976], 240, "This signature MUST be calculated over both the message header (message-header.md) and the message body (message-body.md), in the order of serialization."]]], "requirements": [976]}, {"id": "2.6", "title": "Usage", "lines": ["2.6.   Example Usage", "", "   The following section contains examples of the footer.", ""]}, {"id": "2.6.1", "title": "Structure", "lines": ["2.6.1.   Example Pseudo-ASN.1 Structure", "", "   \"DEFINITIONS ::= BEGIN Footer SEQUENCE (SIZE(2)) { SignatureLength", "   UINT16, Signature OCTET STRING (SIZE(SignatureLength)), }\"", ""]}, {"id": "2.6.2", "title": "Bytes", "lines": ["2.6.2.   Example Bytes", "", "   \"0067 Signature Length (103) 30650230 7229DDF5 B86A5B64 54E4D627", "   Signature CBE194F1 1CC0F8CF D27B7F8B F50658C0 BE84B355 3CED1721", "   A0BE2A1B 8E3F449E 1BEB8281 023100B2 0CB323EF 58A4ACE3 1559963B", "   889F72C3 B15D1700 5FB26E61 331F3614 BC407CEE B86A66FA CBF74D9E", "   34CB7E4B 363A38\"", ""]}, {"id": "3", "title": "References", "lines": ["3.   Normative References", "", "   [RFC2119]  Bradner, S., \"Key words for use in RFCs to Indicate", "              Requirement Levels\", BCP 14, RFC 2119,", "              DOI 10.17487/RFC2119, March 1997,", "              <https://www.rfc-editor.org/info/rfc2119>.", "", "   [RFC8174]  Leiba, B., \"Ambiguity of Uppercase vs Lowercase in RFC", "              2119 Key Words\", BCP 14, RFC 8174, DOI 10.17487/RFC8174,", "              May 2017, <https://www.rfc-editor.org/info/rfc8174>.", "", "Acknowledgments", "", "Author's Address", "", "   Amazon AWS", "   Amazon AWS", "", "   Email: cryptools+rfc@amazon.com"]}]}, "compliance/data-format/message-header.txt": {"requirements": [977, 979, 981, 984, 986, 988, 990, 992, 994], "sections": [{"id": "1", "title": "Definitions", "lines": ["1.   Conventions and Definitions", "", "   The key words \"MUST\", \"MUST NOT\", \"REQUIRED\", \"SHALL\", \"SHALL NOT\",", "   \"SHOULD\", \"SHOULD NOT\", \"RECOMMENDED\", \"NOT RECOMMENDED\", \"MAY\", and", "   \"OPTIONAL\" in this document are to be interpreted as described in BCP", "   14 [RFC2119] [RFC8174] when, and only when, they appear in all", "   capitals, as shown here", ""]}, {"id": "2", "title": "Header", "lines": ["2.   Message Header", ""]}, {"id": "2.1", "title": "Version", "lines": ["2.1.   Version", "", "   0.1.1", ""]}, {"id": "2.1.1", "title": "Changelog", "lines": ["2.1.1.   Changelog", "", "   *  0.1.1", "", "      -  Include \"aws-crypto-public-key\" encryption context key.", "", "   *  0.1.0-preview", "", "      -  Initial record", ""]}, {"id": "2.2", "title": "Implementations", "lines": ["2.2.   Implementations", "", "   *  C (https://github.com/aws/aws-encryption-sdk-c/blob/master/source/", "      header.c)", "", "   *  JavaScript (https://github.com/awslabs/aws-encryption-sdk-", "      javascript/blob/master/modules/serialize/src/types.ts)", "", "   *  Python (https://github.com/aws/aws-encryption-sdk-", "      python/blob/master/src/aws_encryption_sdk/structures.py)", "", "   *  Java (https://github.com/aws/aws-encryption-sdk-", "      java/blob/master/src/main/java/com/amazonaws/encryptionsdk/model/", "      CiphertextHeaders.java)", ""]}, {"id": "2.3", "title": "Overview", "lines": ["2.3.   Overview", "", "   The message header is a component of the message (message.md).", "", "   The purpose of the message header is to define the authenticated", "   metadata required for decryption of the message body (message-", "   body.md#encrypted-content), including:", "", "   *  The format of the message (message.md) and message body (message-", "      body.md)", "", "   *  The encrypted data keys needed for decryption of the message body", "      encrypted content (message-body.md#encrypted-content)", "", "   *  The encryption context (../framework/structures.md#encryption-", "      context)", ""]}, {"id": "2.4", "title": "Definitions", "lines": ["2.4.   Definitions", ""]}, {"id": "2.4.1", "title": "document", "lines": [[[[977], 224, "The key words \"MUST\", \"MUST NOT\", \"REQUIRED\", \"SHALL\", \"SHALL NOT\", \"SHOULD\", \"SHOULD NOT\", \"RECOMMENDED\", \"MAY\", and \"OPTIONAL\" in this document are to be interpreted as described in RFC 2119 (https://tools.ietf.org/html/rfc2119)."]]], "requirements": [977]}, {"id": "2.5", "title": "Structure", "lines": ["2.5.   Structure", "", "   The message header is a sequence of bytes that MUST be in big-endian", "   format.  The following table describes the fields that form the", "   header.  The bytes are appended in the order shown.", "", "    +=======================+================+=======================+", "    | Field                 | Length (bytes) | Interpreted as        |", "    +=======================+================+=======================+", "    | Header Body           | Variable       | Header Body           |", "    | (Section 2.5.1)       |                | (Section 2.5.1)       |", "    +-----------------------+----------------+-----------------------+", "    | Header Authentication | Variable       | Header Authentication |", "    | (Section 2.5.3)       |                | (Section 2.5.3)       |", "    +-----------------------+----------------+-----------------------+", "", "                                 Table 1", ""]}, {"id": "2.5.1", "title": "Body", "lines": ["2.5.1.   Header Body", ""]}, {"id": "2.5.1.1", "title": "1.0", "lines": ["2.5.1.1.   Header Body Version 1.0", "", "   The following table describes the fields that form the Version 1.0", "   header body.  The value of the \"Version\" field MUST be \"01\" in the", "   Version 1.0 header body.  The bytes are appended in the order shown.", "", "   +===========+=====================+================================+", "   | Field     | Length (bytes)      | Interpreted as                 |", "   +===========+=====================+================================+", "   | Section   | 1                   | See Supported Versions         |", "   | 2.1       |                     | (Section 2.5.1.3.1)            |", "   +-----------+---------------------+--------------------------------+", "   | Section   | 1                   | See Supported Types            |", "   | 2.5.1.4   |                     | (Section 2.5.1.4.1)            |", "   +-----------+---------------------+--------------------------------+", "   | Algorithm | 2                   | See Supported Algorithm Suites |", "   | Suite ID  |                     | (../framework/algorithm-       |", "   | (Section  |                     | suites.md#supported-algorithm- |", "   | 2.5.1.5)  |                     | suites)                        |", "   +-----------+---------------------+--------------------------------+", "   | Message   | 16                  | Bytes                          |", "   | ID        |                     |                                |", "   | (Section  |                     |                                |", "   | 2.5.1.6)  |                     |                                |", "   +-----------+---------------------+--------------------------------+", "   | Section   | Variable.           | Section 2.5.1.7                |", "   | 2.5.1.7   | Self-describing     |                                |", "   |           | (Section 2.5.1.7).  |                                |", "   +-----------+---------------------+--------------------------------+", "   | Encrypted | Variable.           | Encrypted Data Keys            |", "   | Data Keys | Determined by the   | (Section 2.5.1.8)              |", "   | (Section  | number of encrypted |                                |", "   | 2.5.1.8)  | data keys and the   |                                |", "   |           | length of each.     |                                |", "   +-----------+---------------------+--------------------------------+", "   | Content   | 1                   | See Supported Types            |", "   | Type      |                     | (Section 2.5.1.11.1)           |", "   | (Section  |                     |                                |", "   | 2.5.1.11) |                     |                                |", "   +-----------+---------------------+--------------------------------+", "   | Section   | 4                   | See Section 2.5.2.1            |", "   | 2.5.2.1   |                     |                                |", "   +-----------+---------------------+--------------------------------+", "   | IV Length | 1                   | UInt8                          |", "   | (Section  |                     |                                |", "   | 2.5.2.2)  |                     |                                |", "   +-----------+---------------------+--------------------------------+", "   | Frame     | 4                   | UInt32                         |", "   | Length    |                     |                                |", "   | (Section  |                     |                                |", "   | 2.5.2.3)  |                     |                                |", "   +-----------+---------------------+--------------------------------+", "", "                                 Table 2", ""]}, {"id": "2.5.1.10", "title": "Entries", "lines": ["2.5.1.10.   Encrypted Data Key Entries", "", "   A sequence of one or more encrypted data key entries.", "", "   The following table describes the fields that form each encrypted", "   data key entry.  The bytes are appended in the order shown.", "", "    +=================+=================================+=============+", "    | Field           | Length, in bytes                | Interpreted |", "    |                 |                                 | as          |", "    +=================+=================================+=============+", "    | Key Provider ID | 2                               | UInt16      |", "    | Length (Section |                                 |             |", "    | 2.5.1.10.1)     |                                 |             |", "    +-----------------+---------------------------------+-------------+", "    | Key Provider ID | Variable.  Equal to the value   | UTF-8       |", "    | (Section        | specified in the previous 2     | encoded     |", "    | 2.5.1.10.2)     | bytes (Key Provider ID Length). | bytes       |", "    +-----------------+---------------------------------+-------------+", "    | Key Provider    | 2                               | UInt16      |", "    | Information     |                                 |             |", "    | Length (Section |                                 |             |", "    | 2.5.1.10.3)     |                                 |             |", "    +-----------------+---------------------------------+-------------+", "    | Key Provider    | Variable.  Equal to the value   | Bytes       |", "    | Information     | specified in the previous 2     |             |", "    | (Section        | bytes (Key Provider Information |             |", "    | 2.5.1.10.4)     | Length).                        |             |", "    +-----------------+---------------------------------+-------------+", "    | Encrypted Data  | 2                               | UInt16      |", "    | Key Length      |                                 |             |", "    | (Section        |                                 |             |", "    | 2.5.1.10.5)     |                                 |             |", "    +-----------------+---------------------------------+-------------+", "    | Encrypted Data  | Variable.  Equal to the value   | Bytes       |", "    | Key (Section    | specified in the previous 2     |             |", "    | 2.5.1.10.6)     | bytes (Encrypted Data Key       |             |", "    |                 | Length).                        |             |", "    +-----------------+---------------------------------+-------------+", "", "                                  Table 10", "", "2.5.1.10.1.  Key Provider ID Length", "", "   The length of the key provider ID.", "", "2.5.1.10.2.  Key Provider ID", "", "   The key provider ID.  See the specification for encrypted data keys", "   (../framework/structures.md#encrypted-data-key).", "", "2.5.1.10.3.  Key Provider Information Length", "", "   The length of the key provider information.", "", "2.5.1.10.4.  Key Provider Information", "", "   The key provider information.  See the specification for encrypted", "   data keys (../framework/structures.md#encrypted-data-key).", "", "2.5.1.10.5.  Encrypted Data Key Length", "", "   The length of the encrypted data key.", "", "2.5.1.10.6.  Encrypted Data Key", "", "   The encrypted data key.  It is the data key encrypted by the key", "   provider.", ""]}, {"id": "2.5.1.11", "title": "Type", "lines": ["2.5.1.11.   Content Type", "", "   The content type of the message body (message-body.md).  The value", "   (hex) of this field MUST be a value that exists in the following", "   table:", "", "2.5.1.11.1.  Supported Content Types", "", "      +=============+==============================================+", "      | Value (hex) | Content Type                                 |", "      +=============+==============================================+", "      | 01          | Non-Framed (message-body.md#non-framed-data) |", "      +-------------+----------------------------------------------+", "      | 02          | Framed (message-body.md#framed-data)         |", "      +-------------+----------------------------------------------+", "", "                                 Table 11", ""]}, {"id": "2.5.1.2", "title": "2.0", "lines": ["2.5.1.2.   Header Body Version 2.0", "", "   The following table describes the fields that form the Version 2.0", "   header body.  The value of the \"Version\" field MUST be \"02\" in the", "   Version 2.0 header body.  The bytes are appended in the order shown.", "", "   +===========+=====================+================================+", "   | Field     | Length (bytes)      | Interpreted as                 |", "   +===========+=====================+================================+", "   | Section   | 1                   | See Supported Versions         |", "   | 2.1       |                     | (Section 2.5.1.3.1)            |", "   +-----------+---------------------+--------------------------------+", "   | Algorithm | 2                   | See Supported Algorithm Suites |", "   | Suite ID  |                     | (../framework/algorithm-       |", "   | (Section  |                     | suites.md#supported-algorithm- |", "   | 2.5.1.5)  |                     | suites)                        |", "   +-----------+---------------------+--------------------------------+", "   | Message   | 32                  | Bytes                          |", "   | ID        |                     |                                |", "   | (Section  |                     |                                |", "   | 2.5.1.6)  |                     |                                |", "   +-----------+---------------------+--------------------------------+", "   | Section   | Variable.           | Section 2.5.1.7                |", "   | 2.5.1.7   | Self-describing     |                                |", "   |           | (Section 2.5.1.7).  |                                |", "   +-----------+---------------------+--------------------------------+", "   | Encrypted | Variable.           | Encrypted Data Keys            |", "   | Data Keys | Determined by the   | (Section 2.5.1.8)              |", "   | (Section  | number of encrypted |                                |", "   | 2.5.1.8)  | data keys and the   |                                |", "   |           | length of each.     |                                |", "   +-----------+---------------------+--------------------------------+", "   | Content   | 1                   | See Supported Types            |", "   | Type      |                     | (Section 2.5.1.11.1)           |", "   | (Section  |                     |                                |", "   | 2.5.1.11) |                     |                                |", "   +-----------+---------------------+--------------------------------+", "   | Frame     | 4                   | UInt32                         |", "   | Length    |                     |                                |", "   | (Section  |                     |                                |", "   | 2.5.2.3)  |                     |                                |", "   +-----------+---------------------+--------------------------------+", "   | Algorithm | Variable.           | See Algorithm Suite Data       |", "   | Suite     | Determined by the   | (../framework/algorithm-       |", "   | Data      | Algorithm Suite ID  | suites.md#algorithm-suite-     |", "   | (Section  |                     | data)                          |", "   | 2.5.2)    |                     |                                |", "   +-----------+---------------------+--------------------------------+", "", "                                 Table 3", ""]}, {"id": "2.5.1.3", "title": "Version", "lines": ["2.5.1.3.   Version", "", "   The version of the message format.  The version (hex) of this field", "   MUST be a value that exists in the following table:", "", "2.5.1.3.1.  Supported Versions", "", "                         +=============+=========+", "                         | Value (hex) | Version |", "                         +=============+=========+", "                         | 01          | 1.0     |", "                         +-------------+---------+", "                         | 02          | 2.0     |", "                         +-------------+---------+", "", "                                  Table 4", ""]}, {"id": "2.5.1.4", "title": "Type", "lines": ["2.5.1.4.   Type", "", "   The type of the message format.  The type (hex) of this field MUST be", "   a value that exists in the following table:", "", "2.5.1.4.1.  Supported Types", "", "          +=============+=======================================+", "          | Value (hex) | Type                                  |", "          +=============+=======================================+", "          | 80          | Customer Authenticated Encrypted Data |", "          +-------------+---------------------------------------+", "", "                                  Table 5", ""]}, {"id": "2.5.1.5", "title": "ID", "lines": [[[[978, 979], 232, "The value (hex) of this field MUST be a value that exists in the Supported Algorithm Suites (../framework/algorithm- suites.md#supported-algorithm-suites) table."]]], "requirements": [979]}, {"id": "2.5.1.6", "title": "ID", "lines": [[[[980, 981], 226, "A Message ID MUST uniquely identify the message (message.md)."]], [[[982, 983, 984], 244, "While implementations cannot guarantee complete uniqueness, implementations MUST use a good source of randomness when generating messages IDs in order to make the chance of duplicate IDs negligible."]]], "requirements": [981, 984]}, {"id": "2.5.1.7", "title": "AAD", "lines": ["2.5.1.7.   AAD", "", "   The Additional Authenticated Data (AAD) for the header.  This AAD is", "   an encoding of the encryption context (../framework/", "   structures.md#encryption-context).", "", "   The following table describes the fields that form the AAD.  The", "   bytes are appended in the order shown.", "", "    +=================+==============================+================+", "    | Field           | Length (bytes)               | Interpreted as |", "    +=================+==============================+================+", "    | Key Value Pairs | 2                            | UInt16         |", "    | Length (Section |                              |                |", "    | 2.5.1.7.1)      |                              |                |", "    +-----------------+------------------------------+----------------+", "    | Key Value Pairs | Variable.  Determined by the | Key Value      |", "    | (Section        | value of Key Value Pairs     | Pairs (Section |", "    | 2.5.1.7.2)      | Length (Section 2.5.1.7.1).  | 2.5.1.7.2)     |", "    +-----------------+------------------------------+----------------+", "", "                                  Table 6", "", "2.5.1.7.1.  Key Value Pairs Length", "", "   The length of the Key Value Pairs (Section 2.5.1.7.2) field in bytes.", "", "   When the encryption context (../framework/structures.md#encryption-", "   context) is empty, the value of this field MUST be 0.", "", "2.5.1.7.2.  Key Value Pairs", "", "   The encoding of the key-value pairs of the encryption context", "   (../framework/structures.md#encryption-context).  When the encryption", "   context (../framework/structures.md#encryption-context) is empty,", "   this field MUST NOT be included in the Section 2.5.1.7.", "", "   The following table describes the fields that form the Key Value", "   Pairs.  The bytes are appended in the order shown.", "", "     +==================+=========================+==================+", "     | Field            | Length (bytes)          | Interpreted as   |", "     +==================+=========================+==================+", "     | Key Value Pair   | 2                       | UInt16           |", "     | Count (Section   |                         |                  |", "     | 2.5.1.7.2.1)     |                         |                  |", "     +------------------+-------------------------+------------------+", "     | Key Value Pair   | Variable.  Determined   | Key Value Pair   |", "     | Entries (Section | by the count and length | Entries (Section |", "     | 2.5.1.7.2.2)     | of each key-value pair. | 2.5.1.7.2.2)     |", "     +------------------+-------------------------+------------------+", "", "                                  Table 7", "", "2.5.1.7.2.1.  Key Value Pair Count", "", "   The number of key-value pairs within the Key Value Pair Entries", "   (Section 2.5.1.7.2.2) field.  The value of this field MUST be greater", "   than 0.", "", "2.5.1.7.2.2.  Key Value Pair Entries", "", "   A sequence of one or more key-value pair entries.", "", "   This sequence MUST NOT contain duplicate entries.", "", "   These entries MUST have entries sorted, by key, in ascending order", "   according to the UTF-8 encoded binary value.", "", "   The following table describes the fields that form each key value", "   pair entry.  The bytes are appended in the order shown.", "", "   +========+=========================================+================+", "   | Field  | Length (bytes)                          | Interpreted    |", "   |        |                                         | as             |", "   +========+=========================================+================+", "   | Key    | 2                                       | UInt16         |", "   | Length |                                         |                |", "   +--------+-----------------------------------------+----------------+", "   | Key    | Variable.  Equal to the value specified | UTF-8 encoded  |", "   |        | in the previous 2 bytes (Key Length).   | bytes          |", "   +--------+-----------------------------------------+----------------+", "   | Value  | 2                                       | UInt16         |", "   | Length |                                         |                |", "   +--------+-----------------------------------------+----------------+", "   | Value  | Variable.  Equal to the value specified | UTF-8 encoded  |", "   |        | in the previous 2 bytes (Value Length). | bytes          |", "   +--------+-----------------------------------------+----------------+", "", "                                  Table 8", ""]}, {"id": "2.5.1.8", "title": "Keys", "lines": ["2.5.1.8.   Encrypted Data Keys", "", "   The encoding of the encrypted data keys (../framework/", "   structures.md#encrypted-data-key).", "", "   The following table describes the fields that form the encrypted data", "   keys.  The bytes are appended in the order shown.", "", "   +====================+=========================+====================+", "   | Field              | Length, in bytes        | Interpreted as     |", "   +====================+=========================+====================+", "   | Encrypted Data Key | 2                       | UInt16             |", "   | Count              |                         |                    |", "   | (Section 2.5.1.9)  |                         |                    |", "   +--------------------+-------------------------+--------------------+", "   | Encrypted Data Key | Variable.  Determined   | Encrypted Data     |", "   | Entries            | by the count and length | Key Entries        |", "   | (Section 2.5.1.10) | of each key-value pair. | (Section           |", "   |                    |                         | 2.5.1.10)          |", "   +--------------------+-------------------------+--------------------+", "", "                                  Table 9", ""]}, {"id": "2.5.1.9", "title": "Count", "lines": [[[[985, 986], 225, "This value MUST be greater than 0."]]], "requirements": [986]}, {"id": "2.5.2", "title": "Data", "lines": [[[[987, 988], 232, "The length of the suite data field MUST be equal to the Algorithm Suite Data Length (../framework/algorithm- suites.md#algorithm-suite-data-length) value of the algorithm suite (../framework/algorithm-suites.md) specified by the Algorithm Suite ID (Section 2.5.1.5) field."]]], "requirements": [988]}, {"id": "2.5.2.1", "title": "Reserved", "lines": [[[[989, 990], 232, "A reserved sequence of 4 bytes that MUST have the value (hex) of \"00 00 00 00\"."]]], "requirements": [990]}, {"id": "2.5.2.2", "title": "Length", "lines": [[[[991, 992], 240, "This value MUST be equal to the IV length (../framework/algorithm-suites.md#iv-length) value of the algorithm suite (../framework/algorithm-suites.md) specified by the Algorithm Suite ID (Section 2.5.1.5) field."]]], "requirements": [992]}, {"id": "2.5.2.3", "title": "Length", "lines": [[[[993, 994], 232, "When the content type (Section 2.5.1.11) is non- framed, the value of this field MUST be 0."]]], "requirements": [994]}, {"id": "2.5.3", "title": "Authentication", "lines": ["2.5.3.   Header Authentication", "", "   The header authentication contains fields used for authentication of", "   the header body (Section 2.5.1).", ""]}, {"id": "2.5.3.1", "title": "1.0", "lines": ["2.5.3.1.   Header Authentication Version 1.0", "", "   The following table describes the fields that form the header", "   authentication.  The bytes are appended in the order shown.", "", "   +================+====================================+=============+", "   | Field          | Length, in bytes                   | Interpreted |", "   |                |                                    | as          |", "   +================+====================================+=============+", "   | Section        | Variable.  Determined by the       | Bytes       |", "   | 2.5.3.3        | IV length value of the             |             |", "   |                | algorithm suite (../framework/     |             |", "   |                | algorithm-suites.md) specified     |             |", "   |                | by the Algorithm Suite ID          |             |", "   |                | (Section 2.5.1.5) field.           |             |", "   +----------------+------------------------------------+-------------+", "   | Authentication | Variable.  Determined by the       | Bytes       |", "   | Tag (Section   | byte value of the                  |             |", "   | 2.5.3.4)       | authentication tag of the          |             |", "   |                | algorithm suite (../framework/     |             |", "   |                | algorithm-suites.md) specified     |             |", "   |                | by the Algorithm Suite ID          |             |", "   |                | (Section 2.5.1.5) field.           |             |", "   +----------------+------------------------------------+-------------+", "", "                                  Table 12", ""]}, {"id": "2.5.3.2", "title": "2.0", "lines": ["2.5.3.2.   Header Authentication Version 2.0", "", "   The following table describes the fields that form the header", "   authentication.  The bytes are appended in the order shown.", "", "   +================+====================================+=============+", "   | Field          | Length, in bytes                   | Interpreted |", "   |                |                                    | as          |", "   +================+====================================+=============+", "   | Authentication | Variable.  Determined by the       | Bytes       |", "   | Tag (Section   | byte value of the                  |             |", "   | 2.5.3.4)       | authentication tag of the          |             |", "   |                | algorithm suite (../framework/     |             |", "   |                | algorithm-suites.md) specified     |             |", "   |                | by the Algorithm Suite ID          |             |", "   |                | (Section 2.5.1.5) field.           |             |", "   +----------------+------------------------------------+-------------+", "", "                                  Table 13", ""]}, {"id": "2.5.3.3", "title": "IV", "lines": ["2.5.3.3.   IV", "", "   The initialization vector (IV) used as input to calculate the", "   authentication tag (Section 2.5.3.4).", ""]}, {"id": "2.5.3.4", "title": "Tag", "lines": ["2.5.3.4.   Authentication Tag", "", "   The authentication value for the header.  The algorithm suite", "   (../framework/algorithm-suites.md) specified by the Algorithm Suite", "   ID (Section 2.5.1.5) field determines how the value of this field is", "   calculated (../client-apis/encrypt.md), and uses this value to", "   authenticate the contents of the header during decryption (../client-", "   apis/decrypt.md).", ""]}, {"id": "2.6", "title": "Appendix", "lines": ["2.6.   Appendix", ""]}, {"id": "2.6.1", "title": "Definition", "lines": ["2.6.1.   Example Structure Definition", "", "   Below is an example definition of the message header format described", "   in this document, described in a \"ASN.1-like\" format.", "", "   ``` DEFINITIONS ::= BEGIN", "", "   Version OCTET STRING (0x01)", "", "   Type OCTET STRING (0x80)", "", "   AlgorithmId OCTET STRING ( 0x00 0x14, 0x00 0x46, 0x00 0x78, 0x01", "   0x14, 0x01 0x46, 0x01 0x78, 0x02 0x14, 0x02 0x46, 0x02 0x78, )", "", "   MessageId OCTET STRING (SIZE(16))", "", "   KeyValuePair SEQUENCE (SIZE(4)) { KeyLength UINT16, Key UTF8String", "   (SIZE(0..2^16-1)), ValueLength UINT16, Value UTF8String", "   (SIZE(0..2^16-1)), }", "", "   AAD SEQUENCE (SIZE(1..2)) { KeyValuePairsLength UINT16, KeyValuePairs", "   SEQUENCE (SIZE(2)) { KeyValuePairCount UINT16, KeyValuePairEntries", "   SEQUENCE (SIZE(1..2^16-1)) of KeyValuePair } }", "", "   EncryptedDataKey SEQUENCE (SIZE(6)) { ProviderIdLength UINT16,", "   ProviderId UTF8String (SIZE(0..2^16-1)), KeyInfoLength UINT16,", "   KeyInfo OCTET STRING (SIZE(0..2^16-1)), EncryptedDataKeyLength", "   UINT16, EncryptedDataKey OCTET STRING (SIZE(0..2^16-1)), }", "", "   EncryptedDataKeys SEQUENCE (SIZE(2)) { EncryptedDataKeyCount UINT16,", "   EncryptedDataKeyEntries SEQUENCE (SIZE(1..2^16-1)) of", "   EncryptedDataKey }", "", "   ContentType OCTET STRING (0x01, 0x02)", "", "   Reserved OCTET STRING (0x00 0x00 0x00 0x00)", "", "   IvLength UINT8", "", "   FrameLength UINT32", "", "   HeaderBody SEQUENCE (SIZE(10)) { Version Version, Type Type,", "   AlgorithmId AlgorithmId, MessageId MessageId, AAD AAD,", "   EncryptedDataKeys EncryptedDataKeys, ContentType ContentType,", "   Reserved Reserved, IvLength IvLength, FrameLength FrameLength, }", "", "   HeaderAuth SEQUENCE (SIZE(2)) { Iv OCTET STRING, AuthTag OCTET", "   STRING, }", "", "   Header SEQUENCE (SIZE(2)) { HeaderBody HeaderBody, HeaderAuth", "   HeaderAuth, } ```", ""]}, {"id": "2.6.2", "title": "Bytes", "lines": ["2.6.2.   Example Bytes", "", "   The example below shows the raw bytes of an example header, in", "   hexadecimal notation, followed by a description of what those bytes", "   represent.", "", "   \"01 Version (1.0) 80 Type (128, customer authenticated encrypted", "   data) 0378 Algorithm Suite ID (see Algorithm Suites Reference)", "   B8929B01 753D4A45 C0217F39 404F70FF Message ID (random 128-bit value)", "   008E AAD Length (142) 0004 AAD Key-Value Pair Count (4) 0005 AAD Key-", "   Value Pair 1, Key Length (5) 30746869 73 AAD Key-Value Pair 1, Key", "   (\"0This\") 0002 AAD Key-Value Pair 1, Value Length (2) 6973 AAD Key-", "   Value Pair 1, Value (\"is\") 0003 AAD Key-Value Pair 2, Key Length (3)", "   31616E AAD Key-Value Pair 2, Key (\"1an\") 000A AAD Key-Value Pair 2,", "   Value Length (10) 656E6372 79774690 6F6E AAD Key-Value Pair 2, Value", "   (\"encryption\") 0008 AAD Key-Value Pair 3, Key Length (8) 32636F6E", "   74657874 AAD Key-Value Pair 3, Key (\"2context\") 0007 AAD Key-Value", "   Pair 3, Value Length (7) 6578616D 706C65 AAD Key-Value Pair 3, Value", "   (\"example\") 0015 AAD Key-Value Pair 4, Key Length (21) 6177732D", "   63727970 746F2D70 75626C69 AAD Key-Value Pair 4, Key (\"aws-crypto-", "   public-key\") 632D6B65 79 0044 AAD Key-Value Pair 4, Value Length (68)", "   41734738 67473949 6E4C5075 3136594B AAD Key-Value Pair 4, Value (\"AsG", "   8gG9InLPu16YKlqXTOD+nykG8YqHAhqecj8aXfD2e5B4gtVE73dZkyClA+rAMOQ==\")", "   6C715854 4F442B6E 796B4738 59714841 68716563 6A386158 66443265", "   35423467 74564537 33645A6B 79436C41 2B72414D 4F513D3D 0002 Encrypted", "   Data Key Count (2) 0007 Encrypted Data Key 1, Key Provider ID Length", "   (7) 6177732D 6B6D73 Encrypted Data Key 1, Key Provider ID (\"aws-kms\")", "   004B Encrypted Data Key 1, Key Provider Information Length (75)", "   61726E3A 6177733A 6B6D733A 75732D77 Encrypted Data Key 1, Key", "   Provider Information (\"arn:aws:kms:us-west-", "   2:111122223333:key/715c0818-5825-4245-a755-138a6d9a11e6\") 6573742D", "   323A3131 31313232 32323333 33333A6B 65792F37 31356330 3831382D", "   35383235 2D343234 352D6137 35352D31 33386136 64396131 316536 00A7", "   Encrypted Data Key 1, Encrypted Data Key Length (167) 01010200", "   7857A1C1 F7370545 4ECA7C83 Encrypted Data Key 1, Encrypted Data Key", "   956C4702 23DCE8D7 16C59679 973E3CED 02A4EF29 7F000000 7E307C06", "   092A8648 86F70D01 0706A06F 306D0201 00306806 092A8648 86F70D01", "   0701301E 06096086 48016503 04012E30 11040C28 4116449A 0F2A0383", "   659EF802 0110803B B23A8133 3A33605C 48840656 C38BCB1F 9CCE7369", "   E9A33EBE 33F46461 0591FECA 947262F3 418E1151 21311A75 E575ECC5", "   61A286E0 3E2DEBD5 CB005D 0007 Encrypted Data Key 2, Key Provider ID", "   Length (7) 6177732D 6B6D73 Encrypted Data Key 2, Key Provider ID", "   (\"aws-kms\") 004E Encrypted Data Key 2, Key Provider Information", "   Length (78) 61726E3A 6177733A 6B6D733A 63612D63 Encrypted Data Key 2,", "   Key Provider Information (\"arn:aws:kms:ca-central-", "   1:111122223333:key/9b13ca4b-afcc-46a8-aa47-be3435b423ff\") 656E7472", "   616C2D31 3A313131 31323232 32333333 333A6B65 792F3962 31336361", "   34622D61 6663632D 34366138 2D616134 372D6265 33343335 62343233 6666", "   00A7 Encrypted Data Key 2, Encrypted Data Key Length (167) 01010200", "   78FAFFFB D6DE06AF AC72F79B Encrypted Data Key 2, Encrypted Data Key", "   0E57BD87 3F60F4E6 FD196144 5A002C94 AF787150 69000000 7E307C06", "   092A8648 86F70D01 0706A06F 306D0201 00306806 092A8648 86F70D01", "   0701301E 06096086 48016503 04012E30 11040CB2 A820D0CC 76616EF2", "   A6B30D02 0110803B 8073D0F1 FDD01BD9 B0979082 099FDBFC F7B13548", "   3CC686D7 F3CF7C7A CCC52639 122A1495 71F18A46 80E2C43F A34C0E58", "   11D05114 2A363C2A E11397 01 Content Type (1, non-framed data)", "   00000000 Reserved 0C IV Length (12) 00000000 Frame Length (0, non-", "   framed data) 734C1BBE 032F7025 84CDA9D0 IV 2C82BB23 4CBF4AAB 8F5C6002", "   622E886C Authentication Tag\"", ""]}, {"id": "3", "title": "References", "lines": ["3.   Normative References", "", "   [RFC2119]  Bradner, S., \"Key words for use in RFCs to Indicate", "              Requirement Levels\", BCP 14, RFC 2119,", "              DOI 10.17487/RFC2119, March 1997,", "              <https://www.rfc-editor.org/info/rfc2119>.", "", "   [RFC8174]  Leiba, B., \"Ambiguity of Uppercase vs Lowercase in RFC", "              2119 Key Words\", BCP 14, RFC 8174, DOI 10.17487/RFC8174,", "              May 2017, <https://www.rfc-editor.org/info/rfc8174>.", "", "Acknowledgments", "", "Author's Address", "", "   Amazon AWS", "   Amazon AWS", "", "   Email: cryptools+rfc@amazon.com"]}]}}, "annotations": [{"source": "compliance/framework/keyring-interface.txt", "target_path": "compliance/framework/keyring-interface.txt", "target_section": "2.3", "type": "SPEC", "level": "MUST", "comment": "\n   The keyring interface specified in this document describes the\n   interface all keyrings MUST implement.\n"}, {"source": "compliance/framework/keyring-interface.txt", "target_path": "compliance/framework/keyring-interface.txt", "target_section": "2.4.1", "type": "SPEC", "level": "MUST", "comment": "\n\n   The key words \"MUST\", \"MUST NOT\", \"REQUIRED\", \"SHALL\", \"SHALL NOT\",\n   \"SHOULD\", \"SHOULD NOT\", \"RECOMMENDED\", \"MAY\", and \"OPTIONAL\" in this\n   document are to be interpreted as described in RFC 2119\n   (https://tools.ietf.org/html/rfc2119).\n"}, {"source": "compliance/framework/keyring-interface.txt", "target_path": "compliance/framework/keyring-interface.txt", "target_section": "2.4.2", "type": "SPEC", "level": "MUST", "comment": "\n   The key namespace MUST be a string value.\n"}, {"source": "compliance/framework/keyring-interface.txt", "target_path": "compliance/framework/keyring-interface.txt", "target_section": "2.4.3", "type": "SPEC", "level": "MUST", "comment": "\n   The key name MUST be a string value.\n"}, {"source": "compliance/framework/keyring-interface.txt", "target_path": "compliance/framework/keyring-interface.txt", "target_section": "2.4.4", "type": "SPEC", "level": "MUST", "comment": "\n   The key provider ID MUST be a binary value and SHOULD be equal to a\n   UTF-8 encoding of the key namespace.\n"}, {"source": "compliance/framework/keyring-interface.txt", "target_path": "compliance/framework/keyring-interface.txt", "target_section": "2.4.4", "type": "SPEC", "level": "MUST", "comment": "\n   This value MUST NOT be \"aws-kms\" unless this encrypted data key was\n   produced by the AWS KMS Keyring (kms-keyring.md).\n"}, {"source": "compliance/framework/keyring-interface.txt", "target_path": "compliance/framework/keyring-interface.txt", "target_section": "2.4.5", "type": "SPEC", "level": "MUST", "comment": "\n   The key provider info MUST be a binary value and SHOULD be equal to a\n   UTF-8 encoding of the key name.\n"}, {"source": "compliance/framework/keyring-interface.txt", "target_path": "compliance/framework/keyring-interface.txt", "target_section": "2.6.1", "type": "SPEC", "level": "MAY", "comment": "   This interface takes encryption materials (structures.md#encryption-\n   materials) as input and MAY modify it with any of the following\n   behaviors:\n"}, {"source": "compliance/framework/keyring-interface.txt", "target_path": "compliance/framework/keyring-interface.txt", "target_section": "2.6.1", "type": "SPEC", "level": "MUST", "comment": "   If this keyring attempted any of the above behaviors, and\n   successfully completed those behaviors, it MUST output the modified\n   encryption materials (structures.md#encryption-materials).\n"}, {"source": "compliance/framework/keyring-interface.txt", "target_path": "compliance/framework/keyring-interface.txt", "target_section": "2.6.1", "type": "SPEC", "level": "MUST", "comment": "\n   If the keyring did not attempt any of the above behaviors, it MUST\n   fail and it MUST NOT modify the encryption materials\n   (structures.md#encryption-materials).\n"}, {"source": "compliance/framework/keyring-interface.txt", "target_path": "compliance/framework/keyring-interface.txt", "target_section": "2.6.1.1", "type": "SPEC", "level": "MAY", "comment": "\n\n   If the encryption materials (structures.md#encryption-materials) do\n   not contain a plaintext data key, OnEncrypt MAY generate a data key.\n"}, {"source": "compliance/framework/keyring-interface.txt", "target_path": "compliance/framework/keyring-interface.txt", "target_section": "2.6.1.1", "type": "SPEC", "level": "MUST", "comment": "   If the encryption materials contain a plaintext data key, OnEncrypt\n   MUST NOT generate a data key.\n"}, {"source": "compliance/framework/keyring-interface.txt", "target_path": "compliance/framework/keyring-interface.txt", "target_section": "2.6.1.1", "type": "SPEC", "level": "MAY", "comment": "\n   Generate Data Key MAY modify the following fields in the encryption\n   materials (structures.md#encryption-materials):\n"}, {"source": "compliance/framework/keyring-interface.txt", "target_path": "compliance/framework/keyring-interface.txt", "target_section": "2.6.1.1", "type": "SPEC", "level": "MUST", "comment": "\n   The length of the output plaintext data key MUST be equal to the KDF\n   input length of the algorithm suite (algorithm-suites.md) specified\n   in the encryption materials (structures.md#encryption-materials).\n"}, {"source": "compliance/framework/keyring-interface.txt", "target_path": "compliance/framework/keyring-interface.txt", "target_section": "2.6.1.1", "type": "SPEC", "level": "MUST", "comment": "   The value of the plaintext data key MUST consist of cryptographically\n   secure (pseudo-)random bits.\n"}, {"source": "compliance/framework/keyring-interface.txt", "target_path": "compliance/framework/keyring-interface.txt", "target_section": "2.6.1.1", "type": "SPEC", "level": "MAY", "comment": "\n   Note: If the keyring successfully performs this behavior, this means\n   that the keyring MAY then perform the Encrypt Data Key\n   (Section 2.6.1.2) behavior.\n"}, {"source": "compliance/framework/keyring-interface.txt", "target_path": "compliance/framework/keyring-interface.txt", "target_section": "2.6.1.2", "type": "SPEC", "level": "MAY", "comment": "\n\n   If the encryption materials (structures.md#encryption-materials)\n   contain a plaintext data key, OnEncrypt MAY encrypt a data key. "}, {"source": "compliance/framework/keyring-interface.txt", "target_path": "compliance/framework/keyring-interface.txt", "target_section": "2.6.1.2", "type": "SPEC", "level": "MUST", "comment": " If\n   the encryption materials do not contain a plaintext data key,\n   OnEncrypt MUST NOT encrypt a data key.\n"}, {"source": "compliance/framework/keyring-interface.txt", "target_path": "compliance/framework/keyring-interface.txt", "target_section": "2.6.1.2", "type": "SPEC", "level": "MAY", "comment": "\n   Encrypt Data Key MAY modify the following fields in the encryption\n   materials (structures.md#encryption-materials):\n"}, {"source": "compliance/framework/keyring-interface.txt", "target_path": "compliance/framework/keyring-interface.txt", "target_section": "2.6.1.2", "type": "SPEC", "level": "MUST", "comment": "\n   The encrypted data keys (structures.md#encrypted-data-key) produced\n   by this keyring MUST have ciphertexts (structures.md#ciphertext) that\n   can be decrypted to the plaintext data key in the encryption\n   materials (structures.md#encryption-materials).\n"}, {"source": "compliance/framework/keyring-interface.txt", "target_path": "compliance/framework/keyring-interface.txt", "target_section": "2.6.2", "type": "SPEC", "level": "MAY", "comment": "   This interface takes decryption materials (structures.md#decryption-\n   materials) and a list of encrypted data keys\n   (structures.md#encrypted-data-key) as input and MAY modify it with\n   the following behavior:\n"}, {"source": "compliance/framework/keyring-interface.txt", "target_path": "compliance/framework/keyring-interface.txt", "target_section": "2.6.2", "type": "SPEC", "level": "MUST", "comment": "   If the decryption materials already contain a plaintext data key, the\n   keyring MUST fail and MUST NOT modify the decryption materials\n   (structures.md#decryption-materials).\n"}, {"source": "compliance/framework/keyring-interface.txt", "target_path": "compliance/framework/keyring-interface.txt", "target_section": "2.6.2", "type": "SPEC", "level": "MUST", "comment": "\n   If this keyring attempted the above behavior, and succeeded, it MUST\n   output the modified decryption materials (structures.md#decryption-\n   materials).\n"}, {"source": "compliance/framework/keyring-interface.txt", "target_path": "compliance/framework/keyring-interface.txt", "target_section": "2.6.2", "type": "SPEC", "level": "MUST", "comment": "\n   If the keyring did not attempt the above behavior, the keyring MUST\n   fail and MUST NOT modify the decryption materials\n   (structures.md#decryption-materials).\n"}, {"source": "compliance/framework/keyring-interface.txt", "target_path": "compliance/framework/keyring-interface.txt", "target_section": "2.6.2.1", "type": "SPEC", "level": "MUST", "comment": "\n\n   If the encryption materials do contain a plaintext data key,\n   OnDecrypt MUST NOT decrypt a data key. "}, {"source": "compliance/framework/keyring-interface.txt", "target_path": "compliance/framework/keyring-interface.txt", "target_section": "2.6.2.1", "type": "SPEC", "level": "MAY", "comment": " If the decryption materials\n   (structures.md#decryption-materials) do not include a plaintext data\n   key, OnDecrypt MAY decrypt a data key.\n"}, {"source": "compliance/framework/keyring-interface.txt", "target_path": "compliance/framework/keyring-interface.txt", "target_section": "2.6.2.1", "type": "SPEC", "level": "MAY", "comment": "\n   The decrypt data key MAY modify the following fields in the\n   decryption materials (structures.md#decryption-materials):\n"}, {"source": "compliance/framework/keyring-interface.txt", "target_path": "compliance/framework/keyring-interface.txt", "target_section": "2.6.2.1", "type": "SPEC", "level": "SHOULD", "comment": "\n   If the keyring is able to succesfully get at least one plaintext data\n   key from any encrypted data key (structures.md#encrypted-data-key)\n   and the decryption materials (structures.md#decryption-materials)\n   still do not include a plaintext data key, it SHOULD set one\n   resulting plaintext data key on the decryption materials\n   (structures.md#decryption-materials).\n"}, {"source": "compliance/framework/keyring-interface.txt", "target_path": "compliance/framework/keyring-interface.txt", "target_section": "2.6.2.1", "type": "SPEC", "level": "MUST", "comment": "\n   If the keyring is unable to get any plaintext data key using the\n   input encrypted data keys (structures.md#encrypted-data-key), the\n   keyring MUST NOT not update the decryption materials\n   (structures.md#decryption-materials) and MUST return failure.\n"}, {"source": "compliance/framework/keyring-interface.txt", "target_path": "compliance/framework/keyring-interface.txt", "target_section": "2.7", "type": "SPEC", "level": "SHOULD", "comment": "\n\n   Keyring implementations SHOULD provide integrity guarantees for the\n   encrypted data keys (structures.md#encrypted-data-key) they return on\n   Section 2.6.1 such that tampered versions of those encrypted data\n   keys, if input into Section 2.6.2, are overwhelmingly likely to cause\n   a decryption failure (i.e. the chance of a successful decryption in\n   this case is negligible).\n"}, {"source": "compliance/framework/keyring-interface.txt", "target_path": "compliance/framework/keyring-interface.txt", "target_section": "2.7", "type": "SPEC", "level": "SHOULD", "comment": "\n   Such integrity guarantees SHOULD include the integrity of the\n   encryption context (structures.md#encryption-context) such that, if\n   the encryption context used as input to OnEncrypt to produce an\n   encrypted data key is different than the encryption context input to\n   OnDecrypt to decrypt that encrypted data key, the decryption is\n   overwhelmingly likely to fail.\n"}, {"source": "compliance/framework/keyring-interface.txt", "target_path": "compliance/framework/keyring-interface.txt", "target_section": "2.7", "type": "SPEC", "level": "SHOULD", "comment": "\n   Users SHOULD use a keyring that protects wrapping keys and performs\n   cryptographic operations within a secure boundary. "}, {"source": "compliance/framework/keyring-interface.txt", "target_path": "compliance/framework/keyring-interface.txt", "target_section": "2.7", "type": "SPEC", "level": "MAY", "comment": "   The raw AES keyring (raw-aes-keyring.md) and raw RSA keyring (raw-\n   rsa-keyring.md) MAY be used, however users should refer to their\n   specification for notes on their respective security considerations.\n"}, {"source": "compliance/framework/keyring-interface.txt", "target_path": "compliance/framework/keyring-interface.txt", "target_section": "2.8.2", "type": "SPEC", "level": "SHOULD", "comment": "\n   Due to this simplified architecture, master keys and master key\n   providers are going to be deprecated in the future, and new\n   implementations SHOULD use keyrings.\n"}, {"source": "compliance/framework/local-cryptographic-materials-cache.txt", "target_path": "compliance/framework/local-cryptographic-materials-cache.txt", "target_section": "2.4.1", "type": "SPEC", "level": "MUST", "comment": "\n\n   The key words \"MUST\", \"MUST NOT\", \"REQUIRED\", \"SHALL\", \"SHALL NOT\",\n   \"SHOULD\", \"SHOULD NOT\", \"RECOMMENDED\", \"MAY\", and \"OPTIONAL\" in this\n   document are to be interpreted as described in RFC 2119\n   (https://tools.ietf.org/html/rfc2119).\n"}, {"source": "compliance/framework/local-cryptographic-materials-cache.txt", "target_path": "compliance/framework/local-cryptographic-materials-cache.txt", "target_section": "2.4.2", "type": "SPEC", "level": "MUST", "comment": "\n\n   Each cache entry has a time-to-live (TTL) field that represents a\n   point in time at which the cache entry MUST be considered invalid.\n"}, {"source": "compliance/framework/local-cryptographic-materials-cache.txt", "target_path": "compliance/framework/local-cryptographic-materials-cache.txt", "target_section": "2.4.2", "type": "SPEC", "level": "MUST", "comment": "   After a cache entry's TTL has elapsed, we say that the entry is _TTL-\n   expired_, and the local CMC MUST NOT return the entry to any caller.\n"}, {"source": "compliance/framework/local-cryptographic-materials-cache.txt", "target_path": "compliance/framework/local-cryptographic-materials-cache.txt", "target_section": "2.5", "type": "SPEC", "level": "MUST", "comment": "   On initialization of the local CMC, the caller MUST provide the\n   following:\n"}, {"source": "compliance/framework/local-cryptographic-materials-cache.txt", "target_path": "compliance/framework/local-cryptographic-materials-cache.txt", "target_section": "2.5", "type": "SPEC", "level": "MUST", "comment": " The local CMC MUST also define the following:\n"}, {"source": "compliance/framework/local-cryptographic-materials-cache.txt", "target_path": "compliance/framework/local-cryptographic-materials-cache.txt", "target_section": "2.5.1", "type": "SPEC", "level": "MUST", "comment": " The local CMC MUST NOT store more entries than this\n   value, except temporarily while performing a Put Cache Entry\n   operation. "}, {"source": "compliance/framework/local-cryptographic-materials-cache.txt", "target_path": "compliance/framework/local-cryptographic-materials-cache.txt", "target_section": "2.5.1", "type": "SPEC", "level": "MUST", "comment": " The local CMC MUST accept entry capacity values between\n   zero and an implementation-defined maximum, inclusive.\n"}, {"source": "compliance/framework/local-cryptographic-materials-cache.txt", "target_path": "compliance/framework/local-cryptographic-materials-cache.txt", "target_section": "2.5.2", "type": "SPEC", "level": "MUST", "comment": "\n\n   The _entry pruning tail size_ is the number of least recently used\n   entries that the local CMC MUST check during Section 2.7 for TTL-\n   expired entries to evict.\n"}, {"source": "compliance/framework/local-cryptographic-materials-cache.txt", "target_path": "compliance/framework/local-cryptographic-materials-cache.txt", "target_section": "2.6.1", "type": "SPEC", "level": "MUST", "comment": "\n\n   When calling the Put Cache Entry operation, the caller MUST provide a\n   time delta value, which the local CMC uses to derive the cache\n   entry's time-to-live (TTL) value. "}, {"source": "compliance/framework/local-cryptographic-materials-cache.txt", "target_path": "compliance/framework/local-cryptographic-materials-cache.txt", "target_section": "2.6.1", "type": "SPEC", "level": "MUST", "comment": " The local CMC MUST NOT return any\n   TTL-expired entry.\n"}, {"source": "compliance/framework/local-cryptographic-materials-cache.txt", "target_path": "compliance/framework/local-cryptographic-materials-cache.txt", "target_section": "2.6.1", "type": "SPEC", "level": "MUST", "comment": "\n   When performing a Put Cache Entry operation, the local CMC MUST prune\n   TTL-expired cache entries (Section 2.7).\n"}, {"source": "compliance/framework/local-cryptographic-materials-cache.txt", "target_path": "compliance/framework/local-cryptographic-materials-cache.txt", "target_section": "2.6.1", "type": "SPEC", "level": "MAY", "comment": "\n   While performing a Put Cache Entry operation, the local CMC MAY store\n   more entries than the entry capacity. "}, {"source": "compliance/framework/local-cryptographic-materials-cache.txt", "target_path": "compliance/framework/local-cryptographic-materials-cache.txt", "target_section": "2.6.1", "type": "SPEC", "level": "MUST", "comment": " However, before returning the\n   inserted cache entry, the local CMC MUST evict least-recently used\n   entries until the number of stored entries does not exceed the entry\n   capacity.\n"}, {"source": "compliance/framework/local-cryptographic-materials-cache.txt", "target_path": "compliance/framework/local-cryptographic-materials-cache.txt", "target_section": "2.6.2", "type": "SPEC", "level": "MUST", "comment": "\n\n   When performing a Get Cache Entry operation, the local CMC MUST prune\n   TTL-expired cache entries (Section 2.7). "}, {"source": "compliance/framework/local-cryptographic-materials-cache.txt", "target_path": "compliance/framework/local-cryptographic-materials-cache.txt", "target_section": "2.6.2", "type": "SPEC", "level": "MUST", "comment": " The local CMC MUST NOT\n   return any TTL-expired entry.\n"}, {"source": "compliance/framework/local-cryptographic-materials-cache.txt", "target_path": "compliance/framework/local-cryptographic-materials-cache.txt", "target_section": "2.7", "type": "SPEC", "level": "MUST", "comment": "\n\n   To prune TTL-expired cache entries, the local CMC MUST evict all TTL-\n   expired entries among the \"N\" least recently used entries, where \"N\"\n   is the Entry Pruning Tail Size (Section 2.5.2).\n"}, {"source": "compliance/framework/local-cryptographic-materials-cache.txt", "target_path": "compliance/framework/local-cryptographic-materials-cache.txt", "target_section": "2.7", "type": "SPEC", "level": "SHOULD", "comment": "\n   The local CMC SHOULD also periodically evict all TTL-expired entries\n   among the \"N\" least recently used entries.\n"}, {"source": "compliance/framework/cryptographic-materials-cache.txt", "target_path": "compliance/framework/cryptographic-materials-cache.txt", "target_section": "2.3", "type": "SPEC", "level": "MUST", "comment": " This document describes the\n   interface that all CMCs MUST implement.\n"}, {"source": "compliance/framework/cryptographic-materials-cache.txt", "target_path": "compliance/framework/cryptographic-materials-cache.txt", "target_section": "2.4.1", "type": "SPEC", "level": "MUST", "comment": "\n\n   The key words \"MUST\", \"MUST NOT\", \"REQUIRED\", \"SHALL\", \"SHALL NOT\",\n   \"SHOULD\", \"SHOULD NOT\", \"RECOMMENDED\", \"MAY\", and \"OPTIONAL\" in this\n   document are to be interpreted as described in RFC 2119\n   (https://tools.ietf.org/html/rfc2119).\n"}, {"source": "compliance/framework/cryptographic-materials-cache.txt", "target_path": "compliance/framework/cryptographic-materials-cache.txt", "target_section": "2.7.1", "type": "SPEC", "level": "MUST", "comment": " This operation MUST NOT return the\n   inserted cache entry.\n"}, {"source": "compliance/framework/cryptographic-materials-cache.txt", "target_path": "compliance/framework/cryptographic-materials-cache.txt", "target_section": "2.7.2", "type": "SPEC", "level": "MUST", "comment": " The CMC\n   MUST validate that the cache entry is valid prior to returning the\n   cache entry. "}, {"source": "compliance/framework/algorithm-suites.txt", "target_path": "compliance/framework/algorithm-suites.txt", "target_section": "2.3", "type": "SPEC", "level": "MUST", "comment": " The algorithm suite defines the behaviors the AWS\n   Encryption SDK MUST follow for cryptographic operations.\n"}, {"source": "compliance/framework/algorithm-suites.txt", "target_path": "compliance/framework/algorithm-suites.txt", "target_section": "2.4.1", "type": "SPEC", "level": "MUST", "comment": "\n\n   The key words \"MUST\", \"MUST NOT\", \"REQUIRED\", \"SHALL\", \"SHALL NOT\",\n   \"SHOULD\", \"SHOULD NOT\", \"RECOMMENDED\", \"MAY\", and \"OPTIONAL\" in this\n   document are to be interpreted as described in RFC 2119\n   (https://tools.ietf.org/html/rfc2119).\n"}, {"source": "compliance/framework/algorithm-suites.txt", "target_path": "compliance/framework/algorithm-suites.txt", "target_section": "2.4.3", "type": "SPEC", "level": "MUST", "comment": "\n   If specified to use GCM, the AWS Encryption SDK MUST use GCM with the\n   following specifics:\n"}, {"source": "compliance/framework/algorithm-suites.txt", "target_path": "compliance/framework/algorithm-suites.txt", "target_section": "2.4.4", "type": "SPEC", "level": "MUST", "comment": "\n   The Identity KDF MUST take a byte sequence as input, and MUST return\n   the input, unchanged, as output.\n"}, {"source": "compliance/framework/algorithm-suites.txt", "target_path": "compliance/framework/algorithm-suites.txt", "target_section": "2.4.4", "type": "SPEC", "level": "MUST", "comment": "\n   If included in the algorithm suite, the algorithm suite's encryption\n   key length MUST equal the algorithm suite's key derivation input\n   length (Section 2.10.8).\n"}, {"source": "compliance/framework/algorithm-suites.txt", "target_path": "compliance/framework/algorithm-suites.txt", "target_section": "2.4.5.1", "type": "SPEC", "level": "MUST", "comment": "   If an algorithm suite uses HKDF to derive the encryption key the AWS\n   Encryption SDK MUST use HKDF with the following specifics:\n"}, {"source": "compliance/framework/algorithm-suites.txt", "target_path": "compliance/framework/algorithm-suites.txt", "target_section": "2.4.5.2", "type": "SPEC", "level": "MUST", "comment": "   If an algorithm suite uses HKDF to derive the commitment key the AWS\n   Encryption SDK MUST use HKDF with the following specifics:\n"}, {"source": "compliance/framework/algorithm-suites.txt", "target_path": "compliance/framework/algorithm-suites.txt", "target_section": "2.4.5.2", "type": "SPEC", "level": "SHOULD", "comment": "   For algorithm suites that support commitment, the AWS Encryption SDK\n   SHOULD only perform the extract step once and use the same output\n   from the extract step for both the encryption key and the commitment\n   key.\n"}, {"source": "compliance/framework/algorithm-suites.txt", "target_path": "compliance/framework/algorithm-suites.txt", "target_section": "2.4.5.2", "type": "SPEC", "level": "MUST", "comment": "\n   Verification of the commitment key MUST be a constant time\n   comparison.\n"}, {"source": "compliance/framework/algorithm-suites.txt", "target_path": "compliance/framework/algorithm-suites.txt", "target_section": "2.4.6", "type": "SPEC", "level": "MUST", "comment": "\n   If specified to use ECDSA, the AWS Encryption SDK MUST use ECDSA with\n   the following specifics:\n"}, {"source": "compliance/framework/algorithm-suites.txt", "target_path": "compliance/framework/algorithm-suites.txt", "target_section": "2.10.2", "type": "SPEC", "level": "MUST", "comment": "\n   The length of the input encryption key MUST equal the encryption key\n   length (Section 2.10.4) specified by the algorithm suite.\n"}, {"source": "compliance/framework/algorithm-suites.txt", "target_path": "compliance/framework/algorithm-suites.txt", "target_section": "2.10.3", "type": "SPEC", "level": "MUST", "comment": "\n   The length of the input IV MUST equal the IV length specified by the\n   algorithm suite. "}, {"source": "compliance/framework/algorithm-suites.txt", "target_path": "compliance/framework/algorithm-suites.txt", "target_section": "2.10.3", "type": "SPEC", "level": "MUST", "comment": " The length of the authentication tag MUST equal the\n   authentication tag length specified by the algorithm suite.\n"}, {"source": "compliance/framework/algorithm-suites.txt", "target_path": "compliance/framework/algorithm-suites.txt", "target_section": "2.10.7", "type": "SPEC", "level": "MUST", "comment": " The specified KDF\n   algorithm MUST be used to generate the encryption algorithm\n   encryption key input.\n"}, {"source": "compliance/framework/algorithm-suites.txt", "target_path": "compliance/framework/algorithm-suites.txt", "target_section": "2.10.11", "type": "SPEC", "level": "MUST", "comment": " The specified KDF\n   algorithm MUST be used to generate the commit key (Section 2.10.10).\n"}, {"source": "compliance/framework/algorithm-suites.txt", "target_path": "compliance/framework/algorithm-suites.txt", "target_section": "2.10.16", "type": "SPEC", "level": "MAY", "comment": " The field MAY be length 0.\n"}, {"source": "compliance/framework/default-cmm.txt", "target_path": "compliance/framework/default-cmm.txt", "target_section": "2.4.1", "type": "SPEC", "level": "MUST", "comment": "\n\n   The key words \"MUST\", \"MUST NOT\", \"REQUIRED\", \"SHALL\", \"SHALL NOT\",\n   \"SHOULD\", \"SHOULD NOT\", \"RECOMMENDED\", \"MAY\", and \"OPTIONAL\" in this\n   document are to be interpreted as described in RFC 2119\n   (https://tools.ietf.org/html/rfc2119).\n"}, {"source": "compliance/framework/default-cmm.txt", "target_path": "compliance/framework/default-cmm.txt", "target_section": "2.5", "type": "SPEC", "level": "MUST", "comment": "   On default CMM initialization, the caller MUST provide the following\n   value:\n"}, {"source": "compliance/framework/default-cmm.txt", "target_path": "compliance/framework/default-cmm.txt", "target_section": "2.6.1", "type": "SPEC", "level": "SHOULD", "comment": " Adding the key \"aws-crypto-public-key\" SHOULD be done\n   to a copy of the encryption context so that the caller's encryption\n   context is not mutated. "}, {"source": "compliance/framework/default-cmm.txt", "target_path": "compliance/framework/default-cmm.txt", "target_section": "2.6.1", "type": "SPEC", "level": "MUST", "comment": " If the encryption context included in the\n   encryption materials request (cmm-interface.md#encryption-materials-\n   request) already contains the \"aws-crypto-public-key\" key, this\n   operation MUST fail rather than overwrite the associated value.\n"}, {"source": "compliance/framework/default-cmm.txt", "target_path": "compliance/framework/default-cmm.txt", "target_section": "2.6.1", "type": "SPEC", "level": "MUST", "comment": "   If the algorithm suite contains a signing algorithm (algorithm-\n   suites.md#signature-algorithm), the default CMM MUST Generate a\n   signing key (structures.md#signing-key).\n"}, {"source": "compliance/framework/default-cmm.txt", "target_path": "compliance/framework/default-cmm.txt", "target_section": "2.6.1", "type": "SPEC", "level": "MUST", "comment": "\n   If the algorithm suite contains a signing algorithm (algorithm-\n   suites.md#signature-algorithm), the default CMM MUST Add the key-\n   value pair of key \"aws-crypto-public-key\", value \"base64-encoded\n   public verification key\" to the encryption context\n   (structures.md#encryption-context).\n"}, {"source": "compliance/framework/default-cmm.txt", "target_path": "compliance/framework/default-cmm.txt", "target_section": "2.6.1", "type": "SPEC", "level": "MUST", "comment": "\n   On each call to Get Encryption Materials, the default CMM MUST make a\n   call to its keyring's (Section 2.5.1) On Encrypt (keyring-\n   interface.md#onencrypt) operation.\n"}, {"source": "compliance/framework/default-cmm.txt", "target_path": "compliance/framework/default-cmm.txt", "target_section": "2.6.1", "type": "SPEC", "level": "MUST", "comment": "\n   The default CMM MUST obtain the Plaintext Data Key from the On\n   Encrypt Response and include it in the encryption materials\n   (structures.md#encryption-materials) returned.\n"}, {"source": "compliance/framework/default-cmm.txt", "target_path": "compliance/framework/default-cmm.txt", "target_section": "2.6.1", "type": "SPEC", "level": "MUST", "comment": "\n   The default CMM MUST obtain the Encrypted Data Keys\n   (structures.md#encrypted-data-keys) from the On Encrypt Response and\n   include it in the encryption materials (structures.md#encryption-\n   materials) returned.\n"}, {"source": "compliance/framework/default-cmm.txt", "target_path": "compliance/framework/default-cmm.txt", "target_section": "2.6.2", "type": "SPEC", "level": "MUST", "comment": "\n\n   If the algorithm suite contains a signing algorithm (algorithm-\n   suites.md#signature-algorithm), the default CMM MUST extract the\n   verification key from the encryption context under the reserved \"aws-\n   crypto-public-key\" key. "}, {"source": "compliance/framework/default-cmm.txt", "target_path": "compliance/framework/default-cmm.txt", "target_section": "2.6.2", "type": "SPEC", "level": "MUST", "comment": " If this key is not present in the encryption\n   context, the operation MUST fail without returning any decryption\n   materials.\n"}, {"source": "compliance/framework/default-cmm.txt", "target_path": "compliance/framework/default-cmm.txt", "target_section": "2.6.2", "type": "SPEC", "level": "MUST", "comment": "\n   If the algorithm suite does not contain a signing algorithm\n   (algorithm-suites.md#signature-algorithm), but the encryption context\n   includes the reserved \"aws-crypto-public-key\" key, the operation MUST\n   fail without returning any decryption materials.\n"}, {"source": "src/AwsCryptographicMaterialProviders/CMMs/DefaultCMM.dfy", "target_path": "compliance/framework/default-cmm.txt", "target_section": "2.6.2", "line": 170, "type": "IMPLICATION"}, {"source": "compliance/framework/default-cmm.txt", "target_path": "compliance/framework/default-cmm.txt", "target_section": "2.6.2", "type": "SPEC", "level": "MUST", "comment": "\n   The request MUST fail if the algorithm suite on the request is not\n   supported by the commitment policy (../client-apis/\n   client.md#commitment-policy) on the request.\n"}, {"source": "compliance/framework/default-cmm.txt", "target_path": "compliance/framework/default-cmm.txt", "target_section": "2.6.2", "type": "SPEC", "level": "MUST", "comment": "\n   On each call to Decrypt Materials, the default CMM MUST make a call\n   to its keyring's (Section 2.5.1) On Decrypt (keyring-\n   interface.md#ondecrypt) operation.\n"}, {"source": "compliance/framework/default-cmm.txt", "target_path": "compliance/framework/default-cmm.txt", "target_section": "2.6.2", "type": "SPEC", "level": "MUST", "comment": "\n   The default CMM MUST obtain the Plaintext Data Key from the On\n   Decrypt response and include it in the decrypt materials returned.\n"}, {"source": "compliance/framework/default-cmm.txt", "target_path": "compliance/framework/default-cmm.txt", "target_section": "2.7", "type": "SPEC", "level": "MUST", "comment": "\n\n   For implementations that support master key providers (master-key-\n   provider-interface.md), the default CMM MUST support generating,\n   encrypting, and decrypting data keys using master key providers.\n"}, {"source": "compliance/framework/default-cmm.txt", "target_path": "compliance/framework/default-cmm.txt", "target_section": "2.7.1", "type": "SPEC", "level": "SHOULD", "comment": " Master key providers SHOULD NOT be\n   included in any additional implementations.\n"}, {"source": "compliance/framework/default-cmm.txt", "target_path": "compliance/framework/default-cmm.txt", "target_section": "2.7.3", "type": "SPEC", "level": "MUST", "comment": "\n\n   In place of calling its keyring's On Encrypt (keyring-\n   interface.md#onencrypt) operation:\n\n   The default CMM MUST call its master key provider's Get Master Keys\n   for Encryption (master-key-provider-interface.md#get-master-keys-for-\n   encryption) operation to obtain a list of master keys to use.\n"}, {"source": "compliance/framework/default-cmm.txt", "target_path": "compliance/framework/default-cmm.txt", "target_section": "2.7.3", "type": "SPEC", "level": "MUST", "comment": "\n   If the master key provider does not identify which master key MUST\n   generate the data key, the default CMM MUST use the first master key\n   in the list for that purpose. "}, {"source": "compliance/framework/default-cmm.txt", "target_path": "compliance/framework/default-cmm.txt", "target_section": "2.7.3", "type": "SPEC", "level": "MUST", "comment": " The default CMM MUST generate the data\n   key using this master key's Generate Data Key (master-key-\n   interface.md#generate-data-key) operation.\n"}, {"source": "compliance/framework/default-cmm.txt", "target_path": "compliance/framework/default-cmm.txt", "target_section": "2.7.3", "type": "SPEC", "level": "MUST", "comment": "\n   For each remaining master key, the default CMM MUST call the master\n   key's Encrypt Data Key (master-key-interface.md#encrypt-data-key)\n   operation with the plaintext data key.\n"}, {"source": "compliance/framework/default-cmm.txt", "target_path": "compliance/framework/default-cmm.txt", "target_section": "2.7.4", "type": "SPEC", "level": "MUST", "comment": "\n\n   In place of calling its keyring's On Decrypt (keyring-\n   interface.md#ondecrypt) operation:\n\n   The default CMM MUST call its master key provider's Decrypt Data Key\n   (master-key-provider-interface.md#decrypt-data-key) operation.\n"}, {"source": "compliance/framework/raw-aes-keyring.txt", "target_path": "compliance/framework/raw-aes-keyring.txt", "target_section": "2.4.1", "type": "SPEC", "level": "MUST", "comment": "\n\n   The key words \"MUST\", \"MUST NOT\", \"REQUIRED\", \"SHALL\", \"SHALL NOT\",\n   \"SHOULD\", \"SHOULD NOT\", \"RECOMMENDED\", \"MAY\", and \"OPTIONAL\" in this\n   document are to be interpreted as described in RFC 2119\n   (https://tools.ietf.org/html/rfc2119).\n"}, {"source": "src/AwsCryptographicMaterialProviders/Keyrings/RawAESKeyring.dfy", "target_path": "compliance/framework/raw-aes-keyring.txt", "target_section": "2.5", "line": 65, "type": "IMPLICATION"}, {"source": "compliance/framework/raw-aes-keyring.txt", "target_path": "compliance/framework/raw-aes-keyring.txt", "target_section": "2.5", "type": "SPEC", "level": "MUST", "comment": "   On keyring initialization, the caller MUST provide the following:\n"}, {"source": "src/AwsCryptographicMaterialProviders/Keyrings/RawAESKeyring.dfy", "target_path": "compliance/framework/raw-aes-keyring.txt", "target_section": "2.5.1", "line": 55, "type": "CITATION"}, {"source": "compliance/framework/raw-aes-keyring.txt", "target_path": "compliance/framework/raw-aes-keyring.txt", "target_section": "2.5.1", "type": "SPEC", "level": "MUST", "comment": "\n   The wrapping key MUST be a secret value consisting of\n   cryptographically secure pseudo-random bytes. "}, {"source": "src/AwsCryptographicMaterialProviders/Keyrings/RawAESKeyring.dfy", "target_path": "compliance/framework/raw-aes-keyring.txt", "target_section": "2.5.1", "line": 59, "type": "CITATION"}, {"source": "compliance/framework/raw-aes-keyring.txt", "target_path": "compliance/framework/raw-aes-keyring.txt", "target_section": "2.5.1", "type": "SPEC", "level": "MUST", "comment": " It MUST be randomly\n   generated from a cryptographically secure entropy source. "}, {"source": "src/AwsCryptographicMaterialProviders/Keyrings/RawAESKeyring.dfy", "target_path": "compliance/framework/raw-aes-keyring.txt", "target_section": "2.5.1", "line": 77, "type": "IMPLICATION"}, {"source": "compliance/framework/raw-aes-keyring.txt", "target_path": "compliance/framework/raw-aes-keyring.txt", "target_section": "2.5.1", "type": "SPEC", "level": "MUST", "comment": " The length\n   of the wrapping key MUST be 128, 192, or 256.\n"}, {"source": "compliance/framework/raw-aes-keyring.txt", "target_path": "compliance/framework/raw-aes-keyring.txt", "target_section": "2.5.2", "type": "SPEC", "level": "MUST", "comment": "\n   The keyring MUST support the following algorithm configurations:\n"}, {"source": "compliance/framework/raw-aes-keyring.txt", "target_path": "compliance/framework/raw-aes-keyring.txt", "target_section": "2.5.2", "type": "SPEC", "level": "MUST", "comment": "   Initialization MUST fail if the length of the wrapping key\n   (Section 2.5.1) does not match the length specified by the wrapping\n   algorithm.\n"}, {"source": "src/AwsCryptographicMaterialProviders/Keyrings/RawAESKeyring.dfy", "target_path": "compliance/framework/raw-aes-keyring.txt", "target_section": "2.6.1.2", "line": 353, "type": "IMPLICATION"}, {"source": "compliance/framework/raw-aes-keyring.txt", "target_path": "compliance/framework/raw-aes-keyring.txt", "target_section": "2.6.1.2", "type": "SPEC", "level": "MUST", "comment": "\n   This value MUST match the authentication tag length of the keyring's\n   configured wrapping algorithm (Section 2.5.2).\n"}, {"source": "src/AwsCryptographicMaterialProviders/Keyrings/RawAESKeyring.dfy", "target_path": "compliance/framework/raw-aes-keyring.txt", "target_section": "2.6.1.3", "line": 361, "type": "IMPLICATION"}, {"source": "compliance/framework/raw-aes-keyring.txt", "target_path": "compliance/framework/raw-aes-keyring.txt", "target_section": "2.6.1.3", "type": "SPEC", "level": "MUST", "comment": "\n   This value MUST match the IV length of the keyring's configured\n   wrapping algorithm (Section 2.5.2).\n"}, {"source": "src/AwsCryptographicMaterialProviders/Keyrings/RawAESKeyring.dfy", "target_path": "compliance/framework/raw-aes-keyring.txt", "target_section": "2.7.1", "line": 95, "type": "IMPLICATION"}, {"source": "compliance/framework/raw-aes-keyring.txt", "target_path": "compliance/framework/raw-aes-keyring.txt", "target_section": "2.7.1", "type": "SPEC", "level": "MUST", "comment": "\n\n   OnEncrypt MUST take encryption materials (structures.md#encryption-\n   materials) as input.\n"}, {"source": "src/AwsCryptographicMaterialProviders/Keyrings/RawAESKeyring.dfy", "target_path": "compliance/framework/raw-aes-keyring.txt", "target_section": "2.7.1", "line": 152, "type": "CITATION"}, {"source": "test/AwsCryptographicMaterialProviders/Keyrings/TestRawAESKeyring.dfy", "target_path": "compliance/framework/raw-aes-keyring.txt", "target_section": "2.7.1", "line": 227, "type": "TEST"}, {"source": "compliance/framework/raw-aes-keyring.txt", "target_path": "compliance/framework/raw-aes-keyring.txt", "target_section": "2.7.1", "type": "SPEC", "level": "MUST", "comment": "\n   If the encryption materials (structures.md#encryption-materials) do\n   not contain a plaintext data key, OnEncrypt MUST generate a random\n   plaintext data key and set it on the encryption materials\n   (structures.md#encryption-materials).\n"}, {"source": "src/AwsCryptographicMaterialProviders/Keyrings/RawAESKeyring.dfy", "target_path": "compliance/framework/raw-aes-keyring.txt", "target_section": "2.7.1", "line": 167, "type": "CITATION"}, {"source": "test/AwsCryptographicMaterialProviders/Keyrings/TestRawAESKeyring.dfy", "target_path": "compliance/framework/raw-aes-keyring.txt", "target_section": "2.7.1", "line": 117, "type": "TEST"}, {"source": "compliance/framework/raw-aes-keyring.txt", "target_path": "compliance/framework/raw-aes-keyring.txt", "target_section": "2.7.1", "type": "SPEC", "level": "MUST", "comment": "\n   The keyring MUST encrypt the plaintext data key in the encryption\n   materials (structures.md#encryption-materials) using AES-GCM.\n"}, {"source": "src/AwsCryptographicMaterialProviders/Keyrings/RawAESKeyring.dfy", "target_path": "compliance/framework/raw-aes-keyring.txt", "target_section": "2.7.1", "line": 399, "type": "CITATION"}, {"source": "test/AwsCryptographicMaterialProviders/Keyrings/TestRawAESKeyring.dfy", "target_path": "compliance/framework/raw-aes-keyring.txt", "target_section": "2.7.1", "line": 258, "type": "TEST"}, {"source": "compliance/framework/raw-aes-keyring.txt", "target_path": "compliance/framework/raw-aes-keyring.txt", "target_section": "2.7.1", "type": "SPEC", "level": "MUST", "comment": "\n   The keyring MUST attempt to serialize the encryption materials'\n   (structures.md#encryption-materials) encryption context\n   (structures.md#encryption-context-1) in the same format as the\n   serialization of message header AAD key value pairs (../data-format/\n   message-header.md#key-value-pairs). "}, {"source": "src/AwsCryptographicMaterialProviders/Keyrings/RawAESKeyring.dfy", "target_path": "compliance/framework/raw-aes-keyring.txt", "target_section": "2.7.1", "line": 134, "type": "IMPLICATION"}, {"source": "compliance/framework/raw-aes-keyring.txt", "target_path": "compliance/framework/raw-aes-keyring.txt", "target_section": "2.7.1", "type": "SPEC", "level": "MUST", "comment": " If the keyring cannot serialize\n   the encryption context, OnEncrypt MUST fail.\n"}, {"source": "compliance/framework/raw-aes-keyring.txt", "target_path": "compliance/framework/raw-aes-keyring.txt", "target_section": "2.7.1", "type": "SPEC", "level": "MUST", "comment": " Based on the ciphertext output of the AES-GCM decryption, the keyring\n   MUST construct an encrypted data key (structures.md#encrypted-data-\n   key) with the following specifics:\n"}, {"source": "src/AwsCryptographicMaterialProviders/Keyrings/RawAESKeyring.dfy", "target_path": "compliance/framework/raw-aes-keyring.txt", "target_section": "2.7.1", "line": 187, "type": "CITATION"}, {"source": "test/AwsCryptographicMaterialProviders/Keyrings/TestRawAESKeyring.dfy", "target_path": "compliance/framework/raw-aes-keyring.txt", "target_section": "2.7.1", "line": 49, "type": "TEST"}, {"source": "compliance/framework/raw-aes-keyring.txt", "target_path": "compliance/framework/raw-aes-keyring.txt", "target_section": "2.7.1", "type": "SPEC", "level": "MUST", "comment": "   The keyring MUST append the constructed encrypted data key to the\n   encrypted data key list in the encryption materials\n   (structures.md#encryption-materials).\n"}, {"source": "src/AwsCryptographicMaterialProviders/Keyrings/RawAESKeyring.dfy", "target_path": "compliance/framework/raw-aes-keyring.txt", "target_section": "2.7.1", "line": 192, "type": "CITATION"}, {"source": "test/AwsCryptographicMaterialProviders/Keyrings/TestRawAESKeyring.dfy", "target_path": "compliance/framework/raw-aes-keyring.txt", "target_section": "2.7.1", "line": 55, "type": "TEST"}, {"source": "compliance/framework/raw-aes-keyring.txt", "target_path": "compliance/framework/raw-aes-keyring.txt", "target_section": "2.7.1", "type": "SPEC", "level": "MUST", "comment": "\n   OnEncrypt MUST output the modified encryption materials\n   (structures.md#encryption-materials).\n"}, {"source": "src/AwsCryptographicMaterialProviders/Keyrings/RawAESKeyring.dfy", "target_path": "compliance/framework/raw-aes-keyring.txt", "target_section": "2.7.2", "line": 203, "type": "IMPLICATION"}, {"source": "compliance/framework/raw-aes-keyring.txt", "target_path": "compliance/framework/raw-aes-keyring.txt", "target_section": "2.7.2", "type": "SPEC", "level": "MUST", "comment": "\n\n   OnDecrypt MUST take decryption materials (structures.md#decryption-\n   materials) and a list of encrypted data keys\n   (structures.md#encrypted-data-key) as input.\n"}, {"source": "compliance/framework/raw-aes-keyring.txt", "target_path": "compliance/framework/raw-aes-keyring.txt", "target_section": "2.7.2", "type": "SPEC", "level": "MUST", "comment": "\n   If the decryption materials already contain a plaintext data key, the\n   keyring MUST fail and MUST NOT modify the decryption materials\n   (structures.md#decryption-materials).\n"}, {"source": "test/AwsCryptographicMaterialProviders/Keyrings/TestRawAESKeyring.dfy", "target_path": "compliance/framework/raw-aes-keyring.txt", "target_section": "2.7.2", "line": 293, "type": "TEST"}, {"source": "compliance/framework/raw-aes-keyring.txt", "target_path": "compliance/framework/raw-aes-keyring.txt", "target_section": "2.7.2", "type": "SPEC", "level": "MUST", "comment": "\n   The keyring MUST attempt to serialize the decryption materials'\n   (structures.md#decryption-materials) encryption context\n   (structures.md#encryption-context-1) in the same format as the\n   serialization of the message header AAD key value pairs (../data-\n   format/message-header.md#key-value-pairs). "}, {"source": "src/AwsCryptographicMaterialProviders/Keyrings/RawAESKeyring.dfy", "target_path": "compliance/framework/raw-aes-keyring.txt", "target_section": "2.7.2", "line": 229, "type": "IMPLICATION"}, {"source": "compliance/framework/raw-aes-keyring.txt", "target_path": "compliance/framework/raw-aes-keyring.txt", "target_section": "2.7.2", "type": "SPEC", "level": "MUST", "comment": " If the keyring cannot\n   serialize the encryption context, OnDecrypt MUST fail.\n"}, {"source": "src/AwsCryptographicMaterialProviders/Keyrings/RawAESKeyring.dfy", "target_path": "compliance/framework/raw-aes-keyring.txt", "target_section": "2.7.2", "line": 246, "type": "CITATION"}, {"source": "compliance/framework/raw-aes-keyring.txt", "target_path": "compliance/framework/raw-aes-keyring.txt", "target_section": "2.7.2", "type": "SPEC", "level": "MUST", "comment": "\n   The keyring MUST perform the following actions on each encrypted data\n   key (structures.md#encrypted-data-key) in the input encrypted data\n   key list, serially, until it successfully decrypts one.\n"}, {"source": "compliance/framework/raw-aes-keyring.txt", "target_path": "compliance/framework/raw-aes-keyring.txt", "target_section": "2.7.2", "type": "SPEC", "level": "MUST", "comment": "\n   For each encrypted data key (structures.md#encrypted-data-key), the\n   keyring MUST first attempt to deserialize the serialized ciphertext\n   (Section 2.6.2) to obtain the encrypted key (Section 2.6.2.1) and\n   authentication tag (Section 2.6.2.2), and deserialize the serialized\n   key provider info (Section 2.6.1) to obtain the key name (./keyring-\n   interface.md#key-name), Section 2.6.1.4, IV length (Section 2.6.1.3),\n   and authentication tag length (Section 2.6.1.2).\n"}, {"source": "src/AwsCryptographicMaterialProviders/Keyrings/RawAESKeyring.dfy", "target_path": "compliance/framework/raw-aes-keyring.txt", "target_section": "2.7.2", "line": 268, "type": "CITATION"}, {"source": "test/AwsCryptographicMaterialProviders/Keyrings/TestRawAESKeyring.dfy", "target_path": "compliance/framework/raw-aes-keyring.txt", "target_section": "2.7.2", "line": 72, "type": "TEST"}, {"source": "compliance/framework/raw-aes-keyring.txt", "target_path": "compliance/framework/raw-aes-keyring.txt", "target_section": "2.7.2", "type": "SPEC", "level": "MUST", "comment": "   If a decryption succeeds, this keyring MUST add the resulting\n   plaintext data key to the decryption materials and return the\n   modified materials.\n"}, {"source": "src/AwsCryptographicMaterialProviders/Keyrings/RawAESKeyring.dfy", "target_path": "compliance/framework/raw-aes-keyring.txt", "target_section": "2.7.2", "line": 291, "type": "CITATION"}, {"source": "compliance/framework/raw-aes-keyring.txt", "target_path": "compliance/framework/raw-aes-keyring.txt", "target_section": "2.7.2", "type": "SPEC", "level": "MUST", "comment": "\n   If no decryption succeeds, the keyring MUST fail and MUST NOT modify\n   the decryption materials (structures.md#decryption-materials).\n"}, {"source": "compliance/framework/cmm-interface.txt", "target_path": "compliance/framework/cmm-interface.txt", "target_section": "2.3", "type": "SPEC", "level": "MUST", "comment": " The CMM interface describes the\n   interface that all CMMs MUST implement.\n"}, {"source": "compliance/framework/cmm-interface.txt", "target_path": "compliance/framework/cmm-interface.txt", "target_section": "2.4.1", "type": "SPEC", "level": "MUST", "comment": "\n\n   The key words \"MUST\", \"MUST NOT\", \"REQUIRED\", \"SHALL\", \"SHALL NOT\",\n   \"SHOULD\", \"SHOULD NOT\", \"RECOMMENDED\", \"MAY\", and \"OPTIONAL\" in this\n   document are to be interpreted as described in RFC 2119\n   (https://tools.ietf.org/html/rfc2119).\n"}, {"source": "compliance/framework/cmm-interface.txt", "target_path": "compliance/framework/cmm-interface.txt", "target_section": "2.5", "type": "SPEC", "level": "MAY", "comment": "   Note: A user MAY create their own custom CMM.\n"}, {"source": "compliance/framework/cmm-interface.txt", "target_path": "compliance/framework/cmm-interface.txt", "target_section": "2.6.1.1", "type": "SPEC", "level": "MUST", "comment": "\n   The encryption materials request MUST include the following:\n"}, {"source": "compliance/framework/cmm-interface.txt", "target_path": "compliance/framework/cmm-interface.txt", "target_section": "2.6.1.1", "type": "SPEC", "level": "MAY", "comment": " The encryption request MAY include the following:\n"}, {"source": "compliance/framework/cmm-interface.txt", "target_path": "compliance/framework/cmm-interface.txt", "target_section": "2.6.1.2", "type": "SPEC", "level": "MUST", "comment": "\n   The decrypt materials request MUST include the following:\n"}, {"source": "compliance/framework/cmm-interface.txt", "target_path": "compliance/framework/cmm-interface.txt", "target_section": "2.6.2", "type": "SPEC", "level": "MUST", "comment": "   The CMM Interface MUST support the following behaviors:\n"}, {"source": "compliance/framework/cmm-interface.txt", "target_path": "compliance/framework/cmm-interface.txt", "target_section": "2.6.2.1", "type": "SPEC", "level": "MUST", "comment": "\n\n   When the CMM gets an encryption materials request (Section 2.6.1.1),\n   it MUST return encryption materials (structures.md#encryption-\n   materials) appropriate for the request.\n"}, {"source": "compliance/framework/cmm-interface.txt", "target_path": "compliance/framework/cmm-interface.txt", "target_section": "2.6.2.1", "type": "SPEC", "level": "MUST", "comment": "\n   The encryption materials returned MUST include the following:\n"}, {"source": "compliance/framework/cmm-interface.txt", "target_path": "compliance/framework/cmm-interface.txt", "target_section": "2.6.2.1", "type": "SPEC", "level": "SHOULD", "comment": "   If the algorithm suite does not contain a signing algorithm\n   (algorithm-suites.md#signature-algorithm):\n\n   *  The CMM SHOULD NOT add a key-value pair using the reserved key\n      \"aws-crypto-public-key\" to the encryption context.\n"}, {"source": "compliance/framework/cmm-interface.txt", "target_path": "compliance/framework/cmm-interface.txt", "target_section": "2.6.2.1", "type": "SPEC", "level": "MUST", "comment": "\n   The CMM MUST ensure that the encryption materials returned are valid.\n"}, {"source": "compliance/framework/cmm-interface.txt", "target_path": "compliance/framework/cmm-interface.txt", "target_section": "2.6.2.1", "type": "SPEC", "level": "MUST", "comment": "\n   *  The encryption materials returned MUST follow the specification\n      for encryption-materials (structures.md#encryption-materials).\n"}, {"source": "compliance/framework/cmm-interface.txt", "target_path": "compliance/framework/cmm-interface.txt", "target_section": "2.6.2.1", "type": "SPEC", "level": "MUST", "comment": "\n   *  The value of the plaintext data key MUST be non-NULL.\n"}, {"source": "compliance/framework/cmm-interface.txt", "target_path": "compliance/framework/cmm-interface.txt", "target_section": "2.6.2.1", "type": "SPEC", "level": "MUST", "comment": "\n   *  The plaintext data key length MUST be equal to the key derivation\n      input length (algorithm-suites.md#key-derivation-input-length).\n"}, {"source": "compliance/framework/cmm-interface.txt", "target_path": "compliance/framework/cmm-interface.txt", "target_section": "2.6.2.1", "type": "SPEC", "level": "MUST", "comment": "\n   *  The encrypted data keys list MUST contain at least one encrypted\n      data key.\n"}, {"source": "compliance/framework/cmm-interface.txt", "target_path": "compliance/framework/cmm-interface.txt", "target_section": "2.6.2.1", "type": "SPEC", "level": "MUST", "comment": "\n   *  If the algorithm suite contains a signing algorithm, the\n      encryption materials returned MUST include the generated signing\n      key.\n"}, {"source": "compliance/framework/cmm-interface.txt", "target_path": "compliance/framework/cmm-interface.txt", "target_section": "2.6.2.2", "type": "SPEC", "level": "MUST", "comment": "\n\n   When the CMM gets a decrypt materials request (Section 2.6.1.2), it\n   MUST return decryption materials (structures.md#decryption-materials)\n   appropriate for the request.\n"}, {"source": "compliance/framework/cmm-interface.txt", "target_path": "compliance/framework/cmm-interface.txt", "target_section": "2.6.2.2", "type": "SPEC", "level": "SHOULD", "comment": "\n   If the requested algorithm suite does not include a signing algorithm\n   but the encryption context includes the reserved \"aws-crypto-public-\n   key\" key, the operation SHOULD fail. "}, {"source": "compliance/framework/cmm-interface.txt", "target_path": "compliance/framework/cmm-interface.txt", "target_section": "2.6.2.2", "type": "SPEC", "level": "SHOULD", "comment": " Likewise, if the requested\n   algorithm suite includes a signing algorithm but the encryption\n   context does not include the reserved \"aws-crypto-public-key\" key,\n   the operation SHOULD fail.\n"}, {"source": "compliance/framework/cmm-interface.txt", "target_path": "compliance/framework/cmm-interface.txt", "target_section": "2.6.2.2", "type": "SPEC", "level": "MUST", "comment": "\n   The decryption materials returned MUST include the following:\n"}, {"source": "compliance/framework/cmm-interface.txt", "target_path": "compliance/framework/cmm-interface.txt", "target_section": "2.6.2.2", "type": "SPEC", "level": "MUST", "comment": "   If the algorithm suite obtained from the decryption request contains\n   a signing algorithm (algorithm-suites.md#signature-algorithm), the\n   decryption materials MUST include the signature verification key\n   (structures.md#verification-key).\n"}, {"source": "compliance/framework/cmm-interface.txt", "target_path": "compliance/framework/cmm-interface.txt", "target_section": "2.6.2.2", "type": "SPEC", "level": "MUST", "comment": "\n   The CMM MUST ensure that the decryption materials returned are valid.\n"}, {"source": "compliance/framework/caching-cmm.txt", "target_path": "compliance/framework/caching-cmm.txt", "target_section": "2.4.1", "type": "SPEC", "level": "MUST", "comment": "\n\n   The key words \"MUST\", \"MUST NOT\", \"REQUIRED\", \"SHALL\", \"SHALL NOT\",\n   \"SHOULD\", \"SHOULD NOT\", \"RECOMMENDED\", \"MAY\", and \"OPTIONAL\" in this\n   document are to be interpreted as described in RFC 2119\n   (https://tools.ietf.org/html/rfc2119).\n"}, {"source": "compliance/framework/caching-cmm.txt", "target_path": "compliance/framework/caching-cmm.txt", "target_section": "2.5", "type": "SPEC", "level": "MUST", "comment": "   On caching CMM initialization, the caller MUST provide the following\n   values:\n"}, {"source": "compliance/framework/caching-cmm.txt", "target_path": "compliance/framework/caching-cmm.txt", "target_section": "2.5", "type": "SPEC", "level": "MUST", "comment": " Additionally, the caller MUST provide one of the following values:\n"}, {"source": "compliance/framework/caching-cmm.txt", "target_path": "compliance/framework/caching-cmm.txt", "target_section": "2.5.1", "type": "SPEC", "level": "MUST", "comment": "\n   Multiple caching CMMs MAY share the same cryptographic materials\n   cache, but by default MUST NOT use each other's cache entries. "}, {"source": "compliance/framework/caching-cmm.txt", "target_path": "compliance/framework/caching-cmm.txt", "target_section": "2.5.3", "type": "SPEC", "level": "MUST", "comment": "   The Caching CMM MUST set a time-to-live (TTL) for data keys in the\n   CMC. "}, {"source": "compliance/framework/caching-cmm.txt", "target_path": "compliance/framework/caching-cmm.txt", "target_section": "2.5.4", "type": "SPEC", "level": "MUST", "comment": "\n\n   A string that is used to avoid collisions with other CMMs.  If this\n   parameter is not set, the caching CMM MUST set a partition ID that\n   uniquely identifies the respective caching CMM. "}, {"source": "compliance/framework/caching-cmm.txt", "target_path": "compliance/framework/caching-cmm.txt", "target_section": "2.5.4", "type": "SPEC", "level": "MUST", "comment": " The Partition ID\n   MUST NOT be changed after initialization.\n"}, {"source": "compliance/framework/caching-cmm.txt", "target_path": "compliance/framework/caching-cmm.txt", "target_section": "2.5.5", "type": "SPEC", "level": "MAY", "comment": "\n\n   The maximum number of bytes that MAY be encrypted by a single data\n   key. "}, {"source": "compliance/framework/caching-cmm.txt", "target_path": "compliance/framework/caching-cmm.txt", "target_section": "2.5.5", "type": "SPEC", "level": "MUST", "comment": " If this parameter is not set, the\n   caching CMM MUST set it to a value no more than 2^63-1. "}, {"source": "compliance/framework/caching-cmm.txt", "target_path": "compliance/framework/caching-cmm.txt", "target_section": "2.5.6", "type": "SPEC", "level": "MAY", "comment": "\n\n   The maximum number of messages that MAY be encrypted by a single data\n   key. "}, {"source": "compliance/framework/caching-cmm.txt", "target_path": "compliance/framework/caching-cmm.txt", "target_section": "2.5.6", "type": "SPEC", "level": "MUST", "comment": " If this parameter is not set, the\n   caching CMM MUST set it to 2^32. "}, {"source": "compliance/framework/caching-cmm.txt", "target_path": "compliance/framework/caching-cmm.txt", "target_section": "2.5.6", "type": "SPEC", "level": "MUST", "comment": "\n   The caching CMM MUST provide a structure as defined below, to track\n   usage statistics.\n"}, {"source": "compliance/framework/caching-cmm.txt", "target_path": "compliance/framework/caching-cmm.txt", "target_section": "2.5.7", "type": "SPEC", "level": "MUST", "comment": "   When the caching CMM stores encryption materials into the\n   cryptographic materials cache, the caching CMM MUST set the initial\n   usage stats for the cache entry.\n"}, {"source": "compliance/framework/caching-cmm.txt", "target_path": "compliance/framework/caching-cmm.txt", "target_section": "2.5.7", "type": "SPEC", "level": "MUST", "comment": "\n   When the caching CMM obtains encryption materials from the\n   cryptographic materials cache, the caching CMM MUST update the usage\n   stats for the cache entry retrieved.\n"}, {"source": "compliance/framework/caching-cmm.txt", "target_path": "compliance/framework/caching-cmm.txt", "target_section": "2.6.1", "type": "SPEC", "level": "MUST", "comment": "\n\n   If the algorithm suite (algorithm-suites.md) requested contains a\n   Identity KDF (algorithm-suites.md#identity-kdf), the caching CMM MUST\n   obtain the encryption materials by making a call to the underlying\n   CMM's Get Encryption Materials (cmm-interface.md#get-encryption-\n   materials) function.\n"}, {"source": "compliance/framework/caching-cmm.txt", "target_path": "compliance/framework/caching-cmm.txt", "target_section": "2.6.1", "type": "SPEC", "level": "MUST", "comment": "\n   Otherwise, the caching CMM MUST attempt to find the encryption\n   materials (structures.md#encryption-materials) from the underlying\n   cryptographic materials cache (CMC) (Section 2.5.1). "}, {"source": "compliance/framework/caching-cmm.txt", "target_path": "compliance/framework/caching-cmm.txt", "target_section": "2.6.1", "type": "SPEC", "level": "MUST", "comment": " The caching CMM\n   MUST use the formulas specified in Appendix A (Section 2.7) in order\n   to compute the cache entry identifier (cryptographic-materials-\n   cache.md#cache-identifier).\n"}, {"source": "compliance/framework/caching-cmm.txt", "target_path": "compliance/framework/caching-cmm.txt", "target_section": "2.6.1", "type": "SPEC", "level": "MUST", "comment": "\n   If a cache entry is found, the caching CMM MUST return the encryption\n   materials retrieved. "}, {"source": "compliance/framework/caching-cmm.txt", "target_path": "compliance/framework/caching-cmm.txt", "target_section": "2.6.1", "type": "SPEC", "level": "MUST", "comment": " If a cache entry is not found or the cache\n   entry is expired, the caching CMM MUST then attempt to obtain the\n   encryption materials by making a call to the underlying CMM's Get\n   Encryption Materials (cmm-interface.md#get-encryption-materials).\n"}, {"source": "compliance/framework/caching-cmm.txt", "target_path": "compliance/framework/caching-cmm.txt", "target_section": "2.6.1", "type": "SPEC", "level": "MUST", "comment": "\n   If the algorithm suite (algorithm-suites.md) requested does not\n   contain an Identity KDF (algorithm-suites.md#identity-kdf), the\n   caching CMM MUST add the encryption materials obtained from the\n   underlying CMM into the underlying CMC.\n"}, {"source": "compliance/framework/caching-cmm.txt", "target_path": "compliance/framework/caching-cmm.txt", "target_section": "2.6.1", "type": "SPEC", "level": "MUST", "comment": "\n   If the algorithm suite (algorithm-suites.md) requested contains an\n   Identity KDF, the caching CMM MUST NOT store the encryption materials\n   in the underlying CMC.\n"}, {"source": "compliance/framework/caching-cmm.txt", "target_path": "compliance/framework/caching-cmm.txt", "target_section": "2.6.2", "type": "SPEC", "level": "MUST", "comment": "\n\n   If the algorithm suite (algorithm-suites.md) requested contains a\n   Identity KDF (algorithm-suites.md#identity-kdf), the caching CMM MUST\n   obtain the decryption materials by making a call to the underlying\n   CMM's Decrypt Materials (cmm-interface.md#decrypt-materials)\n   function.\n"}, {"source": "compliance/framework/caching-cmm.txt", "target_path": "compliance/framework/caching-cmm.txt", "target_section": "2.6.2", "type": "SPEC", "level": "MUST", "comment": "\n   Otherwise, the caching CMM MUST attempt to find the decryption\n   materials (structures.md#decryption-materials) from the underlying\n   CMC (Section 2.5.1). "}, {"source": "compliance/framework/caching-cmm.txt", "target_path": "compliance/framework/caching-cmm.txt", "target_section": "2.6.2", "type": "SPEC", "level": "MUST", "comment": " The caching CMM MUST use the formulas specified\n   in Appendix A (Section 2.7) in order to compute the cache entry\n   identifier (cryptographic-materials-cache.md#cache-identifier).\n"}, {"source": "compliance/framework/caching-cmm.txt", "target_path": "compliance/framework/caching-cmm.txt", "target_section": "2.6.2", "type": "SPEC", "level": "MUST", "comment": "\n   If a cache entry is found, the caching CMM MUST return the decryption\n   materials retrieved. "}, {"source": "compliance/framework/caching-cmm.txt", "target_path": "compliance/framework/caching-cmm.txt", "target_section": "2.6.2", "type": "SPEC", "level": "MUST", "comment": " If a cache entry is not found or the cache\n   entry is expired, the caching CMM MUST attempt to obtain the\n   decryption materials by making a call to the underlying CMM's Decrypt\n   Materials (cmm-interface.md#decrypt-materials).\n"}, {"source": "compliance/framework/caching-cmm.txt", "target_path": "compliance/framework/caching-cmm.txt", "target_section": "2.6.2", "type": "SPEC", "level": "MUST", "comment": "\n   If the algorithm suite (algorithm-suites.md) requested does not\n   contain an Identity KDF (algorithm-suites.md#identity-kdf), the\n   caching CMM MUST add the decryption materials obtained from the\n   underlying CMM into the underlying CMC.\n"}, {"source": "compliance/framework/caching-cmm.txt", "target_path": "compliance/framework/caching-cmm.txt", "target_section": "2.6.2", "type": "SPEC", "level": "MUST", "comment": "\n   If the algorithm suite (algorithm-suites.md) requested contains an\n   Identity KDF, the caching CMM MUST NOT store the decryption materials\n   in the underlying CMC.\n"}, {"source": "compliance/framework/caching-cmm.txt", "target_path": "compliance/framework/caching-cmm.txt", "target_section": "2.7", "type": "SPEC", "level": "MUST", "comment": "\n\n   When accessing the underlying CMC, the caching CMM MUST use the\n   formulas specified in this appendix in order to compute the cache\n   entry identifier (cryptographic-materials-cache.md#cache-identifier).\n"}, {"source": "compliance/framework/caching-cmm.txt", "target_path": "compliance/framework/caching-cmm.txt", "target_section": "2.7.2", "type": "SPEC", "level": "MUST", "comment": "   If the Get Encryption Materials request does not specify an algorithm\n   suite, then the cache entry identifier MUST be calculated as the\n   SHA-512 hash of the concatenation of the following byte strings, in\n   the order listed:\n"}, {"source": "compliance/framework/caching-cmm.txt", "target_path": "compliance/framework/caching-cmm.txt", "target_section": "2.7.3", "type": "SPEC", "level": "MUST", "comment": "   If the Get Encryption Materials request does specify an algorithm\n   suite, then the cache entry identifier MUST be calculated as the\n   SHA-512 hash of the concatenation of the following byte strings, in\n   the order listed:\n"}, {"source": "compliance/framework/raw-rsa-keyring.txt", "target_path": "compliance/framework/raw-rsa-keyring.txt", "target_section": "2.4.1", "type": "SPEC", "level": "MUST", "comment": "\n\n   The key words \"MUST\", \"MUST NOT\", \"REQUIRED\", \"SHALL\", \"SHALL NOT\",\n   \"SHOULD\", \"SHOULD NOT\", \"RECOMMENDED\", \"MAY\", and \"OPTIONAL\" in this\n   document are to be interpreted as described in RFC 2119\n   (https://tools.ietf.org/html/rfc2119).\n"}, {"source": "src/AwsCryptographicMaterialProviders/Keyrings/RawRSAKeyring.dfy", "target_path": "compliance/framework/raw-rsa-keyring.txt", "target_section": "2.5", "line": 50, "type": "IMPLICATION"}, {"source": "compliance/framework/raw-rsa-keyring.txt", "target_path": "compliance/framework/raw-rsa-keyring.txt", "target_section": "2.5", "type": "SPEC", "level": "MUST", "comment": "   On keyring initialization, the caller MUST provide the following:\n"}, {"source": "src/AwsCryptographicMaterialProviders/Keyrings/RawRSAKeyring.dfy", "target_path": "compliance/framework/raw-rsa-keyring.txt", "target_section": "2.5.1", "line": 88, "type": "IMPLICATION"}, {"source": "compliance/framework/raw-rsa-keyring.txt", "target_path": "compliance/framework/raw-rsa-keyring.txt", "target_section": "2.5.1", "type": "SPEC", "level": "MUST", "comment": "\n   This value MUST correspond with one of the supported padding schemes\n   (Section 2.5.1.1).\n"}, {"source": "src/Crypto/RSAEncryption.dfy", "target_path": "compliance/framework/raw-rsa-keyring.txt", "target_section": "2.5.1", "line": 16, "type": "TODO"}, {"source": "compliance/framework/raw-rsa-keyring.txt", "target_path": "compliance/framework/raw-rsa-keyring.txt", "target_section": "2.5.1", "type": "SPEC", "level": "MUST", "comment": "\n   If the padding scheme uses MGF1 Padding, the hash function used as\n   part of MGF1 MUST be the same hash function used to hash the\n   plaintext data key.\n"}, {"source": "src/Crypto/RSAEncryption.dfy", "target_path": "compliance/framework/raw-rsa-keyring.txt", "target_section": "2.5.1.1", "line": 10, "type": "IMPLICATION"}, {"source": "compliance/framework/raw-rsa-keyring.txt", "target_path": "compliance/framework/raw-rsa-keyring.txt", "target_section": "2.5.1.1", "type": "SPEC", "level": "MUST", "comment": "   This keyring MUST NOT use a padding scheme outside those defined\n   above.\n"}, {"source": "src/AwsCryptographicMaterialProviders/Keyrings/RawRSAKeyring.dfy", "target_path": "compliance/framework/raw-rsa-keyring.txt", "target_section": "2.5.2", "line": 61, "type": "TODO"}, {"source": "compliance/framework/raw-rsa-keyring.txt", "target_path": "compliance/framework/raw-rsa-keyring.txt", "target_section": "2.5.2", "type": "SPEC", "level": "MUST", "comment": "\n   The public key MUST follow the RSA specification for public keys\n   (Section 2.4.2). "}, {"source": "src/AwsCryptographicMaterialProviders/Keyrings/RawRSAKeyring.dfy", "target_path": "compliance/framework/raw-rsa-keyring.txt", "target_section": "2.5.2", "line": 35, "type": "TODO"}, {"source": "compliance/framework/raw-rsa-keyring.txt", "target_path": "compliance/framework/raw-rsa-keyring.txt", "target_section": "2.5.2", "type": "SPEC", "level": "SHOULD", "comment": " The raw RSA keyring SHOULD support loading PEM\n   encoded X.509 SubjectPublicKeyInfo structures\n   (https://tools.ietf.org/html/rfc5280#section-4.1) as public keys.\n"}, {"source": "src/AwsCryptographicMaterialProviders/Keyrings/RawRSAKeyring.dfy", "target_path": "compliance/framework/raw-rsa-keyring.txt", "target_section": "2.5.3", "line": 70, "type": "TODO"}, {"source": "compliance/framework/raw-rsa-keyring.txt", "target_path": "compliance/framework/raw-rsa-keyring.txt", "target_section": "2.5.3", "type": "SPEC", "level": "MUST", "comment": "\n   The private key MUST follow the RSA specification for private keys\n   (Section 2.4.2). "}, {"source": "compliance/framework/raw-rsa-keyring.txt", "target_path": "compliance/framework/raw-rsa-keyring.txt", "target_section": "2.5.3", "type": "SPEC", "level": "SHOULD", "comment": " The raw RSA keyring SHOULD support loading PEM\n   encoded PKCS #8 PrivateKeyInfo structures\n   (https://tools.ietf.org/html/rfc5958#section-2) as private keys. "}, {"source": "src/AwsCryptographicMaterialProviders/Keyrings/RawRSAKeyring.dfy", "target_path": "compliance/framework/raw-rsa-keyring.txt", "target_section": "2.5.3", "line": 79, "type": "TODO"}, {"source": "compliance/framework/raw-rsa-keyring.txt", "target_path": "compliance/framework/raw-rsa-keyring.txt", "target_section": "2.5.3", "type": "SPEC", "level": "SHOULD", "comment": " The\n   private key SHOULD contain all Chinese Remainder Theorem (CRT)\n   components (public exponent, prime factors, CRT exponents, and CRT\n   coefficient).\n"}, {"source": "src/AwsCryptographicMaterialProviders/Keyrings/RawRSAKeyring.dfy", "target_path": "compliance/framework/raw-rsa-keyring.txt", "target_section": "2.6.1", "line": 123, "type": "IMPLICATION"}, {"source": "compliance/framework/raw-rsa-keyring.txt", "target_path": "compliance/framework/raw-rsa-keyring.txt", "target_section": "2.6.1", "type": "SPEC", "level": "MUST", "comment": "\n\n   OnEncrypt MUST fail if this keyring does not have a specified public\n   key (Section 2.5.2). "}, {"source": "src/AwsCryptographicMaterialProviders/Keyrings/RawRSAKeyring.dfy", "target_path": "compliance/framework/raw-rsa-keyring.txt", "target_section": "2.6.1", "line": 156, "type": "IMPLICATION"}, {"source": "compliance/framework/raw-rsa-keyring.txt", "target_path": "compliance/framework/raw-rsa-keyring.txt", "target_section": "2.6.1", "type": "SPEC", "level": "MUST", "comment": " The keyring MUST NOT derive a public key from a\n   specified private key (Section 2.5.3).\n"}, {"source": "src/AwsCryptographicMaterialProviders/Keyrings/RawRSAKeyring.dfy", "target_path": "compliance/framework/raw-rsa-keyring.txt", "target_section": "2.6.1", "line": 109, "type": "IMPLICATION"}, {"source": "compliance/framework/raw-rsa-keyring.txt", "target_path": "compliance/framework/raw-rsa-keyring.txt", "target_section": "2.6.1", "type": "SPEC", "level": "MUST", "comment": "\n   OnEncrypt MUST take encryption materials (structures.md#encryption-\n   materials) as input.\n"}, {"source": "src/AwsCryptographicMaterialProviders/Keyrings/RawRSAKeyring.dfy", "target_path": "compliance/framework/raw-rsa-keyring.txt", "target_section": "2.6.1", "line": 132, "type": "IMPLICATION"}, {"source": "src/AwsCryptographicMaterialProviders/Keyrings/RawRSAKeyring.dfy", "target_path": "compliance/framework/raw-rsa-keyring.txt", "target_section": "2.6.1", "line": 179, "type": "CITATION"}, {"source": "compliance/framework/raw-rsa-keyring.txt", "target_path": "compliance/framework/raw-rsa-keyring.txt", "target_section": "2.6.1", "type": "SPEC", "level": "MUST", "comment": "\n   If the encryption materials (structures.md#encryption-materials) do\n   not contain a plaintext data key, OnEncrypt MUST generate a random\n   plaintext data key and set it on the encryption materials\n   (structures.md#encryption-materials).\n"}, {"source": "src/AwsCryptographicMaterialProviders/Keyrings/RawRSAKeyring.dfy", "target_path": "compliance/framework/raw-rsa-keyring.txt", "target_section": "2.6.1", "line": 189, "type": "CITATION"}, {"source": "test/AwsCryptographicMaterialProviders/Keyrings/TestRawRSAKeyring.dfy", "target_path": "compliance/framework/raw-rsa-keyring.txt", "target_section": "2.6.1", "line": 69, "type": "TEST"}, {"source": "compliance/framework/raw-rsa-keyring.txt", "target_path": "compliance/framework/raw-rsa-keyring.txt", "target_section": "2.6.1", "type": "SPEC", "level": "MUST", "comment": "\n   The keyring MUST attempt to encrypt the plaintext data key in the\n   encryption materials (structures.md#encryption-materials) using RSA.\n"}, {"source": "src/AwsCryptographicMaterialProviders/Keyrings/RawRSAKeyring.dfy", "target_path": "compliance/framework/raw-rsa-keyring.txt", "target_section": "2.6.1", "line": 144, "type": "IMPLICATION"}, {"source": "src/AwsCryptographicMaterialProviders/Keyrings/RawRSAKeyring.dfy", "target_path": "compliance/framework/raw-rsa-keyring.txt", "target_section": "2.6.1", "line": 210, "type": "CITATION"}, {"source": "compliance/framework/raw-rsa-keyring.txt", "target_path": "compliance/framework/raw-rsa-keyring.txt", "target_section": "2.6.1", "type": "SPEC", "level": "MUST", "comment": " If RSA encryption was successful, OnEncrypt MUST return the input\n   encryption materials (structures.md#encryption-materials), modified\n   in the following ways:\n"}, {"source": "src/AwsCryptographicMaterialProviders/Keyrings/RawRSAKeyring.dfy", "target_path": "compliance/framework/raw-rsa-keyring.txt", "target_section": "2.6.2", "line": 259, "type": "IMPLICATION"}, {"source": "compliance/framework/raw-rsa-keyring.txt", "target_path": "compliance/framework/raw-rsa-keyring.txt", "target_section": "2.6.2", "type": "SPEC", "level": "MUST", "comment": "\n\n   OnDecrypt MUST fail if this keyring does not have a specified private\n   key (Section 2.5.3).\n"}, {"source": "src/AwsCryptographicMaterialProviders/Keyrings/RawRSAKeyring.dfy", "target_path": "compliance/framework/raw-rsa-keyring.txt", "target_section": "2.6.2", "line": 245, "type": "IMPLICATION"}, {"source": "compliance/framework/raw-rsa-keyring.txt", "target_path": "compliance/framework/raw-rsa-keyring.txt", "target_section": "2.6.2", "type": "SPEC", "level": "MUST", "comment": "\n   OnDecrypt MUST take decryption materials (structures.md#decryption-\n   materials) and a list of encrypted data keys\n   (structures.md#encrypted-data-key) as input.\n"}, {"source": "src/AwsCryptographicMaterialProviders/Keyrings/RawRSAKeyring.dfy", "target_path": "compliance/framework/raw-rsa-keyring.txt", "target_section": "2.6.2", "line": 268, "type": "IMPLICATION"}, {"source": "compliance/framework/raw-rsa-keyring.txt", "target_path": "compliance/framework/raw-rsa-keyring.txt", "target_section": "2.6.2", "type": "SPEC", "level": "MUST", "comment": "\n   If the decryption materials already contain a plaintext data key, the\n   keyring MUST fail and MUST NOT modify the decryption materials\n   (structures.md#decryption-materials).\n"}, {"source": "src/AwsCryptographicMaterialProviders/Keyrings/RawRSAKeyring.dfy", "target_path": "compliance/framework/raw-rsa-keyring.txt", "target_section": "2.6.2", "line": 288, "type": "CITATION"}, {"source": "test/AwsCryptographicMaterialProviders/Keyrings/TestRawRSAKeyring.dfy", "target_path": "compliance/framework/raw-rsa-keyring.txt", "target_section": "2.6.2", "line": 230, "type": "TEST"}, {"source": "compliance/framework/raw-rsa-keyring.txt", "target_path": "compliance/framework/raw-rsa-keyring.txt", "target_section": "2.6.2", "type": "SPEC", "level": "MUST", "comment": "\n   The keyring MUST attempt to decrypt the input encrypted data keys, in\n   list order, until it successfully decrypts one.\n"}, {"source": "src/AwsCryptographicMaterialProviders/Keyrings/RawRSAKeyring.dfy", "target_path": "compliance/framework/raw-rsa-keyring.txt", "target_section": "2.6.2", "line": 341, "type": "IMPLICATION"}, {"source": "compliance/framework/raw-rsa-keyring.txt", "target_path": "compliance/framework/raw-rsa-keyring.txt", "target_section": "2.6.2", "type": "SPEC", "level": "MUST", "comment": "\n   For each encrypted data key, the keyring MUST attempt to decrypt the\n   encrypted data key into plaintext using RSA if and only if the\n   following is true:\n"}, {"source": "src/AwsCryptographicMaterialProviders/Keyrings/RawRSAKeyring.dfy", "target_path": "compliance/framework/raw-rsa-keyring.txt", "target_section": "2.6.2", "line": 302, "type": "CITATION"}, {"source": "test/AwsCryptographicMaterialProviders/Keyrings/TestRawRSAKeyring.dfy", "target_path": "compliance/framework/raw-rsa-keyring.txt", "target_section": "2.6.2", "line": 240, "type": "TEST"}, {"source": "compliance/framework/raw-rsa-keyring.txt", "target_path": "compliance/framework/raw-rsa-keyring.txt", "target_section": "2.6.2", "type": "SPEC", "level": "MUST", "comment": "   If any decryption succeeds, this keyring MUST immediately return the\n   input decryption materials (structures.md#decryption-materials),\n   modified in the following ways:\n\n   *  The output of RSA decryption is set as the decryption material's\n      plaintext data key.\n"}, {"source": "src/AwsCryptographicMaterialProviders/Keyrings/RawRSAKeyring.dfy", "target_path": "compliance/framework/raw-rsa-keyring.txt", "target_section": "2.6.2", "line": 332, "type": "CITATION"}, {"source": "test/AwsCryptographicMaterialProviders/Keyrings/TestRawRSAKeyring.dfy", "target_path": "compliance/framework/raw-rsa-keyring.txt", "target_section": "2.6.2", "line": 175, "type": "TEST"}, {"source": "compliance/framework/raw-rsa-keyring.txt", "target_path": "compliance/framework/raw-rsa-keyring.txt", "target_section": "2.6.2", "type": "SPEC", "level": "MUST", "comment": "\n   If no decryption succeeds, the keyring MUST fail and MUST NOT modify\n   the decryption materials (structures.md#decryption-materials).\n"}, {"source": "compliance/framework/multi-keyring.txt", "target_path": "compliance/framework/multi-keyring.txt", "target_section": "2.5.1", "type": "SPEC", "level": "MUST", "comment": "\n\n   The key words \"MUST\", \"MUST NOT\", \"REQUIRED\", \"SHALL\", \"SHALL NOT\",\n   \"SHOULD\", \"SHOULD NOT\", \"RECOMMENDED\", \"MAY\", and \"OPTIONAL\" in this\n   document are to be interpreted as described in RFC 2119\n   (https://tools.ietf.org/html/rfc2119).\n"}, {"source": "src/AwsCryptographicMaterialProviders/Keyrings/MultiKeyring.dfy", "target_path": "compliance/framework/multi-keyring.txt", "target_section": "2.6", "line": 35, "type": "IMPLICATION"}, {"source": "compliance/framework/multi-keyring.txt", "target_path": "compliance/framework/multi-keyring.txt", "target_section": "2.6", "type": "SPEC", "level": "MUST", "comment": "   On keyring initialization, a keyring MUST define at least one of the\n   following:\n"}, {"source": "src/AwsCryptographicMaterialProviders/Keyrings/MultiKeyring.dfy", "target_path": "compliance/framework/multi-keyring.txt", "target_section": "2.6.1", "line": 61, "type": "IMPLICATION"}, {"source": "compliance/framework/multi-keyring.txt", "target_path": "compliance/framework/multi-keyring.txt", "target_section": "2.6.1", "type": "SPEC", "level": "MUST", "comment": "\n   This keyring MUST implement the Generate Data Key (keyring-\n   interface.md#generate-data-key) behavior during OnEncrypt (keyring-\n   interface.md#onencrypt). "}, {"source": "src/AwsCryptographicMaterialProviders/Keyrings/MultiKeyring.dfy", "target_path": "compliance/framework/multi-keyring.txt", "target_section": "2.6.1", "line": 77, "type": "IMPLICATION"}, {"source": "compliance/framework/multi-keyring.txt", "target_path": "compliance/framework/multi-keyring.txt", "target_section": "2.6.1", "type": "SPEC", "level": "MUST", "comment": " This means that this keyring MUST return\n   encryption materials (structures.md#encryption-materials) containing\n   a plaintext data key on OnEncrypt (keyring-interface.md#onencrypt).\n"}, {"source": "src/AwsCryptographicMaterialProviders/Keyrings/MultiKeyring.dfy", "target_path": "compliance/framework/multi-keyring.txt", "target_section": "2.6.1", "line": 41, "type": "IMPLICATION"}, {"source": "compliance/framework/multi-keyring.txt", "target_path": "compliance/framework/multi-keyring.txt", "target_section": "2.6.1", "type": "SPEC", "level": "MUST", "comment": "\n   If the list of child keyrings (Section 2.6.2) is empty, a generator\n   keyring (Section 2.6.1) MUST be defined for the keyring.\n"}, {"source": "src/AwsCryptographicMaterialProviders/Keyrings/MultiKeyring.dfy", "target_path": "compliance/framework/multi-keyring.txt", "target_section": "2.6.2", "line": 47, "type": "IMPLICATION"}, {"source": "compliance/framework/multi-keyring.txt", "target_path": "compliance/framework/multi-keyring.txt", "target_section": "2.6.2", "type": "SPEC", "level": "MUST", "comment": "\n   If this keyring does not have a generator keyring (Section 2.6.1),\n   this list MUST NOT be empty.\n"}, {"source": "src/AwsCryptographicMaterialProviders/Keyrings/MultiKeyring.dfy", "target_path": "compliance/framework/multi-keyring.txt", "target_section": "2.7.1", "line": 116, "type": "CITATION"}, {"source": "test/AwsCryptographicMaterialProviders/Keyrings/TestMultiKeyring.dfy", "target_path": "compliance/framework/multi-keyring.txt", "target_section": "2.7.1", "line": 68, "type": "TEST"}, {"source": "compliance/framework/multi-keyring.txt", "target_path": "compliance/framework/multi-keyring.txt", "target_section": "2.7.1", "type": "SPEC", "level": "MUST", "comment": "   If this keyring has a generator keyring, this keyring MUST first\n   generate a plaintext data key using the generator keyring:\n"}, {"source": "src/AwsCryptographicMaterialProviders/Keyrings/MultiKeyring.dfy", "target_path": "compliance/framework/multi-keyring.txt", "target_section": "2.7.1", "line": 84, "type": "IMPLICATION"}, {"source": "compliance/framework/multi-keyring.txt", "target_path": "compliance/framework/multi-keyring.txt", "target_section": "2.7.1", "type": "SPEC", "level": "MUST", "comment": "   If this keyring does not have a generator keyring (Section 2.6.1),\n   and the input encryption materials (structures.md#encryption-\n   materials) does not include a plaintext data key, OnEncrypt MUST\n   fail.\n"}, {"source": "src/AwsCryptographicMaterialProviders/Keyrings/MultiKeyring.dfy", "target_path": "compliance/framework/multi-keyring.txt", "target_section": "2.7.1", "line": 148, "type": "CITATION"}, {"source": "test/AwsCryptographicMaterialProviders/Keyrings/TestMultiKeyring.dfy", "target_path": "compliance/framework/multi-keyring.txt", "target_section": "2.7.1", "line": 79, "type": "TEST"}, {"source": "compliance/framework/multi-keyring.txt", "target_path": "compliance/framework/multi-keyring.txt", "target_section": "2.7.1", "type": "SPEC", "level": "MUST", "comment": "\n   Next, for each keyring (keyring-interface.md) in this keyring's list\n   of child keyrings (Section 2.6.2), the keyring MUST call OnEncrypt\n   (keyring-interface.md#onencrypt). "}, {"source": "src/AwsCryptographicMaterialProviders/Keyrings/MultiKeyring.dfy", "target_path": "compliance/framework/multi-keyring.txt", "target_section": "2.7.1", "line": 154, "type": "CITATION"}, {"source": "test/AwsCryptographicMaterialProviders/Keyrings/TestMultiKeyring.dfy", "target_path": "compliance/framework/multi-keyring.txt", "target_section": "2.7.1", "line": 95, "type": "TEST"}, {"source": "compliance/framework/multi-keyring.txt", "target_path": "compliance/framework/multi-keyring.txt", "target_section": "2.7.1", "type": "SPEC", "level": "MUST", "comment": " If the child keyring's OnEncrypt (keyring-\n   interface.md#onencrypt) fails, this OnEncrypt MUST also fail.\n"}, {"source": "src/AwsCryptographicMaterialProviders/Keyrings/MultiKeyring.dfy", "target_path": "compliance/framework/multi-keyring.txt", "target_section": "2.7.1", "line": 174, "type": "CITATION"}, {"source": "test/AwsCryptographicMaterialProviders/Keyrings/TestMultiKeyring.dfy", "target_path": "compliance/framework/multi-keyring.txt", "target_section": "2.7.1", "line": 85, "type": "TEST"}, {"source": "compliance/framework/multi-keyring.txt", "target_path": "compliance/framework/multi-keyring.txt", "target_section": "2.7.1", "type": "SPEC", "level": "MUST", "comment": "\n   If all previous OnEncrypt (keyring-interface.md#onencrypt) calls\n   succeeded, this keyring MUST return the encryption materials\n   (structures.md#encryption-materials) returned by the last OnEncrypt\n   call.\n"}, {"source": "src/AwsCryptographicMaterialProviders/Keyrings/MultiKeyring.dfy", "target_path": "compliance/framework/multi-keyring.txt", "target_section": "2.7.2", "line": 194, "type": "IMPLICATION"}, {"source": "compliance/framework/multi-keyring.txt", "target_path": "compliance/framework/multi-keyring.txt", "target_section": "2.7.2", "type": "SPEC", "level": "MUST", "comment": "\n\n   If the decryption materials already contain a plaintext data key, the\n   keyring MUST fail and MUST NOT modify the decryption materials\n   (structures.md#decryption-materials).\n"}, {"source": "src/AwsCryptographicMaterialProviders/Keyrings/MultiKeyring.dfy", "target_path": "compliance/framework/multi-keyring.txt", "target_section": "2.7.2", "line": 213, "type": "CITATION"}, {"source": "test/AwsCryptographicMaterialProviders/Keyrings/TestMultiKeyring.dfy", "target_path": "compliance/framework/multi-keyring.txt", "target_section": "2.7.2", "line": 156, "type": "TEST"}, {"source": "compliance/framework/multi-keyring.txt", "target_path": "compliance/framework/multi-keyring.txt", "target_section": "2.7.2", "type": "SPEC", "level": "MUST", "comment": "\n   Otherwise, OnDecrypt MUST first attempt to decrypt the encrypted data\n   keys (structures.md#encrypted-data-keys-1) in the input decryption\n   materials (structures.md#decryption-materials) using its generator\n   keyring (Section 2.6.1). "}, {"source": "src/AwsCryptographicMaterialProviders/Keyrings/MultiKeyring.dfy", "target_path": "compliance/framework/multi-keyring.txt", "target_section": "2.7.2", "line": 230, "type": "CITATION"}, {"source": "test/AwsCryptographicMaterialProviders/Keyrings/TestMultiKeyring.dfy", "target_path": "compliance/framework/multi-keyring.txt", "target_section": "2.7.2", "line": 189, "type": "TEST"}, {"source": "compliance/framework/multi-keyring.txt", "target_path": "compliance/framework/multi-keyring.txt", "target_section": "2.7.2", "type": "SPEC", "level": "MUST", "comment": " If the generator keyring is unable to\n   decrypt the materials, the multi-keyring MUST attempt to decrypt\n   using its child keyrings, until one either succeeds in decryption or\n   all have failed.\n"}, {"source": "src/AwsCryptographicMaterialProviders/Keyrings/MultiKeyring.dfy", "target_path": "compliance/framework/multi-keyring.txt", "target_section": "2.7.2", "line": 239, "type": "CITATION"}, {"source": "test/AwsCryptographicMaterialProviders/Keyrings/TestMultiKeyring.dfy", "target_path": "compliance/framework/multi-keyring.txt", "target_section": "2.7.2", "line": 196, "type": "TODO"}, {"source": "compliance/framework/multi-keyring.txt", "target_path": "compliance/framework/multi-keyring.txt", "target_section": "2.7.2", "type": "SPEC", "level": "MUST", "comment": "\n   For each keyring (keyring-interface.md) to be used for decryption,\n   the multi-keyring MUST call that keyring's OnDecrypt (keyring-\n   interface.md#ondecrypt) using the unmodified decryption materials\n   (structures.md#decryption-materials) and the input encrypted data key\n   (structures.md#encrypted-data-key) list. "}, {"source": "src/AwsCryptographicMaterialProviders/Keyrings/MultiKeyring.dfy", "target_path": "compliance/framework/multi-keyring.txt", "target_section": "2.7.2", "line": 248, "type": "CITATION"}, {"source": "test/AwsCryptographicMaterialProviders/Keyrings/TestMultiKeyring.dfy", "target_path": "compliance/framework/multi-keyring.txt", "target_section": "2.7.2", "line": 229, "type": "TODO"}, {"source": "compliance/framework/multi-keyring.txt", "target_path": "compliance/framework/multi-keyring.txt", "target_section": "2.7.2", "type": "SPEC", "level": "MUST", "comment": " If OnDecrypt (keyring-\n   interface.md#ondecrypt) returns decryption materials\n   (structures.md#decryption-materials) containing a plaintext data key,\n   the multi-keyring MUST immediately return the modified decryption\n   materials. "}, {"source": "src/AwsCryptographicMaterialProviders/Keyrings/MultiKeyring.dfy", "target_path": "compliance/framework/multi-keyring.txt", "target_section": "2.7.2", "line": 259, "type": "CITATION"}, {"source": "test/AwsCryptographicMaterialProviders/Keyrings/TestMultiKeyring.dfy", "target_path": "compliance/framework/multi-keyring.txt", "target_section": "2.7.2", "line": 246, "type": "TEST"}, {"source": "compliance/framework/multi-keyring.txt", "target_path": "compliance/framework/multi-keyring.txt", "target_section": "2.7.2", "type": "SPEC", "level": "MUST", "comment": " If the child keyring's OnDecrypt call fails, the multi-\n   keyring MUST collect the error and continue to the next keyring, if\n   any.\n"}, {"source": "src/AwsCryptographicMaterialProviders/Keyrings/MultiKeyring.dfy", "target_path": "compliance/framework/multi-keyring.txt", "target_section": "2.7.2", "line": 267, "type": "CITATION"}, {"source": "test/AwsCryptographicMaterialProviders/Keyrings/TestMultiKeyring.dfy", "target_path": "compliance/framework/multi-keyring.txt", "target_section": "2.7.2", "line": 252, "type": "TEST"}, {"source": "compliance/framework/multi-keyring.txt", "target_path": "compliance/framework/multi-keyring.txt", "target_section": "2.7.2", "type": "SPEC", "level": "MUST", "comment": "\n   If, after calling OnDecrypt (keyring-interface.md#ondecrypt) on every\n   child keyring (Section 2.6.2) (and possibly the generator keyring\n   (Section 2.6.1)), the decryption materials (structures.md#decryption-\n   materials) still do not contain a plaintext data key, OnDecrypt MUST\n   return a failure message containing the collected failure messages\n   from the child keyrings.\n"}, {"source": "compliance_exceptions/multi-keyring.txt", "target_path": "compliance/framework/multi-keyring.txt", "target_section": "2.8", "line": 1, "type": "EXCEPTION"}, {"source": "compliance/framework/multi-keyring.txt", "target_path": "compliance/framework/multi-keyring.txt", "target_section": "2.8", "type": "SPEC", "level": "SHOULD", "comment": "\n\n   Users SHOULD examine the keyrings (keyring-interface.md) they include\n   in a multi-keyring to ensure that they understand what set of\n   keyrings will be capable of obtaining the plaintext data key from the\n   returned set of encrypted data keys.\n"}, {"source": "compliance/framework/structures.txt", "target_path": "compliance/framework/structures.txt", "target_section": "2.2.1", "type": "SPEC", "level": "MUST", "comment": "\n\n   The key words \"MUST\", \"MUST NOT\", \"REQUIRED\", \"SHALL\", \"SHALL NOT\",\n   \"SHOULD\", \"SHOULD NOT\", \"RECOMMENDED\", \"MAY\", and \"OPTIONAL\" in this\n   document are to be interpreted as described in RFC 2119\n   (https://tools.ietf.org/html/rfc2119).\n"}, {"source": "compliance_exceptions/structures.txt", "target_path": "compliance/framework/structures.txt", "target_section": "2.3", "line": 2, "type": "EXCEPTION"}, {"source": "compliance/framework/structures.txt", "target_path": "compliance/framework/structures.txt", "target_section": "2.3", "type": "SPEC", "level": "MUST", "comment": " These\n   structures define a group of related fields that MUST hold certain\n   properties. "}, {"source": "compliance_exceptions/structures.txt", "target_path": "compliance/framework/structures.txt", "target_section": "2.3", "line": 9, "type": "EXCEPTION"}, {"source": "compliance/framework/structures.txt", "target_path": "compliance/framework/structures.txt", "target_section": "2.3", "type": "SPEC", "level": "MUST", "comment": " Wherever these structures are referenced in this\n   specification, implementations MUST ensure that all properties of a\n   structure's fields are upheld.\n"}, {"source": "compliance_exceptions/structures.txt", "target_path": "compliance/framework/structures.txt", "target_section": "2.3", "line": 16, "type": "EXCEPTION"}, {"source": "compliance/framework/structures.txt", "target_path": "compliance/framework/structures.txt", "target_section": "2.3", "type": "SPEC", "level": "MAY", "comment": " While these structures will usually be represented as\n   objects, lower level languages MAY represent these fields in a less\n   strictly defined way as long as all field properties are still\n   upheld.\n"}, {"source": "compliance_exceptions/structures.txt", "target_path": "compliance/framework/structures.txt", "target_section": "2.3.1.2", "line": 24, "type": "EXCEPTION"}, {"source": "compliance/framework/structures.txt", "target_path": "compliance/framework/structures.txt", "target_section": "2.3.1.2", "type": "SPEC", "level": "MAY", "comment": "   This specification uses the terms \"encrypt\" and \"decrypt\" for\n   simplicity, but the actual process by which a key provider obtains\n   the plaintext data key from the ciphertext and vice versa MAY be any\n   reversible operation, though we expect that most will use encryption.\n"}, {"source": "compliance/framework/structures.txt", "target_path": "compliance/framework/structures.txt", "target_section": "2.3.1.2", "type": "SPEC", "level": "MUST", "comment": "\n   Some key provider MUST be capable of deterministically obtaining the\n   plaintext key from the ciphertext.\n"}, {"source": "compliance_exceptions/structures.txt", "target_path": "compliance/framework/structures.txt", "target_section": "2.3.2.2", "line": 38, "type": "EXCEPTION"}, {"source": "compliance/framework/structures.txt", "target_path": "compliance/framework/structures.txt", "target_section": "2.3.2.2", "type": "SPEC", "level": "SHOULD", "comment": "\n   Users SHOULD use the encryption context to store:\n"}, {"source": "compliance_exceptions/structures.txt", "target_path": "compliance/framework/structures.txt", "target_section": "2.3.2.2", "line": 49, "type": "EXCEPTION"}, {"source": "compliance/framework/structures.txt", "target_path": "compliance/framework/structures.txt", "target_section": "2.3.2.2", "type": "SPEC", "level": "MUST", "comment": "   Users MUST NOT use the encryption context to store secret data.\n"}, {"source": "src/Generated/AwsCryptographicMaterialProviders.dfy", "target_path": "compliance/framework/structures.txt", "target_section": "2.3.3.2", "line": 132, "type": "IMPLICATION"}, {"source": "compliance/framework/structures.txt", "target_path": "compliance/framework/structures.txt", "target_section": "2.3.3.2", "type": "SPEC", "level": "MAY", "comment": " This structure MAY include\n   any of the following fields:\n"}, {"source": "compliance/framework/structures.txt", "target_path": "compliance/framework/structures.txt", "target_section": "2.3.3.2", "type": "SPEC", "level": "MUST", "comment": "\n   The Section 2.3.1.2.3 of each encrypted data key in this list MUST be\n   an opaque form of the plaintext data key from this set of encryption\n   materials.\n"}, {"source": "compliance/framework/structures.txt", "target_path": "compliance/framework/structures.txt", "target_section": "2.3.3.2", "type": "SPEC", "level": "MUST", "comment": "\n   If the plaintext data key is not included in this set of encryption\n   materials, this list MUST be empty.\n"}, {"source": "compliance/framework/structures.txt", "target_path": "compliance/framework/structures.txt", "target_section": "2.3.3.2", "type": "SPEC", "level": "SHOULD", "comment": "\n   If an encryption material (Section 2.3.3) contains a signing key\n   (Section 2.3.3.2.5), the encryption context (Section 2.3.2) SHOULD\n   include the reserved key \"aws-crypto-public-key\". "}, {"source": "compliance/framework/structures.txt", "target_path": "compliance/framework/structures.txt", "target_section": "2.3.3.2", "type": "SPEC", "level": "SHOULD", "comment": " The mapped value\n   from the reserved key \"aws-crypto-public-key\" SHOULD be the signature\n   verification key corresponding to the signing key (Section 2.3.3.2.5)\n   stored on the encryption material (Section 2.3.3). "}, {"source": "compliance/framework/structures.txt", "target_path": "compliance/framework/structures.txt", "target_section": "2.3.3.2", "type": "SPEC", "level": "SHOULD", "comment": " If an encryption\n   material (Section 2.3.3) does not contains a signing key\n   (Section 2.3.3.2.5), the encryption context (Section 2.3.2) SHOULD\n   NOT include the reserved key \"aws-crypto-public-key\".\n"}, {"source": "compliance/framework/structures.txt", "target_path": "compliance/framework/structures.txt", "target_section": "2.3.3.2", "type": "SPEC", "level": "MUST", "comment": "\n   The plaintext data key MUST:\n"}, {"source": "compliance/framework/structures.txt", "target_path": "compliance/framework/structures.txt", "target_section": "2.3.3.2", "type": "SPEC", "level": "SHOULD", "comment": "   The plaintext data key SHOULD be stored as immutable data.\n"}, {"source": "compliance/framework/structures.txt", "target_path": "compliance/framework/structures.txt", "target_section": "2.3.3.2", "type": "SPEC", "level": "SHOULD", "comment": "\n   The plaintext data key SHOULD offer an interface to zero the\n   plaintext data key.\n"}, {"source": "compliance/framework/structures.txt", "target_path": "compliance/framework/structures.txt", "target_section": "2.3.3.2", "type": "SPEC", "level": "MUST", "comment": "\n   The signing key MUST fit the specification described by the signature\n   algorithm (algorithm-suites.md#signature-algorithm) included in this\n   encryption material's algorithm suite (Section 2.3.3.2.1). "}, {"source": "compliance/framework/structures.txt", "target_path": "compliance/framework/structures.txt", "target_section": "2.3.3.2", "type": "SPEC", "level": "MUST", "comment": " If the\n   algorithm suite does not contain a signing algorithm, the signing key\n   MUST NOT be present.\n"}, {"source": "compliance/framework/structures.txt", "target_path": "compliance/framework/structures.txt", "target_section": "2.3.3.2", "type": "SPEC", "level": "MUST", "comment": "\n   The value of this key MUST be kept secret.\n"}, {"source": "src/Generated/AwsCryptographicMaterialProviders.dfy", "target_path": "compliance/framework/structures.txt", "target_section": "2.3.4.2", "line": 151, "type": "IMPLICATION"}, {"source": "compliance/framework/structures.txt", "target_path": "compliance/framework/structures.txt", "target_section": "2.3.4.2", "type": "SPEC", "level": "MAY", "comment": " This structure MAY include\n   any of the following fields:\n"}, {"source": "compliance/framework/structures.txt", "target_path": "compliance/framework/structures.txt", "target_section": "2.3.4.2", "type": "SPEC", "level": "SHOULD", "comment": "\n   If a decryption materials (Section 2.3.4) contains a verification key\n   (Section 2.3.4.2.4), the encryption context (Section 2.3.2) SHOULD\n   include the reserved key \"aws-crypto-public-key\". "}, {"source": "compliance/framework/structures.txt", "target_path": "compliance/framework/structures.txt", "target_section": "2.3.4.2", "type": "SPEC", "level": "SHOULD", "comment": " The mapped value\n   from the reserved key \"aws-crypto-public-key\" SHOULD be the signature\n   verification key stored on the decryption materials (Section 2.3.4).\n"}, {"source": "compliance/framework/structures.txt", "target_path": "compliance/framework/structures.txt", "target_section": "2.3.4.2", "type": "SPEC", "level": "SHOULD", "comment": "   If a decryption materials (Section 2.3.4) does not contain a\n   verification key (Section 2.3.4.2.4), the encryption context\n   (Section 2.3.2) SHOULD NOT include the reserved key \"aws-crypto-\n   public-key\".\n"}, {"source": "compliance/framework/structures.txt", "target_path": "compliance/framework/structures.txt", "target_section": "2.3.4.2", "type": "SPEC", "level": "MUST", "comment": "\n   The plaintext data key MUST:\n"}, {"source": "compliance/framework/structures.txt", "target_path": "compliance/framework/structures.txt", "target_section": "2.3.4.2", "type": "SPEC", "level": "SHOULD", "comment": "   The plaintext data key SHOULD be stored as immutable data.\n"}, {"source": "compliance/framework/structures.txt", "target_path": "compliance/framework/structures.txt", "target_section": "2.3.4.2", "type": "SPEC", "level": "SHOULD", "comment": "\n   The plaintext data key SHOULD offer an interface to zero the\n   plaintext data key.\n"}, {"source": "compliance/framework/structures.txt", "target_path": "compliance/framework/structures.txt", "target_section": "2.3.4.2", "type": "SPEC", "level": "MUST", "comment": "\n   The verification key MUST fit the specification for the signature\n   algorithm (algorithm-suites.md#signature-algorithm) included in this\n   decryption material's algorithm suite (Section 2.3.4.2.1).\n"}, {"source": "compliance/framework/master-key-provider-interface.txt", "target_path": "compliance/framework/master-key-provider-interface.txt", "target_section": "2.3.1", "type": "SPEC", "level": "SHOULD", "comment": " Master key providers SHOULD NOT be\n   included in any additional implementations. "}, {"source": "compliance/framework/master-key-provider-interface.txt", "target_path": "compliance/framework/master-key-provider-interface.txt", "target_section": "2.3.1", "type": "SPEC", "level": "MUST", "comment": " Any new implementations\n   MUST include Keyrings (./keyring-interface.md) instead.\n"}, {"source": "compliance/framework/master-key-provider-interface.txt", "target_path": "compliance/framework/master-key-provider-interface.txt", "target_section": "2.4.1", "type": "SPEC", "level": "MUST", "comment": "\n\n   The key words \"MUST\", \"MUST NOT\", \"REQUIRED\", \"SHALL\", \"SHALL NOT\",\n   \"SHOULD\", \"SHOULD NOT\", \"RECOMMENDED\", \"MAY\", and \"OPTIONAL\" in this\n   document are to be interpreted as described in RFC 2119\n   (https://tools.ietf.org/html/rfc2119).\n"}, {"source": "compliance/framework/master-key-provider-interface.txt", "target_path": "compliance/framework/master-key-provider-interface.txt", "target_section": "2.5.1", "type": "SPEC", "level": "MUST", "comment": "\n   An implementation MUST support master key selection by key ID.\n"}, {"source": "compliance/framework/master-key-provider-interface.txt", "target_path": "compliance/framework/master-key-provider-interface.txt", "target_section": "2.5.1", "type": "SPEC", "level": "MAY", "comment": "\n   An implementation MAY support master key selection by provider info\n   or provider ID.\n"}, {"source": "compliance/framework/master-key-provider-interface.txt", "target_path": "compliance/framework/master-key-provider-interface.txt", "target_section": "2.5.1", "type": "SPEC", "level": "MUST", "comment": "\n   The output of this interface MUST be a master key.\n"}, {"source": "compliance/framework/master-key-provider-interface.txt", "target_path": "compliance/framework/master-key-provider-interface.txt", "target_section": "2.5.1", "type": "SPEC", "level": "MUST", "comment": "\n   If the master key provider cannot locate an appropriate master key,\n   the call MUST result in an error.\n"}, {"source": "compliance/framework/master-key-provider-interface.txt", "target_path": "compliance/framework/master-key-provider-interface.txt", "target_section": "2.5.2", "type": "SPEC", "level": "SHOULD", "comment": "\n\n   This interface provides a way for a master key provider to indicate\n   which master keys SHOULD be used for encryption.\n"}, {"source": "compliance/framework/master-key-provider-interface.txt", "target_path": "compliance/framework/master-key-provider-interface.txt", "target_section": "2.5.2", "type": "SPEC", "level": "MUST", "comment": "\n   Inputs to this interface MUST include the encryption context.\n"}, {"source": "compliance/framework/master-key-provider-interface.txt", "target_path": "compliance/framework/master-key-provider-interface.txt", "target_section": "2.5.2", "type": "SPEC", "level": "MAY", "comment": "\n   Inputs MAY include the plaintext body and plaintext size.\n"}, {"source": "compliance/framework/master-key-provider-interface.txt", "target_path": "compliance/framework/master-key-provider-interface.txt", "target_section": "2.5.2", "type": "SPEC", "level": "MUST", "comment": "\n   The output of this interface MUST include a list of all master keys\n   that SHOULD be used for encryption.\n"}, {"source": "compliance/framework/master-key-provider-interface.txt", "target_path": "compliance/framework/master-key-provider-interface.txt", "target_section": "2.5.2", "type": "SPEC", "level": "MUST", "comment": "\n   The output of this interface MUST indicate which one of those master\n   keys MUST be used to generate the data key.\n"}, {"source": "compliance/framework/master-key-provider-interface.txt", "target_path": "compliance/framework/master-key-provider-interface.txt", "target_section": "2.5.3", "type": "SPEC", "level": "SHOULD", "comment": "\n   The master key provider SHOULD attempt to decrypt the data key by\n   passing the request to any master keys that it has access to until it\n   has either exhausted available master keys or obtained a plaintext\n   data key.\n"}, {"source": "compliance/framework/master-key-provider-interface.txt", "target_path": "compliance/framework/master-key-provider-interface.txt", "target_section": "2.5.3", "type": "SPEC", "level": "MUST", "comment": "\n   Inputs to this interface MUST include the algorithm suite, the\n   encryption context, and a list of encrypted data keys.\n"}, {"source": "compliance/framework/master-key-provider-interface.txt", "target_path": "compliance/framework/master-key-provider-interface.txt", "target_section": "2.5.3", "type": "SPEC", "level": "MUST", "comment": "\n   The output of this interface MUST include the decrypted data key and\n   information that can identify which master key decrypted the data\n   key.\n"}, {"source": "compliance/framework/master-key-provider-interface.txt", "target_path": "compliance/framework/master-key-provider-interface.txt", "target_section": "2.5.3", "type": "SPEC", "level": "MUST", "comment": "\n   If the master key provider cannot decrypt the data key, the call MUST\n   result in an error.\n"}, {"source": "compliance/framework/master-key-interface.txt", "target_path": "compliance/framework/master-key-interface.txt", "target_section": "2.3.1", "type": "SPEC", "level": "SHOULD", "comment": " Master keys SHOULD NOT be included\n   in any additional implementations. "}, {"source": "compliance/framework/master-key-interface.txt", "target_path": "compliance/framework/master-key-interface.txt", "target_section": "2.3.1", "type": "SPEC", "level": "MUST", "comment": " Any new implementations MUST\n   include Keyrings (./keyring-interface.md) instead.\n"}, {"source": "compliance/framework/master-key-interface.txt", "target_path": "compliance/framework/master-key-interface.txt", "target_section": "2.4.1", "type": "SPEC", "level": "MUST", "comment": "\n\n   The key words \"MUST\", \"MUST NOT\", \"REQUIRED\", \"SHALL\", \"SHALL NOT\",\n   \"SHOULD\", \"SHOULD NOT\", \"RECOMMENDED\", \"MAY\", and \"OPTIONAL\" in this\n   document are to be interpreted as described in RFC 2119\n   (https://tools.ietf.org/html/rfc2119).\n"}, {"source": "compliance/framework/master-key-interface.txt", "target_path": "compliance/framework/master-key-interface.txt", "target_section": "2.5.1", "type": "SPEC", "level": "MUST", "comment": "\n   A master key MUST supply itself and MUST NOT supply any other master\n   keys.\n"}, {"source": "compliance/framework/master-key-interface.txt", "target_path": "compliance/framework/master-key-interface.txt", "target_section": "2.5.2", "type": "SPEC", "level": "MUST", "comment": "\n   A master key MUST supply itself and MUST NOT supply any other master\n   keys.\n"}, {"source": "compliance/framework/master-key-interface.txt", "target_path": "compliance/framework/master-key-interface.txt", "target_section": "2.5.3", "type": "SPEC", "level": "SHOULD", "comment": "\n   A master key SHOULD attempt to decrypt a data key using itself.\n"}, {"source": "compliance/framework/master-key-interface.txt", "target_path": "compliance/framework/master-key-interface.txt", "target_section": "2.5.3", "type": "SPEC", "level": "MUST", "comment": "\n   A master key MUST not attempt to use any other master keys.\n"}, {"source": "compliance/framework/master-key-interface.txt", "target_path": "compliance/framework/master-key-interface.txt", "target_section": "2.5.4", "type": "SPEC", "level": "MUST", "comment": "\n   The master key MUST generate a data key and MUST then encrypt that\n   data key.\n"}, {"source": "compliance/framework/master-key-interface.txt", "target_path": "compliance/framework/master-key-interface.txt", "target_section": "2.5.4", "type": "SPEC", "level": "MUST", "comment": "\n   Inputs to this interface MUST include the algorithm suite and the\n   encryption context.\n"}, {"source": "compliance/framework/master-key-interface.txt", "target_path": "compliance/framework/master-key-interface.txt", "target_section": "2.5.4", "type": "SPEC", "level": "MUST", "comment": "\n   The output of this interface MUST include the plaintext data key, the\n   data key encrypted under the master key, and information that can\n   identify which master key was used to generate and encrypt the data\n   key.\n"}, {"source": "compliance/framework/master-key-interface.txt", "target_path": "compliance/framework/master-key-interface.txt", "target_section": "2.5.4", "type": "SPEC", "level": "MUST", "comment": "\n   If the master key cannot generate or encrypt the data key, the call\n   MUST result in an error.\n"}, {"source": "compliance/framework/master-key-interface.txt", "target_path": "compliance/framework/master-key-interface.txt", "target_section": "2.5.5", "type": "SPEC", "level": "MUST", "comment": "\n   The master key MUST encrypt the data key.\n"}, {"source": "compliance/framework/master-key-interface.txt", "target_path": "compliance/framework/master-key-interface.txt", "target_section": "2.5.5", "type": "SPEC", "level": "MUST", "comment": "\n   Inputs to this interface MUST include the algorithm suite, the\n   encryption context, the encrypted data key, and information that can\n   identify which master key was used to encrypt the data key.\n"}, {"source": "compliance/framework/master-key-interface.txt", "target_path": "compliance/framework/master-key-interface.txt", "target_section": "2.5.5", "type": "SPEC", "level": "MUST", "comment": "\n   The output of this interface MUST include a value that this master\n   key can use to obtain the plaintext data key. "}, {"source": "compliance/framework/master-key-interface.txt", "target_path": "compliance/framework/master-key-interface.txt", "target_section": "2.5.5", "type": "SPEC", "level": "MUST", "comment": "\n   If the master key cannot encrypt the data key, the call MUST result\n   in an error.\n"}, {"source": "compliance/framework/aws-kms/aws-kms-discovery-keyring.txt", "target_path": "compliance/framework/aws-kms/aws-kms-discovery-keyring.txt", "target_section": "2.4.1", "type": "SPEC", "level": "MUST", "comment": "\n\n   The key words \"MUST\", \"MUST NOT\", \"REQUIRED\", \"SHALL\", \"SHALL NOT\",\n   \"SHOULD\", \"SHOULD NOT\", \"RECOMMENDED\", \"MAY\", and \"OPTIONAL\" in this\n   document are to be interpreted as described in RFC 2119\n   (https://tools.ietf.org/html/rfc2119).\n"}, {"source": "src/AwsCryptographicMaterialProviders/Keyrings/AwsKms/AwsKmsDiscoveryKeyring.dfy", "target_path": "compliance/framework/aws-kms/aws-kms-discovery-keyring.txt", "target_section": "2.6", "line": 44, "type": "IMPLICATION"}, {"source": "compliance/framework/aws-kms/aws-kms-discovery-keyring.txt", "target_path": "compliance/framework/aws-kms/aws-kms-discovery-keyring.txt", "target_section": "2.6", "type": "SPEC", "level": "MUST", "comment": "   On initialization the caller MUST provide:\n"}, {"source": "src/AwsCryptographicMaterialProviders/Keyrings/AwsKms/AwsKmsDiscoveryKeyring.dfy", "target_path": "compliance/framework/aws-kms/aws-kms-discovery-keyring.txt", "target_section": "2.6", "line": 48, "type": "IMPLICATION"}, {"source": "compliance/framework/aws-kms/aws-kms-discovery-keyring.txt", "target_path": "compliance/framework/aws-kms/aws-kms-discovery-keyring.txt", "target_section": "2.6", "type": "SPEC", "level": "MUST", "comment": "   The AWS KMS SDK client MUST NOT be null.\n"}, {"source": "src/AwsCryptographicMaterialProviders/Keyrings/AwsKms/AwsKmsDiscoveryKeyring.dfy", "target_path": "compliance/framework/aws-kms/aws-kms-discovery-keyring.txt", "target_section": "2.7", "line": 71, "type": "IMPLICATION"}, {"source": "compliance/framework/aws-kms/aws-kms-discovery-keyring.txt", "target_path": "compliance/framework/aws-kms/aws-kms-discovery-keyring.txt", "target_section": "2.7", "type": "SPEC", "level": "MUST", "comment": "\n\n   This function MUST fail.\n"}, {"source": "src/AwsCryptographicMaterialProviders/Keyrings/AwsKms/AwsKmsDiscoveryKeyring.dfy", "target_path": "compliance/framework/aws-kms/aws-kms-discovery-keyring.txt", "target_section": "2.8", "line": 81, "type": "IMPLICATION"}, {"source": "compliance/framework/aws-kms/aws-kms-discovery-keyring.txt", "target_path": "compliance/framework/aws-kms/aws-kms-discovery-keyring.txt", "target_section": "2.8", "type": "SPEC", "level": "MUST", "comment": "\n\n   OnDecrypt MUST take decryption materials\n   (../structures.md#decryption-materials) and a list of encrypted data\n   keys (../structures.md#encrypted-data-key) as input.\n"}, {"source": "src/AwsCryptographicMaterialProviders/Keyrings/AwsKms/AwsKmsDiscoveryKeyring.dfy", "target_path": "compliance/framework/aws-kms/aws-kms-discovery-keyring.txt", "target_section": "2.8", "line": 97, "type": "IMPLICATION"}, {"source": "compliance/framework/aws-kms/aws-kms-discovery-keyring.txt", "target_path": "compliance/framework/aws-kms/aws-kms-discovery-keyring.txt", "target_section": "2.8", "type": "SPEC", "level": "MUST", "comment": "\n   If the decryption materials (../structures.md#decryption-materials)\n   already contained a valid plaintext data key, they keyring MUST fail\n   and MUST NOT modify the decryption materials\n   (../structures.md#decryption-materials).\n"}, {"source": "src/AwsCryptographicMaterialProviders/Keyrings/AwsKms/AwsKmsDiscoveryKeyring.dfy", "target_path": "compliance/framework/aws-kms/aws-kms-discovery-keyring.txt", "target_section": "2.8", "line": 184, "type": "CITATION"}, {"source": "test/AwsCryptographicMaterialProviders/Keyrings/AwsKms/AwsKmsDiscoveryKeryring/TestAwsKmsEncryptedDataKeyFilter.dfy", "target_path": "compliance/framework/aws-kms/aws-kms-discovery-keyring.txt", "target_section": "2.8", "line": 43, "type": "TEST"}, {"source": "compliance/framework/aws-kms/aws-kms-discovery-keyring.txt", "target_path": "compliance/framework/aws-kms/aws-kms-discovery-keyring.txt", "target_section": "2.8", "type": "SPEC", "level": "MUST", "comment": "\n   The set of encrypted data keys MUST first be filtered to match this\n   keyring's configuration. "}, {"source": "src/AwsCryptographicMaterialProviders/Keyrings/AwsKms/AwsKmsDiscoveryKeyring.dfy", "target_path": "compliance/framework/aws-kms/aws-kms-discovery-keyring.txt", "target_section": "2.8", "line": 209, "type": "CITATION"}, {"source": "compliance/framework/aws-kms/aws-kms-discovery-keyring.txt", "target_path": "compliance/framework/aws-kms/aws-kms-discovery-keyring.txt", "target_section": "2.8", "type": "SPEC", "level": "MUST", "comment": "   For each encrypted data key in the filtered set, one at a time, the\n   OnDecrypt MUST attempt to decrypt the data key. "}, {"source": "src/AwsCryptographicMaterialProviders/Keyrings/AwsKms/AwsKmsDiscoveryKeyring.dfy", "target_path": "compliance/framework/aws-kms/aws-kms-discovery-keyring.txt", "target_section": "2.8", "line": 141, "type": "IMPLICATION"}, {"source": "compliance/framework/aws-kms/aws-kms-discovery-keyring.txt", "target_path": "compliance/framework/aws-kms/aws-kms-discovery-keyring.txt", "target_section": "2.8", "type": "SPEC", "level": "MUST", "comment": "\n   To attempt to decrypt a particular encrypted data key\n   (../structures.md#encrypted-data-key), OnDecrypt MUST call AWS KMS\n   Decrypt (https://docs.aws.amazon.com/kms/latest/APIReference/\n   API_Decrypt.html) with the configured AWS KMS client.\n"}, {"source": "src/AwsCryptographicMaterialProviders/Keyrings/AwsKms/AwsKmsDiscoveryKeyring.dfy", "target_path": "compliance/framework/aws-kms/aws-kms-discovery-keyring.txt", "target_section": "2.8", "line": 148, "type": "IMPLICATION"}, {"source": "compliance/framework/aws-kms/aws-kms-discovery-keyring.txt", "target_path": "compliance/framework/aws-kms/aws-kms-discovery-keyring.txt", "target_section": "2.8", "type": "SPEC", "level": "MUST", "comment": "\n   When calling AWS KMS Decrypt\n   (https://docs.aws.amazon.com/kms/latest/APIReference/\n   API_Decrypt.html), the keyring MUST call with a request constructed\n   as follows:\n"}, {"source": "compliance/framework/aws-kms/aws-kms-discovery-keyring.txt", "target_path": "compliance/framework/aws-kms/aws-kms-discovery-keyring.txt", "target_section": "2.8", "type": "SPEC", "level": "MUST", "comment": "   If the call to AWS KMS Decrypt\n   (https://docs.aws.amazon.com/kms/latest/APIReference/\n   API_Decrypt.html) succeeds OnDecrypt verifies\n\n   *  The \"KeyId\" field in the response MUST equal the AWS KMS ARN from\n      the provider info\n\n   *  The length of the response's \"Plaintext\" MUST equal the key\n      derivation input length (../algorithm-suites.md#key-derivation-\n      input-length) specified by the algorithm suite (../algorithm-\n      suites.md) included in the input decryption materials\n      (../structures.md#decryption-materials).\n"}, {"source": "src/AwsCryptographicMaterialProviders/Keyrings/AwsKms/AwsKmsDiscoveryKeyring.dfy", "target_path": "compliance/framework/aws-kms/aws-kms-discovery-keyring.txt", "target_section": "2.8", "line": 217, "type": "CITATION"}, {"source": "compliance/framework/aws-kms/aws-kms-discovery-keyring.txt", "target_path": "compliance/framework/aws-kms/aws-kms-discovery-keyring.txt", "target_section": "2.8", "type": "SPEC", "level": "MUST", "comment": "\n   If the response does not satisfy these requirements then an error is\n   collected and the next encrypted data key in the filtered set MUST be\n   attempted.\n"}, {"source": "src/AwsCryptographicMaterialProviders/Keyrings/AwsKms/AwsKmsDiscoveryKeyring.dfy", "target_path": "compliance/framework/aws-kms/aws-kms-discovery-keyring.txt", "target_section": "2.8", "line": 155, "type": "IMPLICATION"}, {"source": "compliance/framework/aws-kms/aws-kms-discovery-keyring.txt", "target_path": "compliance/framework/aws-kms/aws-kms-discovery-keyring.txt", "target_section": "2.8", "type": "SPEC", "level": "MUST", "comment": "\n   If the response does satisfy these requirements then OnDecrypt MUST\n   do the following with the response:\n\n   *  set the plaintext data key on the decryption materials\n      (../structures.md#decryption-materials) as the response\n      \"Plaintext\".\n"}, {"source": "src/AwsCryptographicMaterialProviders/Keyrings/AwsKms/AwsKmsDiscoveryKeyring.dfy", "target_path": "compliance/framework/aws-kms/aws-kms-discovery-keyring.txt", "target_section": "2.8", "line": 234, "type": "CITATION"}, {"source": "compliance/framework/aws-kms/aws-kms-discovery-keyring.txt", "target_path": "compliance/framework/aws-kms/aws-kms-discovery-keyring.txt", "target_section": "2.8", "type": "SPEC", "level": "MUST", "comment": "\n   If OnDecrypt fails to successfully decrypt any encrypted data key\n   (../structures.md#encrypted-data-key), then it MUST yield an error\n   that includes all collected errors.\n"}, {"source": "compliance/framework/aws-kms/aws-kms-mrk-discovery-keyring.txt", "target_path": "compliance/framework/aws-kms/aws-kms-mrk-discovery-keyring.txt", "target_section": "2.4.1", "type": "SPEC", "level": "MUST", "comment": "\n\n   The key words \"MUST\", \"MUST NOT\", \"REQUIRED\", \"SHALL\", \"SHALL NOT\",\n   \"SHOULD\", \"SHOULD NOT\", \"RECOMMENDED\", \"MAY\", and \"OPTIONAL\" in this\n   document are to be interpreted as described in RFC 2119\n   (https://tools.ietf.org/html/rfc2119).\n"}, {"source": "src/AwsCryptographicMaterialProviders/Keyrings/AwsKms/AwsKmsMrkDiscoveryKeyring.dfy", "target_path": "compliance/framework/aws-kms/aws-kms-mrk-discovery-keyring.txt", "target_section": "2.6", "line": 45, "type": "IMPLICATION"}, {"source": "compliance/framework/aws-kms/aws-kms-mrk-discovery-keyring.txt", "target_path": "compliance/framework/aws-kms/aws-kms-mrk-discovery-keyring.txt", "target_section": "2.6", "type": "SPEC", "level": "MUST", "comment": "   On initialization the keyring MUST accept the following parameters:\n"}, {"source": "src/AwsCryptographicMaterialProviders/Keyrings/AwsKms/AwsKmsMrkDiscoveryKeyring.dfy", "target_path": "compliance/framework/aws-kms/aws-kms-mrk-discovery-keyring.txt", "target_section": "2.6", "line": 49, "type": "IMPLICATION"}, {"source": "compliance/framework/aws-kms/aws-kms-mrk-discovery-keyring.txt", "target_path": "compliance/framework/aws-kms/aws-kms-mrk-discovery-keyring.txt", "target_section": "2.6", "type": "SPEC", "level": "MUST", "comment": "   They keyring MUST fail initialization if any required parameters are\n   missing or null. "}, {"source": "src/AwsCryptographicMaterialProviders/Client.dfy", "target_path": "compliance/framework/aws-kms/aws-kms-mrk-discovery-keyring.txt", "target_section": "2.6", "line": 207, "type": "IMPLICATION"}, {"source": "compliance/framework/aws-kms/aws-kms-mrk-discovery-keyring.txt", "target_path": "compliance/framework/aws-kms/aws-kms-mrk-discovery-keyring.txt", "target_section": "2.6", "type": "SPEC", "level": "SHOULD", "comment": " The keyring SHOULD fail initialization if the\n   provided region does not match the region of the KMS client. "}, {"source": "src/AwsCryptographicMaterialProviders/Keyrings/AwsKms/AwsKmsMrkDiscoveryKeyring.dfy", "target_path": "compliance/framework/aws-kms/aws-kms-mrk-discovery-keyring.txt", "target_section": "2.7", "line": 75, "type": "IMPLICATION"}, {"source": "compliance/framework/aws-kms/aws-kms-mrk-discovery-keyring.txt", "target_path": "compliance/framework/aws-kms/aws-kms-mrk-discovery-keyring.txt", "target_section": "2.7", "type": "SPEC", "level": "MUST", "comment": "\n\n   This function MUST fail.\n"}, {"source": "src/AwsCryptographicMaterialProviders/Keyrings/AwsKms/AwsKmsMrkDiscoveryKeyring.dfy", "target_path": "compliance/framework/aws-kms/aws-kms-mrk-discovery-keyring.txt", "target_section": "2.8", "line": 85, "type": "IMPLICATION"}, {"source": "compliance/framework/aws-kms/aws-kms-mrk-discovery-keyring.txt", "target_path": "compliance/framework/aws-kms/aws-kms-mrk-discovery-keyring.txt", "target_section": "2.8", "type": "SPEC", "level": "MUST", "comment": "\n\n   OnDecrypt MUST take decryption materials\n   (../structures.md#decryption-materials) and a list of encrypted data\n   keys (../structures.md#encrypted-data-key) as input.\n"}, {"source": "src/AwsCryptographicMaterialProviders/Keyrings/AwsKms/AwsKmsMrkDiscoveryKeyring.dfy", "target_path": "compliance/framework/aws-kms/aws-kms-mrk-discovery-keyring.txt", "target_section": "2.8", "line": 101, "type": "IMPLICATION"}, {"source": "compliance/framework/aws-kms/aws-kms-mrk-discovery-keyring.txt", "target_path": "compliance/framework/aws-kms/aws-kms-mrk-discovery-keyring.txt", "target_section": "2.8", "type": "SPEC", "level": "MUST", "comment": "\n   If the decryption materials (../structures.md#decryption-materials)\n   already contained a valid plaintext data key, they keyring MUST fail\n   and MUST NOT modify the decryption materials\n   (../structures.md#decryption-materials).\n"}, {"source": "src/AwsCryptographicMaterialProviders/Keyrings/AwsKms/AwsKmsMrkDiscoveryKeyring.dfy", "target_path": "compliance/framework/aws-kms/aws-kms-mrk-discovery-keyring.txt", "target_section": "2.8", "line": 190, "type": "CITATION"}, {"source": "compliance/framework/aws-kms/aws-kms-mrk-discovery-keyring.txt", "target_path": "compliance/framework/aws-kms/aws-kms-mrk-discovery-keyring.txt", "target_section": "2.8", "type": "SPEC", "level": "MUST", "comment": "\n   The set of encrypted data keys MUST first be filtered to match this\n   keyring's configuration. "}, {"source": "src/AwsCryptographicMaterialProviders/Keyrings/AwsKms/AwsKmsMrkDiscoveryKeyring.dfy", "target_path": "compliance/framework/aws-kms/aws-kms-mrk-discovery-keyring.txt", "target_section": "2.8", "line": 241, "type": "CITATION"}, {"source": "compliance/framework/aws-kms/aws-kms-mrk-discovery-keyring.txt", "target_path": "compliance/framework/aws-kms/aws-kms-mrk-discovery-keyring.txt", "target_section": "2.8", "type": "SPEC", "level": "MUST", "comment": "   For each encrypted data key in the filtered set, one at a time, the\n   OnDecrypt MUST attempt to decrypt the data key. "}, {"source": "src/AwsCryptographicMaterialProviders/Keyrings/AwsKms/AwsKmsMrkDiscoveryKeyring.dfy", "target_path": "compliance/framework/aws-kms/aws-kms-mrk-discovery-keyring.txt", "target_section": "2.8", "line": 144, "type": "IMPLICATION"}, {"source": "compliance/framework/aws-kms/aws-kms-mrk-discovery-keyring.txt", "target_path": "compliance/framework/aws-kms/aws-kms-mrk-discovery-keyring.txt", "target_section": "2.8", "type": "SPEC", "level": "MUST", "comment": "\n   To attempt to decrypt a particular encrypted data key\n   (../structures.md#encrypted-data-key), OnDecrypt MUST call AWS KMS\n   Decrypt (https://docs.aws.amazon.com/kms/latest/APIReference/\n   API_Decrypt.html) with the configured AWS KMS client.\n"}, {"source": "src/AwsCryptographicMaterialProviders/Keyrings/AwsKms/AwsKmsMrkDiscoveryKeyring.dfy", "target_path": "compliance/framework/aws-kms/aws-kms-mrk-discovery-keyring.txt", "target_section": "2.8", "line": 151, "type": "IMPLICATION"}, {"source": "compliance/framework/aws-kms/aws-kms-mrk-discovery-keyring.txt", "target_path": "compliance/framework/aws-kms/aws-kms-mrk-discovery-keyring.txt", "target_section": "2.8", "type": "SPEC", "level": "MUST", "comment": "\n   When calling AWS KMS Decrypt\n   (https://docs.aws.amazon.com/kms/latest/APIReference/\n   API_Decrypt.html), the keyring MUST call with a request constructed\n   as follows:\n"}, {"source": "compliance/framework/aws-kms/aws-kms-mrk-discovery-keyring.txt", "target_path": "compliance/framework/aws-kms/aws-kms-mrk-discovery-keyring.txt", "target_section": "2.8", "type": "SPEC", "level": "MUST", "comment": "   If the call to AWS KMS Decrypt\n   (https://docs.aws.amazon.com/kms/latest/APIReference/\n   API_Decrypt.html) succeeds OnDecrypt verifies\n\n   *  The \"KeyId\" field in the response MUST equal the requested \"KeyId\"\n\n   *  The length of the response's \"Plaintext\" MUST equal the key\n      derivation input length (../algorithm-suites.md#key-derivation-\n      input-length) specified by the algorithm suite (../algorithm-\n      suites.md) included in the input decryption materials\n      (../structures.md#decryption-materials).\n"}, {"source": "src/AwsCryptographicMaterialProviders/Keyrings/AwsKms/AwsKmsMrkDiscoveryKeyring.dfy", "target_path": "compliance/framework/aws-kms/aws-kms-mrk-discovery-keyring.txt", "target_section": "2.8", "line": 250, "type": "CITATION"}, {"source": "compliance/framework/aws-kms/aws-kms-mrk-discovery-keyring.txt", "target_path": "compliance/framework/aws-kms/aws-kms-mrk-discovery-keyring.txt", "target_section": "2.8", "type": "SPEC", "level": "MUST", "comment": "\n   If the response does not satisfies these requirements then an error\n   is collected and the next encrypted data key in the filtered set MUST\n   be attempted.\n"}, {"source": "src/AwsCryptographicMaterialProviders/Keyrings/AwsKms/AwsKmsMrkDiscoveryKeyring.dfy", "target_path": "compliance/framework/aws-kms/aws-kms-mrk-discovery-keyring.txt", "target_section": "2.8", "line": 159, "type": "IMPLICATION"}, {"source": "compliance/framework/aws-kms/aws-kms-mrk-discovery-keyring.txt", "target_path": "compliance/framework/aws-kms/aws-kms-mrk-discovery-keyring.txt", "target_section": "2.8", "type": "SPEC", "level": "MUST", "comment": "\n   Since the response does satisfies these requirements then OnDecrypt\n   MUST do the following with the response:\n\n   *  set the plaintext data key on the decryption materials\n      (../structures.md#decryption-materials) as the response\n      \"Plaintext\".\n"}, {"source": "src/AwsCryptographicMaterialProviders/Keyrings/AwsKms/AwsKmsMrkDiscoveryKeyring.dfy", "target_path": "compliance/framework/aws-kms/aws-kms-mrk-discovery-keyring.txt", "target_section": "2.8", "line": 269, "type": "CITATION"}, {"source": "compliance/framework/aws-kms/aws-kms-mrk-discovery-keyring.txt", "target_path": "compliance/framework/aws-kms/aws-kms-mrk-discovery-keyring.txt", "target_section": "2.8", "type": "SPEC", "level": "MUST", "comment": "\n   If OnDecrypt fails to successfully decrypt any encrypted data key\n   (../structures.md#encrypted-data-key), then it MUST yield an error\n   that includes all collected errors.\n"}, {"source": "compliance/framework/aws-kms/aws-kms-mrk-aware-master-key.txt", "target_path": "compliance/framework/aws-kms/aws-kms-mrk-aware-master-key.txt", "target_section": "2.4.1", "type": "SPEC", "level": "MUST", "comment": "\n\n   The key words \"MUST\", \"MUST NOT\", \"REQUIRED\", \"SHALL\", \"SHALL NOT\",\n   \"SHOULD\", \"SHOULD NOT\", \"RECOMMENDED\", \"MAY\", and \"OPTIONAL\" in this\n   document are to be interpreted as described in RFC 2119\n   (https://tools.ietf.org/html/rfc2119).\n"}, {"source": "compliance/framework/aws-kms/aws-kms-mrk-aware-master-key.txt", "target_path": "compliance/framework/aws-kms/aws-kms-mrk-aware-master-key.txt", "target_section": "2.6", "type": "SPEC", "level": "MUST", "comment": "   On initialization, the caller MUST provide:\n"}, {"source": "compliance/framework/aws-kms/aws-kms-mrk-aware-master-key.txt", "target_path": "compliance/framework/aws-kms/aws-kms-mrk-aware-master-key.txt", "target_section": "2.6", "type": "SPEC", "level": "MUST", "comment": "   The AWS KMS key identifier MUST NOT be null or empty. "}, {"source": "compliance/framework/aws-kms/aws-kms-mrk-aware-master-key.txt", "target_path": "compliance/framework/aws-kms/aws-kms-mrk-aware-master-key.txt", "target_section": "2.6", "type": "SPEC", "level": "MUST", "comment": " The AWS KMS\n   key identifier MUST be a valid identifier (aws-kms-key-arn.md#a-\n   valid-aws-kms-identifier). "}, {"source": "compliance/framework/aws-kms/aws-kms-mrk-aware-master-key.txt", "target_path": "compliance/framework/aws-kms/aws-kms-mrk-aware-master-key.txt", "target_section": "2.6", "type": "SPEC", "level": "MUST", "comment": " The AWS KMS SDK client MUST not be null.\n"}, {"source": "compliance/framework/aws-kms/aws-kms-mrk-aware-master-key.txt", "target_path": "compliance/framework/aws-kms/aws-kms-mrk-aware-master-key.txt", "target_section": "2.6", "type": "SPEC", "level": "MUST", "comment": "   The master key MUST be able to be configured with an optional list of\n   Grant Tokens. "}, {"source": "compliance/framework/aws-kms/aws-kms-mrk-aware-master-key.txt", "target_path": "compliance/framework/aws-kms/aws-kms-mrk-aware-master-key.txt", "target_section": "2.6", "type": "SPEC", "level": "SHOULD", "comment": " This configuration SHOULD be on initialization and\n   SHOULD be immutable.\n"}, {"source": "compliance/framework/aws-kms/aws-kms-mrk-aware-master-key.txt", "target_path": "compliance/framework/aws-kms/aws-kms-mrk-aware-master-key.txt", "target_section": "2.7", "type": "SPEC", "level": "MUST", "comment": "\n\n   MUST be unchanged from the Master Key interface.\n"}, {"source": "compliance/framework/aws-kms/aws-kms-mrk-aware-master-key.txt", "target_path": "compliance/framework/aws-kms/aws-kms-mrk-aware-master-key.txt", "target_section": "2.8", "type": "SPEC", "level": "MUST", "comment": "\n\n   MUST be unchanged from the Master Key interface.\n"}, {"source": "compliance/framework/aws-kms/aws-kms-mrk-aware-master-key.txt", "target_path": "compliance/framework/aws-kms/aws-kms-mrk-aware-master-key.txt", "target_section": "2.9", "type": "SPEC", "level": "MUST", "comment": "\n\n   The inputs MUST be the same as the Master Key Decrypt Data Key\n   (../master-key-interface.md#decrypt-data-key) interface.\n"}, {"source": "compliance/framework/aws-kms/aws-kms-mrk-aware-master-key.txt", "target_path": "compliance/framework/aws-kms/aws-kms-mrk-aware-master-key.txt", "target_section": "2.9", "type": "SPEC", "level": "MUST", "comment": "\n   The set of encrypted data keys MUST first be filtered to match this\n   master key's configuration. "}, {"source": "compliance/framework/aws-kms/aws-kms-mrk-aware-master-key.txt", "target_path": "compliance/framework/aws-kms/aws-kms-mrk-aware-master-key.txt", "target_section": "2.9", "type": "SPEC", "level": "MUST", "comment": " To match the encrypted data key's\n   provider ID MUST exactly match the value \"aws-kms\" and the the\n   function AWS KMS MRK Match for Decrypt (aws-kms-mrk-match-for-\n   decrypt.md#implementation) called with the configured AWS KMS key\n   identifier and the encrypted data key's provider info MUST return\n   \"true\". "}, {"source": "compliance/framework/aws-kms/aws-kms-mrk-aware-master-key.txt", "target_path": "compliance/framework/aws-kms/aws-kms-mrk-aware-master-key.txt", "target_section": "2.9", "type": "SPEC", "level": "MUST", "comment": " Additionally each provider info MUST be a valid AWS KMS ARN\n   (aws-kms-key-arn.md#a-valid-aws-kms-arn) with a resource type of\n   \"key\".\n"}, {"source": "compliance/framework/aws-kms/aws-kms-mrk-aware-master-key.txt", "target_path": "compliance/framework/aws-kms/aws-kms-mrk-aware-master-key.txt", "target_section": "2.9", "type": "SPEC", "level": "MUST", "comment": "\n   For each encrypted data key in the filtered set, one at a time, the\n   master key MUST attempt to decrypt the data key. "}, {"source": "compliance/framework/aws-kms/aws-kms-mrk-aware-master-key.txt", "target_path": "compliance/framework/aws-kms/aws-kms-mrk-aware-master-key.txt", "target_section": "2.9", "type": "SPEC", "level": "MUST", "comment": " If this attempt\n   results in an error, then these errors MUST be collected.\n"}, {"source": "compliance/framework/aws-kms/aws-kms-mrk-aware-master-key.txt", "target_path": "compliance/framework/aws-kms/aws-kms-mrk-aware-master-key.txt", "target_section": "2.9", "type": "SPEC", "level": "MUST", "comment": "\n   To decrypt the encrypted data key this master key MUST use the\n   configured AWS KMS client to make an AWS KMS Decrypt\n   (https://docs.aws.amazon.com/kms/latest/APIReference/\n   API_Decrypt.html) request constructed as follows:\n"}, {"source": "compliance/framework/aws-kms/aws-kms-mrk-aware-master-key.txt", "target_path": "compliance/framework/aws-kms/aws-kms-mrk-aware-master-key.txt", "target_section": "2.9", "type": "SPEC", "level": "MUST", "comment": "   If the call succeeds then the response's \"KeyId\" MUST be equal to the\n   configured AWS KMS key identifier otherwise the function MUST collect\n   an error. "}, {"source": "compliance/framework/aws-kms/aws-kms-mrk-aware-master-key.txt", "target_path": "compliance/framework/aws-kms/aws-kms-mrk-aware-master-key.txt", "target_section": "2.9", "type": "SPEC", "level": "MUST", "comment": " The response's \"Plaintext\"'s length MUST equal the length\n   required by the requested algorithm suite otherwise the function MUST\n   collect an error.\n"}, {"source": "compliance/framework/aws-kms/aws-kms-mrk-aware-master-key.txt", "target_path": "compliance/framework/aws-kms/aws-kms-mrk-aware-master-key.txt", "target_section": "2.9", "type": "SPEC", "level": "MUST", "comment": "\n   If the AWS KMS response satisfies the requirements then it MUST be\n   use and this function MUST return and not attempt to decrypt any more\n   encrypted data keys.\n"}, {"source": "compliance/framework/aws-kms/aws-kms-mrk-aware-master-key.txt", "target_path": "compliance/framework/aws-kms/aws-kms-mrk-aware-master-key.txt", "target_section": "2.9", "type": "SPEC", "level": "MUST", "comment": "\n   If all the input encrypted data keys have been processed then this\n   function MUST yield an error that includes all the collected errors.\n"}, {"source": "compliance/framework/aws-kms/aws-kms-mrk-aware-master-key.txt", "target_path": "compliance/framework/aws-kms/aws-kms-mrk-aware-master-key.txt", "target_section": "2.9", "type": "SPEC", "level": "MUST", "comment": "\n   The output MUST be the same as the Master Key Decrypt Data Key\n   (../master-key-interface.md#decrypt-data-key) interface.\n"}, {"source": "compliance/framework/aws-kms/aws-kms-mrk-aware-master-key.txt", "target_path": "compliance/framework/aws-kms/aws-kms-mrk-aware-master-key.txt", "target_section": "2.10", "type": "SPEC", "level": "MUST", "comment": "\n\n   The inputs MUST be the same as the Master Key Generate Data Key\n   (../master-key-interface.md#generate-data-key) interface. "}, {"source": "compliance/framework/aws-kms/aws-kms-mrk-aware-master-key.txt", "target_path": "compliance/framework/aws-kms/aws-kms-mrk-aware-master-key.txt", "target_section": "2.10", "type": "SPEC", "level": "MUST", "comment": " This\n   master key MUST use the configured AWS KMS client to make an AWS KMS\n   GenerateDatakey (https://docs.aws.amazon.com/kms/latest/APIReference/\n   API_GenerateDataKey.html) request constructed as follows:\n"}, {"source": "compliance/framework/aws-kms/aws-kms-mrk-aware-master-key.txt", "target_path": "compliance/framework/aws-kms/aws-kms-mrk-aware-master-key.txt", "target_section": "2.10", "type": "SPEC", "level": "MUST", "comment": "   If the call succeeds the AWS KMS Generate Data Key response's\n   \"Plaintext\" MUST match the key derivation input length specified by\n   the algorithm suite included in the input. "}, {"source": "compliance/framework/aws-kms/aws-kms-mrk-aware-master-key.txt", "target_path": "compliance/framework/aws-kms/aws-kms-mrk-aware-master-key.txt", "target_section": "2.10", "type": "SPEC", "level": "MUST", "comment": " The response's \"KeyId\"\n   MUST be valid. "}, {"source": "compliance/framework/aws-kms/aws-kms-mrk-aware-master-key.txt", "target_path": "compliance/framework/aws-kms/aws-kms-mrk-aware-master-key.txt", "target_section": "2.10", "type": "SPEC", "level": "MUST", "comment": " The response's \"Plaintext\" MUST be the plaintext in\n   the output. "}, {"source": "compliance/framework/aws-kms/aws-kms-mrk-aware-master-key.txt", "target_path": "compliance/framework/aws-kms/aws-kms-mrk-aware-master-key.txt", "target_section": "2.10", "type": "SPEC", "level": "MUST", "comment": " The response's cipher text blob MUST be used as the\n   returned as the ciphertext for the encrypted data key in the output.\n"}, {"source": "compliance/framework/aws-kms/aws-kms-mrk-aware-master-key.txt", "target_path": "compliance/framework/aws-kms/aws-kms-mrk-aware-master-key.txt", "target_section": "2.10", "type": "SPEC", "level": "MUST", "comment": "\n   The output MUST be the same as the Master Key Generate Data Key\n   (../master-key-interface.md#generate-data-key) interface.\n"}, {"source": "compliance/framework/aws-kms/aws-kms-mrk-aware-master-key.txt", "target_path": "compliance/framework/aws-kms/aws-kms-mrk-aware-master-key.txt", "target_section": "2.11", "type": "SPEC", "level": "MUST", "comment": "\n\n   The inputs MUST be the same as the Master Key Encrypt Data Key\n   (../master-key-interface.md#encrypt-data-key) interface. "}, {"source": "compliance/framework/aws-kms/aws-kms-mrk-aware-master-key.txt", "target_path": "compliance/framework/aws-kms/aws-kms-mrk-aware-master-key.txt", "target_section": "2.11", "type": "SPEC", "level": "MUST", "comment": " The master\n   key MUST use the configured AWS KMS client to make an AWS KMS Encrypt\n   (https://docs.aws.amazon.com/kms/latest/APIReference/\n   API_Encrypt.html) request constructed as follows:\n"}, {"source": "compliance/framework/aws-kms/aws-kms-mrk-aware-master-key.txt", "target_path": "compliance/framework/aws-kms/aws-kms-mrk-aware-master-key.txt", "target_section": "2.11", "type": "SPEC", "level": "MUST", "comment": "   The AWS KMS Encrypt response MUST contain a valid \"KeyId\". "}, {"source": "compliance/framework/aws-kms/aws-kms-mrk-aware-master-key.txt", "target_path": "compliance/framework/aws-kms/aws-kms-mrk-aware-master-key.txt", "target_section": "2.11", "type": "SPEC", "level": "MUST", "comment": " The\n   response's cipher text blob MUST be used as the \"ciphertext\" for the\n   encrypted data key.\n"}, {"source": "compliance/framework/aws-kms/aws-kms-mrk-aware-master-key.txt", "target_path": "compliance/framework/aws-kms/aws-kms-mrk-aware-master-key.txt", "target_section": "2.11", "type": "SPEC", "level": "MUST", "comment": "\n   The output MUST be the same as the Master Key Encrypt Data Key\n   (../master-key-interface.md#encrypt-data-key) interface.\n"}, {"source": "compliance/framework/aws-kms/aws-kms-mrk-aware-master-key-provider.txt", "target_path": "compliance/framework/aws-kms/aws-kms-mrk-aware-master-key-provider.txt", "target_section": "2.4.1", "type": "SPEC", "level": "MUST", "comment": "\n\n   The key words \"MUST\", \"MUST NOT\", \"REQUIRED\", \"SHALL\", \"SHALL NOT\",\n   \"SHOULD\", \"SHOULD NOT\", \"RECOMMENDED\", \"MAY\", and \"OPTIONAL\" in this\n   document are to be interpreted as described in RFC 2119\n   (https://tools.ietf.org/html/rfc2119).\n"}, {"source": "compliance/framework/aws-kms/aws-kms-mrk-aware-master-key-provider.txt", "target_path": "compliance/framework/aws-kms/aws-kms-mrk-aware-master-key-provider.txt", "target_section": "2.6", "type": "SPEC", "level": "MUST", "comment": "   On initialization the caller MUST provide:\n"}, {"source": "compliance/framework/aws-kms/aws-kms-mrk-aware-master-key-provider.txt", "target_path": "compliance/framework/aws-kms/aws-kms-mrk-aware-master-key-provider.txt", "target_section": "2.6", "type": "SPEC", "level": "MUST", "comment": "   The key id list MUST NOT be empty or null in strict mode. "}, {"source": "compliance/framework/aws-kms/aws-kms-mrk-aware-master-key-provider.txt", "target_path": "compliance/framework/aws-kms/aws-kms-mrk-aware-master-key-provider.txt", "target_section": "2.6", "type": "SPEC", "level": "MUST", "comment": " The key id\n   list MUST NOT contain any null or empty string values. "}, {"source": "compliance/framework/aws-kms/aws-kms-mrk-aware-master-key-provider.txt", "target_path": "compliance/framework/aws-kms/aws-kms-mrk-aware-master-key-provider.txt", "target_section": "2.6", "type": "SPEC", "level": "MUST", "comment": " All AWS KMS\n   key identifiers are be passed to Assert AWS KMS MRK are unique (aws-\n   kms-mrk-are-unique.md#Implementation) and the function MUST return\n   success. "}, {"source": "compliance/framework/aws-kms/aws-kms-mrk-aware-master-key-provider.txt", "target_path": "compliance/framework/aws-kms/aws-kms-mrk-aware-master-key-provider.txt", "target_section": "2.6", "type": "SPEC", "level": "MUST", "comment": " A discovery filter MUST NOT be configured in strict mode.\n"}, {"source": "compliance/framework/aws-kms/aws-kms-mrk-aware-master-key-provider.txt", "target_path": "compliance/framework/aws-kms/aws-kms-mrk-aware-master-key-provider.txt", "target_section": "2.6", "type": "SPEC", "level": "MUST", "comment": "   A default MRK Region MUST NOT be configured in strict mode. "}, {"source": "compliance/framework/aws-kms/aws-kms-mrk-aware-master-key-provider.txt", "target_path": "compliance/framework/aws-kms/aws-kms-mrk-aware-master-key-provider.txt", "target_section": "2.6", "type": "SPEC", "level": "MUST", "comment": " In\n   discovery mode if a default MRK Region is not configured the AWS SDK\n   Default Region MUST be used. "}, {"source": "compliance/framework/aws-kms/aws-kms-mrk-aware-master-key-provider.txt", "target_path": "compliance/framework/aws-kms/aws-kms-mrk-aware-master-key-provider.txt", "target_section": "2.6", "type": "SPEC", "level": "MUST", "comment": " If an AWS SDK Default Region can not be\n   obtained initialization MUST fail.\n"}, {"source": "compliance/framework/aws-kms/aws-kms-mrk-aware-master-key-provider.txt", "target_path": "compliance/framework/aws-kms/aws-kms-mrk-aware-master-key-provider.txt", "target_section": "2.6", "type": "SPEC", "level": "MUST", "comment": "\n   The key id list MUST be empty in discovery mode. "}, {"source": "compliance/framework/aws-kms/aws-kms-mrk-aware-master-key-provider.txt", "target_path": "compliance/framework/aws-kms/aws-kms-mrk-aware-master-key-provider.txt", "target_section": "2.6", "type": "SPEC", "level": "MUST", "comment": " The regional client\n   supplier MUST be defined in discovery mode.\n"}, {"source": "compliance/framework/aws-kms/aws-kms-mrk-aware-master-key-provider.txt", "target_path": "compliance/framework/aws-kms/aws-kms-mrk-aware-master-key-provider.txt", "target_section": "2.7", "type": "SPEC", "level": "MUST", "comment": "\n\n   The input MUST be the same as the Master Key Provider Get Master Key\n   (../master-key-provider-interface.md#get-master-key) interface.\n"}, {"source": "compliance/framework/aws-kms/aws-kms-mrk-aware-master-key-provider.txt", "target_path": "compliance/framework/aws-kms/aws-kms-mrk-aware-master-key-provider.txt", "target_section": "2.7", "type": "SPEC", "level": "MUST", "comment": "\n   The function MUST only provide master keys if the input provider id\n   equals \"aws-kms\". "}, {"source": "compliance/framework/aws-kms/aws-kms-mrk-aware-master-key-provider.txt", "target_path": "compliance/framework/aws-kms/aws-kms-mrk-aware-master-key-provider.txt", "target_section": "2.7", "type": "SPEC", "level": "MUST", "comment": " In strict mode, the requested AWS KMS key ARN MUST\n   match a member of the configured key ids by using AWS KMS MRK Match\n   for Decrypt (aws-kms-mrk-match-for-decrypt.md#implementation)\n   otherwise this function MUST error. "}, {"source": "compliance/framework/aws-kms/aws-kms-mrk-aware-master-key-provider.txt", "target_path": "compliance/framework/aws-kms/aws-kms-mrk-aware-master-key-provider.txt", "target_section": "2.7", "type": "SPEC", "level": "MUST", "comment": " In discovery mode, the requested\n   AWS KMS key identifier MUST be a well formed AWS KMS ARN. "}, {"source": "compliance/framework/aws-kms/aws-kms-mrk-aware-master-key-provider.txt", "target_path": "compliance/framework/aws-kms/aws-kms-mrk-aware-master-key-provider.txt", "target_section": "2.7", "type": "SPEC", "level": "MUST", "comment": " In\n   discovery mode if a discovery filter is configured the requested AWS\n   KMS key ARN's \"partition\" MUST match the discovery filter's\n   \"partition\" and the AWS KMS key ARN's \"account\" MUST exist in the\n   discovery filter's account id set.\n"}, {"source": "compliance/framework/aws-kms/aws-kms-mrk-aware-master-key-provider.txt", "target_path": "compliance/framework/aws-kms/aws-kms-mrk-aware-master-key-provider.txt", "target_section": "2.7", "type": "SPEC", "level": "MUST", "comment": "\n   If the requested AWS KMS key identifier is not a well formed ARN the\n   AWS Region MUST be the configured default region this SHOULD be\n   obtained from the AWS SDK. "}, {"source": "compliance/framework/aws-kms/aws-kms-mrk-aware-master-key-provider.txt", "target_path": "compliance/framework/aws-kms/aws-kms-mrk-aware-master-key-provider.txt", "target_section": "2.7", "type": "SPEC", "level": "MUST", "comment": " Otherwise if the requested AWS KMS key\n   identifier is identified as a multi-Region key (aws-kms-key-\n   arn.md#identifying-an-aws-kms-multi-region-key), then AWS Region MUST\n   be the region from the AWS KMS key ARN stored in the provider info\n   from the encrypted data key. "}, {"source": "compliance/framework/aws-kms/aws-kms-mrk-aware-master-key-provider.txt", "target_path": "compliance/framework/aws-kms/aws-kms-mrk-aware-master-key-provider.txt", "target_section": "2.7", "type": "SPEC", "level": "MUST", "comment": " Otherwise if the mode is discovery then\n   the AWS Region MUST be the discovery MRK region. "}, {"source": "compliance/framework/aws-kms/aws-kms-mrk-aware-master-key-provider.txt", "target_path": "compliance/framework/aws-kms/aws-kms-mrk-aware-master-key-provider.txt", "target_section": "2.7", "type": "SPEC", "level": "MUST", "comment": " Finally if the\n   provider info is identified as a multi-Region key (aws-kms-key-\n   arn.md#identifying-an-aws-kms-multi-region-key) the AWS Region MUST\n   be the region from the AWS KMS key in the configured key ids matched\n   to the requested AWS KMS key by using AWS KMS MRK Match for Decrypt\n   (aws-kms-mrk-match-for-decrypt.md#implementation). "}, {"source": "compliance/framework/aws-kms/aws-kms-mrk-aware-master-key-provider.txt", "target_path": "compliance/framework/aws-kms/aws-kms-mrk-aware-master-key-provider.txt", "target_section": "2.7", "type": "SPEC", "level": "MUST", "comment": " An AWS KMS client\n   MUST be obtained by calling the regional client supplier with this\n   AWS Region.\n"}, {"source": "compliance/framework/aws-kms/aws-kms-mrk-aware-master-key-provider.txt", "target_path": "compliance/framework/aws-kms/aws-kms-mrk-aware-master-key-provider.txt", "target_section": "2.7", "type": "SPEC", "level": "MUST", "comment": "\n   In strict mode a AWS KMS MRK Aware Master Key (aws-kms-mrk-aware-\n   master-key.md) MUST be returned configured with\n"}, {"source": "compliance/framework/aws-kms/aws-kms-mrk-aware-master-key-provider.txt", "target_path": "compliance/framework/aws-kms/aws-kms-mrk-aware-master-key-provider.txt", "target_section": "2.7", "type": "SPEC", "level": "MUST", "comment": " In discovery mode a AWS KMS MRK Aware Master Key (aws-kms-mrk-aware-\n   master-key.md) MUST be returned configured with\n"}, {"source": "compliance/framework/aws-kms/aws-kms-mrk-aware-master-key-provider.txt", "target_path": "compliance/framework/aws-kms/aws-kms-mrk-aware-master-key-provider.txt", "target_section": "2.7", "type": "SPEC", "level": "MUST", "comment": "   The output MUST be the same as the Master Key Provider Get Master Key\n   (../master-key-provider-interface.md#get-master-key) interface.\n"}, {"source": "compliance/framework/aws-kms/aws-kms-mrk-aware-master-key-provider.txt", "target_path": "compliance/framework/aws-kms/aws-kms-mrk-aware-master-key-provider.txt", "target_section": "2.8", "type": "SPEC", "level": "MUST", "comment": "\n\n   The input MUST be the same as the Master Key Provider Get Master Keys\n   For Encryption (../master-key-provider-interface.md#get-master-keys-\n   for-encryption) interface.\n"}, {"source": "compliance/framework/aws-kms/aws-kms-mrk-aware-master-key-provider.txt", "target_path": "compliance/framework/aws-kms/aws-kms-mrk-aware-master-key-provider.txt", "target_section": "2.8", "type": "SPEC", "level": "MUST", "comment": "\n   If the configured mode is discovery the function MUST return an empty\n   list. "}, {"source": "compliance/framework/aws-kms/aws-kms-mrk-aware-master-key-provider.txt", "target_path": "compliance/framework/aws-kms/aws-kms-mrk-aware-master-key-provider.txt", "target_section": "2.8", "type": "SPEC", "level": "MUST", "comment": " If the configured mode is strict this function MUST return a\n   list of master keys obtained by calling Get Master Key (aws-kms-mrk-\n   aware-master-key-provider.md#get-master-key) for each AWS KMS key\n   identifier in the configured key ids\n\n   The output MUST be the same as the Master Key Provider Get Master\n   Keys For Encryption (../master-key-provider-interface.md#get-master-\n   keys-for-encryption) interface.\n"}, {"source": "compliance/framework/aws-kms/aws-kms-mrk-aware-master-key-provider.txt", "target_path": "compliance/framework/aws-kms/aws-kms-mrk-aware-master-key-provider.txt", "target_section": "2.9", "type": "SPEC", "level": "MUST", "comment": "\n\n   The input MUST be the same as the Master Key Provider Decrypt Data\n   Key (../master-key-provider-interface.md#decrypt-data-key) interface.\n"}, {"source": "compliance/framework/aws-kms/aws-kms-mrk-aware-master-key-provider.txt", "target_path": "compliance/framework/aws-kms/aws-kms-mrk-aware-master-key-provider.txt", "target_section": "2.9", "type": "SPEC", "level": "MUST", "comment": "\n   The set of encrypted data keys MUST first be filtered to match this\n   master key's configuration. "}, {"source": "compliance/framework/aws-kms/aws-kms-mrk-aware-master-key-provider.txt", "target_path": "compliance/framework/aws-kms/aws-kms-mrk-aware-master-key-provider.txt", "target_section": "2.9", "type": "SPEC", "level": "MUST", "comment": " To match the encrypted data key's\n   provider ID MUST exactly match the value \"aws-kms\". "}, {"source": "compliance/framework/aws-kms/aws-kms-mrk-aware-master-key-provider.txt", "target_path": "compliance/framework/aws-kms/aws-kms-mrk-aware-master-key-provider.txt", "target_section": "2.9", "type": "SPEC", "level": "MUST", "comment": " Additionally\n   each provider info MUST be a valid AWS KMS ARN (aws-kms-key-arn.md#a-\n   valid-aws-kms-arn) with a resource type of \"key\".\n"}, {"source": "compliance/framework/aws-kms/aws-kms-mrk-aware-master-key-provider.txt", "target_path": "compliance/framework/aws-kms/aws-kms-mrk-aware-master-key-provider.txt", "target_section": "2.9", "type": "SPEC", "level": "MUST", "comment": "\n   For each encrypted data key in the filtered set, one at a time, the\n   master key provider MUST call Get Master Key (aws-kms-mrk-aware-\n   master-key-provider.md#get-master-key) with the encrypted data key's\n   provider info as the AWS KMS key ARN. "}, {"source": "compliance/framework/aws-kms/aws-kms-mrk-aware-master-key-provider.txt", "target_path": "compliance/framework/aws-kms/aws-kms-mrk-aware-master-key-provider.txt", "target_section": "2.9", "type": "SPEC", "level": "MUST", "comment": " It MUST call Decrypt Data Key\n   (aws-kms-mrk-aware-master-key.md#decrypt-data-key) on this master key\n   with the input algorithm, this single encrypted data key, and the\n   input encryption context. "}, {"source": "compliance/framework/aws-kms/aws-kms-mrk-aware-master-key-provider.txt", "target_path": "compliance/framework/aws-kms/aws-kms-mrk-aware-master-key-provider.txt", "target_section": "2.9", "type": "SPEC", "level": "MUST", "comment": " If this attempt results in an error, then\n   these errors MUST be collected. "}, {"source": "compliance/framework/aws-kms/aws-kms-mrk-aware-master-key-provider.txt", "target_path": "compliance/framework/aws-kms/aws-kms-mrk-aware-master-key-provider.txt", "target_section": "2.9", "type": "SPEC", "level": "MUST", "comment": " If the decrypt data key call is\n   successful, then this function MUST return this result and not\n   attempt to decrypt any more encrypted data keys.\n"}, {"source": "compliance/framework/aws-kms/aws-kms-mrk-aware-master-key-provider.txt", "target_path": "compliance/framework/aws-kms/aws-kms-mrk-aware-master-key-provider.txt", "target_section": "2.9", "type": "SPEC", "level": "MUST", "comment": "\n   If all the input encrypted data keys have been processed then this\n   function MUST yield an error that includes all the collected errors.\n"}, {"source": "compliance/framework/aws-kms/aws-kms-mrk-aware-master-key-provider.txt", "target_path": "compliance/framework/aws-kms/aws-kms-mrk-aware-master-key-provider.txt", "target_section": "2.9", "type": "SPEC", "level": "MUST", "comment": "\n   The output MUST be the same as the Master Key Provider Decrypt Data\n   Key (../master-key-provider-interface.md#decrypt-data-key) interface.\n"}, {"source": "compliance/framework/aws-kms/aws-kms-keyring.txt", "target_path": "compliance/framework/aws-kms/aws-kms-keyring.txt", "target_section": "2.4.1", "type": "SPEC", "level": "MUST", "comment": "\n\n   The key words \"MUST\", \"MUST NOT\", \"REQUIRED\", \"SHALL\", \"SHALL NOT\",\n   \"SHOULD\", \"SHOULD NOT\", \"RECOMMENDED\", \"MAY\", and \"OPTIONAL\" in this\n   document are to be interpreted as described in RFC 2119\n   (https://tools.ietf.org/html/rfc2119).\n"}, {"source": "src/AwsCryptographicMaterialProviders/Keyrings/AwsKms/AwsKmsKeyring.dfy", "target_path": "compliance/framework/aws-kms/aws-kms-keyring.txt", "target_section": "2.6", "line": 75, "type": "IMPLICATION"}, {"source": "compliance/framework/aws-kms/aws-kms-keyring.txt", "target_path": "compliance/framework/aws-kms/aws-kms-keyring.txt", "target_section": "2.6", "type": "SPEC", "level": "MUST", "comment": "   The AWS KMS key identifier MUST NOT be null or empty. "}, {"source": "src/AwsCryptographicMaterialProviders/Keyrings/AwsKms/AwsKmsKeyring.dfy", "target_path": "compliance/framework/aws-kms/aws-kms-keyring.txt", "target_section": "2.6", "line": 68, "type": "IMPLICATION"}, {"source": "compliance/framework/aws-kms/aws-kms-keyring.txt", "target_path": "compliance/framework/aws-kms/aws-kms-keyring.txt", "target_section": "2.6", "type": "SPEC", "level": "MUST", "comment": " The AWS KMS\n   key identifier MUST be a valid identifier (aws-kms-key-arn.md#a-\n   valid-aws-kms-identifier). "}, {"source": "src/AwsCryptographicMaterialProviders/Keyrings/AwsKms/AwsKmsKeyring.dfy", "target_path": "compliance/framework/aws-kms/aws-kms-keyring.txt", "target_section": "2.6", "line": 55, "type": "IMPLICATION"}, {"source": "compliance/framework/aws-kms/aws-kms-keyring.txt", "target_path": "compliance/framework/aws-kms/aws-kms-keyring.txt", "target_section": "2.6", "type": "SPEC", "level": "MUST", "comment": " The AWS KMS SDK client MUST NOT be null.\n"}, {"source": "src/AwsCryptographicMaterialProviders/Keyrings/AwsKms/AwsKmsKeyring.dfy", "target_path": "compliance/framework/aws-kms/aws-kms-keyring.txt", "target_section": "2.7", "line": 91, "type": "IMPLICATION"}, {"source": "compliance/framework/aws-kms/aws-kms-keyring.txt", "target_path": "compliance/framework/aws-kms/aws-kms-keyring.txt", "target_section": "2.7", "type": "SPEC", "level": "MUST", "comment": "\n\n   OnEncrypt MUST take encryption materials\n   (../structures.md#encryption-materials) as input.\n"}, {"source": "src/AwsCryptographicMaterialProviders/Keyrings/AwsKms/AwsKmsKeyring.dfy", "target_path": "compliance/framework/aws-kms/aws-kms-keyring.txt", "target_section": "2.7", "line": 118, "type": "IMPLICATION"}, {"source": "compliance/framework/aws-kms/aws-kms-keyring.txt", "target_path": "compliance/framework/aws-kms/aws-kms-keyring.txt", "target_section": "2.7", "type": "SPEC", "level": "MUST", "comment": "\n   If the input encryption materials (../structures.md#encryption-\n   materials) do not contain a plaintext data key OnEncrypt MUST attempt\n   to generate a new plaintext data key by calling AWS KMS\n   GenerateDataKey (https://docs.aws.amazon.com/kms/latest/APIReference/\n   API_GenerateDataKey.html).\n"}, {"source": "src/AwsCryptographicMaterialProviders/Keyrings/AwsKms/AwsKmsKeyring.dfy", "target_path": "compliance/framework/aws-kms/aws-kms-keyring.txt", "target_section": "2.7", "line": 131, "type": "IMPLICATION"}, {"source": "compliance/framework/aws-kms/aws-kms-keyring.txt", "target_path": "compliance/framework/aws-kms/aws-kms-keyring.txt", "target_section": "2.7", "type": "SPEC", "level": "MUST", "comment": "\n   If the keyring calls AWS KMS GenerateDataKeys, it MUST use the\n   configured AWS KMS client to make the call. "}, {"source": "src/AwsCryptographicMaterialProviders/Keyrings/AwsKms/AwsKmsKeyring.dfy", "target_path": "compliance/framework/aws-kms/aws-kms-keyring.txt", "target_section": "2.7", "line": 136, "type": "IMPLICATION"}, {"source": "compliance/framework/aws-kms/aws-kms-keyring.txt", "target_path": "compliance/framework/aws-kms/aws-kms-keyring.txt", "target_section": "2.7", "type": "SPEC", "level": "MUST", "comment": " The keyring MUST call\n   AWS KMS GenerateDataKeys with a request constructed as follows:\n"}, {"source": "src/AwsCryptographicMaterialProviders/Keyrings/AwsKms/AwsKmsKeyring.dfy", "target_path": "compliance/framework/aws-kms/aws-kms-keyring.txt", "target_section": "2.7", "line": 300, "type": "CITATION"}, {"source": "compliance/framework/aws-kms/aws-kms-keyring.txt", "target_path": "compliance/framework/aws-kms/aws-kms-keyring.txt", "target_section": "2.7", "type": "SPEC", "level": "MUST", "comment": "   If the call to AWS KMS GenerateDataKey\n   (https://docs.aws.amazon.com/kms/latest/APIReference/\n   API_GenerateDataKey.html) does not succeed, OnEncrypt MUST NOT modify\n   the encryption materials (../structures.md#encryption-materials) and\n   MUST fail.\n"}, {"source": "src/AwsCryptographicMaterialProviders/Keyrings/AwsKms/AwsKmsKeyring.dfy", "target_path": "compliance/framework/aws-kms/aws-kms-keyring.txt", "target_section": "2.7", "line": 179, "type": "IMPLICATION"}, {"source": "compliance/framework/aws-kms/aws-kms-keyring.txt", "target_path": "compliance/framework/aws-kms/aws-kms-keyring.txt", "target_section": "2.7", "type": "SPEC", "level": "MUST", "comment": "\n   If the Generate Data Key call succeeds, OnEncrypt MUST verify that\n   the response \"Plaintext\" length matches the specification of the\n   algorithm suite (../algorithm-suites.md)'s Key Derivation Input\n   Length field. "}, {"source": "src/AwsCryptographicMaterialProviders/Keyrings/AwsKms/AwsKmsKeyring.dfy", "target_path": "compliance/framework/aws-kms/aws-kms-keyring.txt", "target_section": "2.7", "line": 313, "type": "CITATION"}, {"source": "compliance/framework/aws-kms/aws-kms-keyring.txt", "target_path": "compliance/framework/aws-kms/aws-kms-keyring.txt", "target_section": "2.7", "type": "SPEC", "level": "MUST", "comment": " The Generate Data Key response's \"KeyId\" MUST be a\n   valid AWS KMS key ARN (aws-kms-key-arn.md#a-valid-aws-kms-arn). "}, {"source": "src/AwsCryptographicMaterialProviders/Keyrings/AwsKms/AwsKmsKeyring.dfy", "target_path": "compliance/framework/aws-kms/aws-kms-keyring.txt", "target_section": "2.7", "line": 141, "type": "IMPLICATION"}, {"source": "src/AwsCryptographicMaterialProviders/Keyrings/AwsKms/AwsKmsKeyring.dfy", "target_path": "compliance/framework/aws-kms/aws-kms-keyring.txt", "target_section": "2.7", "line": 228, "type": "CITATION"}, {"source": "compliance/framework/aws-kms/aws-kms-keyring.txt", "target_path": "compliance/framework/aws-kms/aws-kms-keyring.txt", "target_section": "2.7", "type": "SPEC", "level": "MUST", "comment": "\n   *  \"EncryptionContext\" MUST be the encryption context\n      (../structures.md#encryption-context) included in the input\n      encryption materials (../structures.md#encryption-materials).\n"}, {"source": "src/AwsCryptographicMaterialProviders/Keyrings/AwsKms/AwsKmsKeyring.dfy", "target_path": "compliance/framework/aws-kms/aws-kms-keyring.txt", "target_section": "2.7", "line": 147, "type": "IMPLICATION"}, {"source": "src/AwsCryptographicMaterialProviders/Keyrings/AwsKms/AwsKmsKeyring.dfy", "target_path": "compliance/framework/aws-kms/aws-kms-keyring.txt", "target_section": "2.7", "line": 233, "type": "CITATION"}, {"source": "compliance/framework/aws-kms/aws-kms-keyring.txt", "target_path": "compliance/framework/aws-kms/aws-kms-keyring.txt", "target_section": "2.7", "type": "SPEC", "level": "MUST", "comment": "\n   *  \"GrantTokens\" MUST be this keyring's grant tokens\n      (https://docs.aws.amazon.com/kms/latest/developerguide/\n      concepts.html#grant_token).\n"}, {"source": "src/AwsCryptographicMaterialProviders/Keyrings/AwsKms/AwsKmsKeyring.dfy", "target_path": "compliance/framework/aws-kms/aws-kms-keyring.txt", "target_section": "2.7", "line": 379, "type": "IMPLICATION"}, {"source": "compliance/framework/aws-kms/aws-kms-keyring.txt", "target_path": "compliance/framework/aws-kms/aws-kms-keyring.txt", "target_section": "2.7", "type": "SPEC", "level": "MUST", "comment": "\n   If the call to AWS KMS Encrypt\n   (https://docs.aws.amazon.com/kms/latest/APIReference/\n   API_Encrypt.html) does not succeed, OnEncrypt MUST fail.\n"}, {"source": "src/AwsCryptographicMaterialProviders/Keyrings/AwsKms/AwsKmsKeyring.dfy", "target_path": "compliance/framework/aws-kms/aws-kms-keyring.txt", "target_section": "2.7", "line": 392, "type": "CITATION"}, {"source": "compliance/framework/aws-kms/aws-kms-keyring.txt", "target_path": "compliance/framework/aws-kms/aws-kms-keyring.txt", "target_section": "2.7", "type": "SPEC", "level": "MUST", "comment": "\n   If the Encrypt call succeeds the response's \"KeyId\" MUST be A valid\n   AWS KMS key ARN (aws-kms-key-arn.md#a-valid-aws-kms-arn). "}, {"source": "src/AwsCryptographicMaterialProviders/Keyrings/AwsKms/AwsKmsKeyring.dfy", "target_path": "compliance/framework/aws-kms/aws-kms-keyring.txt", "target_section": "2.7", "line": 258, "type": "IMPLICATION"}, {"source": "compliance/framework/aws-kms/aws-kms-keyring.txt", "target_path": "compliance/framework/aws-kms/aws-kms-keyring.txt", "target_section": "2.7", "type": "SPEC", "level": "MUST", "comment": " If\n   verified, OnEncrypt MUST append a new encrypted data key\n   (../structures.md#encrypted-data-key) to the encrypted data key list\n   in the encryption materials (../structures.md#encryption-materials),\n   constructed as follows:\n\n   *  The ciphertext (../structures.md#ciphertext) MUST be the response\n      \"CiphertextBlob\".\n"}, {"source": "src/AwsCryptographicMaterialProviders/Keyrings/AwsKms/AwsKmsKeyring.dfy", "target_path": "compliance/framework/aws-kms/aws-kms-keyring.txt", "target_section": "2.7", "line": 410, "type": "CITATION"}, {"source": "compliance/framework/aws-kms/aws-kms-keyring.txt", "target_path": "compliance/framework/aws-kms/aws-kms-keyring.txt", "target_section": "2.7", "type": "SPEC", "level": "MUST", "comment": "\n   *  The key provider id (../structures.md#key-provider-id) MUST be\n      \"aws-kms\".\n"}, {"source": "src/AwsCryptographicMaterialProviders/Keyrings/AwsKms/AwsKmsKeyring.dfy", "target_path": "compliance/framework/aws-kms/aws-kms-keyring.txt", "target_section": "2.7", "line": 414, "type": "CITATION"}, {"source": "compliance/framework/aws-kms/aws-kms-keyring.txt", "target_path": "compliance/framework/aws-kms/aws-kms-keyring.txt", "target_section": "2.7", "type": "SPEC", "level": "MUST", "comment": "\n   *  The key provider information (../structures.md#key-provider-\n      information) MUST be the response \"KeyId\". "}, {"source": "src/AwsCryptographicMaterialProviders/Keyrings/AwsKms/AwsKmsKeyring.dfy", "target_path": "compliance/framework/aws-kms/aws-kms-keyring.txt", "target_section": "2.7", "line": 250, "type": "IMPLICATION"}, {"source": "compliance/framework/aws-kms/aws-kms-keyring.txt", "target_path": "compliance/framework/aws-kms/aws-kms-keyring.txt", "target_section": "2.7", "type": "SPEC", "level": "MUST", "comment": "\n   If all Encrypt calls succeed, OnEncrypt MUST output the modified\n   encryption materials (../structures.md#encryption-materials).\n"}, {"source": "src/AwsCryptographicMaterialProviders/Keyrings/AwsKms/AwsKmsKeyring.dfy", "target_path": "compliance/framework/aws-kms/aws-kms-keyring.txt", "target_section": "2.8", "line": 433, "type": "IMPLICATION"}, {"source": "compliance/framework/aws-kms/aws-kms-keyring.txt", "target_path": "compliance/framework/aws-kms/aws-kms-keyring.txt", "target_section": "2.8", "type": "SPEC", "level": "MUST", "comment": "\n\n   OnDecrypt MUST take decryption materials\n   (../structures.md#decryption-materials) and a list of encrypted data\n   keys (../structures.md#encrypted-data-key) as input.\n"}, {"source": "src/AwsCryptographicMaterialProviders/Keyrings/AwsKms/AwsKmsKeyring.dfy", "target_path": "compliance/framework/aws-kms/aws-kms-keyring.txt", "target_section": "2.8", "line": 449, "type": "IMPLICATION"}, {"source": "compliance/framework/aws-kms/aws-kms-keyring.txt", "target_path": "compliance/framework/aws-kms/aws-kms-keyring.txt", "target_section": "2.8", "type": "SPEC", "level": "MUST", "comment": "\n   If the decryption materials (../structures.md#decryption-materials)\n   already contained a valid plaintext data key OnDecrypt MUST return an\n   error.\n"}, {"source": "src/AwsCryptographicMaterialProviders/Keyrings/AwsKms/AwsKmsKeyring.dfy", "target_path": "compliance/framework/aws-kms/aws-kms-keyring.txt", "target_section": "2.8", "line": 537, "type": "CITATION"}, {"source": "compliance/framework/aws-kms/aws-kms-keyring.txt", "target_path": "compliance/framework/aws-kms/aws-kms-keyring.txt", "target_section": "2.8", "type": "SPEC", "level": "MUST", "comment": "\n   The set of encrypted data keys MUST first be filtered to match this\n   keyring's configuration. "}, {"source": "src/AwsCryptographicMaterialProviders/Keyrings/AwsKms/AwsKmsKeyring.dfy", "target_path": "compliance/framework/aws-kms/aws-kms-keyring.txt", "target_section": "2.8", "line": 544, "type": "CITATION"}, {"source": "compliance/framework/aws-kms/aws-kms-keyring.txt", "target_path": "compliance/framework/aws-kms/aws-kms-keyring.txt", "target_section": "2.8", "type": "SPEC", "level": "MUST", "comment": "   For each encrypted data key in the filtered set, one at a time, the\n   OnDecrypt MUST attempt to decrypt the data key. "}, {"source": "compliance/framework/aws-kms/aws-kms-keyring.txt", "target_path": "compliance/framework/aws-kms/aws-kms-keyring.txt", "target_section": "2.8", "type": "SPEC", "level": "MUST", "comment": " If this attempt\n   results in an error, then these errors MUST be collected.\n"}, {"source": "src/AwsCryptographicMaterialProviders/Keyrings/AwsKms/AwsKmsKeyring.dfy", "target_path": "compliance/framework/aws-kms/aws-kms-keyring.txt", "target_section": "2.8", "line": 498, "type": "IMPLICATION"}, {"source": "compliance/framework/aws-kms/aws-kms-keyring.txt", "target_path": "compliance/framework/aws-kms/aws-kms-keyring.txt", "target_section": "2.8", "type": "SPEC", "level": "MUST", "comment": "\n   To attempt to decrypt a particular encrypted data key\n   (../structures.md#encrypted-data-key), OnDecrypt MUST call AWS KMS\n   Decrypt (https://docs.aws.amazon.com/kms/latest/APIReference/\n   API_Decrypt.html) with the configured AWS KMS client.\n"}, {"source": "src/AwsCryptographicMaterialProviders/Keyrings/AwsKms/AwsKmsKeyring.dfy", "target_path": "compliance/framework/aws-kms/aws-kms-keyring.txt", "target_section": "2.8", "line": 468, "type": "IMPLICATION"}, {"source": "compliance/framework/aws-kms/aws-kms-keyring.txt", "target_path": "compliance/framework/aws-kms/aws-kms-keyring.txt", "target_section": "2.8", "type": "SPEC", "level": "MUST", "comment": "\n   When calling AWS KMS Decrypt\n   (https://docs.aws.amazon.com/kms/latest/APIReference/\n   API_Decrypt.html), the keyring MUST call with a request constructed\n   as follows:\n"}, {"source": "compliance/framework/aws-kms/aws-kms-keyring.txt", "target_path": "compliance/framework/aws-kms/aws-kms-keyring.txt", "target_section": "2.8", "type": "SPEC", "level": "MUST", "comment": " \"Plaintext\" MUST equal the key\n      derivation input length (../algorithm-suites.md#key-derivation-\n      input-length) specified by the algorithm suite (../algorithm-\n      suites.md) included in the input decryption materials\n      (../structures.md#decryption-materials).\n"}, {"source": "src/AwsCryptographicMaterialProviders/Keyrings/AwsKms/AwsKmsKeyring.dfy", "target_path": "compliance/framework/aws-kms/aws-kms-keyring.txt", "target_section": "2.8", "line": 556, "type": "CITATION"}, {"source": "compliance/framework/aws-kms/aws-kms-keyring.txt", "target_path": "compliance/framework/aws-kms/aws-kms-keyring.txt", "target_section": "2.8", "type": "SPEC", "level": "MUST", "comment": "\n   If the response does not satisfies these requirements then an error\n   MUST be collected and the next encrypted data key in the filtered set\n   MUST be attempted.\n"}, {"source": "compliance/framework/aws-kms/aws-kms-keyring.txt", "target_path": "compliance/framework/aws-kms/aws-kms-keyring.txt", "target_section": "2.8", "type": "SPEC", "level": "MUST", "comment": "\n   If the response does satisfy these requirements then OnDecrypt:\n\n   *  MUST set the plaintext data key on the decryption materials\n      (../structures.md#decryption-materials) as the response\n      \"Plaintext\".\n"}, {"source": "src/AwsCryptographicMaterialProviders/Keyrings/AwsKms/AwsKmsKeyring.dfy", "target_path": "compliance/framework/aws-kms/aws-kms-keyring.txt", "target_section": "2.8", "line": 515, "type": "IMPLICATION"}, {"source": "compliance/framework/aws-kms/aws-kms-keyring.txt", "target_path": "compliance/framework/aws-kms/aws-kms-keyring.txt", "target_section": "2.8", "type": "SPEC", "level": "MUST", "comment": "\n   *  MUST immediately return the modified decryption materials\n      (../structures.md#decryption-materials).\n"}, {"source": "src/AwsCryptographicMaterialProviders/Keyrings/AwsKms/AwsKmsKeyring.dfy", "target_path": "compliance/framework/aws-kms/aws-kms-keyring.txt", "target_section": "2.8", "line": 578, "type": "CITATION"}, {"source": "compliance/framework/aws-kms/aws-kms-keyring.txt", "target_path": "compliance/framework/aws-kms/aws-kms-keyring.txt", "target_section": "2.8", "type": "SPEC", "level": "MUST", "comment": "\n   If OnDecrypt fails to successfully decrypt any encrypted data key\n   (../structures.md#encrypted-data-key), then it MUST yield an error\n   that includes all the collected errors.\n"}, {"source": "compliance/framework/aws-kms/aws-kms-mrk-match-for-decrypt.txt", "target_path": "compliance/framework/aws-kms/aws-kms-mrk-match-for-decrypt.txt", "target_section": "2.4.1", "type": "SPEC", "level": "MUST", "comment": "\n\n   The key words \"MUST\", \"MUST NOT\", \"REQUIRED\", \"SHALL\", \"SHALL NOT\",\n   \"SHOULD\", \"SHOULD NOT\", \"RECOMMENDED\", \"MAY\", and \"OPTIONAL\" in this\n   document are to be interpreted as described in RFC 2119\n   (https://tools.ietf.org/html/rfc2119).\n"}, {"source": "src/AwsCryptographicMaterialProviders/Keyrings/AwsKms/AwsKmsMrkMatchForDecrypt.dfy", "target_path": "compliance/framework/aws-kms/aws-kms-mrk-match-for-decrypt.txt", "target_section": "2.5", "line": 14, "type": "IMPLICATION"}, {"source": "compliance/framework/aws-kms/aws-kms-mrk-match-for-decrypt.txt", "target_path": "compliance/framework/aws-kms/aws-kms-mrk-match-for-decrypt.txt", "target_section": "2.5", "type": "SPEC", "level": "MUST", "comment": "   The caller MUST provide:\n"}, {"source": "src/AwsCryptographicMaterialProviders/Keyrings/AwsKms/AwsKmsMrkMatchForDecrypt.dfy", "target_path": "compliance/framework/aws-kms/aws-kms-mrk-match-for-decrypt.txt", "target_section": "2.5", "line": 40, "type": "IMPLICATION"}, {"source": "compliance/framework/aws-kms/aws-kms-mrk-match-for-decrypt.txt", "target_path": "compliance/framework/aws-kms/aws-kms-mrk-match-for-decrypt.txt", "target_section": "2.5", "type": "SPEC", "level": "MUST", "comment": "   If both identifiers are identical, this function MUST return \"true\".\n"}, {"source": "src/AwsCryptographicMaterialProviders/Keyrings/AwsKms/AwsKmsMrkMatchForDecrypt.dfy", "target_path": "compliance/framework/aws-kms/aws-kms-mrk-match-for-decrypt.txt", "target_section": "2.5", "line": 51, "type": "IMPLICATION"}, {"source": "compliance/framework/aws-kms/aws-kms-mrk-match-for-decrypt.txt", "target_path": "compliance/framework/aws-kms/aws-kms-mrk-match-for-decrypt.txt", "target_section": "2.5", "type": "SPEC", "level": "MUST", "comment": "   Otherwise if either input is not identified as a multi-Region key\n   (aws-kms-key-arn.md#identifying-an-aws-kms-multi-region-key), then\n   this function MUST return \"false\". "}, {"source": "src/AwsCryptographicMaterialProviders/Keyrings/AwsKms/AwsKmsMrkMatchForDecrypt.dfy", "target_path": "compliance/framework/aws-kms/aws-kms-mrk-match-for-decrypt.txt", "target_section": "2.5", "line": 68, "type": "IMPLICATION"}, {"source": "compliance/framework/aws-kms/aws-kms-mrk-match-for-decrypt.txt", "target_path": "compliance/framework/aws-kms/aws-kms-mrk-match-for-decrypt.txt", "target_section": "2.5", "type": "SPEC", "level": "MUST", "comment": " Otherwise if both inputs are\n   identified as a multi-Region keys (aws-kms-key-arn.md#identifying-an-\n   aws-kms-multi-region-key), this function MUST return the result of\n   comparing the \"partition\", \"service\", \"accountId\", \"resourceType\",\n   and \"resource\" parts of both ARN inputs. "}, {"source": "compliance/framework/aws-kms/aws-kms-multi-keyrings.txt", "target_path": "compliance/framework/aws-kms/aws-kms-multi-keyrings.txt", "target_section": "2.4.1", "type": "SPEC", "level": "MUST", "comment": "\n\n   The key words \"MUST\", \"MUST NOT\", \"REQUIRED\", \"SHALL\", \"SHALL NOT\",\n   \"SHOULD\", \"SHOULD NOT\", \"RECOMMENDED\", \"MAY\", and \"OPTIONAL\" in this\n   document are to be interpreted as described in RFC 2119\n   (https://tools.ietf.org/html/rfc2119).\n"}, {"source": "compliance/framework/aws-kms/aws-kms-multi-keyrings.txt", "target_path": "compliance/framework/aws-kms/aws-kms-multi-keyrings.txt", "target_section": "2.5", "type": "SPEC", "level": "MUST", "comment": "   The caller MUST provide:\n"}, {"source": "src/AwsCryptographicMaterialProviders/Client.dfy", "target_path": "compliance/framework/aws-kms/aws-kms-multi-keyrings.txt", "target_section": "2.5", "line": 637, "type": "IMPLICATION"}, {"source": "compliance/framework/aws-kms/aws-kms-multi-keyrings.txt", "target_path": "compliance/framework/aws-kms/aws-kms-multi-keyrings.txt", "target_section": "2.5", "type": "SPEC", "level": "MUST", "comment": "   If any of the AWS KMS key identifiers is not a valid AWS KMS key ARN\n   (aws-kms-key-arn.md#a-valid-aws-kms-arn), this function MUST fail.\n"}, {"source": "src/AwsCryptographicMaterialProviders/Client.dfy", "target_path": "compliance/framework/aws-kms/aws-kms-multi-keyrings.txt", "target_section": "2.5", "line": 606, "type": "CITATION"}, {"source": "compliance/framework/aws-kms/aws-kms-multi-keyrings.txt", "target_path": "compliance/framework/aws-kms/aws-kms-multi-keyrings.txt", "target_section": "2.5", "type": "SPEC", "level": "MUST", "comment": "   If a regional client supplier is not passed, then a default MUST be\n   created that takes a region string and generates a default AWS SDK\n   client for the given region.\n"}, {"source": "src/AwsCryptographicMaterialProviders/Client.dfy", "target_path": "compliance/framework/aws-kms/aws-kms-multi-keyrings.txt", "target_section": "2.5", "line": 665, "type": "IMPLICATION"}, {"source": "compliance/framework/aws-kms/aws-kms-multi-keyrings.txt", "target_path": "compliance/framework/aws-kms/aws-kms-multi-keyrings.txt", "target_section": "2.5", "type": "SPEC", "level": "MUST", "comment": "\n   If there is a generator input then the generator keyring MUST be a\n   AWS KMS Keyring (aws-kms-keyring.md) initialized with\n"}, {"source": "compliance/framework/aws-kms/aws-kms-multi-keyrings.txt", "target_path": "compliance/framework/aws-kms/aws-kms-multi-keyrings.txt", "target_section": "2.5", "type": "SPEC", "level": "MUST", "comment": "\n   *  The AWS KMS client that MUST be created by the regional client\n      supplier when called with the region part of the AWS KMS key\n      identifier or a signal for the AWS SDK to select the default\n      region.\n"}, {"source": "compliance/framework/aws-kms/aws-kms-multi-keyrings.txt", "target_path": "compliance/framework/aws-kms/aws-kms-multi-keyrings.txt", "target_section": "2.5", "type": "SPEC", "level": "SHOULD", "comment": "\n   *  The input list of AWS KMS grant tokens\n\n   NOTE: The AWS Encryption SDK SHOULD NOT attempt to evaluate its own\n   default region.\n"}, {"source": "src/AwsCryptographicMaterialProviders/Client.dfy", "target_path": "compliance/framework/aws-kms/aws-kms-multi-keyrings.txt", "target_section": "2.5", "line": 651, "type": "IMPLICATION"}, {"source": "compliance/framework/aws-kms/aws-kms-multi-keyrings.txt", "target_path": "compliance/framework/aws-kms/aws-kms-multi-keyrings.txt", "target_section": "2.5", "type": "SPEC", "level": "MUST", "comment": "\n   Then a Multi-Keyring (../multi-keyring.md#inputs) MUST be initialize\n   by using this generator keyring as the generator keyring (../multi-\n   keyring.md#generator-keyring) and this set of child keyrings as the\n   child keyrings (../multi-keyring.md#child-keyrings). "}, {"source": "src/AwsCryptographicMaterialProviders/Client.dfy", "target_path": "compliance/framework/aws-kms/aws-kms-multi-keyrings.txt", "target_section": "2.5", "line": 658, "type": "IMPLICATION"}, {"source": "compliance/framework/aws-kms/aws-kms-multi-keyrings.txt", "target_path": "compliance/framework/aws-kms/aws-kms-multi-keyrings.txt", "target_section": "2.5", "type": "SPEC", "level": "MUST", "comment": " This Multi-\n   Keyring MUST be this function's output.\n"}, {"source": "src/AwsCryptographicMaterialProviders/Client.dfy", "target_path": "compliance/framework/aws-kms/aws-kms-multi-keyrings.txt", "target_section": "2.6", "line": 805, "type": "IMPLICATION"}, {"source": "compliance/framework/aws-kms/aws-kms-multi-keyrings.txt", "target_path": "compliance/framework/aws-kms/aws-kms-multi-keyrings.txt", "target_section": "2.6", "type": "SPEC", "level": "MUST", "comment": "   The caller MUST provide:\n"}, {"source": "src/AwsCryptographicMaterialProviders/Client.dfy", "target_path": "compliance/framework/aws-kms/aws-kms-multi-keyrings.txt", "target_section": "2.6", "line": 825, "type": "IMPLICATION"}, {"source": "compliance/framework/aws-kms/aws-kms-multi-keyrings.txt", "target_path": "compliance/framework/aws-kms/aws-kms-multi-keyrings.txt", "target_section": "2.6", "type": "SPEC", "level": "MUST", "comment": "   If an empty set of Region is provided this function MUST fail. "}, {"source": "src/AwsCryptographicMaterialProviders/Client.dfy", "target_path": "compliance/framework/aws-kms/aws-kms-multi-keyrings.txt", "target_section": "2.6", "line": 829, "type": "IMPLICATION"}, {"source": "compliance/framework/aws-kms/aws-kms-multi-keyrings.txt", "target_path": "compliance/framework/aws-kms/aws-kms-multi-keyrings.txt", "target_section": "2.6", "type": "SPEC", "level": "MUST", "comment": " If\n   any element of the set of regions is null or an empty string this\n   function MUST fail. "}, {"source": "src/AwsCryptographicMaterialProviders/Client.dfy", "target_path": "compliance/framework/aws-kms/aws-kms-multi-keyrings.txt", "target_section": "2.6", "line": 788, "type": "CITATION"}, {"source": "compliance/framework/aws-kms/aws-kms-multi-keyrings.txt", "target_path": "compliance/framework/aws-kms/aws-kms-multi-keyrings.txt", "target_section": "2.6", "type": "SPEC", "level": "MUST", "comment": " If a regional client supplier is not passed,\n   then a default MUST be created that takes a region string and\n   generates a default AWS SDK client for the given region.\n"}, {"source": "src/AwsCryptographicMaterialProviders/Client.dfy", "target_path": "compliance/framework/aws-kms/aws-kms-multi-keyrings.txt", "target_section": "2.6", "line": 880, "type": "CITATION"}, {"source": "compliance/framework/aws-kms/aws-kms-multi-keyrings.txt", "target_path": "compliance/framework/aws-kms/aws-kms-multi-keyrings.txt", "target_section": "2.6", "type": "SPEC", "level": "MUST", "comment": "\n   A set of AWS KMS clients MUST be created by calling regional client\n   supplier for each region in the input set of regions.\n"}, {"source": "src/AwsCryptographicMaterialProviders/Client.dfy", "target_path": "compliance/framework/aws-kms/aws-kms-multi-keyrings.txt", "target_section": "2.6", "line": 855, "type": "IMPLICATION"}, {"source": "compliance/framework/aws-kms/aws-kms-multi-keyrings.txt", "target_path": "compliance/framework/aws-kms/aws-kms-multi-keyrings.txt", "target_section": "2.6", "type": "SPEC", "level": "MUST", "comment": "\n   Then a set of AWS KMS Discovery Keyring (aws-kms-discovery-\n   keyring.md) MUST be created for each AWS KMS client by initializing\n   each keyring with\n"}, {"source": "src/AwsCryptographicMaterialProviders/Client.dfy", "target_path": "compliance/framework/aws-kms/aws-kms-multi-keyrings.txt", "target_section": "2.6", "line": 838, "type": "IMPLICATION"}, {"source": "compliance/framework/aws-kms/aws-kms-multi-keyrings.txt", "target_path": "compliance/framework/aws-kms/aws-kms-multi-keyrings.txt", "target_section": "2.6", "type": "SPEC", "level": "MUST", "comment": "   Then a Multi-Keyring (../multi-keyring.md#inputs) MUST be initialize\n   by using this set of discovery keyrings as the child keyrings\n   (../multi-keyring.md#child-keyrings). "}, {"source": "compliance/framework/aws-kms/aws-kms-multi-keyrings.txt", "target_path": "compliance/framework/aws-kms/aws-kms-multi-keyrings.txt", "target_section": "2.6", "type": "SPEC", "level": "MUST", "comment": " This Multi-Keyring MUST be\n   this functions output.\n"}, {"source": "compliance/framework/aws-kms/aws-kms-key-arn.txt", "target_path": "compliance/framework/aws-kms/aws-kms-key-arn.txt", "target_section": "2.4.1", "type": "SPEC", "level": "MUST", "comment": "\n\n   The key words \"MUST\", \"MUST NOT\", \"REQUIRED\", \"SHALL\", \"SHALL NOT\",\n   \"SHOULD\", \"SHOULD NOT\", \"RECOMMENDED\", \"MAY\", and \"OPTIONAL\" in this\n   document are to be interpreted as described in RFC 2119\n   (https://tools.ietf.org/html/rfc2119).\n"}, {"source": "src/AwsCryptographicMaterialProviders/Keyrings/AwsKms/AwsKmsArnParsing.dfy", "target_path": "compliance/framework/aws-kms/aws-kms-key-arn.txt", "target_section": "2.8", "line": 227, "type": "IMPLICATION"}, {"source": "compliance/framework/aws-kms/aws-kms-key-arn.txt", "target_path": "compliance/framework/aws-kms/aws-kms-key-arn.txt", "target_section": "2.8", "type": "SPEC", "level": "MUST", "comment": "\n\n   This function MUST take a single AWS KMS ARN\n\n   If the input is an invalid AWS KMS ARN this function MUST error.\n"}, {"source": "src/AwsCryptographicMaterialProviders/Keyrings/AwsKms/AwsKmsArnParsing.dfy", "target_path": "compliance/framework/aws-kms/aws-kms-key-arn.txt", "target_section": "2.8", "line": 237, "type": "IMPLICATION"}, {"source": "compliance/framework/aws-kms/aws-kms-key-arn.txt", "target_path": "compliance/framework/aws-kms/aws-kms-key-arn.txt", "target_section": "2.8", "type": "SPEC", "level": "MUST", "comment": "\n   If resource type is \"alias\", this is an AWS KMS alias ARN and MUST\n   return false. "}, {"source": "src/AwsCryptographicMaterialProviders/Keyrings/AwsKms/AwsKmsArnParsing.dfy", "target_path": "compliance/framework/aws-kms/aws-kms-key-arn.txt", "target_section": "2.8", "line": 249, "type": "IMPLICATION"}, {"source": "compliance/framework/aws-kms/aws-kms-key-arn.txt", "target_path": "compliance/framework/aws-kms/aws-kms-key-arn.txt", "target_section": "2.8", "type": "SPEC", "level": "MUST", "comment": " If resource type is \"key\" and resource ID starts with\n   \"mrk-\", this is a AWS KMS multi-Region key ARN and MUST return true.\n"}, {"source": "src/AwsCryptographicMaterialProviders/Keyrings/AwsKms/AwsKmsArnParsing.dfy", "target_path": "compliance/framework/aws-kms/aws-kms-key-arn.txt", "target_section": "2.8", "line": 242, "type": "IMPLICATION"}, {"source": "compliance/framework/aws-kms/aws-kms-key-arn.txt", "target_path": "compliance/framework/aws-kms/aws-kms-key-arn.txt", "target_section": "2.8", "type": "SPEC", "level": "MUST", "comment": "   If resource type is \"key\" and resource ID does not start with \"mrk-\",\n   this is a (single-region) AWS KMS key ARN and MUST return false.\n"}, {"source": "src/AwsCryptographicMaterialProviders/Keyrings/AwsKms/AwsKmsArnParsing.dfy", "target_path": "compliance/framework/aws-kms/aws-kms-key-arn.txt", "target_section": "2.9", "line": 259, "type": "IMPLICATION"}, {"source": "compliance/framework/aws-kms/aws-kms-key-arn.txt", "target_path": "compliance/framework/aws-kms/aws-kms-key-arn.txt", "target_section": "2.9", "type": "SPEC", "level": "MUST", "comment": "\n\n   This function MUST take a single AWS KMS identifier\n\n   If the input starts with \"arn:\", this MUST return the output of\n   identifying an an AWS KMS multi-Region ARN (aws-kms-key-\n   arn.md#identifying-an-an-aws-kms-multi-region-arn) called with this\n   input. "}, {"source": "src/AwsCryptographicMaterialProviders/Keyrings/AwsKms/AwsKmsArnParsing.dfy", "target_path": "compliance/framework/aws-kms/aws-kms-key-arn.txt", "target_section": "2.9", "line": 285, "type": "IMPLICATION"}, {"source": "compliance/framework/aws-kms/aws-kms-key-arn.txt", "target_path": "compliance/framework/aws-kms/aws-kms-key-arn.txt", "target_section": "2.9", "type": "SPEC", "level": "MUST", "comment": " If the input starts with \"alias/\", this an AWS KMS alias and\n   not a multi-Region key id and MUST return false. "}, {"source": "src/AwsCryptographicMaterialProviders/Keyrings/AwsKms/AwsKmsArnParsing.dfy", "target_path": "compliance/framework/aws-kms/aws-kms-key-arn.txt", "target_section": "2.9", "line": 294, "type": "IMPLICATION"}, {"source": "compliance/framework/aws-kms/aws-kms-key-arn.txt", "target_path": "compliance/framework/aws-kms/aws-kms-key-arn.txt", "target_section": "2.9", "type": "SPEC", "level": "MUST", "comment": " If the input starts\n   with \"mrk-\", this is a multi-Region key id and MUST return true. "}, {"source": "src/AwsCryptographicMaterialProviders/Keyrings/AwsKms/AwsKmsArnParsing.dfy", "target_path": "compliance/framework/aws-kms/aws-kms-key-arn.txt", "target_section": "2.9", "line": 303, "type": "IMPLICATION"}, {"source": "compliance/framework/aws-kms/aws-kms-key-arn.txt", "target_path": "compliance/framework/aws-kms/aws-kms-key-arn.txt", "target_section": "2.9", "type": "SPEC", "level": "MUST", "comment": " If\n   the input does not start with any of the above, this is not a multi-\n   Region key id and MUST return false.\n"}, {"source": "compliance/framework/aws-kms/aws-kms-mrk-are-unique.txt", "target_path": "compliance/framework/aws-kms/aws-kms-mrk-are-unique.txt", "target_section": "2.4.1", "type": "SPEC", "level": "MUST", "comment": "\n\n   The key words \"MUST\", \"MUST NOT\", \"REQUIRED\", \"SHALL\", \"SHALL NOT\",\n   \"SHOULD\", \"SHOULD NOT\", \"RECOMMENDED\", \"MAY\", and \"OPTIONAL\" in this\n   document are to be interpreted as described in RFC 2119\n   (https://tools.ietf.org/html/rfc2119).\n"}, {"source": "src/AwsCryptographicMaterialProviders/Keyrings/AwsKms/AwsKmsMrkAreUnique.dfy", "target_path": "compliance/framework/aws-kms/aws-kms-mrk-are-unique.txt", "target_section": "2.5", "line": 14, "type": "IMPLICATION"}, {"source": "compliance/framework/aws-kms/aws-kms-mrk-are-unique.txt", "target_path": "compliance/framework/aws-kms/aws-kms-mrk-are-unique.txt", "target_section": "2.5", "type": "SPEC", "level": "MUST", "comment": "   The caller MUST provide:\n"}, {"source": "src/AwsCryptographicMaterialProviders/Keyrings/AwsKms/AwsKmsMrkAreUnique.dfy", "target_path": "compliance/framework/aws-kms/aws-kms-mrk-are-unique.txt", "target_section": "2.5", "line": 57, "type": "IMPLICATION"}, {"source": "compliance/framework/aws-kms/aws-kms-mrk-are-unique.txt", "target_path": "compliance/framework/aws-kms/aws-kms-mrk-are-unique.txt", "target_section": "2.5", "type": "SPEC", "level": "MUST", "comment": "   If the list does not contain any multi-Region keys (aws-kms-key-\n   arn.md#identifying-an-aws-kms-multi-region-key) this function MUST\n   exit successfully.\n"}, {"source": "src/AwsCryptographicMaterialProviders/Keyrings/AwsKms/AwsKmsMrkAreUnique.dfy", "target_path": "compliance/framework/aws-kms/aws-kms-mrk-are-unique.txt", "target_section": "2.5", "line": 67, "type": "IMPLICATION"}, {"source": "compliance/framework/aws-kms/aws-kms-mrk-are-unique.txt", "target_path": "compliance/framework/aws-kms/aws-kms-mrk-are-unique.txt", "target_section": "2.5", "type": "SPEC", "level": "MUST", "comment": "\n   If there are zero duplicate resource ids between the multi-region\n   keys, this function MUST exit successfully\n\n   If any duplicate multi-region resource ids exist, this function MUST\n   yield an error that includes all identifiers with duplicate resource\n   ids not only the first duplicate found.\n"}, {"source": "compliance/framework/aws-kms/aws-kms-mrk-keyring.txt", "target_path": "compliance/framework/aws-kms/aws-kms-mrk-keyring.txt", "target_section": "2.4.1", "type": "SPEC", "level": "MUST", "comment": "\n\n   The key words \"MUST\", \"MUST NOT\", \"REQUIRED\", \"SHALL\", \"SHALL NOT\",\n   \"SHOULD\", \"SHOULD NOT\", \"RECOMMENDED\", \"MAY\", and \"OPTIONAL\" in this\n   document are to be interpreted as described in RFC 2119\n   (https://tools.ietf.org/html/rfc2119).\n"}, {"source": "compliance/framework/aws-kms/aws-kms-mrk-keyring.txt", "target_path": "compliance/framework/aws-kms/aws-kms-mrk-keyring.txt", "target_section": "2.6", "type": "SPEC", "level": "MUST", "comment": "   On initialization the caller MUST provide:\n"}, {"source": "src/AwsCryptographicMaterialProviders/Keyrings/AwsKms/AwsKmsMrkKeyring.dfy", "target_path": "compliance/framework/aws-kms/aws-kms-mrk-keyring.txt", "target_section": "2.6", "line": 60, "type": "IMPLICATION"}, {"source": "compliance/framework/aws-kms/aws-kms-mrk-keyring.txt", "target_path": "compliance/framework/aws-kms/aws-kms-mrk-keyring.txt", "target_section": "2.6", "type": "SPEC", "level": "MUST", "comment": "   The AWS KMS key identifier MUST NOT be null or empty. "}, {"source": "compliance/framework/aws-kms/aws-kms-mrk-keyring.txt", "target_path": "compliance/framework/aws-kms/aws-kms-mrk-keyring.txt", "target_section": "2.6", "type": "SPEC", "level": "MUST", "comment": " The AWS KMS\n   key identifier MUST be a valid identifier (aws-kms-key-arn.md#a-\n   valid-aws-kms-identifier). "}, {"source": "src/AwsCryptographicMaterialProviders/Keyrings/AwsKms/AwsKmsMrkKeyring.dfy", "target_path": "compliance/framework/aws-kms/aws-kms-mrk-keyring.txt", "target_section": "2.6", "line": 53, "type": "IMPLICATION"}, {"source": "compliance/framework/aws-kms/aws-kms-mrk-keyring.txt", "target_path": "compliance/framework/aws-kms/aws-kms-mrk-keyring.txt", "target_section": "2.6", "type": "SPEC", "level": "MUST", "comment": " The AWS KMS SDK client MUST NOT be null.\n"}, {"source": "src/AwsCryptographicMaterialProviders/Keyrings/AwsKms/AwsKmsMrkKeyring.dfy", "target_path": "compliance/framework/aws-kms/aws-kms-mrk-keyring.txt", "target_section": "2.7", "line": 81, "type": "IMPLICATION"}, {"source": "compliance/framework/aws-kms/aws-kms-mrk-keyring.txt", "target_path": "compliance/framework/aws-kms/aws-kms-mrk-keyring.txt", "target_section": "2.7", "type": "SPEC", "level": "MUST", "comment": "\n\n   OnEncrypt MUST take encryption materials\n   (../structures.md#encryption-materials) as input.\n"}, {"source": "src/AwsCryptographicMaterialProviders/Keyrings/AwsKms/AwsKmsMrkKeyring.dfy", "target_path": "compliance/framework/aws-kms/aws-kms-mrk-keyring.txt", "target_section": "2.7", "line": 94, "type": "IMPLICATION"}, {"source": "compliance/framework/aws-kms/aws-kms-mrk-keyring.txt", "target_path": "compliance/framework/aws-kms/aws-kms-mrk-keyring.txt", "target_section": "2.7", "type": "SPEC", "level": "MUST", "comment": "\n   If the input encryption materials (../structures.md#encryption-\n   materials) do not contain a plaintext data key OnEncrypt MUST attempt\n   to generate a new plaintext data key by calling AWS KMS\n   GenerateDataKey (https://docs.aws.amazon.com/kms/latest/APIReference/\n   API_GenerateDataKey.html).\n"}, {"source": "src/AwsCryptographicMaterialProviders/Keyrings/AwsKms/AwsKmsMrkKeyring.dfy", "target_path": "compliance/framework/aws-kms/aws-kms-mrk-keyring.txt", "target_section": "2.7", "line": 107, "type": "IMPLICATION"}, {"source": "compliance/framework/aws-kms/aws-kms-mrk-keyring.txt", "target_path": "compliance/framework/aws-kms/aws-kms-mrk-keyring.txt", "target_section": "2.7", "type": "SPEC", "level": "MUST", "comment": "\n   If the keyring calls AWS KMS GenerateDataKeys, it MUST use the\n   configured AWS KMS client to make the call. "}, {"source": "src/AwsCryptographicMaterialProviders/Keyrings/AwsKms/AwsKmsMrkKeyring.dfy", "target_path": "compliance/framework/aws-kms/aws-kms-mrk-keyring.txt", "target_section": "2.7", "line": 112, "type": "IMPLICATION"}, {"source": "compliance/framework/aws-kms/aws-kms-mrk-keyring.txt", "target_path": "compliance/framework/aws-kms/aws-kms-mrk-keyring.txt", "target_section": "2.7", "type": "SPEC", "level": "MUST", "comment": " The keyring MUST call\n   AWS KMS GenerateDataKeys with a request constructed as follows:\n"}, {"source": "src/AwsCryptographicMaterialProviders/Keyrings/AwsKms/AwsKmsMrkKeyring.dfy", "target_path": "compliance/framework/aws-kms/aws-kms-mrk-keyring.txt", "target_section": "2.7", "line": 248, "type": "CITATION"}, {"source": "compliance/framework/aws-kms/aws-kms-mrk-keyring.txt", "target_path": "compliance/framework/aws-kms/aws-kms-mrk-keyring.txt", "target_section": "2.7", "type": "SPEC", "level": "MUST", "comment": "   If the call to AWS KMS GenerateDataKey\n   (https://docs.aws.amazon.com/kms/latest/APIReference/\n   API_GenerateDataKey.html) does not succeed, OnEncrypt MUST NOT modify\n   the encryption materials (../structures.md#encryption-materials) and\n   MUST fail.\n"}, {"source": "src/AwsCryptographicMaterialProviders/Keyrings/AwsKms/AwsKmsMrkKeyring.dfy", "target_path": "compliance/framework/aws-kms/aws-kms-mrk-keyring.txt", "target_section": "2.7", "line": 135, "type": "IMPLICATION"}, {"source": "compliance/framework/aws-kms/aws-kms-mrk-keyring.txt", "target_path": "compliance/framework/aws-kms/aws-kms-mrk-keyring.txt", "target_section": "2.7", "type": "SPEC", "level": "MUST", "comment": "\n   If the Generate Data Key call succeeds, OnEncrypt MUST verify that\n   the response \"Plaintext\" length matches the specification of the\n   algorithm suite (../algorithm-suites.md)'s Key Derivation Input\n   Length field. "}, {"source": "src/AwsCryptographicMaterialProviders/Keyrings/AwsKms/AwsKmsMrkKeyring.dfy", "target_path": "compliance/framework/aws-kms/aws-kms-mrk-keyring.txt", "target_section": "2.7", "line": 261, "type": "CITATION"}, {"source": "compliance/framework/aws-kms/aws-kms-mrk-keyring.txt", "target_path": "compliance/framework/aws-kms/aws-kms-mrk-keyring.txt", "target_section": "2.7", "type": "SPEC", "level": "MUST", "comment": " The Generate Data Key response's \"KeyId\" MUST be A\n   valid AWS KMS key ARN (aws-kms-key-arn.md#identifying-an-aws-kms-\n   multi-region-key). "}, {"source": "src/AwsCryptographicMaterialProviders/Keyrings/AwsKms/AwsKmsMrkKeyring.dfy", "target_path": "compliance/framework/aws-kms/aws-kms-mrk-keyring.txt", "target_section": "2.7", "line": 144, "type": "IMPLICATION"}, {"source": "compliance/framework/aws-kms/aws-kms-mrk-keyring.txt", "target_path": "compliance/framework/aws-kms/aws-kms-mrk-keyring.txt", "target_section": "2.7", "type": "SPEC", "level": "MUST", "comment": " If verified, OnEncrypt MUST do the following with\n   the response from AWS KMS GenerateDataKey\n   (https://docs.aws.amazon.com/kms/latest/APIReference/\n   API_GenerateDataKey.html):\n"}, {"source": "compliance/framework/aws-kms/aws-kms-mrk-keyring.txt", "target_path": "compliance/framework/aws-kms/aws-kms-mrk-keyring.txt", "target_section": "2.7", "type": "SPEC", "level": "MUST", "comment": "\n   *  \"GrantTokens\": this keyring's grant tokens\n      (https://docs.aws.amazon.com/kms/latest/developerguide/\n      concepts.html#grant_token)\n\n   If the call to AWS KMS Encrypt\n   (https://docs.aws.amazon.com/kms/latest/APIReference/\n   API_Encrypt.html) does not succeed, OnEncrypt MUST fail.\n"}, {"source": "src/AwsCryptographicMaterialProviders/Keyrings/AwsKms/AwsKmsMrkKeyring.dfy", "target_path": "compliance/framework/aws-kms/aws-kms-mrk-keyring.txt", "target_section": "2.7", "line": 327, "type": "CITATION"}, {"source": "compliance/framework/aws-kms/aws-kms-mrk-keyring.txt", "target_path": "compliance/framework/aws-kms/aws-kms-mrk-keyring.txt", "target_section": "2.7", "type": "SPEC", "level": "MUST", "comment": "\n   If the Encrypt call succeeds the response's \"KeyId\" MUST be A valid\n   AWS KMS key ARN (aws-kms-key-arn.md#a-valid-aws-kms-arn). "}, {"source": "src/AwsCryptographicMaterialProviders/Keyrings/AwsKms/AwsKmsMrkKeyring.dfy", "target_path": "compliance/framework/aws-kms/aws-kms-mrk-keyring.txt", "target_section": "2.7", "line": 206, "type": "IMPLICATION"}, {"source": "compliance/framework/aws-kms/aws-kms-mrk-keyring.txt", "target_path": "compliance/framework/aws-kms/aws-kms-mrk-keyring.txt", "target_section": "2.7", "type": "SPEC", "level": "MUST", "comment": " If\n   verified, OnEncrypt MUST do the following with the response from AWS\n   KMS Encrypt (https://docs.aws.amazon.com/kms/latest/APIReference/\n   API_Encrypt.html):\n\n   *  append a new encrypted data key (../structures.md#encrypted-data-\n      key) to the encrypted data key list in the encryption materials\n      (../structures.md#encryption-materials), constructed as follows:\n\n      -  The ciphertext (../structures.md#ciphertext) is the response\n         \"CiphertextBlob\".\n"}, {"source": "src/AwsCryptographicMaterialProviders/Keyrings/AwsKms/AwsKmsMrkKeyring.dfy", "target_path": "compliance/framework/aws-kms/aws-kms-mrk-keyring.txt", "target_section": "2.7", "line": 197, "type": "IMPLICATION"}, {"source": "compliance/framework/aws-kms/aws-kms-mrk-keyring.txt", "target_path": "compliance/framework/aws-kms/aws-kms-mrk-keyring.txt", "target_section": "2.7", "type": "SPEC", "level": "MUST", "comment": "\n   If all Encrypt calls succeed, OnEncrypt MUST output the modified\n   encryption materials (../structures.md#encryption-materials).\n"}, {"source": "src/AwsCryptographicMaterialProviders/Keyrings/AwsKms/AwsKmsMrkKeyring.dfy", "target_path": "compliance/framework/aws-kms/aws-kms-mrk-keyring.txt", "target_section": "2.8", "line": 359, "type": "IMPLICATION"}, {"source": "compliance/framework/aws-kms/aws-kms-mrk-keyring.txt", "target_path": "compliance/framework/aws-kms/aws-kms-mrk-keyring.txt", "target_section": "2.8", "type": "SPEC", "level": "MUST", "comment": "\n\n   OnDecrypt MUST take decryption materials\n   (../structures.md#decryption-materials) and a list of encrypted data\n   keys (../structures.md#encrypted-data-key) as input.\n"}, {"source": "compliance/framework/aws-kms/aws-kms-mrk-keyring.txt", "target_path": "compliance/framework/aws-kms/aws-kms-mrk-keyring.txt", "target_section": "2.8", "type": "SPEC", "level": "MUST", "comment": "\n   If the decryption materials (../structures.md#decryption-materials)\n   already contained a valid plaintext data key OnDecrypt MUST\n   immediately return the unmodified decryption materials\n   (../structures.md#decryption-materials).\n"}, {"source": "src/AwsCryptographicMaterialProviders/Keyrings/AwsKms/AwsKmsMrkKeyring.dfy", "target_path": "compliance/framework/aws-kms/aws-kms-mrk-keyring.txt", "target_section": "2.8", "line": 439, "type": "CITATION"}, {"source": "compliance/framework/aws-kms/aws-kms-mrk-keyring.txt", "target_path": "compliance/framework/aws-kms/aws-kms-mrk-keyring.txt", "target_section": "2.8", "type": "SPEC", "level": "MUST", "comment": "\n   The set of encrypted data keys MUST first be filtered to match this\n   keyring's configuration. "}, {"source": "src/AwsCryptographicMaterialProviders/Keyrings/AwsKms/AwsKmsMrkKeyring.dfy", "target_path": "compliance/framework/aws-kms/aws-kms-mrk-keyring.txt", "target_section": "2.8", "line": 446, "type": "CITATION"}, {"source": "compliance/framework/aws-kms/aws-kms-mrk-keyring.txt", "target_path": "compliance/framework/aws-kms/aws-kms-mrk-keyring.txt", "target_section": "2.8", "type": "SPEC", "level": "MUST", "comment": "   For each encrypted data key in the filtered set, one at a time, the\n   OnDecrypt MUST attempt to decrypt the data key. "}, {"source": "compliance/framework/aws-kms/aws-kms-mrk-keyring.txt", "target_path": "compliance/framework/aws-kms/aws-kms-mrk-keyring.txt", "target_section": "2.8", "type": "SPEC", "level": "MUST", "comment": " If this attempt\n   results in an error, then these errors MUST be collected.\n"}, {"source": "src/AwsCryptographicMaterialProviders/Keyrings/AwsKms/AwsKmsMrkKeyring.dfy", "target_path": "compliance/framework/aws-kms/aws-kms-mrk-keyring.txt", "target_section": "2.8", "line": 396, "type": "IMPLICATION"}, {"source": "compliance/framework/aws-kms/aws-kms-mrk-keyring.txt", "target_path": "compliance/framework/aws-kms/aws-kms-mrk-keyring.txt", "target_section": "2.8", "type": "SPEC", "level": "MUST", "comment": "\n   To attempt to decrypt a particular encrypted data key\n   (../structures.md#encrypted-data-key), OnDecrypt MUST call AWS KMS\n   Decrypt (https://docs.aws.amazon.com/kms/latest/APIReference/\n   API_Decrypt.html) with the configured AWS KMS client.\n"}, {"source": "src/AwsCryptographicMaterialProviders/Keyrings/AwsKms/AwsKmsMrkKeyring.dfy", "target_path": "compliance/framework/aws-kms/aws-kms-mrk-keyring.txt", "target_section": "2.8", "line": 403, "type": "IMPLICATION"}, {"source": "compliance/framework/aws-kms/aws-kms-mrk-keyring.txt", "target_path": "compliance/framework/aws-kms/aws-kms-mrk-keyring.txt", "target_section": "2.8", "type": "SPEC", "level": "MUST", "comment": "\n   When calling AWS KMS Decrypt\n   (https://docs.aws.amazon.com/kms/latest/APIReference/\n   API_Decrypt.html), the keyring MUST call with a request constructed\n   as follows:\n"}, {"source": "compliance/framework/aws-kms/aws-kms-mrk-keyring.txt", "target_path": "compliance/framework/aws-kms/aws-kms-mrk-keyring.txt", "target_section": "2.8", "type": "SPEC", "level": "MUST", "comment": "   If the call to AWS KMS Decrypt\n   (https://docs.aws.amazon.com/kms/latest/APIReference/\n   API_Decrypt.html) succeeds OnDecrypt verifies\n\n   *  The \"KeyId\" field in the response MUST equal the configured AWS\n      KMS key identifier.\n"}, {"source": "src/AwsCryptographicMaterialProviders/Keyrings/AwsKms/AwsKmsMrkKeyring.dfy", "target_path": "compliance/framework/aws-kms/aws-kms-mrk-keyring.txt", "target_section": "2.8", "line": 410, "type": "IMPLICATION"}, {"source": "compliance/framework/aws-kms/aws-kms-mrk-keyring.txt", "target_path": "compliance/framework/aws-kms/aws-kms-mrk-keyring.txt", "target_section": "2.8", "type": "SPEC", "level": "MUST", "comment": "\n   *  The length of the response's \"Plaintext\" MUST equal the key\n      derivation input length (../algorithm-suites.md#key-derivation-\n      input-length) specified by the algorithm suite (../algorithm-\n      suites.md) included in the input decryption materials\n      (../structures.md#decryption-materials).\n"}, {"source": "src/AwsCryptographicMaterialProviders/Keyrings/AwsKms/AwsKmsMrkKeyring.dfy", "target_path": "compliance/framework/aws-kms/aws-kms-mrk-keyring.txt", "target_section": "2.8", "line": 458, "type": "CITATION"}, {"source": "compliance/framework/aws-kms/aws-kms-mrk-keyring.txt", "target_path": "compliance/framework/aws-kms/aws-kms-mrk-keyring.txt", "target_section": "2.8", "type": "SPEC", "level": "MUST", "comment": "\n   If the response does not satisfies these requirements then an error\n   MUST be collected and the next encrypted data key in the filtered set\n   MUST be attempted.\n"}, {"source": "src/AwsCryptographicMaterialProviders/Keyrings/AwsKms/AwsKmsMrkKeyring.dfy", "target_path": "compliance/framework/aws-kms/aws-kms-mrk-keyring.txt", "target_section": "2.8", "line": 425, "type": "IMPLICATION"}, {"source": "compliance/framework/aws-kms/aws-kms-mrk-keyring.txt", "target_path": "compliance/framework/aws-kms/aws-kms-mrk-keyring.txt", "target_section": "2.8", "type": "SPEC", "level": "MUST", "comment": "\n   If the response does satisfies these requirements then OnDecrypt MUST\n   do the following with the response:\n\n   *  set the plaintext data key on the decryption materials\n      (../structures.md#decryption-materials) as the response\n      \"Plaintext\".\n"}, {"source": "src/AwsCryptographicMaterialProviders/Keyrings/AwsKms/AwsKmsMrkKeyring.dfy", "target_path": "compliance/framework/aws-kms/aws-kms-mrk-keyring.txt", "target_section": "2.8", "line": 495, "type": "CITATION"}, {"source": "compliance/framework/aws-kms/aws-kms-mrk-keyring.txt", "target_path": "compliance/framework/aws-kms/aws-kms-mrk-keyring.txt", "target_section": "2.8", "type": "SPEC", "level": "MUST", "comment": "\n   If OnDecrypt fails to successfully decrypt any encrypted data key\n   (../structures.md#encrypted-data-key), then it MUST yield an error\n   that includes all the collected errors.\n"}, {"source": "compliance/framework/aws-kms/aws-kms-mrk-multi-keyrings.txt", "target_path": "compliance/framework/aws-kms/aws-kms-mrk-multi-keyrings.txt", "target_section": "2.4.1", "type": "SPEC", "level": "MUST", "comment": "\n\n   The key words \"MUST\", \"MUST NOT\", \"REQUIRED\", \"SHALL\", \"SHALL NOT\",\n   \"SHOULD\", \"SHOULD NOT\", \"RECOMMENDED\", \"MAY\", and \"OPTIONAL\" in this\n   document are to be interpreted as described in RFC 2119\n   (https://tools.ietf.org/html/rfc2119).\n"}, {"source": "compliance/framework/aws-kms/aws-kms-mrk-multi-keyrings.txt", "target_path": "compliance/framework/aws-kms/aws-kms-mrk-multi-keyrings.txt", "target_section": "2.5", "type": "SPEC", "level": "MUST", "comment": "   The caller MUST provide:\n"}, {"source": "src/AwsCryptographicMaterialProviders/Client.dfy", "target_path": "compliance/framework/aws-kms/aws-kms-mrk-multi-keyrings.txt", "target_section": "2.5", "line": 310, "type": "IMPLICATION"}, {"source": "compliance/framework/aws-kms/aws-kms-mrk-multi-keyrings.txt", "target_path": "compliance/framework/aws-kms/aws-kms-mrk-multi-keyrings.txt", "target_section": "2.5", "type": "SPEC", "level": "MUST", "comment": "   If any of the AWS KMS key identifiers is not a valid AWS KMS key ARN\n   (aws-kms-key-arn.md#a-valid-aws-kms-arn), this function MUST fail All\n   AWS KMS identifiers are passed to Assert AWS KMS MRK are unique (aws-\n   kms-mrk-are-unique.md#Implementation) and the function MUST return\n   success otherwise this MUST fail. "}, {"source": "src/AwsCryptographicMaterialProviders/Client.dfy", "target_path": "compliance/framework/aws-kms/aws-kms-mrk-multi-keyrings.txt", "target_section": "2.5", "line": 285, "type": "CITATION"}, {"source": "compliance/framework/aws-kms/aws-kms-mrk-multi-keyrings.txt", "target_path": "compliance/framework/aws-kms/aws-kms-mrk-multi-keyrings.txt", "target_section": "2.5", "type": "SPEC", "level": "MUST", "comment": " If a regional client supplier is\n   not passed, then a default MUST be created that takes a region string\n   and generates a default AWS SDK client for the given region.\n"}, {"source": "src/AwsCryptographicMaterialProviders/Client.dfy", "target_path": "compliance/framework/aws-kms/aws-kms-mrk-multi-keyrings.txt", "target_section": "2.5", "line": 351, "type": "IMPLICATION"}, {"source": "compliance/framework/aws-kms/aws-kms-mrk-multi-keyrings.txt", "target_path": "compliance/framework/aws-kms/aws-kms-mrk-multi-keyrings.txt", "target_section": "2.5", "type": "SPEC", "level": "MUST", "comment": "\n   If there is a generator input then the generator keyring MUST be a\n   AWS KMS MRK Keyring (aws-kms-mrk-keyring.md) initialized with\n"}, {"source": "compliance/framework/aws-kms/aws-kms-mrk-multi-keyrings.txt", "target_path": "compliance/framework/aws-kms/aws-kms-mrk-multi-keyrings.txt", "target_section": "2.5", "type": "SPEC", "level": "MUST", "comment": "\n   *  The AWS KMS client that MUST be created by the regional client\n      supplier when called with the region part of the AWS KMS key\n      identifier or a signal for the AWS SDK to select the default\n      region.\n"}, {"source": "compliance/framework/aws-kms/aws-kms-mrk-multi-keyrings.txt", "target_path": "compliance/framework/aws-kms/aws-kms-mrk-multi-keyrings.txt", "target_section": "2.5", "type": "SPEC", "level": "SHOULD", "comment": "\n   *  The input list of AWS KMS grant tokens\n\n   NOTE: The AWS Encryption SDK SHOULD NOT attempt to evaluate its own\n   default region.\n"}, {"source": "src/AwsCryptographicMaterialProviders/Client.dfy", "target_path": "compliance/framework/aws-kms/aws-kms-mrk-multi-keyrings.txt", "target_section": "2.5", "line": 340, "type": "IMPLICATION"}, {"source": "compliance/framework/aws-kms/aws-kms-mrk-multi-keyrings.txt", "target_path": "compliance/framework/aws-kms/aws-kms-mrk-multi-keyrings.txt", "target_section": "2.5", "type": "SPEC", "level": "MUST", "comment": "\n   Then a Multi-Keyring (../multi-keyring.md#inputs) MUST be initialize\n   by using this generator keyring as the generator keyring (../multi-\n   keyring.md#generator-keyring) and this set of child keyrings as the\n   child keyrings (../multi-keyring.md#child-keyrings). "}, {"source": "compliance/framework/aws-kms/aws-kms-mrk-multi-keyrings.txt", "target_path": "compliance/framework/aws-kms/aws-kms-mrk-multi-keyrings.txt", "target_section": "2.5", "type": "SPEC", "level": "MUST", "comment": " This Multi-\n   Keyring MUST be this functions output.\n"}, {"source": "src/AwsCryptographicMaterialProviders/Client.dfy", "target_path": "compliance/framework/aws-kms/aws-kms-mrk-multi-keyrings.txt", "target_section": "2.6", "line": 497, "type": "IMPLICATION"}, {"source": "compliance/framework/aws-kms/aws-kms-mrk-multi-keyrings.txt", "target_path": "compliance/framework/aws-kms/aws-kms-mrk-multi-keyrings.txt", "target_section": "2.6", "type": "SPEC", "level": "MUST", "comment": "   The caller MUST provide:\n"}, {"source": "src/AwsCryptographicMaterialProviders/Client.dfy", "target_path": "compliance/framework/aws-kms/aws-kms-mrk-multi-keyrings.txt", "target_section": "2.6", "line": 517, "type": "IMPLICATION"}, {"source": "compliance/framework/aws-kms/aws-kms-mrk-multi-keyrings.txt", "target_path": "compliance/framework/aws-kms/aws-kms-mrk-multi-keyrings.txt", "target_section": "2.6", "type": "SPEC", "level": "MUST", "comment": "   If an empty set of Region is provided this function MUST fail. "}, {"source": "src/AwsCryptographicMaterialProviders/Client.dfy", "target_path": "compliance/framework/aws-kms/aws-kms-mrk-multi-keyrings.txt", "target_section": "2.6", "line": 521, "type": "IMPLICATION"}, {"source": "compliance/framework/aws-kms/aws-kms-mrk-multi-keyrings.txt", "target_path": "compliance/framework/aws-kms/aws-kms-mrk-multi-keyrings.txt", "target_section": "2.6", "type": "SPEC", "level": "MUST", "comment": " If\n   any element of the set of regions is null or an empty string this\n   function MUST fail. "}, {"source": "src/AwsCryptographicMaterialProviders/Client.dfy", "target_path": "compliance/framework/aws-kms/aws-kms-mrk-multi-keyrings.txt", "target_section": "2.6", "line": 480, "type": "CITATION"}, {"source": "compliance/framework/aws-kms/aws-kms-mrk-multi-keyrings.txt", "target_path": "compliance/framework/aws-kms/aws-kms-mrk-multi-keyrings.txt", "target_section": "2.6", "type": "SPEC", "level": "MUST", "comment": " If a regional client supplier is not passed,\n   then a default MUST be created that takes a region string and\n   generates a default AWS SDK client for the given region.\n"}, {"source": "src/AwsCryptographicMaterialProviders/Client.dfy", "target_path": "compliance/framework/aws-kms/aws-kms-mrk-multi-keyrings.txt", "target_section": "2.6", "line": 573, "type": "CITATION"}, {"source": "compliance/framework/aws-kms/aws-kms-mrk-multi-keyrings.txt", "target_path": "compliance/framework/aws-kms/aws-kms-mrk-multi-keyrings.txt", "target_section": "2.6", "type": "SPEC", "level": "MUST", "comment": "\n   A set of AWS KMS clients MUST be created by calling regional client\n   supplier for each region in the input set of regions.\n"}, {"source": "src/AwsCryptographicMaterialProviders/Client.dfy", "target_path": "compliance/framework/aws-kms/aws-kms-mrk-multi-keyrings.txt", "target_section": "2.6", "line": 547, "type": "IMPLICATION"}, {"source": "compliance/framework/aws-kms/aws-kms-mrk-multi-keyrings.txt", "target_path": "compliance/framework/aws-kms/aws-kms-mrk-multi-keyrings.txt", "target_section": "2.6", "type": "SPEC", "level": "MUST", "comment": "\n   Then a set of AWS KMS MRK Discovery Keyring (aws-kms-mrk-discovery-\n   keyring.md) MUST be created for each AWS KMS client by initializing\n   each keyring with\n"}, {"source": "src/AwsCryptographicMaterialProviders/Client.dfy", "target_path": "compliance/framework/aws-kms/aws-kms-mrk-multi-keyrings.txt", "target_section": "2.6", "line": 530, "type": "IMPLICATION"}, {"source": "compliance/framework/aws-kms/aws-kms-mrk-multi-keyrings.txt", "target_path": "compliance/framework/aws-kms/aws-kms-mrk-multi-keyrings.txt", "target_section": "2.6", "type": "SPEC", "level": "MUST", "comment": "   Then a Multi-Keyring (../multi-keyring.md#inputs) MUST be initialize\n   by using this set of discovery keyrings as the child keyrings\n   (../multi-keyring.md#child-keyrings). "}, {"source": "compliance/framework/aws-kms/aws-kms-mrk-multi-keyrings.txt", "target_path": "compliance/framework/aws-kms/aws-kms-mrk-multi-keyrings.txt", "target_section": "2.6", "type": "SPEC", "level": "MUST", "comment": " This Multi-Keyring MUST be\n   this functions output.\n"}, {"source": "compliance/client-apis/streaming.txt", "target_path": "compliance/client-apis/streaming.txt", "target_section": "2.2", "type": "SPEC", "level": "MAY", "comment": "\n\n   The AWS Encryption SDK MAY provide APIs that enable streamed\n   encryption (encrypt.md) and decryption (decrypt.md). "}, {"source": "compliance/client-apis/streaming.txt", "target_path": "compliance/client-apis/streaming.txt", "target_section": "2.2", "type": "SPEC", "level": "SHOULD", "comment": "\n   If an implementation requires holding the entire input in memory in\n   order to perform the operation, that implementation SHOULD NOT\n   provide an API that allows the caller to stream the operation. "}, {"source": "compliance/client-apis/streaming.txt", "target_path": "compliance/client-apis/streaming.txt", "target_section": "2.2", "type": "SPEC", "level": "SHOULD", "comment": " APIs\n   that support streaming of the encrypt or decrypt operation SHOULD\n   allow customers to be able to process arbitrarily large inputs with a\n   finite amount of working memory.\n"}, {"source": "compliance/client-apis/streaming.txt", "target_path": "compliance/client-apis/streaming.txt", "target_section": "2.3.1", "type": "SPEC", "level": "MUST", "comment": "\n\n   The key words \"MUST\", \"MUST NOT\", \"REQUIRED\", \"SHALL\", \"SHALL NOT\",\n   \"SHOULD\", \"SHOULD NOT\", \"RECOMMENDED\", \"MAY\", and \"OPTIONAL\" in this\n   document are to be interpreted as described in RFC2119\n   (https://tools.ietf.org/html/rfc2119).\n"}, {"source": "compliance/client-apis/streaming.txt", "target_path": "compliance/client-apis/streaming.txt", "target_section": "2.3.3", "type": "SPEC", "level": "MUST", "comment": " The\n   decrypt and encrypt operations specify when output bytes MUST NOT be\n   released and when they SHOULD be released.\n"}, {"source": "compliance/client-apis/streaming.txt", "target_path": "compliance/client-apis/streaming.txt", "target_section": "2.4", "type": "SPEC", "level": "MUST", "comment": "\n\n   In order to support streaming, the operation MUST accept some input\n   within a streaming framework.\n"}, {"source": "compliance/client-apis/streaming.txt", "target_path": "compliance/client-apis/streaming.txt", "target_section": "2.5", "type": "SPEC", "level": "MUST", "comment": "\n\n   In order to support streaming, the operation MUST produce some output\n   within a streaming framework.\n"}, {"source": "compliance/client-apis/streaming.txt", "target_path": "compliance/client-apis/streaming.txt", "target_section": "2.5", "type": "SPEC", "level": "MUST", "comment": "\n   Operations MUST NOT indicate completion or success until an end to\n   the output has been indicated.\n"}, {"source": "compliance/client-apis/streaming.txt", "target_path": "compliance/client-apis/streaming.txt", "target_section": "2.6", "type": "SPEC", "level": "MUST", "comment": "\n   The behavior of the operation specifies how the operation processes\n   consumable bytes, and specifies when processed bytes MUST NOT and\n   SHOULD be released.\n"}, {"source": "compliance_exceptions/encrypt.txt", "target_path": "compliance/client-apis/encrypt.txt", "target_section": "2.3", "line": 2, "type": "EXCEPTION"}, {"source": "compliance/client-apis/encrypt.txt", "target_path": "compliance/client-apis/encrypt.txt", "target_section": "2.3", "type": "SPEC", "level": "MUST", "comment": "\n   Any client provided by the AWS Encryption SDK that performs\n   encryption of caller plaintext MUST follow this specification for\n   encryption.\n"}, {"source": "src/Generated/AwsEncryptionSdk.dfy", "target_path": "compliance/client-apis/encrypt.txt", "target_section": "2.4", "line": 31, "type": "CITATION"}, {"source": "compliance/client-apis/encrypt.txt", "target_path": "compliance/client-apis/encrypt.txt", "target_section": "2.4", "type": "SPEC", "level": "MUST", "comment": " The following inputs to this behavior MUST be OPTIONAL:\n"}, {"source": "compliance_exceptions/encrypt.txt", "target_path": "compliance/client-apis/encrypt.txt", "target_section": "2.4", "line": 139, "type": "EXCEPTION"}, {"source": "compliance/client-apis/encrypt.txt", "target_path": "compliance/client-apis/encrypt.txt", "target_section": "2.4", "type": "SPEC", "level": "MAY", "comment": "   If the plaintext (Section 2.4.1) is of unknown length, the caller MAY\n   also input a Plaintext Length Bound (Section 2.4.7).\n"}, {"source": "compliance_exceptions/encrypt.txt", "target_path": "compliance/client-apis/encrypt.txt", "target_section": "2.4", "line": 121, "type": "EXCEPTION"}, {"source": "compliance/client-apis/encrypt.txt", "target_path": "compliance/client-apis/encrypt.txt", "target_section": "2.4", "type": "SPEC", "level": "SHOULD", "comment": "\n   Implementations SHOULD ensure that a caller is not able to specify\n   both a plaintext (Section 2.4.1) with known length and a Plaintext\n   Length Bound (Section 2.4.7) by construction. "}, {"source": "compliance_exceptions/encrypt.txt", "target_path": "compliance/client-apis/encrypt.txt", "target_section": "2.4", "line": 129, "type": "EXCEPTION"}, {"source": "compliance/client-apis/encrypt.txt", "target_path": "compliance/client-apis/encrypt.txt", "target_section": "2.4", "type": "SPEC", "level": "MUST", "comment": " If a caller is able to\n   specify both an input plaintext (Section 2.4.1) with known length and\n   a Plaintext Length Bound (Section 2.4.7), the Plaintext Length Bound\n   (Section 2.4.7) MUST NOT be used during the Encrypt operation and\n   MUST be ignored.\n"}, {"source": "src/Generated/AwsEncryptionSdk.dfy", "target_path": "compliance/client-apis/encrypt.txt", "target_section": "2.4.1", "line": 23, "type": "IMPLICATION"}, {"source": "compliance/client-apis/encrypt.txt", "target_path": "compliance/client-apis/encrypt.txt", "target_section": "2.4.1", "type": "SPEC", "level": "MUST", "comment": " This MUST be a sequence of bytes.\n"}, {"source": "compliance_exceptions/encrypt.txt", "target_path": "compliance/client-apis/encrypt.txt", "target_section": "2.4.1", "line": 9, "type": "EXCEPTION"}, {"source": "compliance/client-apis/encrypt.txt", "target_path": "compliance/client-apis/encrypt.txt", "target_section": "2.4.1", "type": "SPEC", "level": "MAY", "comment": "\n   This input MAY be streamed (streaming.md) to this operation.\n"}, {"source": "compliance_exceptions/encrypt.txt", "target_path": "compliance/client-apis/encrypt.txt", "target_section": "2.4.1", "line": 14, "type": "IMPLICATION"}, {"source": "compliance/client-apis/encrypt.txt", "target_path": "compliance/client-apis/encrypt.txt", "target_section": "2.4.1", "type": "SPEC", "level": "SHOULD", "comment": "\n   If an implementation requires holding the input entire plaintext in\n   memory in order to perform this operation, that implementation SHOULD\n   NOT provide an API that allows this input to be streamed.\n"}, {"source": "compliance/client-apis/encrypt.txt", "target_path": "compliance/client-apis/encrypt.txt", "target_section": "2.4.2", "type": "SPEC", "level": "MUST", "comment": " If the input encryption context contains any entries with\n   a key beginning with this prefix, the encryption operation MUST fail.\n"}, {"source": "src/SDK/AwsEncryptionSdk.dfy", "target_path": "compliance/client-apis/encrypt.txt", "target_section": "2.4.5", "line": 231, "type": "CITATION"}, {"source": "test/SDK/POCEncryptDecrypt.dfy", "target_path": "compliance/client-apis/encrypt.txt", "target_section": "2.4.5", "line": 80, "type": "TEST"}, {"source": "compliance/client-apis/encrypt.txt", "target_path": "compliance/client-apis/encrypt.txt", "target_section": "2.4.5", "type": "SPEC", "level": "SHOULD", "comment": "\n\n   The algorithm suite (../framework/algorithm-suite.md) that SHOULD be\n   used for encryption.\n"}, {"source": "src/SDK/AwsEncryptionSdk.dfy", "target_path": "compliance/client-apis/encrypt.txt", "target_section": "2.4.6", "line": 189, "type": "IMPLICATION"}, {"source": "compliance/client-apis/encrypt.txt", "target_path": "compliance/client-apis/encrypt.txt", "target_section": "2.4.6", "type": "SPEC", "level": "MUST", "comment": " This value\n   MUST be greater than 0 and MUST NOT exceed the value 2^32 - 1. "}, {"source": "src/SDK/EncryptDecrypt.dfy", "target_path": "compliance/client-apis/encrypt.txt", "target_section": "2.4.6", "line": 28, "type": "IMPLICATION"}, {"source": "compliance/client-apis/encrypt.txt", "target_path": "compliance/client-apis/encrypt.txt", "target_section": "2.4.6", "type": "SPEC", "level": "MUST", "comment": " This\n   value MUST default to 4096 bytes.\n"}, {"source": "compliance_exceptions/encrypt.txt", "target_path": "compliance/client-apis/encrypt.txt", "target_section": "2.4.7", "line": 146, "type": "EXCEPTION"}, {"source": "compliance/client-apis/encrypt.txt", "target_path": "compliance/client-apis/encrypt.txt", "target_section": "2.4.7", "type": "SPEC", "level": "MUST", "comment": "\n   If this input is provided, this operation MUST NOT encrypt a\n   plaintext with length greater than this value.\n"}, {"source": "src/SDK/AwsEncryptionSdk.dfy", "target_path": "compliance/client-apis/encrypt.txt", "target_section": "2.5", "line": 364, "type": "CITATION"}, {"source": "test/SDK/POCEncryptDecrypt.dfy", "target_path": "compliance/client-apis/encrypt.txt", "target_section": "2.5", "line": 73, "type": "TEST"}, {"source": "compliance/client-apis/encrypt.txt", "target_path": "compliance/client-apis/encrypt.txt", "target_section": "2.5", "type": "SPEC", "level": "MUST", "comment": "   This behavior MUST output the following if the behavior is\n   successful:\n"}, {"source": "compliance_exceptions/encrypt.txt", "target_path": "compliance/client-apis/encrypt.txt", "target_section": "2.5", "line": 22, "type": "EXCEPTION"}, {"source": "compliance/client-apis/encrypt.txt", "target_path": "compliance/client-apis/encrypt.txt", "target_section": "2.5", "type": "SPEC", "level": "SHOULD", "comment": " The client SHOULD return as an output:\n"}, {"source": "src/Generated/AwsEncryptionSdk.dfy", "target_path": "compliance/client-apis/encrypt.txt", "target_section": "2.5.1", "line": 41, "type": "CITATION"}, {"source": "compliance/client-apis/encrypt.txt", "target_path": "compliance/client-apis/encrypt.txt", "target_section": "2.5.1", "type": "SPEC", "level": "MUST", "comment": " This MUST\n   be a sequence of bytes and conform to the message format\n   specification (../data-format/message.md).\n"}, {"source": "compliance_exceptions/encrypt.txt", "target_path": "compliance/client-apis/encrypt.txt", "target_section": "2.5.1", "line": 28, "type": "EXCEPTION"}, {"source": "compliance/client-apis/encrypt.txt", "target_path": "compliance/client-apis/encrypt.txt", "target_section": "2.5.1", "type": "SPEC", "level": "MAY", "comment": "\n   This operation MAY stream (streaming.md) the encrypted message.\n"}, {"source": "compliance_exceptions/encrypt.txt", "target_path": "compliance/client-apis/encrypt.txt", "target_section": "2.5.1", "line": 34, "type": "IMPLICATION"}, {"source": "compliance/client-apis/encrypt.txt", "target_path": "compliance/client-apis/encrypt.txt", "target_section": "2.5.1", "type": "SPEC", "level": "SHOULD", "comment": "\n   If an implementation requires holding the entire input plaintext in\n   memory in order to perform this operation, that implementation SHOULD\n   NOT provide an API that allows this output to be streamed.\n"}, {"source": "compliance_exceptions/encrypt.txt", "target_path": "compliance/client-apis/encrypt.txt", "target_section": "2.5.2", "line": 41, "type": "EXCEPTION"}, {"source": "compliance/client-apis/encrypt.txt", "target_path": "compliance/client-apis/encrypt.txt", "target_section": "2.5.2", "type": "SPEC", "level": "MAY", "comment": "\n   This output MAY be satisfied by outputting a parsed header\n   (Section 2.5.4) containing this value.\n"}, {"source": "compliance_exceptions/encrypt.txt", "target_path": "compliance/client-apis/encrypt.txt", "target_section": "2.5.3", "line": 47, "type": "EXCEPTION"}, {"source": "compliance/client-apis/encrypt.txt", "target_path": "compliance/client-apis/encrypt.txt", "target_section": "2.5.3", "type": "SPEC", "level": "MAY", "comment": "\n   This output MAY be satisfied by outputting a parsed header\n   (Section 2.5.4) containing this value.\n"}, {"source": "compliance_exceptions/encrypt.txt", "target_path": "compliance/client-apis/encrypt.txt", "target_section": "2.6", "line": 152, "type": "EXCEPTION"}, {"source": "compliance/client-apis/encrypt.txt", "target_path": "compliance/client-apis/encrypt.txt", "target_section": "2.6", "type": "SPEC", "level": "MUST", "comment": "   This operation MUST perform all the above steps unless otherwise\n   specified, and it MUST perform them in the above order.\n"}, {"source": "compliance/client-apis/encrypt.txt", "target_path": "compliance/client-apis/encrypt.txt", "target_section": "2.6", "type": "SPEC", "level": "MUST", "comment": " Any data that is not specified\n   within the message format (../data-format/message.md) MUST NOT be\n   added to the output message.\n"}, {"source": "compliance_exceptions/encrypt.txt", "target_path": "compliance/client-apis/encrypt.txt", "target_section": "2.6", "line": 158, "type": "EXCEPTION"}, {"source": "compliance/client-apis/encrypt.txt", "target_path": "compliance/client-apis/encrypt.txt", "target_section": "2.6", "type": "SPEC", "level": "MUST", "comment": "\n   If any of these steps fails, this operation MUST halt and indicate a\n   failure to the caller.\n"}, {"source": "src/SDK/AwsEncryptionSdk.dfy", "target_path": "compliance/client-apis/encrypt.txt", "target_section": "2.6.1", "line": 156, "type": "IMPLICATION"}, {"source": "compliance/client-apis/encrypt.txt", "target_path": "compliance/client-apis/encrypt.txt", "target_section": "2.6.1", "type": "SPEC", "level": "MUST", "comment": "\n\n   If an input algorithm suite (Section 2.4.5) is provided that is not\n   supported by the commitment policy (client.md#commitment-policy)\n   configured in the client (client.md) encrypt MUST yield an error.\n"}, {"source": "compliance_exceptions/encrypt.txt", "target_path": "compliance/client-apis/encrypt.txt", "target_section": "2.6.1", "line": 53, "type": "EXCEPTION"}, {"source": "compliance/client-apis/encrypt.txt", "target_path": "compliance/client-apis/encrypt.txt", "target_section": "2.6.1", "type": "SPEC", "level": "MUST", "comment": "\n   To construct the encrypted message (Section 2.5.1), some fields MUST\n   be constructed using information obtained from a set of valid\n   encryption materials (../framework/structures.md#encryption-\n   materials). "}, {"source": "src/SDK/AwsEncryptionSdk.dfy", "target_path": "compliance/client-apis/encrypt.txt", "target_section": "2.6.1", "line": 426, "type": "CITATION"}, {"source": "compliance/client-apis/encrypt.txt", "target_path": "compliance/client-apis/encrypt.txt", "target_section": "2.6.1", "type": "SPEC", "level": "MUST", "comment": " This operation MUST obtain this set of encryption\n   materials (../framework/structures.md#encryption-materials) by\n   calling Get Encryption Materials (../framework/cmm-interface.md#get-\n   encryption-materials) on a CMM (../framework/cmm-interface.md). "}, {"source": "src/SDK/AwsEncryptionSdk.dfy", "target_path": "compliance/client-apis/encrypt.txt", "target_section": "2.6.1", "line": 466, "type": "IMPLICATION"}, {"source": "compliance/client-apis/encrypt.txt", "target_path": "compliance/client-apis/encrypt.txt", "target_section": "2.6.1", "type": "SPEC", "level": "MUST", "comment": " The\n   CMM used MUST be the input CMM, if supplied. "}, {"source": "src/SDK/AwsEncryptionSdk.dfy", "target_path": "compliance/client-apis/encrypt.txt", "target_section": "2.6.1", "line": 503, "type": "CITATION"}, {"source": "compliance/client-apis/encrypt.txt", "target_path": "compliance/client-apis/encrypt.txt", "target_section": "2.6.1", "type": "SPEC", "level": "MUST", "comment": " If instead the caller\n   supplied a keyring (../framework/keyring-interface.md), this behavior\n   MUST use a default CMM (../framework/default-cmm.md) constructed\n   using the caller-supplied keyring as input. "}, {"source": "compliance/client-apis/encrypt.txt", "target_path": "compliance/client-apis/encrypt.txt", "target_section": "2.6.1", "type": "SPEC", "level": "MUST", "comment": " The call to Get\n   Encryption Materials (../framework/cmm-interface.md#get-encryption-\n   materials) on that CMM MUST be constructed as follows:\n"}, {"source": "src/SDK/AwsEncryptionSdk.dfy", "target_path": "compliance/client-apis/encrypt.txt", "target_section": "2.6.1", "line": 271, "type": "CITATION"}, {"source": "compliance/client-apis/encrypt.txt", "target_path": "compliance/client-apis/encrypt.txt", "target_section": "2.6.1", "type": "SPEC", "level": "MUST", "comment": "   The algorithm suite (../framework/algorithm-suites.md) used in all\n   aspects of this operation MUST be the algorithm suite in the\n   encryption materials (../framework/structures.md#encryption-\n   materials) returned from the Get Encryption Materials (../framework/\n   cmm-interface.md#get-encryption-materials) call. "}, {"source": "compliance_exceptions/encrypt.txt", "target_path": "compliance/client-apis/encrypt.txt", "target_section": "2.6.1", "line": 62, "type": "EXCEPTION"}, {"source": "compliance/client-apis/encrypt.txt", "target_path": "compliance/client-apis/encrypt.txt", "target_section": "2.6.1", "type": "SPEC", "level": "MAY", "comment": " Note that the\n   algorithm suite in the retrieved encryption materials MAY be\n   different from the input algorithm suite (Section 2.4.5). "}, {"source": "src/SDK/AwsEncryptionSdk.dfy", "target_path": "compliance/client-apis/encrypt.txt", "target_section": "2.6.1", "line": 257, "type": "CITATION"}, {"source": "compliance/client-apis/encrypt.txt", "target_path": "compliance/client-apis/encrypt.txt", "target_section": "2.6.1", "type": "SPEC", "level": "MUST", "comment": " If this\n   algorithm suite (../framework/algorithm-suites.md) is not supported\n   by the commitment policy (client.md#commitment-policy) configured in\n   the client (client.md) encrypt MUST yield an error. "}, {"source": "src/SDK/AwsEncryptionSdk.dfy", "target_path": "compliance/client-apis/encrypt.txt", "target_section": "2.6.1", "line": 199, "type": "IMPLICATION"}, {"source": "compliance/client-apis/encrypt.txt", "target_path": "compliance/client-apis/encrypt.txt", "target_section": "2.6.1", "type": "SPEC", "level": "MUST", "comment": " If the number of\n   encrypted data keys (../framework/structures.md#encrypted-data-keys)\n   on the encryption materials (../framework/structures.md#encryption-\n   materials) is greater than the maximum number of encrypted data keys\n   (client.md#maximum-number-of-encrypted-data-keys) configured in the\n   client (client.md) encrypt MUST yield an error.\n"}, {"source": "src/SDK/KeyDerivation.dfy", "target_path": "compliance/client-apis/encrypt.txt", "target_section": "2.6.1", "line": 53, "type": "CITATION"}, {"source": "compliance/client-apis/encrypt.txt", "target_path": "compliance/client-apis/encrypt.txt", "target_section": "2.6.1", "type": "SPEC", "level": "MUST", "comment": " The algorithm used to derive a data key from the\n   plaintext data key MUST be the key derivation algorithm\n   (../framework/algorithm-suites.md#key-derivation-algorithm) included\n   in the algorithm suite (../framework/algorithm-suites.md) defined\n   above. "}, {"source": "src/SDK/AwsEncryptionSdk.dfy", "target_path": "compliance/client-apis/encrypt.txt", "target_section": "2.6.2", "line": 723, "type": "CITATION"}, {"source": "compliance/client-apis/encrypt.txt", "target_path": "compliance/client-apis/encrypt.txt", "target_section": "2.6.2", "type": "SPEC", "level": "MUST", "comment": "\n\n   Before encrypting input plaintext, this operation MUST serialize the\n   message header body (../data-format/message-header.md). "}, {"source": "src/AwsCryptographicMaterialProviders/AlgorithmSuites.dfy", "target_path": "compliance/client-apis/encrypt.txt", "target_section": "2.6.2", "line": 84, "type": "IMPLICATION"}, {"source": "compliance/client-apis/encrypt.txt", "target_path": "compliance/client-apis/encrypt.txt", "target_section": "2.6.2", "type": "SPEC", "level": "MUST", "comment": " The message\n   format version (../data-format/message-header.md#supported-versions)\n   MUST be associated with the algorithm suite (../framework/algorithm-\n   suites.md#supported-algorithm-suites).\n"}, {"source": "src/SDK/Serialize/V2HeaderBody.dfy", "target_path": "compliance/client-apis/encrypt.txt", "target_section": "2.6.2", "line": 39, "type": "CITATION"}, {"source": "compliance/client-apis/encrypt.txt", "target_path": "compliance/client-apis/encrypt.txt", "target_section": "2.6.2", "type": "SPEC", "level": "MUST", "comment": "\n   If the message format version associated with the algorithm suite\n   (../framework/algorithm-suites.md#supported-algorithm-suites) is 2.0\n   then the message header body (../data-format/message-\n   header.md#header-body-version-1-0) MUST be serialized with the\n   following specifics:\n"}, {"source": "src/SDK/Serialize/V1HeaderBody.dfy", "target_path": "compliance/client-apis/encrypt.txt", "target_section": "2.6.2", "line": 52, "type": "CITATION"}, {"source": "compliance/client-apis/encrypt.txt", "target_path": "compliance/client-apis/encrypt.txt", "target_section": "2.6.2", "type": "SPEC", "level": "MUST", "comment": " If the message format version associated with the algorithm suite\n   (../framework/algorithm-suites.md#supported-algorithm-suites) is 1.0\n   then the message header body (../data-format/message-\n   header.md#header-body-version-1-0) MUST be serialized with the\n   following specifics:\n"}, {"source": "src/SDK/AwsEncryptionSdk.dfy", "target_path": "compliance/client-apis/encrypt.txt", "target_section": "2.6.2", "line": 728, "type": "CITATION"}, {"source": "compliance/client-apis/encrypt.txt", "target_path": "compliance/client-apis/encrypt.txt", "target_section": "2.6.2", "type": "SPEC", "level": "MUST", "comment": "   After serializing the message header body, this operation MUST\n   calculate an authentication tag (../data-format/message-\n   header.md#authentication-tag) over the message header body. "}, {"source": "src/SDK/AwsEncryptionSdk.dfy", "target_path": "compliance/client-apis/encrypt.txt", "target_section": "2.6.2", "line": 653, "type": "CITATION"}, {"source": "compliance/client-apis/encrypt.txt", "target_path": "compliance/client-apis/encrypt.txt", "target_section": "2.6.2", "type": "SPEC", "level": "MUST", "comment": " The\n   value of this MUST be the output of the authenticated encryption\n   algorithm (../framework/algorithm-suites.md#encryption-algorithm)\n   specified by the algorithm suite (../framework/algorithm-suites.md),\n   with the following inputs:\n\n   *  The AAD is the serialized message header body (../data-format/\n      message-header.md#header-body).\n"}, {"source": "compliance/client-apis/encrypt.txt", "target_path": "compliance/client-apis/encrypt.txt", "target_section": "2.6.2", "type": "SPEC", "level": "MUST", "comment": "\n   *  The cipherkey is the derived data key\n\n   *  The plaintext is an empty byte array\n\n   With the authentication tag calculated, if the message format version\n   associated with the algorithm suite (../framework/algorithm-\n   suites.md#supported-algorithm-suites) is 2.0, this operation MUST\n   serialize the message header authentication (../data-format/message-\n   header.md#header-authentication-version-2-0) with the following\n   specifics:\n\n   *  Authentication Tag (../data-format/message-\n      header.md#authentication-tag): MUST have the value of the\n      authentication tag calculated above.\n"}, {"source": "src/SDK/Serialize/HeaderAuth.dfy", "target_path": "compliance/client-apis/encrypt.txt", "target_section": "2.6.2", "line": 57, "type": "CITATION"}, {"source": "compliance/client-apis/encrypt.txt", "target_path": "compliance/client-apis/encrypt.txt", "target_section": "2.6.2", "type": "SPEC", "level": "MUST", "comment": "\n   If the message format version associated with the algorithm suite\n   (../framework/algorithm-suites.md#supported-algorithm-suites) is 1.0\n   this operation MUST serialize the message header authentication\n   (../data-format/message-header.md#header-authentication-version-1-0)\n   with the following specifics:\n\n   *  IV (../data-format/message-header.md#iv): MUST have the value of\n      the IV used in the calculation above, padded to the IV length\n      (../data-format/message-header.md#iv-length) with 0.\n"}, {"source": "src/SDK/Serialize/HeaderAuth.dfy", "target_path": "compliance/client-apis/encrypt.txt", "target_section": "2.6.2", "line": 69, "type": "CITATION"}, {"source": "compliance/client-apis/encrypt.txt", "target_path": "compliance/client-apis/encrypt.txt", "target_section": "2.6.2", "type": "SPEC", "level": "MUST", "comment": "\n   *  Authentication Tag (../data-format/message-\n      header.md#authentication-tag): MUST have the value of the\n      authentication tag calculated above.\n"}, {"source": "compliance/client-apis/encrypt.txt", "target_path": "compliance/client-apis/encrypt.txt", "target_section": "2.6.2", "type": "SPEC", "level": "MUST", "comment": "\n   The serialized bytes MUST NOT be released until the entire message\n   header has been serialized If this operation is streaming the\n   encrypted message and the entire message header has been serialized,\n   the serialized message header SHOULD be released.\n"}, {"source": "src/SDK/EncryptDecrypt.dfy", "target_path": "compliance/client-apis/encrypt.txt", "target_section": "2.6.2", "line": 67, "type": "CITATION"}, {"source": "compliance/client-apis/encrypt.txt", "target_path": "compliance/client-apis/encrypt.txt", "target_section": "2.6.2", "type": "SPEC", "level": "MUST", "comment": "\n   The encrypted message output by this operation MUST have a message\n   header equal to the message header calculated in this step.\n"}, {"source": "compliance_exceptions/encrypt.txt", "target_path": "compliance/client-apis/encrypt.txt", "target_section": "2.6.2", "line": 69, "type": "EXCEPTION"}, {"source": "compliance/client-apis/encrypt.txt", "target_path": "compliance/client-apis/encrypt.txt", "target_section": "2.6.2", "type": "SPEC", "level": "MUST", "comment": "\n   If the algorithm suite contains a signature algorithm and this\n   operation is streaming (streaming.md) the encrypted message output to\n   the caller, this operation MUST input the serialized header to the\n   signature algorithm as soon as it is serialized, such that the\n   serialized header isn't required to remain in memory to construct the\n   signature (Section 2.7.2).\n"}, {"source": "compliance_exceptions/encrypt.txt", "target_path": "compliance/client-apis/encrypt.txt", "target_section": "2.7", "line": 92, "type": "EXCEPTION"}, {"source": "compliance/client-apis/encrypt.txt", "target_path": "compliance/client-apis/encrypt.txt", "target_section": "2.7", "type": "SPEC", "level": "MUST", "comment": "\n\n   The encrypted message output by this operation MUST have a message\n   body equal to the message body calculated in this step.\n"}, {"source": "compliance_exceptions/encrypt.txt", "target_path": "compliance/client-apis/encrypt.txt", "target_section": "2.7", "line": 165, "type": "EXCEPTION"}, {"source": "compliance/client-apis/encrypt.txt", "target_path": "compliance/client-apis/encrypt.txt", "target_section": "2.7", "type": "SPEC", "level": "MUST", "comment": "\n   If Plaintext Length Bound (Section 2.4.7) was specified on input and\n   this operation determines at any time that the plaintext being\n   encrypted has a length greater than this value, this operation MUST\n   immediately fail.\n"}, {"source": "src/SDK/MessageBody.dfy", "target_path": "compliance/client-apis/encrypt.txt", "target_section": "2.7", "line": 243, "type": "CITATION"}, {"source": "compliance/client-apis/encrypt.txt", "target_path": "compliance/client-apis/encrypt.txt", "target_section": "2.7", "type": "SPEC", "level": "MUST", "comment": "\n   Before the end of the input is indicated, this operation MUST process\n   as much of the consumable bytes as possible by constructing regular\n   frames (Section 2.7.1).\n"}, {"source": "compliance/client-apis/encrypt.txt", "target_path": "compliance/client-apis/encrypt.txt", "target_section": "2.7", "type": "SPEC", "level": "MUST", "comment": "\n   When the end of the input is indicated, this operation MUST perform\n   the following until all consumable plaintext bytes are processed:\n"}, {"source": "src/SDK/MessageBody.dfy", "target_path": "compliance/client-apis/encrypt.txt", "target_section": "2.7", "line": 248, "type": "CITATION"}, {"source": "compliance/client-apis/encrypt.txt", "target_path": "compliance/client-apis/encrypt.txt", "target_section": "2.7", "type": "SPEC", "level": "MUST", "comment": "   If an end to the input has been indicated, there are no more\n   consumable plaintext bytes to process, and a final frame has not yet\n   been constructed, this operation MUST construct an empty final frame\n   (Section 2.7.1).\n"}, {"source": "src/SDK/MessageBody.dfy", "target_path": "compliance/client-apis/encrypt.txt", "target_section": "2.7.1", "line": 359, "type": "CITATION"}, {"source": "compliance/client-apis/encrypt.txt", "target_path": "compliance/client-apis/encrypt.txt", "target_section": "2.7.1", "type": "SPEC", "level": "MUST", "comment": "   To construct a regular or final frame that represents the next frame\n   in the encrypted message's body, this operation MUST calculate the\n   encrypted content and an authentication tag using the authenticated\n   encryption algorithm (../framework/algorithm-suites.md#encryption-\n   algorithm) specified by the algorithm suite (../framework/algorithm-\n   suites.md), with the following inputs:\n"}, {"source": "src/SDK/MessageBody.dfy", "target_path": "compliance/client-apis/encrypt.txt", "target_section": "2.7.1", "line": 394, "type": "CITATION"}, {"source": "compliance/client-apis/encrypt.txt", "target_path": "compliance/client-apis/encrypt.txt", "target_section": "2.7.1", "type": "SPEC", "level": "MUST", "comment": " This operation MUST serialize a regular frame or final frame with the\n   following specifics:\n"}, {"source": "compliance_exceptions/encrypt.txt", "target_path": "compliance/client-apis/encrypt.txt", "target_section": "2.7.1", "line": 98, "type": "EXCEPTION"}, {"source": "compliance/client-apis/encrypt.txt", "target_path": "compliance/client-apis/encrypt.txt", "target_section": "2.7.1", "type": "SPEC", "level": "MUST", "comment": "   The above serialized bytes MUST NOT be released until the entire\n   frame has been serialized. "}, {"source": "compliance_exceptions/encrypt.txt", "target_path": "compliance/client-apis/encrypt.txt", "target_section": "2.7.1", "line": 79, "type": "EXCEPTION"}, {"source": "compliance/client-apis/encrypt.txt", "target_path": "compliance/client-apis/encrypt.txt", "target_section": "2.7.1", "type": "SPEC", "level": "SHOULD", "comment": " If this operation is streaming the\n   encrypted message and the entire frame has been serialized, the\n   serialized frame SHOULD be released.\n"}, {"source": "compliance_exceptions/encrypt.txt", "target_path": "compliance/client-apis/encrypt.txt", "target_section": "2.7.1", "line": 104, "type": "EXCEPTION"}, {"source": "compliance/client-apis/encrypt.txt", "target_path": "compliance/client-apis/encrypt.txt", "target_section": "2.7.1", "type": "SPEC", "level": "MUST", "comment": "\n   If the algorithm suite contains a signature algorithm and this\n   operation is streaming (streaming.md) the encrypted message output to\n   the caller, this operation MUST input the serialized frame to the\n   signature algorithm as soon as it is serialized, such that the\n   serialized frame isn't required to remain in memory to construct the\n   signature (Section 2.7.2).\n"}, {"source": "src/SDK/AwsEncryptionSdk.dfy", "target_path": "compliance/client-apis/encrypt.txt", "target_section": "2.7.2", "line": 306, "type": "CITATION"}, {"source": "compliance/client-apis/encrypt.txt", "target_path": "compliance/client-apis/encrypt.txt", "target_section": "2.7.2", "type": "SPEC", "level": "MUST", "comment": "\n\n   If the algorithm suite (../framework/algorithm-suites.md) contains a\n   signature algorithm (../framework/algorithm-suites.md#signature-\n   algorithm), this operation MUST calculate a signature over the\n   message, and the output encrypted message (Section 2.5.1) MUST\n   contain a message footer (../data-format/message-footer.md).\n"}, {"source": "src/SDK/AwsEncryptionSdk.dfy", "target_path": "compliance/client-apis/encrypt.txt", "target_section": "2.7.2", "line": 329, "type": "CITATION"}, {"source": "compliance/client-apis/encrypt.txt", "target_path": "compliance/client-apis/encrypt.txt", "target_section": "2.7.2", "type": "SPEC", "level": "MUST", "comment": "\n   To calculate a signature, this operation MUST use the signature\n   algorithm (../framework/algorithm-suites.md#signature-algorithm)\n   specified by the algorithm suite (../framework/algorithm-suites.md),\n   with the following input:\n"}, {"source": "compliance_exceptions/encrypt.txt", "target_path": "compliance/client-apis/encrypt.txt", "target_section": "2.7.2", "line": 86, "type": "EXCEPTION"}, {"source": "compliance/client-apis/encrypt.txt", "target_path": "compliance/client-apis/encrypt.txt", "target_section": "2.7.2", "type": "SPEC", "level": "MAY", "comment": "   Note that the message header and message body MAY have already been\n   input during previous steps.\n"}, {"source": "src/SDK/AwsEncryptionSdk.dfy", "target_path": "compliance/client-apis/encrypt.txt", "target_section": "2.7.2", "line": 343, "type": "CITATION"}, {"source": "compliance/client-apis/encrypt.txt", "target_path": "compliance/client-apis/encrypt.txt", "target_section": "2.7.2", "type": "SPEC", "level": "MUST", "comment": "\n   This operation MUST then serialize a message footer with the\n   following specifics:\n"}, {"source": "compliance_exceptions/encrypt.txt", "target_path": "compliance/client-apis/encrypt.txt", "target_section": "2.7.2", "line": 173, "type": "EXCEPTION"}, {"source": "compliance/client-apis/encrypt.txt", "target_path": "compliance/client-apis/encrypt.txt", "target_section": "2.7.2", "type": "SPEC", "level": "MUST", "comment": "   The above serialized bytes MUST NOT be released until the entire\n   message footer has been serialized. "}, {"source": "compliance_exceptions/encrypt.txt", "target_path": "compliance/client-apis/encrypt.txt", "target_section": "2.7.2", "line": 179, "type": "EXCEPTION"}, {"source": "compliance/client-apis/encrypt.txt", "target_path": "compliance/client-apis/encrypt.txt", "target_section": "2.7.2", "type": "SPEC", "level": "MUST", "comment": " Once the entire message footer\n   has been serialized, this operation MUST release any previously\n   unreleased serialized bytes from previous steps and MUST release the\n   message footer.\n"}, {"source": "src/SDK/AwsEncryptionSdk.dfy", "target_path": "compliance/client-apis/encrypt.txt", "target_section": "2.7.2", "line": 357, "type": "CITATION"}, {"source": "compliance/client-apis/encrypt.txt", "target_path": "compliance/client-apis/encrypt.txt", "target_section": "2.7.2", "type": "SPEC", "level": "MUST", "comment": "\n   The encrypted message output by this operation MUST have a message\n   footer equal to the message footer calculated in this step.\n"}, {"source": "src/SDK/AwsEncryptionSdk.dfy", "target_path": "compliance/client-apis/encrypt.txt", "target_section": "2.8.1", "line": 616, "type": "CITATION"}, {"source": "compliance/client-apis/encrypt.txt", "target_path": "compliance/client-apis/encrypt.txt", "target_section": "2.8.1", "type": "SPEC", "level": "MUST", "comment": "\n\n   Implementations of the AWS Encryption SDK MUST NOT encrypt using the\n   Non-Framed content type. "}, {"source": "src/SDK/AwsEncryptionSdk.dfy", "target_path": "compliance/client-apis/client.txt", "target_section": "2.4", "line": 69, "type": "IMPLICATION"}, {"source": "compliance/client-apis/client.txt", "target_path": "compliance/client-apis/client.txt", "target_section": "2.4", "type": "SPEC", "level": "MUST", "comment": "   On client initialization, the caller MUST have the option to provide\n   a:\n"}, {"source": "src/SDK/AwsEncryptionSdk.dfy", "target_path": "compliance/client-apis/client.txt", "target_section": "2.4", "line": 81, "type": "IMPLICATION"}, {"source": "compliance/client-apis/client.txt", "target_path": "compliance/client-apis/client.txt", "target_section": "2.4", "type": "SPEC", "level": "MUST", "comment": "   If no commitment policy (Section 2.4.1) is provided the default MUST\n   be REQUIRE_ENCRYPT_REQUIRE_DECRYPT (../framework/algorithm-\n   suites.md#require_encrypt_require_decrypt). "}, {"source": "src/SDK/AwsEncryptionSdk.dfy", "target_path": "compliance/client-apis/client.txt", "target_section": "2.4", "line": 92, "type": "CITATION"}, {"source": "compliance/client-apis/client.txt", "target_path": "compliance/client-apis/client.txt", "target_section": "2.4", "type": "SPEC", "level": "MUST", "comment": " If no maximum number of\n   encrypted data keys (Section 2.4.2) is provided the default MUST\n   result in no limit on the number of encrypted data keys (aside from\n   the limit imposed by the message format (../format/message-\n   header.md)).\n"}, {"source": "src/SDK/AwsEncryptionSdk.dfy", "target_path": "compliance/client-apis/client.txt", "target_section": "2.4", "line": 58, "type": "IMPLICATION"}, {"source": "compliance/client-apis/client.txt", "target_path": "compliance/client-apis/client.txt", "target_section": "2.4", "type": "SPEC", "level": "SHOULD", "comment": "\n   Once a commitment policy (Section 2.4.1) has been set it SHOULD be\n   immutable.\n"}, {"source": "src/Generated/AwsCryptographicMaterialProviders.dfy", "target_path": "compliance/client-apis/client.txt", "target_section": "2.4.1", "line": 171, "type": "IMPLICATION"}, {"source": "compliance/client-apis/client.txt", "target_path": "compliance/client-apis/client.txt", "target_section": "2.4.1", "type": "SPEC", "level": "MUST", "comment": "\n   The AWS Encryption SDK MUST provide the following commitment\n   policies:\n"}, {"source": "src/SDK/AwsEncryptionSdk.dfy", "target_path": "compliance/client-apis/client.txt", "target_section": "2.4.2", "line": 100, "type": "IMPLICATION"}, {"source": "compliance/client-apis/client.txt", "target_path": "compliance/client-apis/client.txt", "target_section": "2.4.2", "type": "SPEC", "level": "MUST", "comment": " Callers MUST have a way to disable\n   this limit.\n"}, {"source": "compliance_exceptions/client.txt", "target_path": "compliance/client-apis/client.txt", "target_section": "2.5.1", "line": 2, "type": "EXCEPTION"}, {"source": "compliance/client-apis/client.txt", "target_path": "compliance/client-apis/client.txt", "target_section": "2.5.1", "type": "SPEC", "level": "MUST", "comment": "\n\n   The AWS Encryption SDK Client MUST provide an encrypt\n   (./encrypt.md#input) function that adheres to encrypt (./encrypt.md).\n"}, {"source": "compliance_exceptions/client.txt", "target_path": "compliance/client-apis/client.txt", "target_section": "2.5.2", "line": 8, "type": "EXCEPTION"}, {"source": "compliance/client-apis/client.txt", "target_path": "compliance/client-apis/client.txt", "target_section": "2.5.2", "type": "SPEC", "level": "MUST", "comment": "\n\n   The AWS Encryption SDK Client MUST provide an decrypt\n   (./decrypt.md#input) function that adheres to decrypt (./decrypt.md).\n"}, {"source": "compliance_exceptions/decrypt.txt", "target_path": "compliance/client-apis/decrypt.txt", "target_section": "2.3", "line": 2, "type": "EXCEPTION"}, {"source": "compliance/client-apis/decrypt.txt", "target_path": "compliance/client-apis/decrypt.txt", "target_section": "2.3", "type": "SPEC", "level": "MUST", "comment": "\n   Any client provided by the AWS Encryption SDK that performs\n   decryption of encrypted messages MUST follow this specification for\n   decryption.\n"}, {"source": "compliance/client-apis/decrypt.txt", "target_path": "compliance/client-apis/decrypt.txt", "target_section": "2.4.1", "type": "SPEC", "level": "MUST", "comment": "\n\n   The key words \"MUST\", \"MUST NOT\", \"REQUIRED\", \"SHALL\", \"SHALL NOT\",\n   \"SHOULD\", \"SHOULD NOT\", \"RECOMMENDED\", \"MAY\", and \"OPTIONAL\" in this\n   document are to be interpreted as described in RFC2119\n   (https://tools.ietf.org/html/rfc2119).\n"}, {"source": "src/SDK/AwsEncryptionSdk.dfy", "target_path": "compliance/client-apis/decrypt.txt", "target_section": "2.4.2", "line": 886, "type": "CITATION"}, {"source": "compliance/client-apis/decrypt.txt", "target_path": "compliance/client-apis/decrypt.txt", "target_section": "2.4.2", "type": "SPEC", "level": "MUST", "comment": "\n   This operation MUST NOT release any unauthenticated plaintext or\n   unauthenticated associated data.\n"}, {"source": "src/Generated/AwsEncryptionSdk.dfy", "target_path": "compliance/client-apis/decrypt.txt", "target_section": "2.5", "line": 50, "type": "IMPLICATION"}, {"source": "compliance/client-apis/decrypt.txt", "target_path": "compliance/client-apis/decrypt.txt", "target_section": "2.5", "type": "SPEC", "level": "MUST", "comment": "   The client MUST require the following as inputs to this operation:\n"}, {"source": "src/SDK/AwsEncryptionSdk.dfy", "target_path": "compliance/client-apis/decrypt.txt", "target_section": "2.5", "line": 817, "type": "IMPLICATION"}, {"source": "compliance/client-apis/decrypt.txt", "target_path": "compliance/client-apis/decrypt.txt", "target_section": "2.5", "type": "SPEC", "level": "MUST", "comment": " The client MUST require exactly one of the following types of inputs:\n"}, {"source": "src/Generated/AwsEncryptionSdk.dfy", "target_path": "compliance/client-apis/decrypt.txt", "target_section": "2.5.1", "line": 55, "type": "IMPLICATION"}, {"source": "compliance/client-apis/decrypt.txt", "target_path": "compliance/client-apis/decrypt.txt", "target_section": "2.5.1", "type": "SPEC", "level": "MUST", "comment": " The input encrypted message MUST\n   be a sequence of bytes in the message format (../data-format/\n   message.md) specified by the AWS Encryption SDK. "}, {"source": "compliance_exceptions/decrypt.txt", "target_path": "compliance/client-apis/decrypt.txt", "target_section": "2.5.1", "line": 17, "type": "EXCEPTION"}, {"source": "compliance/client-apis/decrypt.txt", "target_path": "compliance/client-apis/decrypt.txt", "target_section": "2.5.1", "type": "SPEC", "level": "MAY", "comment": "\n   This input MAY be streamed (streaming.md) to this operation.\n"}, {"source": "compliance_exceptions/decrypt.txt", "target_path": "compliance/client-apis/decrypt.txt", "target_section": "2.5.1", "line": 9, "type": "IMPLICATION"}, {"source": "compliance/client-apis/decrypt.txt", "target_path": "compliance/client-apis/decrypt.txt", "target_section": "2.5.1", "type": "SPEC", "level": "SHOULD", "comment": "\n   If an implementation requires holding the entire encrypted message in\n   memory in order to perform this operation, that implementation SHOULD\n   NOT provide an API that allows the caller to stream the encrypted\n   message.\n"}, {"source": "src/SDK/AwsEncryptionSdk.dfy", "target_path": "compliance/client-apis/decrypt.txt", "target_section": "2.5.2", "line": 865, "type": "CITATION"}, {"source": "compliance/client-apis/decrypt.txt", "target_path": "compliance/client-apis/decrypt.txt", "target_section": "2.5.2", "type": "SPEC", "level": "MUST", "comment": "\n   This CMM MUST obtain the decryption materials (../framework/\n   structures.md#decryption-materials) required for decryption.\n"}, {"source": "src/SDK/AwsEncryptionSdk.dfy", "target_path": "compliance/client-apis/decrypt.txt", "target_section": "2.5.3", "line": 509, "type": "CITATION"}, {"source": "compliance/client-apis/decrypt.txt", "target_path": "compliance/client-apis/decrypt.txt", "target_section": "2.5.3", "type": "SPEC", "level": "MUST", "comment": "\n   If the Keyring is provided as the input, the client MUST construct a\n   default CMM (../framework/default-cmm.md) that uses this keyring, to\n   obtain the decryption materials (../framework/\n   structures.md#decryption-materials) that is required for decryption.\n"}, {"source": "src/SDK/AwsEncryptionSdk.dfy", "target_path": "compliance/client-apis/decrypt.txt", "target_section": "2.5.3", "line": 869, "type": "CITATION"}, {"source": "compliance/client-apis/decrypt.txt", "target_path": "compliance/client-apis/decrypt.txt", "target_section": "2.5.3", "type": "SPEC", "level": "MUST", "comment": "\n   This default CMM MUST obtain the decryption materials required for\n   decryption.\n"}, {"source": "src/Generated/AwsEncryptionSdk.dfy", "target_path": "compliance/client-apis/decrypt.txt", "target_section": "2.6", "line": 69, "type": "IMPLICATION"}, {"source": "src/SDK/AwsEncryptionSdk.dfy", "target_path": "compliance/client-apis/decrypt.txt", "target_section": "2.6", "line": 802, "type": "IMPLICATION"}, {"source": "compliance/client-apis/decrypt.txt", "target_path": "compliance/client-apis/decrypt.txt", "target_section": "2.6", "type": "SPEC", "level": "MUST", "comment": "   The client MUST return as output to this operation:\n"}, {"source": "src/Generated/AwsEncryptionSdk.dfy", "target_path": "compliance/client-apis/decrypt.txt", "target_section": "2.6", "line": 90, "type": "EXCEPTION"}, {"source": "compliance/client-apis/decrypt.txt", "target_path": "compliance/client-apis/decrypt.txt", "target_section": "2.6", "type": "SPEC", "level": "SHOULD", "comment": " The client SHOULD return as an output:\n"}, {"source": "compliance_exceptions/decrypt.txt", "target_path": "compliance/client-apis/decrypt.txt", "target_section": "2.6.1", "line": 30, "type": "EXCEPTION"}, {"source": "compliance/client-apis/decrypt.txt", "target_path": "compliance/client-apis/decrypt.txt", "target_section": "2.6.1", "type": "SPEC", "level": "MAY", "comment": "\n   This operation MAY stream (streaming.md) the plaintext as output.\n"}, {"source": "compliance_exceptions/decrypt.txt", "target_path": "compliance/client-apis/decrypt.txt", "target_section": "2.6.1", "line": 22, "type": "IMPLICATION"}, {"source": "compliance/client-apis/decrypt.txt", "target_path": "compliance/client-apis/decrypt.txt", "target_section": "2.6.1", "type": "SPEC", "level": "SHOULD", "comment": "\n   If an implementation requires holding the entire encrypted message in\n   memory in order to perform this operation, that implementation SHOULD\n   NOT provide an API that allows the caller to stream the encrypted\n   message.\n"}, {"source": "src/Generated/AwsEncryptionSdk.dfy", "target_path": "compliance/client-apis/decrypt.txt", "target_section": "2.6.2", "line": 76, "type": "EXCEPTION"}, {"source": "compliance/client-apis/decrypt.txt", "target_path": "compliance/client-apis/decrypt.txt", "target_section": "2.6.2", "type": "SPEC", "level": "MAY", "comment": "\n   This output MAY be satisfied by outputting a parsed header\n   (Section 2.6.4) containing this value.\n"}, {"source": "src/Generated/AwsEncryptionSdk.dfy", "target_path": "compliance/client-apis/decrypt.txt", "target_section": "2.6.3", "line": 83, "type": "EXCEPTION"}, {"source": "compliance/client-apis/decrypt.txt", "target_path": "compliance/client-apis/decrypt.txt", "target_section": "2.6.3", "type": "SPEC", "level": "MAY", "comment": "\n   This output MAY be satisfied by outputting a parsed header\n   (Section 2.6.4) containing this value.\n"}, {"source": "src/SDK/AwsEncryptionSdk.dfy", "target_path": "compliance/client-apis/decrypt.txt", "target_section": "2.7", "line": 756, "type": "TODO"}, {"source": "compliance_exceptions/decrypt.txt", "target_path": "compliance/client-apis/decrypt.txt", "target_section": "2.7", "line": 155, "type": "EXCEPTION"}, {"source": "compliance/client-apis/decrypt.txt", "target_path": "compliance/client-apis/decrypt.txt", "target_section": "2.7", "type": "SPEC", "level": "MUST", "comment": "   This operation MUST perform all the above steps unless otherwise\n   specified, and it MUST perform them in the above order.\n"}, {"source": "src/SDK/AwsEncryptionSdk.dfy", "target_path": "compliance/client-apis/decrypt.txt", "target_section": "2.7", "line": 1016, "type": "CITATION"}, {"source": "compliance/client-apis/decrypt.txt", "target_path": "compliance/client-apis/decrypt.txt", "target_section": "2.7", "type": "SPEC", "level": "MUST", "comment": "\n   If the input encrypted message is not being streamed (streaming.md)\n   to this operation, all output MUST NOT be released until after these\n   steps complete successfully.\n"}, {"source": "src/SDK/AwsEncryptionSdk.dfy", "target_path": "compliance/client-apis/decrypt.txt", "target_section": "2.7.1", "line": 834, "type": "CITATION"}, {"source": "compliance/client-apis/decrypt.txt", "target_path": "compliance/client-apis/decrypt.txt", "target_section": "2.7.1", "type": "SPEC", "level": "MUST", "comment": "\n\n   Given encrypted message bytes, this operation MUST process those\n   bytes sequentially, deserializing those bytes according to the\n   message format (../data-format/message.md).\n"}, {"source": "src/SDK/Serialize/Header.dfy", "target_path": "compliance/client-apis/decrypt.txt", "target_section": "2.7.1", "line": 109, "type": "CITATION"}, {"source": "compliance/client-apis/decrypt.txt", "target_path": "compliance/client-apis/decrypt.txt", "target_section": "2.7.1", "type": "SPEC", "level": "MUST", "comment": "\n   This operation MUST attempt to deserialize all consumable encrypted\n   message bytes until it has successfully deserialized a valid message\n   header (../data-format/message-header.md).\n"}, {"source": "src/SDK/Serialize/EncryptedDataKeys.dfy", "target_path": "compliance/client-apis/decrypt.txt", "target_section": "2.7.1", "line": 104, "type": "CITATION"}, {"source": "compliance/client-apis/decrypt.txt", "target_path": "compliance/client-apis/decrypt.txt", "target_section": "2.7.1", "type": "SPEC", "level": "MUST", "comment": "\n   If the number of encrypted data keys (../framework/\n   structures.md#encrypted-data-keys) deserialized from the message\n   header (../data-format/message-header.md) is greater than the maximum\n   number of encrypted data keys (client.md#maximum-number-of-encrypted-\n   data-keys) configured in the client (client.md), then as soon as that\n   can be determined during deserializing decrypt MUST process no more\n   bytes and yield an error.\n"}, {"source": "src/SDK/Serialize/Header.dfy", "target_path": "compliance/client-apis/decrypt.txt", "target_section": "2.7.1", "line": 102, "type": "EXCEPTION"}, {"source": "compliance/client-apis/decrypt.txt", "target_path": "compliance/client-apis/decrypt.txt", "target_section": "2.7.1", "type": "SPEC", "level": "MUST", "comment": "\n   This operation MUST wait if it doesn't have enough consumable\n   encrypted message bytes to deserialize the next field of the message\n   header until enough input bytes become consumable or the caller\n   indicates an end to the encrypted message.\n"}, {"source": "src/SDK/AwsEncryptionSdk.dfy", "target_path": "compliance/client-apis/decrypt.txt", "target_section": "2.7.1", "line": 1008, "type": "CITATION"}, {"source": "compliance/client-apis/decrypt.txt", "target_path": "compliance/client-apis/decrypt.txt", "target_section": "2.7.1", "type": "SPEC", "level": "MUST", "comment": "\n   Until the header is verified (Section 2.7.3), this operation MUST NOT\n   release any parsed information from the header.\n"}, {"source": "src/SDK/AwsEncryptionSdk.dfy", "target_path": "compliance/client-apis/decrypt.txt", "target_section": "2.7.2", "line": 761, "type": "IMPLICATION"}, {"source": "compliance/client-apis/decrypt.txt", "target_path": "compliance/client-apis/decrypt.txt", "target_section": "2.7.2", "type": "SPEC", "level": "MUST", "comment": "\n\n   If the parsed algorithm suite ID (../data-format/message-\n   header.md#algorithm-suite-id) is not supported by the commitment\n   policy (client.md#commitment-policy) configured in the client\n   (client.md) decrypt MUST yield an error.\n"}, {"source": "src/SDK/AwsEncryptionSdk.dfy", "target_path": "compliance/client-apis/decrypt.txt", "target_section": "2.7.2", "line": 875, "type": "CITATION"}, {"source": "compliance/client-apis/decrypt.txt", "target_path": "compliance/client-apis/decrypt.txt", "target_section": "2.7.2", "type": "SPEC", "level": "MUST", "comment": "\n   This operation MUST obtain this set of decryption materials\n   (../framework/structures.md#decryption-materials), by calling Decrypt\n   Materials (../framework/cmm-interface.md#decrypt-materials) on a CMM\n   (../framework/cmm-interface.md).\n"}, {"source": "src/SDK/AwsEncryptionSdk.dfy", "target_path": "compliance/client-apis/decrypt.txt", "target_section": "2.7.2", "line": 471, "type": "IMPLICATION"}, {"source": "compliance/client-apis/decrypt.txt", "target_path": "compliance/client-apis/decrypt.txt", "target_section": "2.7.2", "type": "SPEC", "level": "MUST", "comment": "\n   The CMM used MUST be the input CMM, if supplied. "}, {"source": "src/SDK/AwsEncryptionSdk.dfy", "target_path": "compliance/client-apis/decrypt.txt", "target_section": "2.7.2", "line": 515, "type": "CITATION"}, {"source": "compliance/client-apis/decrypt.txt", "target_path": "compliance/client-apis/decrypt.txt", "target_section": "2.7.2", "type": "SPEC", "level": "MUST", "comment": " If a CMM is not\n   supplied as the input, the decrypt operation MUST construct a default\n   CMM (../framework/default-cmm.md) from the input keyring\n   (../framework/keyring-interface.md).\n"}, {"source": "compliance/client-apis/decrypt.txt", "target_path": "compliance/client-apis/decrypt.txt", "target_section": "2.7.2", "type": "SPEC", "level": "MUST", "comment": "\n   The call to the CMM's Decrypt Materials (../framework/cmm-\n   interface.md#decrypt-materials) operation MUST be constructed as\n   follows:\n"}, {"source": "src/SDK/AwsEncryptionSdk.dfy", "target_path": "compliance/client-apis/decrypt.txt", "target_section": "2.7.2", "line": 782, "type": "IMPLICATION"}, {"source": "src/SDK/AwsEncryptionSdk.dfy", "target_path": "compliance/client-apis/decrypt.txt", "target_section": "2.7.2", "line": 856, "type": "CITATION"}, {"source": "compliance/client-apis/decrypt.txt", "target_path": "compliance/client-apis/decrypt.txt", "target_section": "2.7.2", "type": "SPEC", "level": "MUST", "comment": " If the\n   algorithm suite is not supported by the commitment policy\n   (client.md#commitment-policy) configured in the client (client.md)\n   decrypt MUST yield an error. "}, {"source": "src/SDK/KeyDerivation.dfy", "target_path": "compliance/client-apis/decrypt.txt", "target_section": "2.7.2", "line": 126, "type": "IMPLICATION"}, {"source": "compliance/client-apis/decrypt.txt", "target_path": "compliance/client-apis/decrypt.txt", "target_section": "2.7.2", "type": "SPEC", "level": "MUST", "comment": " If the algorithm suite (../framework/\n   algorithm-suites.md#algorithm-suites-encryption-key-derivation-\n   settings) supports key commitment (../framework/algorithm-\n   suites.md#key-commitment) then the commit key (../framework/\n   algorithm-suites.md#commit-key) MUST be derived from the plaintext\n   data key using the commit key derivation (../framework/algorithm-\n   suites.md#algorithm-suites-commit-key-derivation-settings). "}, {"source": "src/SDK/AwsEncryptionSdk.dfy", "target_path": "compliance/client-apis/decrypt.txt", "target_section": "2.7.2", "line": 1189, "type": "IMPLICATION"}, {"source": "compliance/client-apis/decrypt.txt", "target_path": "compliance/client-apis/decrypt.txt", "target_section": "2.7.2", "type": "SPEC", "level": "MUST", "comment": " The\n   derived commit key MUST equal the commit key stored in the message\n   header. "}, {"source": "src/SDK/KeyDerivation.dfy", "target_path": "compliance/client-apis/decrypt.txt", "target_section": "2.7.2", "line": 60, "type": "CITATION"}, {"source": "src/SDK/KeyDerivation.dfy", "target_path": "compliance/client-apis/decrypt.txt", "target_section": "2.7.2", "line": 110, "type": "IMPLICATION"}, {"source": "compliance/client-apis/decrypt.txt", "target_path": "compliance/client-apis/decrypt.txt", "target_section": "2.7.2", "type": "SPEC", "level": "MUST", "comment": " The algorithm suite used to derive a data key from the\n   plaintext data key MUST be the key derivation algorithm\n   (../framework/algorithm-suites.md#key-derivation-algorithm) included\n   in the algorithm suite (../framework/algorithm-suites.md) associated\n   with the returned decryption materials. "}, {"source": "src/SDK/AwsEncryptionSdk.dfy", "target_path": "compliance/client-apis/decrypt.txt", "target_section": "2.7.3", "line": 908, "type": "CITATION"}, {"source": "compliance/client-apis/decrypt.txt", "target_path": "compliance/client-apis/decrypt.txt", "target_section": "2.7.3", "type": "SPEC", "level": "MUST", "comment": "   Once a valid message header is deserialized and decryption materials\n   are available, this operation MUST validate the message header body\n   (../data-format/message-header.md#header-body) by using the\n   authenticated encryption algorithm (../framework/algorithm-\n   suites.md#encryption-algorithm) to decrypt with the following inputs:\n"}, {"source": "src/SDK/AwsEncryptionSdk.dfy", "target_path": "compliance/client-apis/decrypt.txt", "target_section": "2.7.3", "line": 904, "type": "CITATION"}, {"source": "compliance/client-apis/decrypt.txt", "target_path": "compliance/client-apis/decrypt.txt", "target_section": "2.7.3", "type": "SPEC", "level": "MUST", "comment": "   If this tag verification fails, this operation MUST immediately halt\n   and fail.\n"}, {"source": "src/SDK/AwsEncryptionSdk.dfy", "target_path": "compliance/client-apis/decrypt.txt", "target_section": "2.7.4", "line": 966, "type": "CITATION"}, {"source": "compliance/client-apis/decrypt.txt", "target_path": "compliance/client-apis/decrypt.txt", "target_section": "2.7.4", "type": "SPEC", "level": "MUST", "comment": "\n\n   Once the message header is successfully parsed, the next sequential\n   bytes MUST be deserialized according to the message body spec\n   (../data-format/message-body.md).\n"}, {"source": "compliance_exceptions/decrypt.txt", "target_path": "compliance/client-apis/decrypt.txt", "target_section": "2.7.4", "line": 76, "type": "EXCEPTION"}, {"source": "compliance/client-apis/decrypt.txt", "target_path": "compliance/client-apis/decrypt.txt", "target_section": "2.7.4", "type": "SPEC", "level": "MUST", "comment": "\n   While there MAY still be message body left to deserialize and\n   decrypt, this operation MUST either wait for more of the encrypted\n   message bytes to become consumable, wait for the end to the encrypted\n   message to be indicated, or to deserialize and/or decrypt the\n   consumable bytes.\n"}, {"source": "src/SDK/AwsEncryptionSdk.dfy", "target_path": "compliance/client-apis/decrypt.txt", "target_section": "2.7.4", "line": 971, "type": "CITATION"}, {"source": "compliance/client-apis/decrypt.txt", "target_path": "compliance/client-apis/decrypt.txt", "target_section": "2.7.4", "type": "SPEC", "level": "MUST", "comment": "\n   The content type (../data-format/message-header.md#content-type)\n   field parsed from the message header above determines whether these\n   bytes MUST be deserialized as framed data (../data-format/message-\n   body.md#framed-data) or un-framed data (../data-format/message-\n   body.md#un-framed-data).\n"}, {"source": "src/SDK/MessageBody.dfy", "target_path": "compliance/client-apis/decrypt.txt", "target_section": "2.7.4", "line": 769, "type": "CITATION"}, {"source": "compliance/client-apis/decrypt.txt", "target_path": "compliance/client-apis/decrypt.txt", "target_section": "2.7.4", "type": "SPEC", "level": "MUST", "comment": "\n   If deserializing framed data (../data-format/message-body.md#framed-\n   data), this operation MUST use the first 4 bytes of a frame to\n   determine if the frame MUST be deserialized as a final frame\n   (../data-format/message-body.md#final-frame) or regular frame\n   (../fata-format/message-body/md#regular-frame). "}, {"source": "src/SDK/MessageBody.dfy", "target_path": "compliance/client-apis/decrypt.txt", "target_section": "2.7.4", "line": 826, "type": "CITATION"}, {"source": "compliance/client-apis/decrypt.txt", "target_path": "compliance/client-apis/decrypt.txt", "target_section": "2.7.4", "type": "SPEC", "level": "MUST", "comment": " If the first 4 bytes\n   have a value of 0xFFFF, then this MUST be deserialized as the\n   sequence number end (../data-format/message-header.md#sequence-\n   number-end) and the following bytes according to the final frame spec\n   (../data-format/message-body.md#final-frame). "}, {"source": "src/SDK/MessageBody.dfy", "target_path": "compliance/client-apis/decrypt.txt", "target_section": "2.7.4", "line": 779, "type": "CITATION"}, {"source": "compliance/client-apis/decrypt.txt", "target_path": "compliance/client-apis/decrypt.txt", "target_section": "2.7.4", "type": "SPEC", "level": "MUST", "comment": " Otherwise, this MUST\n   be deserialized as the sequence number (../data-format/message-\n   header.md#sequence-number) and the following bytes according to the\n   regular frame spec (../data-format/message-body.md#regular-frame).\n"}, {"source": "src/SDK/Serialize/Frames.dfy", "target_path": "compliance/client-apis/decrypt.txt", "target_section": "2.7.4", "line": 210, "type": "IMPLICATION"}, {"source": "src/SDK/Serialize/Frames.dfy", "target_path": "compliance/client-apis/decrypt.txt", "target_section": "2.7.4", "line": 237, "type": "CITATION"}, {"source": "compliance/client-apis/decrypt.txt", "target_path": "compliance/client-apis/decrypt.txt", "target_section": "2.7.4", "type": "SPEC", "level": "MUST", "comment": "\n   If deserializing a final frame (../data-format/message-body.md#final-\n   frame), this operation MUST ensure that the length of the encrypted\n   content field is less than or equal to the frame length deserialized\n   in the message header.\n"}, {"source": "src/SDK/MessageBody.dfy", "target_path": "compliance/client-apis/decrypt.txt", "target_section": "2.7.4", "line": 557, "type": "EXCEPTION"}, {"source": "src/SDK/MessageBody.dfy", "target_path": "compliance/client-apis/decrypt.txt", "target_section": "2.7.4", "line": 811, "type": "EXCEPTION"}, {"source": "compliance/client-apis/decrypt.txt", "target_path": "compliance/client-apis/decrypt.txt", "target_section": "2.7.4", "type": "SPEC", "level": "MUST", "comment": "\n   Once at least a single frame is deserialized (or the entire body in\n   the un-framed case), this operation MUST decrypt and authenticate the\n   frame (or body) using the authenticated encryption algorithm\n   (../framework/algorithm-suites.md#encryption-algorithm) specified by\n   the algorithm suite (../framework/algorithm-suites.md), with the\n   following inputs:\n"}, {"source": "src/SDK/MessageBody.dfy", "target_path": "compliance/client-apis/decrypt.txt", "target_section": "2.7.4", "line": 549, "type": "CITATION"}, {"source": "src/SDK/AwsEncryptionSdk.dfy", "target_path": "compliance/client-apis/decrypt.txt", "target_section": "2.7.4", "line": 979, "type": "CITATION"}, {"source": "src/SDK/AwsEncryptionSdk.dfy", "target_path": "compliance/client-apis/decrypt.txt", "target_section": "2.7.4", "line": 987, "type": "CITATION"}, {"source": "compliance/client-apis/decrypt.txt", "target_path": "compliance/client-apis/decrypt.txt", "target_section": "2.7.4", "type": "SPEC", "level": "MUST", "comment": "   If this decryption fails, this operation MUST immediately halt and\n   fail. "}, {"source": "src/SDK/AwsEncryptionSdk.dfy", "target_path": "compliance/client-apis/decrypt.txt", "target_section": "2.7.4", "line": 1013, "type": "CITATION"}, {"source": "compliance/client-apis/decrypt.txt", "target_path": "compliance/client-apis/decrypt.txt", "target_section": "2.7.4", "type": "SPEC", "level": "MUST", "comment": " This operation MUST NOT release any unauthenticated plaintext.\n"}, {"source": "src/SDK/EncryptDecrypt.dfy", "target_path": "compliance/client-apis/decrypt.txt", "target_section": "2.7.5", "line": 176, "type": "CITATION"}, {"source": "compliance/client-apis/decrypt.txt", "target_path": "compliance/client-apis/decrypt.txt", "target_section": "2.7.5", "type": "SPEC", "level": "MUST", "comment": "\n\n   If the algorithm suite has a signature algorithm, this operation MUST\n   verify the message footer using the specified signature algorithm.\n"}, {"source": "src/SDK/EncryptDecrypt.dfy", "target_path": "compliance/client-apis/decrypt.txt", "target_section": "2.7.5", "line": 187, "type": "CITATION"}, {"source": "compliance/client-apis/decrypt.txt", "target_path": "compliance/client-apis/decrypt.txt", "target_section": "2.7.5", "type": "SPEC", "level": "MUST", "comment": "\n   After deserializing the body, this operation MUST deserialize the\n   next encrypted message bytes as the message footer (../data-format/\n   message-footer.md).\n"}, {"source": "compliance_exceptions/decrypt.txt", "target_path": "compliance/client-apis/decrypt.txt", "target_section": "2.7.5", "line": 117, "type": "EXCEPTION"}, {"source": "compliance/client-apis/decrypt.txt", "target_path": "compliance/client-apis/decrypt.txt", "target_section": "2.7.5", "type": "SPEC", "level": "MUST", "comment": "\n   If there are not enough consumable bytes to deserialize the message\n   footer and the caller has not yet indicated an end to the encrypted\n   message, this operation MUST wait for enough bytes to become\n   consumable or for the caller to indicate an end to the encrypted\n   message.\n"}, {"source": "src/SDK/EncryptDecrypt.dfy", "target_path": "compliance/client-apis/decrypt.txt", "target_section": "2.7.5", "line": 196, "type": "CITATION"}, {"source": "compliance/client-apis/decrypt.txt", "target_path": "compliance/client-apis/decrypt.txt", "target_section": "2.7.5", "type": "SPEC", "level": "MUST", "comment": "\n   Once the message footer is deserialized, this operation MUST use the\n   signature algorithm (../framework/algorithm-suites.md#signature-\n   algorithm) from the algorithm suite (../framework/algorithm-\n   suites.md) in the decryption materials to verify the encrypted\n   message, with the following inputs:\n"}, {"source": "compliance_exceptions/decrypt.txt", "target_path": "compliance/client-apis/decrypt.txt", "target_section": "2.7.5", "line": 126, "type": "EXCEPTION"}, {"source": "compliance/client-apis/decrypt.txt", "target_path": "compliance/client-apis/decrypt.txt", "target_section": "2.7.5", "type": "SPEC", "level": "MAY", "comment": "   Note that the message header and message body MAY have already been\n   input during previous steps.\n"}, {"source": "src/SDK/AwsEncryptionSdk.dfy", "target_path": "compliance/client-apis/decrypt.txt", "target_section": "2.7.5", "line": 997, "type": "CITATION"}, {"source": "compliance/client-apis/decrypt.txt", "target_path": "compliance/client-apis/decrypt.txt", "target_section": "2.7.5", "type": "SPEC", "level": "MUST", "comment": "\n   If this verification is not successful, this operation MUST\n   immediately halt and fail.\n"}, {"source": "compliance_exceptions/decrypt.txt", "target_path": "compliance/client-apis/decrypt.txt", "target_section": "2.8", "line": 132, "type": "EXCEPTION"}, {"source": "compliance/client-apis/decrypt.txt", "target_path": "compliance/client-apis/decrypt.txt", "target_section": "2.8", "type": "SPEC", "level": "MUST", "comment": "\n\n   If this operation is streaming (streaming.md) output to the caller\n   and is decrypting messages created with an algorithm suite including\n   a signature algorithm, any released plaintext MUST NOT be considered\n   signed data until this operation finishes successfully.\n"}, {"source": "compliance_exceptions/decrypt.txt", "target_path": "compliance/client-apis/decrypt.txt", "target_section": "2.8", "line": 140, "type": "EXCEPTION"}, {"source": "compliance/client-apis/decrypt.txt", "target_path": "compliance/client-apis/decrypt.txt", "target_section": "2.8", "type": "SPEC", "level": "MUST", "comment": "\n   This means that callers that process such released plaintext MUST NOT\n   consider any processing successful until this operation completes\n   successfully. "}, {"source": "compliance_exceptions/decrypt.txt", "target_path": "compliance/client-apis/decrypt.txt", "target_section": "2.8", "line": 147, "type": "EXCEPTION"}, {"source": "compliance/client-apis/decrypt.txt", "target_path": "compliance/client-apis/decrypt.txt", "target_section": "2.8", "type": "SPEC", "level": "MUST", "comment": " Additionally, if this operation fails, callers MUST\n   discard the released plaintext and encryption context and MUST\n   rollback any processing done due to the released plaintext or\n   encryption context.\n"}, {"source": "compliance/data-format/message-body.txt", "target_path": "compliance/data-format/message-body.txt", "target_section": "2.4.1", "type": "SPEC", "level": "MUST", "comment": "\n\n   The key words \"MUST\", \"MUST NOT\", \"REQUIRED\", \"SHALL\", \"SHALL NOT\",\n   \"SHOULD\", \"SHOULD NOT\", \"RECOMMENDED\", \"MAY\", and \"OPTIONAL\" in this\n   document are to be interpreted as described in RFC 2119\n   (https://tools.ietf.org/html/rfc2119).\n"}, {"source": "src/SDK/Serialize/Frames.dfy", "target_path": "compliance/data-format/message-body.txt", "target_section": "2.5.1.1", "line": 59, "type": "IMPLICATION"}, {"source": "compliance/data-format/message-body.txt", "target_path": "compliance/data-format/message-body.txt", "target_section": "2.5.1.1", "type": "SPEC", "level": "MUST", "comment": " The\n   IV MUST be a unique IV within the message.\n"}, {"source": "src/SDK/Serialize/Frames.dfy", "target_path": "compliance/data-format/message-body.txt", "target_section": "2.5.1.2", "line": 114, "type": "IMPLICATION"}, {"source": "compliance/data-format/message-body.txt", "target_path": "compliance/data-format/message-body.txt", "target_section": "2.5.1.2", "type": "SPEC", "level": "MUST", "comment": "   The length MUST NOT be greater than \"2^36 - 32\", or 64 gibibytes (64\n   GiB), due to restrictions imposed by the implemented algorithms\n   (../framework/algorithm-suites.md).\n"}, {"source": "compliance/data-format/message-body.txt", "target_path": "compliance/data-format/message-body.txt", "target_section": "2.5.2.1", "type": "SPEC", "level": "MUST", "comment": "   Framed Data MUST start at Sequence Number 1.\n"}, {"source": "compliance/data-format/message-body.txt", "target_path": "compliance/data-format/message-body.txt", "target_section": "2.5.2.1", "type": "SPEC", "level": "MUST", "comment": "   Subsequent frames MUST be in order and MUST contain an increment of 1\n   from the previous frame.\n"}, {"source": "compliance/data-format/message-body.txt", "target_path": "compliance/data-format/message-body.txt", "target_section": "2.5.2.1", "type": "SPEC", "level": "MUST", "comment": "   Each frame in the Framed Data (Section 2.5.2) MUST include an IV that\n   is unique within the message. "}, {"source": "compliance/data-format/message-body.txt", "target_path": "compliance/data-format/message-body.txt", "target_section": "2.5.2.1", "type": "SPEC", "level": "MUST", "comment": " The IV length MUST be equal to the IV\n   length of the algorithm suite specified by the Algorithm Suite ID\n   (message-header.md#algorithm-suite-id) field. "}, {"source": "compliance/data-format/message-body.txt", "target_path": "compliance/data-format/message-body.txt", "target_section": "2.5.2.1", "type": "SPEC", "level": "MUST", "comment": "   The length of the encrypted content of a Regular Frame MUST be equal\n   to the Frame Length.\n"}, {"source": "compliance/data-format/message-body.txt", "target_path": "compliance/data-format/message-body.txt", "target_section": "2.5.2.1", "type": "SPEC", "level": "MUST", "comment": "   The authentication tag length MUST be equal to the authentication tag\n   length of the algorithm suite specified by the Algorithm Suite ID\n   (message-header.md#algorithm-suite-id) field.\n"}, {"source": "compliance/data-format/message-body.txt", "target_path": "compliance/data-format/message-body.txt", "target_section": "2.5.2.2", "type": "SPEC", "level": "MUST", "comment": "   The value MUST be encoded as the 4 bytes \"FF FF FF FF\" in hexadecimal\n   notation.\n"}, {"source": "compliance/data-format/message-body.txt", "target_path": "compliance/data-format/message-body.txt", "target_section": "2.5.2.2", "type": "SPEC", "level": "MUST", "comment": " The Final Frame\n   Sequence number MUST be equal to the total number of frames in the\n   Framed Data.\n"}, {"source": "compliance/data-format/message-body.txt", "target_path": "compliance/data-format/message-body.txt", "target_section": "2.5.2.2", "type": "SPEC", "level": "MUST", "comment": "   The IV MUST be a unique IV within the message.\n"}, {"source": "compliance/data-format/message-body.txt", "target_path": "compliance/data-format/message-body.txt", "target_section": "2.5.2.2", "type": "SPEC", "level": "MUST", "comment": "   The IV length MUST be equal to the IV length of the algorithm suite\n   (../framework/algorithm-suites.md) that generated the message. "}, {"source": "compliance/data-format/message-body.txt", "target_path": "compliance/data-format/message-body.txt", "target_section": "2.5.2.2", "type": "SPEC", "level": "MUST", "comment": "   The authentication tag length MUST be equal to the authentication tag\n   length of the algorithm suite specified by the Algorithm Suite ID\n   (message-header.md#algorithm-suite-id) field.\n"}, {"source": "compliance/data-format/message.txt", "target_path": "compliance/data-format/message.txt", "target_section": "2.3", "type": "SPEC", "level": "MUST", "comment": "   If the message header (message-header.md) contains an algorithm suite\n   (../framework/algorithm-suites.md) in the algorithm suite ID\n   (message-header.md#algorithm-suite-id) field that contains a\n   signature algorithm (../framework/algorithm-suites.md#signature-\n   algorithm), the message MUST also contain a message footer (message-\n   footer.md), serialized after the message body (message-body.md).\n"}, {"source": "src/SDK/MessageBody.dfy", "target_path": "compliance/data-format/message-body-aad.txt", "target_section": "2.4.3", "line": 600, "type": "CITATION"}, {"source": "src/SDK/MessageBody.dfy", "target_path": "compliance/data-format/message-body-aad.txt", "target_section": "2.4.3", "line": 624, "type": "CITATION"}, {"source": "compliance/data-format/message-body-aad.txt", "target_path": "compliance/data-format/message-body-aad.txt", "target_section": "2.4.3", "type": "SPEC", "level": "MUST", "comment": "   For framed data (message-body.md#framed-data), the value of this\n   field MUST be the frame sequence number (message-body.md#sequence-\n   number). "}, {"source": "src/SDK/MessageBody.dfy", "target_path": "compliance/data-format/message-body-aad.txt", "target_section": "2.4.3", "line": 653, "type": "CITATION"}, {"source": "compliance/data-format/message-body-aad.txt", "target_path": "compliance/data-format/message-body-aad.txt", "target_section": "2.4.3", "type": "SPEC", "level": "MUST", "comment": " For non-framed data (message-body.md#non-framed-data), the\n   value of this field MUST be \"1\".\n"}, {"source": "src/SDK/AwsEncryptionSdk.dfy", "target_path": "compliance/data-format/message-footer.txt", "target_section": "2.3", "line": 319, "type": "CITATION"}, {"source": "compliance/data-format/message-footer.txt", "target_path": "compliance/data-format/message-footer.txt", "target_section": "2.3", "type": "SPEC", "level": "MUST", "comment": "   When an algorithm suite (../framework/algorithm-suites.md) includes a\n   signature algorithm (../framework/algorithm-suites.md#signature-\n   algorithm), the message (message.md) MUST contain a footer.\n"}, {"source": "compliance/data-format/message-footer.txt", "target_path": "compliance/data-format/message-footer.txt", "target_section": "2.4.1", "type": "SPEC", "level": "MUST", "comment": "\n\n   The key words \"MUST\", \"MUST NOT\", \"REQUIRED\", \"SHALL\", \"SHALL NOT\",\n   \"SHOULD\", \"SHOULD NOT\", \"RECOMMENDED\", \"MAY\", and \"OPTIONAL\" in this\n   document are to be interpreted as described in RFC 2119\n   (https://tools.ietf.org/html/rfc2119).\n"}, {"source": "src/SDK/EncryptDecrypt.dfy", "target_path": "compliance/data-format/message-footer.txt", "target_section": "2.5.2", "line": 62, "type": "CITATION"}, {"source": "compliance/data-format/message-footer.txt", "target_path": "compliance/data-format/message-footer.txt", "target_section": "2.5.2", "type": "SPEC", "level": "MUST", "comment": "   This signature MUST be calculated over both the message header\n   (message-header.md) and the message body (message-body.md), in the\n   order of serialization.\n"}, {"source": "compliance/data-format/message-header.txt", "target_path": "compliance/data-format/message-header.txt", "target_section": "2.4.1", "type": "SPEC", "level": "MUST", "comment": "\n\n   The key words \"MUST\", \"MUST NOT\", \"REQUIRED\", \"SHALL\", \"SHALL NOT\",\n   \"SHOULD\", \"SHOULD NOT\", \"RECOMMENDED\", \"MAY\", and \"OPTIONAL\" in this\n   document are to be interpreted as described in RFC 2119\n   (https://tools.ietf.org/html/rfc2119).\n"}, {"source": "src/SDK/Serialize/SerializableTypes.dfy", "target_path": "compliance/data-format/message-header.txt", "target_section": "2.5.1.5", "line": 54, "type": "IMPLICATION"}, {"source": "compliance/data-format/message-header.txt", "target_path": "compliance/data-format/message-header.txt", "target_section": "2.5.1.5", "type": "SPEC", "level": "MUST", "comment": " The value (hex) of this field MUST be a value that exists\n   in the Supported Algorithm Suites (../framework/algorithm-\n   suites.md#supported-algorithm-suites) table.\n"}, {"source": "compliance_exceptions/message-header.txt", "target_path": "compliance/data-format/message-header.txt", "target_section": "2.5.1.6", "line": 8, "type": "EXCEPTION"}, {"source": "compliance/data-format/message-header.txt", "target_path": "compliance/data-format/message-header.txt", "target_section": "2.5.1.6", "type": "SPEC", "level": "MUST", "comment": "\n\n   A Message ID MUST uniquely identify the message (message.md). "}, {"source": "compliance_exceptions/message-header.txt", "target_path": "compliance/data-format/message-header.txt", "target_section": "2.5.1.6", "line": 13, "type": "TEST"}, {"source": "aws-encryption-sdk-net/Source/Extern/Random.cs", "target_path": "compliance/data-format/message-header.txt", "target_section": "2.5.1.6", "line": 14, "type": "CITATION"}, {"source": "compliance/data-format/message-header.txt", "target_path": "compliance/data-format/message-header.txt", "target_section": "2.5.1.6", "type": "SPEC", "level": "MUST", "comment": " While\n   implementations cannot guarantee complete uniqueness, implementations\n   MUST use a good source of randomness when generating messages IDs in\n   order to make the chance of duplicate IDs negligible.\n"}, {"source": "src/SDK/Serialize/EncryptedDataKeys.dfy", "target_path": "compliance/data-format/message-header.txt", "target_section": "2.5.1.9", "line": 40, "type": "TODO"}, {"source": "compliance/data-format/message-header.txt", "target_path": "compliance/data-format/message-header.txt", "target_section": "2.5.1.9", "type": "SPEC", "level": "MUST", "comment": " This value MUST be greater than\n   0.\n"}, {"source": "src/SDK/AwsEncryptionSdk.dfy", "target_path": "compliance/data-format/message-header.txt", "target_section": "2.5.2", "line": 568, "type": "IMPLICATION"}, {"source": "compliance/data-format/message-header.txt", "target_path": "compliance/data-format/message-header.txt", "target_section": "2.5.2", "type": "SPEC", "level": "MUST", "comment": " The length of the suite data field MUST be equal to\n   the Algorithm Suite Data Length (../framework/algorithm-\n   suites.md#algorithm-suite-data-length) value of the algorithm suite\n   (../framework/algorithm-suites.md) specified by the Algorithm Suite\n   ID (Section 2.5.1.5) field.\n"}, {"source": "src/SDK/Serialize/V1HeaderBody.dfy", "target_path": "compliance/data-format/message-header.txt", "target_section": "2.5.2.1", "line": 34, "type": "IMPLICATION"}, {"source": "compliance/data-format/message-header.txt", "target_path": "compliance/data-format/message-header.txt", "target_section": "2.5.2.1", "type": "SPEC", "level": "MUST", "comment": "\n\n   A reserved sequence of 4 bytes that MUST have the value (hex) of \"00\n   00 00 00\".\n"}, {"source": "src/SDK/Serialize/V1HeaderBody.dfy", "target_path": "compliance/data-format/message-header.txt", "target_section": "2.5.2.2", "line": 102, "type": "CITATION"}, {"source": "compliance/data-format/message-header.txt", "target_path": "compliance/data-format/message-header.txt", "target_section": "2.5.2.2", "type": "SPEC", "level": "MUST", "comment": " This value MUST be\n   equal to the IV length (../framework/algorithm-suites.md#iv-length)\n   value of the algorithm suite (../framework/algorithm-suites.md)\n   specified by the Algorithm Suite ID (Section 2.5.1.5) field.\n"}, {"source": "src/SDK/Serialize/Header.dfy", "target_path": "compliance/data-format/message-header.txt", "target_section": "2.5.2.3", "line": 119, "type": "IMPLICATION"}, {"source": "compliance/data-format/message-header.txt", "target_path": "compliance/data-format/message-header.txt", "target_section": "2.5.2.3", "type": "SPEC", "level": "MUST", "comment": " When the content type (Section 2.5.1.11) is non-\n   framed, the value of this field MUST be 0.\n"}], "statuses": {"0": {"spec": 109, "related": [0]}, "1": {"spec": 246, "related": [1]}, "2": {"spec": 46, "related": [2]}, "3": {"spec": 41, "related": [3]}, "4": {"spec": 112, "related": [4]}, "5": {"spec": 125, "related": [5]}, "6": {"spec": 109, "related": [6]}, "7": {"spec": 153, "related": [7]}, "8": {"spec": 194, "related": [8]}, "9": {"spec": 168, "related": [9]}, "10": {"spec": 145, "related": [10]}, "11": {"spec": 104, "related": [11]}, "12": {"spec": 123, "related": [12]}, "13": {"spec": 213, "related": [13]}, "14": {"spec": 105, "related": [14]}, "15": {"spec": 162, "related": [15]}, "16": {"spec": 137, "related": [16]}, "17": {"spec": 111, "related": [17]}, "18": {"spec": 122, "related": [18]}, "19": {"spec": 260, "related": [19]}, "20": {"spec": 217, "related": [20]}, "21": {"spec": 180, "related": [21]}, "22": {"spec": 159, "related": [22]}, "23": {"spec": 166, "related": [23]}, "24": {"spec": 108, "related": [24]}, "25": {"spec": 143, "related": [25]}, "26": {"spec": 126, "related": [26]}, "27": {"spec": 378, "related": [27]}, "28": {"spec": 259, "related": [28]}, "29": {"spec": 388, "related": [29]}, "30": {"spec": 377, "related": [30]}, "31": {"spec": 126, "related": [31]}, "32": {"spec": 210, "related": [32]}, "33": {"spec": 171, "related": [33]}, "34": {"spec": 246, "related": [34]}, "35": {"spec": 141, "related": [35]}, "36": {"spec": 145, "related": [36]}, "37": {"spec": 81, "related": [37]}, "38": {"spec": 47, "related": [38]}, "39": {"spec": 131, "related": [39]}, "40": {"spec": 115, "related": [40]}, "41": {"spec": 170, "related": [41]}, "42": {"spec": 178, "related": [42]}, "43": {"spec": 57, "related": [43]}, "44": {"spec": 118, "related": [44]}, "45": {"spec": 115, "related": [45]}, "46": {"spec": 186, "related": [46]}, "47": {"spec": 119, "related": [47]}, "48": {"spec": 57, "related": [48]}, "49": {"spec": 198, "related": [49]}, "50": {"spec": 119, "related": [50]}, "51": {"spec": 72, "related": [51]}, "52": {"spec": 246, "related": [52]}, "53": {"spec": 61, "related": [53]}, "54": {"spec": 95, "related": [54]}, "55": {"spec": 111, "related": [55]}, "56": {"spec": 246, "related": [56]}, "57": {"spec": 98, "related": [57]}, "58": {"spec": 109, "related": [58]}, "59": {"spec": 169, "related": [59]}, "60": {"spec": 134, "related": [60]}, "61": {"spec": 134, "related": [61]}, "62": {"spec": 221, "related": [62]}, "63": {"spec": 78, "related": [63]}, "64": {"spec": 102, "related": [64]}, "65": {"spec": 134, "related": [65]}, "66": {"spec": 93, "related": [66]}, "67": {"spec": 116, "related": [67]}, "68": {"spec": 107, "related": [68]}, "69": {"spec": 91, "related": [69]}, "70": {"spec": 28, "related": [70]}, "71": {"spec": 246, "related": [71]}, "72": {"spec": 82, "related": [72]}, "73": {"spec": 153, "related": [73]}, "74": {"spec": 249, "related": [74]}, "75": {"spec": 178, "related": [75]}, "76": {"spec": 298, "related": [76]}, "77": {"spec": 174, "related": [77]}, "78": {"spec": 180, "related": [78]}, "79": {"spec": 221, "related": [79]}, "80": {"spec": 237, "related": [80]}, "81": {"spec": 129, "related": [81]}, "82": {"spec": 262, "related": [82]}, "84": {"spec": 174, "implication": 174, "related": [83, 84]}, "85": {"spec": 167, "related": [85]}, "86": {"spec": 137, "related": [86]}, "87": {"spec": 208, "related": [87]}, "88": {"spec": 83, "related": [88]}, "89": {"spec": 308, "related": [89]}, "90": {"spec": 176, "related": [90]}, "91": {"spec": 148, "related": [91]}, "92": {"spec": 183, "related": [92]}, "93": {"spec": 237, "related": [93]}, "94": {"spec": 246, "related": [94]}, "96": {"spec": 69, "implication": 69, "related": [95, 96]}, "98": {"spec": 107, "citation": 107, "related": [97, 98]}, "100": {"spec": 82, "citation": 82, "related": [99, 100]}, "102": {"spec": 61, "implication": 61, "related": [101, 102]}, "103": {"spec": 69, "related": [103]}, "104": {"spec": 147, "related": [104]}, "106": {"spec": 123, "implication": 123, "related": [105, 106]}, "108": {"spec": 107, "implication": 107, "related": [107, 108]}, "110": {"spec": 97, "implication": 97, "related": [109, 110]}, "113": {"spec": 244, "citation": 244, "test": 244, "related": [111, 112, 113]}, "116": {"spec": 135, "citation": 135, "test": 135, "related": [114, 115, 116]}, "119": {"spec": 304, "citation": 304, "test": 304, "related": [117, 118, 119]}, "121": {"spec": 81, "implication": 81, "related": [120, 121]}, "122": {"spec": 180, "related": [122]}, "125": {"spec": 165, "citation": 165, "test": 165, "related": [123, 124, 125]}, "128": {"spec": 101, "citation": 101, "test": 101, "related": [126, 127, 128]}, "130": {"spec": 169, "implication": 169, "related": [129, 130]}, "131": {"spec": 181, "related": [131]}, "133": {"spec": 308, "test": 308, "related": [132, 133]}, "135": {"spec": 81, "implication": 81, "related": [134, 135]}, "137": {"spec": 203, "citation": 203, "related": [136, 137]}, "138": {"spec": 481, "related": [138]}, "141": {"spec": 153, "citation": 153, "test": 153, "related": [139, 140, 141]}, "143": {"spec": 139, "citation": 139, "related": [142, 143]}, "144": {"spec": 76, "related": [144]}, "145": {"spec": 246, "related": [145]}, "146": {"spec": 49, "related": [146]}, "147": {"spec": 65, "related": [147]}, "148": {"spec": 51, "related": [148]}, "149": {"spec": 62, "related": [149]}, "150": {"spec": 59, "related": [150]}, "151": {"spec": 183, "related": [151]}, "152": {"spec": 66, "related": [152]}, "153": {"spec": 236, "related": [153]}, "154": {"spec": 74, "related": [154]}, "155": {"spec": 140, "related": [155]}, "156": {"spec": 61, "related": [156]}, "157": {"spec": 143, "related": [157]}, "158": {"spec": 88, "related": [158]}, "159": {"spec": 146, "related": [159]}, "160": {"spec": 178, "related": [160]}, "161": {"spec": 186, "related": [161]}, "162": {"spec": 195, "related": [162]}, "163": {"spec": 66, "related": [163]}, "164": {"spec": 247, "related": [164]}, "165": {"spec": 74, "related": [165]}, "166": {"spec": 246, "related": [166]}, "167": {"spec": 83, "related": [167]}, "168": {"spec": 68, "related": [168]}, "169": {"spec": 135, "related": [169]}, "170": {"spec": 78, "related": [170]}, "171": {"spec": 194, "related": [171]}, "172": {"spec": 63, "related": [172]}, "173": {"spec": 80, "related": [173]}, "174": {"spec": 94, "related": [174]}, "175": {"spec": 83, "related": [175]}, "176": {"spec": 71, "related": [176]}, "177": {"spec": 93, "related": [177]}, "178": {"spec": 168, "related": [178]}, "179": {"spec": 175, "related": [179]}, "180": {"spec": 306, "related": [180]}, "181": {"spec": 193, "related": [181]}, "182": {"spec": 187, "related": [182]}, "183": {"spec": 98, "related": [183]}, "184": {"spec": 251, "related": [184]}, "185": {"spec": 245, "related": [185]}, "186": {"spec": 170, "related": [186]}, "187": {"spec": 291, "related": [187]}, "188": {"spec": 161, "related": [188]}, "189": {"spec": 183, "related": [189]}, "190": {"spec": 98, "related": [190]}, "191": {"spec": 232, "related": [191]}, "192": {"spec": 245, "related": [192]}, "193": {"spec": 170, "related": [193]}, "194": {"spec": 211, "related": [194]}, "195": {"spec": 233, "related": [195]}, "196": {"spec": 229, "related": [196]}, "197": {"spec": 246, "related": [197]}, "199": {"spec": 69, "implication": 69, "related": [198, 199]}, "201": {"spec": 95, "implication": 95, "related": [200, 201]}, "203": {"spec": 158, "todo": 158, "related": [202, 203]}, "205": {"spec": 78, "implication": 78, "related": [204, 205]}, "207": {"spec": 89, "todo": 89, "related": [206, 207]}, "209": {"spec": 166, "todo": 166, "related": [208, 209]}, "211": {"spec": 91, "todo": 91, "related": [210, 211]}, "212": {"spec": 161, "related": [212]}, "214": {"spec": 158, "todo": 158, "related": [213, 214]}, "216": {"spec": 98, "implication": 98, "related": [215, 216]}, "218": {"spec": 91, "implication": 91, "related": [217, 218]}, "220": {"spec": 96, "implication": 96, "related": [219, 220]}, "223": {"spec": 244, "citation": 244, "implication": 244, "related": [221, 222, 223]}, "226": {"spec": 142, "citation": 142, "test": 142, "related": [224, 225, 226]}, "229": {"spec": 164, "citation": 164, "implication": 164, "related": [227, 228, 229]}, "231": {"spec": 99, "implication": 99, "related": [230, 231]}, "233": {"spec": 168, "implication": 168, "related": [232, 233]}, "235": {"spec": 181, "implication": 181, "related": [234, 235]}, "238": {"spec": 125, "citation": 125, "test": 125, "related": [236, 237, 238]}, "240": {"spec": 161, "implication": 161, "related": [239, 240]}, "243": {"spec": 273, "citation": 273, "test": 273, "related": [241, 242, 243]}, "246": {"spec": 139, "citation": 139, "test": 139, "related": [244, 245, 246]}, "247": {"spec": 246, "related": [247]}, "249": {"spec": 86, "implication": 86, "related": [248, 249]}, "251": {"spec": 163, "implication": 163, "related": [250, 251]}, "253": {"spec": 185, "implication": 185, "related": [252, 253]}, "255": {"spec": 132, "implication": 132, "related": [254, 255]}, "257": {"spec": 103, "implication": 103, "related": [256, 257]}, "260": {"spec": 130, "citation": 130, "test": 130, "related": [258, 259, 260]}, "262": {"spec": 212, "implication": 212, "related": [261, 262]}, "265": {"spec": 180, "citation": 180, "test": 180, "related": [263, 264, 265]}, "268": {"spec": 109, "citation": 109, "test": 109, "related": [266, 267, 268]}, "271": {"spec": 213, "citation": 213, "test": 213, "related": [269, 270, 271]}, "273": {"spec": 182, "implication": 182, "related": [272, 273]}, "276": {"spec": 242, "citation": 242, "test": 242, "related": [274, 275, 276]}, "279": {"spec": 199, "citation": 199, "test": 199, "related": [277, 278, 279]}, "282": {"spec": 323, "citation": 323, "todo": 323, "related": [280, 281, 282]}, "285": {"spec": 236, "citation": 236, "todo": 236, "related": [283, 284, 285]}, "288": {"spec": 136, "citation": 136, "test": 136, "related": [286, 287, 288]}, "291": {"spec": 386, "citation": 386, "test": 386, "related": [289, 290, 291]}, "293": {"spec": 253, "exception": 253, "related": [292, 293]}, "294": {"spec": 246, "related": [294]}, "296": {"spec": 92, "exception": 92, "related": [295, 296]}, "298": {"spec": 155, "exception": 155, "related": [297, 298]}, "300": {"spec": 203, "exception": 203, "related": [299, 300]}, "302": {"spec": 280, "exception": 280, "related": [301, 302]}, "303": {"spec": 111, "related": [303]}, "305": {"spec": 54, "exception": 54, "related": [304, 305]}, "307": {"spec": 67, "exception": 67, "related": [306, 307]}, "309": {"spec": 60, "implication": 60, "related": [308, 309]}, "310": {"spec": 160, "related": [310]}, "311": {"spec": 111, "related": [311]}, "312": {"spec": 192, "related": [312]}, "313": {"spec": 218, "related": [313]}, "314": {"spec": 205, "related": [314]}, "315": {"spec": 33, "related": [315]}, "316": {"spec": 62, "related": [316]}, "317": {"spec": 88, "related": [317]}, "318": {"spec": 208, "related": [318]}, "319": {"spec": 105, "related": [319]}, "320": {"spec": 47, "related": [320]}, "322": {"spec": 60, "implication": 60, "related": [321, 322]}, "323": {"spec": 197, "related": [323]}, "324": {"spec": 163, "related": [324]}, "325": {"spec": 212, "related": [325]}, "326": {"spec": 33, "related": [326]}, "327": {"spec": 62, "related": [327]}, "328": {"spec": 88, "related": [328]}, "329": {"spec": 204, "related": [329]}, "330": {"spec": 83, "related": [330]}, "331": {"spec": 84, "related": [331]}, "332": {"spec": 246, "related": [332]}, "333": {"spec": 67, "related": [333]}, "334": {"spec": 91, "related": [334]}, "335": {"spec": 55, "related": [335]}, "336": {"spec": 109, "related": [336]}, "337": {"spec": 125, "related": [337]}, "338": {"spec": 66, "related": [338]}, "339": {"spec": 62, "related": [339]}, "340": {"spec": 111, "related": [340]}, "341": {"spec": 120, "related": [341]}, "342": {"spec": 226, "related": [342]}, "343": {"spec": 125, "related": [343]}, "344": {"spec": 150, "related": [344]}, "345": {"spec": 97, "related": [345]}, "346": {"spec": 74, "related": [346]}, "347": {"spec": 84, "related": [347]}, "348": {"spec": 246, "related": [348]}, "349": {"spec": 82, "related": [349]}, "350": {"spec": 82, "related": [350]}, "351": {"spec": 68, "related": [351]}, "352": {"spec": 64, "related": [352]}, "353": {"spec": 84, "related": [353]}, "354": {"spec": 93, "related": [354]}, "355": {"spec": 222, "related": [355]}, "356": {"spec": 100, "related": [356]}, "357": {"spec": 46, "related": [357]}, "358": {"spec": 202, "related": [358]}, "359": {"spec": 120, "related": [359]}, "360": {"spec": 88, "related": [360]}, "361": {"spec": 246, "related": [361]}, "363": {"spec": 46, "implication": 46, "related": [362, 363]}, "365": {"spec": 44, "implication": 44, "related": [364, 365]}, "367": {"spec": 30, "implication": 30, "related": [366, 367]}, "369": {"spec": 174, "implication": 174, "related": [368, 369]}, "371": {"spec": 236, "implication": 236, "related": [370, 371]}, "374": {"spec": 100, "citation": 100, "test": 100, "related": [372, 373, 374]}, "376": {"spec": 122, "citation": 122, "related": [375, 376]}, "378": {"spec": 250, "implication": 250, "related": [377, 378]}, "380": {"spec": 176, "implication": 176, "related": [379, 380]}, "381": {"spec": 549, "related": [381]}, "383": {"spec": 160, "citation": 160, "related": [382, 383]}, "385": {"spec": 254, "implication": 254, "related": [384, 385]}, "387": {"spec": 179, "citation": 179, "related": [386, 387]}, "388": {"spec": 246, "related": [388]}, "390": {"spec": 71, "implication": 71, "related": [389, 390]}, "392": {"spec": 92, "implication": 92, "related": [391, 392]}, "394": {"spec": 111, "implication": 111, "related": [393, 394]}, "396": {"spec": 30, "implication": 30, "related": [395, 396]}, "398": {"spec": 174, "implication": 174, "related": [397, 398]}, "400": {"spec": 236, "implication": 236, "related": [399, 400]}, "402": {"spec": 100, "citation": 100, "related": [401, 402]}, "404": {"spec": 122, "citation": 122, "related": [403, 404]}, "406": {"spec": 250, "implication": 250, "related": [405, 406]}, "408": {"spec": 176, "implication": 176, "related": [407, 408]}, "409": {"spec": 526, "related": [409]}, "411": {"spec": 162, "citation": 162, "related": [410, 411]}, "413": {"spec": 259, "implication": 259, "related": [412, 413]}, "415": {"spec": 179, "citation": 179, "related": [414, 415]}, "416": {"spec": 246, "related": [416]}, "417": {"spec": 47, "related": [417]}, "418": {"spec": 57, "related": [418]}, "419": {"spec": 111, "related": [419]}, "420": {"spec": 42, "related": [420]}, "421": {"spec": 90, "related": [421]}, "422": {"spec": 76, "related": [422]}, "423": {"spec": 54, "related": [423]}, "424": {"spec": 54, "related": [424]}, "425": {"spec": 128, "related": [425]}, "426": {"spec": 103, "related": [426]}, "427": {"spec": 316, "related": [427]}, "428": {"spec": 139, "related": [428]}, "429": {"spec": 124, "related": [429]}, "430": {"spec": 78, "related": [430]}, "431": {"spec": 233, "related": [431]}, "432": {"spec": 159, "related": [432]}, "433": {"spec": 153, "related": [433]}, "434": {"spec": 168, "related": [434]}, "435": {"spec": 143, "related": [435]}, "436": {"spec": 127, "related": [436]}, "437": {"spec": 130, "related": [437]}, "438": {"spec": 212, "related": [438]}, "439": {"spec": 182, "related": [439]}, "440": {"spec": 42, "related": [440]}, "441": {"spec": 68, "related": [441]}, "442": {"spec": 125, "related": [442]}, "443": {"spec": 129, "related": [443]}, "444": {"spec": 128, "related": [444]}, "445": {"spec": 195, "related": [445]}, "446": {"spec": 62, "related": [446]}, "447": {"spec": 100, "related": [447]}, "448": {"spec": 127, "related": [448]}, "449": {"spec": 246, "related": [449]}, "450": {"spec": 46, "related": [450]}, "451": {"spec": 61, "related": [451]}, "452": {"spec": 70, "related": [452]}, "453": {"spec": 167, "related": [453]}, "454": {"spec": 59, "related": [454]}, "455": {"spec": 63, "related": [455]}, "456": {"spec": 108, "related": [456]}, "457": {"spec": 79, "related": [457]}, "458": {"spec": 53, "related": [458]}, "459": {"spec": 68, "related": [459]}, "460": {"spec": 141, "related": [460]}, "461": {"spec": 93, "related": [461]}, "462": {"spec": 227, "related": [462]}, "463": {"spec": 95, "related": [463]}, "464": {"spec": 246, "related": [464]}, "465": {"spec": 170, "related": [465]}, "466": {"spec": 279, "related": [466]}, "467": {"spec": 93, "related": [467]}, "468": {"spec": 351, "related": [468]}, "469": {"spec": 104, "related": [469]}, "470": {"spec": 121, "related": [470]}, "471": {"spec": 121, "related": [471]}, "472": {"spec": 140, "related": [472]}, "473": {"spec": 177, "related": [473]}, "474": {"spec": 83, "related": [474]}, "475": {"spec": 420, "related": [475]}, "476": {"spec": 145, "related": [476]}, "477": {"spec": 103, "related": [477]}, "478": {"spec": 90, "related": [478]}, "479": {"spec": 140, "related": [479]}, "480": {"spec": 253, "related": [480]}, "481": {"spec": 202, "related": [481]}, "482": {"spec": 78, "related": [482]}, "483": {"spec": 151, "related": [483]}, "484": {"spec": 143, "related": [484]}, "485": {"spec": 145, "related": [485]}, "486": {"spec": 246, "related": [486]}, "488": {"spec": 57, "implication": 57, "related": [487, 488]}, "490": {"spec": 111, "implication": 111, "related": [489, 490]}, "492": {"spec": 42, "implication": 42, "related": [491, 492]}, "494": {"spec": 99, "implication": 99, "related": [493, 494]}, "496": {"spec": 303, "implication": 303, "related": [495, 496]}, "498": {"spec": 114, "implication": 114, "related": [497, 498]}, "500": {"spec": 90, "implication": 90, "related": [499, 500]}, "502": {"spec": 258, "citation": 258, "related": [501, 502]}, "504": {"spec": 223, "implication": 223, "related": [503, 504]}, "506": {"spec": 119, "citation": 119, "related": [505, 506]}, "509": {"spec": 192, "citation": 192, "implication": 192, "related": [507, 508, 509]}, "512": {"spec": 153, "citation": 153, "implication": 153, "related": [510, 511, 512]}, "514": {"spec": 152, "implication": 152, "related": [513, 514]}, "516": {"spec": 133, "citation": 133, "related": [515, 516]}, "518": {"spec": 332, "implication": 332, "related": [517, 518]}, "520": {"spec": 87, "citation": 87, "related": [519, 520]}, "522": {"spec": 117, "citation": 117, "related": [521, 522]}, "524": {"spec": 134, "implication": 134, "related": [523, 524]}, "526": {"spec": 174, "implication": 174, "related": [525, 526]}, "528": {"spec": 155, "implication": 155, "related": [527, 528]}, "530": {"spec": 100, "citation": 100, "related": [529, 530]}, "532": {"spec": 122, "citation": 122, "related": [531, 532]}, "533": {"spec": 78, "related": [533]}, "535": {"spec": 250, "implication": 250, "related": [534, 535]}, "537": {"spec": 176, "implication": 176, "related": [536, 537]}, "538": {"spec": 277, "related": [538]}, "540": {"spec": 167, "citation": 167, "related": [539, 540]}, "541": {"spec": 216, "related": [541]}, "543": {"spec": 112, "implication": 112, "related": [542, 543]}, "545": {"spec": 183, "citation": 183, "related": [544, 545]}, "546": {"spec": 246, "related": [546]}, "548": {"spec": 28, "implication": 28, "related": [547, 548]}, "550": {"spec": 72, "implication": 72, "related": [549, 550]}, "552": {"spec": 177, "implication": 177, "related": [551, 552]}, "554": {"spec": 287, "implication": 287, "related": [553, 554]}, "555": {"spec": 246, "related": [555]}, "556": {"spec": 28, "related": [556]}, "558": {"spec": 142, "implication": 142, "related": [557, 558]}, "560": {"spec": 173, "citation": 173, "related": [559, 560]}, "562": {"spec": 128, "implication": 128, "related": [561, 562]}, "563": {"spec": 218, "related": [563]}, "564": {"spec": 137, "related": [564]}, "566": {"spec": 271, "implication": 271, "related": [565, 566]}, "568": {"spec": 56, "implication": 56, "related": [567, 568]}, "570": {"spec": 28, "implication": 28, "related": [569, 570]}, "572": {"spec": 66, "implication": 66, "related": [571, 572]}, "574": {"spec": 96, "implication": 96, "related": [573, 574]}, "576": {"spec": 171, "citation": 171, "related": [575, 576]}, "578": {"spec": 129, "citation": 129, "related": [577, 578]}, "580": {"spec": 156, "implication": 156, "related": [579, 580]}, "582": {"spec": 178, "implication": 178, "related": [581, 582]}, "583": {"spec": 54, "related": [583]}, "584": {"spec": 246, "related": [584]}, "586": {"spec": 119, "implication": 119, "related": [585, 586]}, "588": {"spec": 88, "implication": 88, "related": [587, 588]}, "590": {"spec": 127, "implication": 127, "related": [589, 590]}, "592": {"spec": 141, "implication": 141, "related": [591, 592]}, "594": {"spec": 266, "implication": 266, "related": [593, 594]}, "596": {"spec": 114, "implication": 114, "related": [595, 596]}, "598": {"spec": 89, "implication": 89, "related": [597, 598]}, "600": {"spec": 116, "implication": 116, "related": [599, 600]}, "601": {"spec": 246, "related": [601]}, "603": {"spec": 28, "implication": 28, "related": [602, 603]}, "605": {"spec": 160, "implication": 160, "related": [604, 605]}, "607": {"spec": 304, "implication": 304, "related": [606, 607]}, "608": {"spec": 246, "related": [608]}, "609": {"spec": 46, "related": [609]}, "611": {"spec": 57, "implication": 57, "related": [610, 611]}, "612": {"spec": 111, "related": [612]}, "614": {"spec": 42, "implication": 42, "related": [613, 614]}, "616": {"spec": 99, "implication": 99, "related": [615, 616]}, "618": {"spec": 303, "implication": 303, "related": [617, 618]}, "620": {"spec": 114, "implication": 114, "related": [619, 620]}, "622": {"spec": 90, "implication": 90, "related": [621, 622]}, "624": {"spec": 258, "citation": 258, "related": [623, 624]}, "626": {"spec": 223, "implication": 223, "related": [625, 626]}, "628": {"spec": 143, "citation": 143, "related": [627, 628]}, "630": {"spec": 183, "implication": 183, "related": [629, 630]}, "631": {"spec": 297, "related": [631]}, "633": {"spec": 133, "citation": 133, "related": [632, 633]}, "635": {"spec": 479, "implication": 479, "related": [634, 635]}, "637": {"spec": 134, "implication": 134, "related": [636, 637]}, "639": {"spec": 174, "implication": 174, "related": [638, 639]}, "640": {"spec": 237, "related": [640]}, "642": {"spec": 100, "citation": 100, "related": [641, 642]}, "644": {"spec": 122, "citation": 122, "related": [643, 644]}, "645": {"spec": 78, "related": [645]}, "647": {"spec": 250, "implication": 250, "related": [646, 647]}, "649": {"spec": 176, "implication": 176, "related": [648, 649]}, "650": {"spec": 237, "related": [650]}, "652": {"spec": 312, "implication": 312, "related": [651, 652]}, "654": {"spec": 167, "citation": 167, "related": [653, 654]}, "656": {"spec": 256, "implication": 256, "related": [655, 656]}, "658": {"spec": 183, "citation": 183, "related": [657, 658]}, "659": {"spec": 246, "related": [659]}, "660": {"spec": 28, "related": [660]}, "662": {"spec": 325, "implication": 325, "related": [661, 662]}, "664": {"spec": 171, "citation": 171, "related": [663, 664]}, "666": {"spec": 136, "implication": 136, "related": [665, 666]}, "667": {"spec": 218, "related": [667]}, "668": {"spec": 137, "related": [668]}, "670": {"spec": 271, "implication": 271, "related": [669, 670]}, "671": {"spec": 55, "related": [671]}, "673": {"spec": 28, "implication": 28, "related": [672, 673]}, "675": {"spec": 66, "implication": 66, "related": [674, 675]}, "677": {"spec": 96, "implication": 96, "related": [676, 677]}, "679": {"spec": 171, "citation": 171, "related": [678, 679]}, "681": {"spec": 129, "citation": 129, "related": [680, 681]}, "683": {"spec": 164, "implication": 164, "related": [682, 683]}, "685": {"spec": 178, "implication": 178, "related": [684, 685]}, "686": {"spec": 54, "related": [686]}, "687": {"spec": 122, "related": [687]}, "688": {"spec": 204, "related": [688]}, "689": {"spec": 184, "related": [689]}, "690": {"spec": 245, "related": [690]}, "691": {"spec": 123, "related": [691]}, "692": {"spec": 106, "related": [692]}, "693": {"spec": 108, "related": [693]}, "694": {"spec": 105, "related": [694]}, "695": {"spec": 164, "related": [695]}, "697": {"spec": 148, "exception": 148, "related": [696, 697]}, "699": {"spec": 57, "citation": 57, "related": [698, 699]}, "701": {"spec": 129, "exception": 129, "related": [700, 701]}, "703": {"spec": 190, "exception": 190, "related": [702, 703]}, "705": {"spec": 258, "exception": 258, "related": [704, 705]}, "707": {"spec": 35, "implication": 35, "related": [706, 707]}, "709": {"spec": 65, "exception": 65, "related": [708, 709]}, "711": {"spec": 206, "implication": 206, "related": [710, 711]}, "712": {"spec": 132, "related": [712]}, "715": {"spec": 98, "citation": 98, "test": 98, "related": [713, 714, 715]}, "717": {"spec": 78, "implication": 78, "related": [716, 717]}, "719": {"spec": 43, "implication": 43, "related": [718, 719]}, "721": {"spec": 115, "exception": 115, "related": [720, 721]}, "724": {"spec": 77, "citation": 77, "test": 77, "related": [722, 723, 724]}, "726": {"spec": 40, "exception": 40, "related": [725, 726]}, "728": {"spec": 117, "citation": 117, "related": [727, 728]}, "730": {"spec": 68, "exception": 68, "related": [729, 730]}, "732": {"spec": 207, "implication": 207, "related": [731, 732]}, "734": {"spec": 105, "exception": 105, "related": [733, 734]}, "736": {"spec": 105, "exception": 105, "related": [735, 736]}, "738": {"spec": 127, "exception": 127, "related": [737, 738]}, "739": {"spec": 133, "related": [739]}, "741": {"spec": 99, "exception": 99, "related": [740, 741]}, "743": {"spec": 210, "implication": 210, "related": [742, 743]}, "745": {"spec": 217, "exception": 217, "related": [744, 745]}, "747": {"spec": 256, "citation": 256, "related": [746, 747]}, "749": {"spec": 53, "implication": 53, "related": [748, 749]}, "751": {"spec": 211, "citation": 211, "related": [750, 751]}, "752": {"spec": 146, "related": [752]}, "754": {"spec": 322, "citation": 322, "related": [753, 754]}, "756": {"spec": 140, "exception": 140, "related": [755, 756]}, "758": {"spec": 207, "citation": 207, "related": [757, 758]}, "760": {"spec": 355, "implication": 355, "related": [759, 760]}, "762": {"spec": 260, "citation": 260, "related": [761, 762]}, "764": {"spec": 133, "citation": 133, "related": [763, 764]}, "766": {"spec": 199, "implication": 199, "related": [765, 766]}, "768": {"spec": 289, "citation": 289, "related": [767, 768]}, "770": {"spec": 286, "citation": 286, "related": [769, 770]}, "772": {"spec": 189, "citation": 189, "related": [771, 772]}, "774": {"spec": 352, "citation": 352, "related": [773, 774]}, "775": {"spec": 607, "related": [775]}, "777": {"spec": 513, "citation": 513, "related": [776, 777]}, "779": {"spec": 158, "citation": 158, "related": [778, 779]}, "780": {"spec": 261, "related": [780]}, "782": {"spec": 134, "citation": 134, "related": [781, 782]}, "784": {"spec": 379, "exception": 379, "related": [783, 784]}, "786": {"spec": 131, "exception": 131, "related": [785, 786]}, "788": {"spec": 231, "exception": 231, "related": [787, 788]}, "790": {"spec": 172, "citation": 172, "related": [789, 790]}, "791": {"spec": 141, "related": [791]}, "793": {"spec": 228, "citation": 228, "related": [792, 793]}, "795": {"spec": 397, "citation": 397, "related": [794, 795]}, "797": {"spec": 95, "citation": 95, "related": [796, 797]}, "799": {"spec": 98, "exception": 98, "related": [798, 799]}, "801": {"spec": 143, "exception": 143, "related": [800, 801]}, "803": {"spec": 377, "exception": 377, "related": [802, 803]}, "805": {"spec": 338, "citation": 338, "related": [804, 805]}, "807": {"spec": 237, "citation": 237, "related": [806, 807]}, "809": {"spec": 103, "exception": 103, "related": [808, 809]}, "811": {"spec": 89, "citation": 89, "related": [810, 811]}, "813": {"spec": 107, "exception": 107, "related": [812, 813]}, "815": {"spec": 190, "exception": 190, "related": [814, 815]}, "817": {"spec": 134, "citation": 134, "related": [816, 817]}, "819": {"spec": 102, "citation": 102, "related": [818, 819]}, "821": {"spec": 78, "implication": 78, "related": [820, 821]}, "823": {"spec": 182, "implication": 182, "related": [822, 823]}, "825": {"spec": 243, "citation": 243, "related": [824, 825]}, "827": {"spec": 85, "implication": 85, "related": [826, 827]}, "829": {"spec": 78, "implication": 78, "related": [828, 829]}, "831": {"spec": 51, "implication": 51, "related": [830, 831]}, "833": {"spec": 132, "exception": 132, "related": [832, 833]}, "835": {"spec": 132, "exception": 132, "related": [834, 835]}, "837": {"spec": 150, "exception": 150, "related": [836, 837]}, "838": {"spec": 245, "related": [838]}, "840": {"spec": 105, "citation": 105, "related": [839, 840]}, "842": {"spec": 70, "implication": 70, "related": [841, 842]}, "844": {"spec": 71, "implication": 71, "related": [843, 844]}, "846": {"spec": 151, "implication": 151, "related": [845, 846]}, "848": {"spec": 65, "exception": 65, "related": [847, 848]}, "850": {"spec": 228, "implication": 228, "related": [849, 850]}, "852": {"spec": 129, "citation": 129, "related": [851, 852]}, "854": {"spec": 267, "citation": 267, "related": [853, 854]}, "856": {"spec": 86, "citation": 86, "related": [855, 856]}, "859": {"spec": 55, "implication": 55, "related": [857, 858, 859]}, "861": {"spec": 40, "exception": 40, "related": [860, 861]}, "863": {"spec": 70, "exception": 70, "related": [862, 863]}, "865": {"spec": 228, "implication": 228, "related": [864, 865]}, "867": {"spec": 105, "exception": 105, "related": [866, 867]}, "869": {"spec": 105, "exception": 105, "related": [868, 869]}, "872": {"spec": 127, "exception": 127, "todo": 127, "related": [870, 871, 872]}, "874": {"spec": 176, "citation": 176, "related": [873, 874]}, "876": {"spec": 183, "citation": 183, "related": [875, 876]}, "878": {"spec": 190, "citation": 190, "related": [877, 878]}, "880": {"spec": 443, "citation": 443, "related": [879, 880]}, "882": {"spec": 251, "exception": 251, "related": [881, 882]}, "884": {"spec": 125, "citation": 125, "related": [883, 884]}, "886": {"spec": 240, "implication": 240, "related": [885, 886]}, "888": {"spec": 245, "citation": 245, "related": [887, 888]}, "890": {"spec": 53, "implication": 53, "related": [889, 890]}, "892": {"spec": 190, "citation": 190, "related": [891, 892]}, "893": {"spec": 143, "related": [893]}, "896": {"spec": 171, "citation": 171, "implication": 171, "related": [894, 895, 896]}, "898": {"spec": 434, "implication": 434, "related": [897, 898]}, "900": {"spec": 86, "implication": 86, "related": [899, 900]}, "903": {"spec": 302, "citation": 302, "implication": 302, "related": [901, 902, 903]}, "905": {"spec": 342, "citation": 342, "related": [904, 905]}, "907": {"spec": 85, "citation": 85, "related": [906, 907]}, "909": {"spec": 175, "citation": 175, "related": [908, 909]}, "911": {"spec": 295, "exception": 295, "related": [910, 911]}, "913": {"spec": 305, "citation": 305, "related": [912, 913]}, "915": {"spec": 319, "citation": 319, "related": [914, 915]}, "917": {"spec": 276, "citation": 276, "related": [916, 917]}, "919": {"spec": 230, "citation": 230, "related": [918, 919]}, "922": {"spec": 243, "citation": 243, "implication": 243, "related": [920, 921, 922]}, "925": {"spec": 370, "exception": 370, "related": [923, 924, 925]}, "929": {"spec": 79, "citation": 79, "related": [926, 927, 928, 929]}, "931": {"spec": 64, "citation": 64, "related": [930, 931]}, "933": {"spec": 145, "citation": 145, "related": [932, 933]}, "935": {"spec": 164, "citation": 164, "related": [934, 935]}, "937": {"spec": 287, "exception": 287, "related": [936, 937]}, "939": {"spec": 310, "citation": 310, "related": [938, 939]}, "941": {"spec": 103, "exception": 103, "related": [940, 941]}, "943": {"spec": 94, "citation": 94, "related": [942, 943]}, "945": {"spec": 275, "exception": 275, "related": [944, 945]}, "947": {"spec": 160, "exception": 160, "related": [946, 947]}, "949": {"spec": 207, "exception": 207, "related": [948, 949]}, "950": {"spec": 246, "related": [950]}, "952": {"spec": 51, "implication": 51, "related": [951, 952]}, "954": {"spec": 178, "implication": 178, "related": [953, 954]}, "955": {"spec": 48, "related": [955]}, "956": {"spec": 101, "related": [956]}, "957": {"spec": 106, "related": [957]}, "958": {"spec": 157, "related": [958]}, "959": {"spec": 96, "related": [959]}, "960": {"spec": 191, "related": [960]}, "961": {"spec": 86, "related": [961]}, "962": {"spec": 103, "related": [962]}, "963": {"spec": 50, "related": [963]}, "964": {"spec": 137, "related": [964]}, "965": {"spec": 191, "related": [965]}, "966": {"spec": 409, "related": [966]}, "969": {"spec": 150, "citation": 150, "related": [967, 968, 969]}, "971": {"spec": 96, "citation": 96, "related": [970, 971]}, "973": {"spec": 204, "citation": 204, "related": [972, 973]}, "974": {"spec": 246, "related": [974]}, "976": {"spec": 163, "citation": 163, "related": [975, 976]}, "977": {"spec": 246, "related": [977]}, "979": {"spec": 169, "implication": 169, "related": [978, 979]}, "981": {"spec": 67, "exception": 67, "related": [980, 981]}, "984": {"spec": 209, "citation": 209, "test": 209, "related": [982, 983, 984]}, "986": {"spec": 39, "todo": 39, "related": [985, 986]}, "988": {"spec": 286, "implication": 286, "related": [987, 988]}, "990": {"spec": 88, "implication": 88, "related": [989, 990]}, "992": {"spec": 222, "citation": 222, "related": [991, 992]}, "994": {"spec": 96, "implication": 96, "related": [993, 994]}}, "refs": [{}, {"todo": true}, {"exception": true}, {"exception": true, "todo": true}, {"test": true}, {"test": true, "todo": true}, {"test": true, "exception": true}, {"test": true, "exception": true, "todo": true}, {"implication": true}, {"implication": true, "todo": true}, {"implication": true, "exception": true}, {"implication": true, "exception": true, "todo": true}, {"implication": true, "test": true}, {"implication": true, "test": true, "todo": true}, {"implication": true, "test": true, "exception": true}, {"implication": true, "test": true, "exception": true, "todo": true}, {"citation": true}, {"citation": true, "todo": true}, {"citation": true, "exception": true}, {"citation": true, "exception": true, "todo": true}, {"citation": true, "test": true}, {"citation": true, "test": true, "todo": true}, {"citation": true, "test": true, "exception": true}, {"citation": true, "test": true, "exception": true, "todo": true}, {"citation": true, "implication": true}, {"citation": true, "implication": true, "todo": true}, {"citation": true, "implication": true, "exception": true}, {"citation": true, "implication": true, "exception": true, "todo": true}, {"citation": true, "implication": true, "test": true}, {"citation": true, "implication": true, "test": true, "todo": true}, {"citation": true, "implication": true, "test": true, "exception": true}, {"citation": true, "implication": true, "test": true, "exception": true, "todo": true}, {"spec": true}, {"spec": true, "todo": true}, {"spec": true, "exception": true}, {"spec": true, "exception": true, "todo": true}, {"spec": true, "test": true}, {"spec": true, "test": true, "todo": true}, {"spec": true, "test": true, "exception": true}, {"spec": true, "test": true, "exception": true, "todo": true}, {"spec": true, "implication": true}, {"spec": true, "implication": true, "todo": true}, {"spec": true, "implication": true, "exception": true}, {"spec": true, "implication": true, "exception": true, "todo": true}, {"spec": true, "implication": true, "test": true}, {"spec": true, "implication": true, "test": true, "todo": true}, {"spec": true, "implication": true, "test": true, "exception": true}, {"spec": true, "implication": true, "test": true, "exception": true, "todo": true}, {"spec": true, "citation": true}, {"spec": true, "citation": true, "todo": true}, {"spec": true, "citation": true, "exception": true}, {"spec": true, "citation": true, "exception": true, "todo": true}, {"spec": true, "citation": true, "test": true}, {"spec": true, "citation": true, "test": true, "todo": true}, {"spec": true, "citation": true, "test": true, "exception": true}, {"spec": true, "citation": true, "test": true, "exception": true, "todo": true}, {"spec": true, "citation": true, "implication": true}, {"spec": true, "citation": true, "implication": true, "todo": true}, {"spec": true, "citation": true, "implication": true, "exception": true}, {"spec": true, "citation": true, "implication": true, "exception": true, "todo": true}, {"spec": true, "citation": true, "implication": true, "test": true}, {"spec": true, "citation": true, "implication": true, "test": true, "todo": true}, {"spec": true, "citation": true, "implication": true, "test": true, "exception": true}, {"spec": true, "citation": true, "implication": true, "test": true, "exception": true, "todo": true}, {"level": "MAY"}, {"todo": true, "level": "MAY"}, {"exception": true, "level": "MAY"}, {"exception": true, "todo": true, "level": "MAY"}, {"test": true, "level": "MAY"}, {"test": true, "todo": true, "level": "MAY"}, {"test": true, "exception": true, "level": "MAY"}, {"test": true, "exception": true, "todo": true, "level": "MAY"}, {"implication": true, "level": "MAY"}, {"implication": true, "todo": true, "level": "MAY"}, {"implication": true, "exception": true, "level": "MAY"}, {"implication": true, "exception": true, "todo": true, "level": "MAY"}, {"implication": true, "test": true, "level": "MAY"}, {"implication": true, "test": true, "todo": true, "level": "MAY"}, {"implication": true, "test": true, "exception": true, "level": "MAY"}, {"implication": true, "test": true, "exception": true, "todo": true, "level": "MAY"}, {"citation": true, "level": "MAY"}, {"citation": true, "todo": true, "level": "MAY"}, {"citation": true, "exception": true, "level": "MAY"}, {"citation": true, "exception": true, "todo": true, "level": "MAY"}, {"citation": true, "test": true, "level": "MAY"}, {"citation": true, "test": true, "todo": true, "level": "MAY"}, {"citation": true, "test": true, "exception": true, "level": "MAY"}, {"citation": true, "test": true, "exception": true, "todo": true, "level": "MAY"}, {"citation": true, "implication": true, "level": "MAY"}, {"citation": true, "implication": true, "todo": true, "level": "MAY"}, {"citation": true, "implication": true, "exception": true, "level": "MAY"}, {"citation": true, "implication": true, "exception": true, "todo": true, "level": "MAY"}, {"citation": true, "implication": true, "test": true, "level": "MAY"}, {"citation": true, "implication": true, "test": true, "todo": true, "level": "MAY"}, {"citation": true, "implication": true, "test": true, "exception": true, "level": "MAY"}, {"citation": true, "implication": true, "test": true, "exception": true, "todo": true, "level": "MAY"}, {"spec": true, "level": "MAY"}, {"spec": true, "todo": true, "level": "MAY"}, {"spec": true, "exception": true, "level": "MAY"}, {"spec": true, "exception": true, "todo": true, "level": "MAY"}, {"spec": true, "test": true, "level": "MAY"}, {"spec": true, "test": true, "todo": true, "level": "MAY"}, {"spec": true, "test": true, "exception": true, "level": "MAY"}, {"spec": true, "test": true, "exception": true, "todo": true, "level": "MAY"}, {"spec": true, "implication": true, "level": "MAY"}, {"spec": true, "implication": true, "todo": true, "level": "MAY"}, {"spec": true, "implication": true, "exception": true, "level": "MAY"}, {"spec": true, "implication": true, "exception": true, "todo": true, "level": "MAY"}, {"spec": true, "implication": true, "test": true, "level": "MAY"}, {"spec": true, "implication": true, "test": true, "todo": true, "level": "MAY"}, {"spec": true, "implication": true, "test": true, "exception": true, "level": "MAY"}, {"spec": true, "implication": true, "test": true, "exception": true, "todo": true, "level": "MAY"}, {"spec": true, "citation": true, "level": "MAY"}, {"spec": true, "citation": true, "todo": true, "level": "MAY"}, {"spec": true, "citation": true, "exception": true, "level": "MAY"}, {"spec": true, "citation": true, "exception": true, "todo": true, "level": "MAY"}, {"spec": true, "citation": true, "test": true, "level": "MAY"}, {"spec": true, "citation": true, "test": true, "todo": true, "level": "MAY"}, {"spec": true, "citation": true, "test": true, "exception": true, "level": "MAY"}, {"spec": true, "citation": true, "test": true, "exception": true, "todo": true, "level": "MAY"}, {"spec": true, "citation": true, "implication": true, "level": "MAY"}, {"spec": true, "citation": true, "implication": true, "todo": true, "level": "MAY"}, {"spec": true, "citation": true, "implication": true, "exception": true, "level": "MAY"}, {"spec": true, "citation": true, "implication": true, "exception": true, "todo": true, "level": "MAY"}, {"spec": true, "citation": true, "implication": true, "test": true, "level": "MAY"}, {"spec": true, "citation": true, "implication": true, "test": true, "todo": true, "level": "MAY"}, {"spec": true, "citation": true, "implication": true, "test": true, "exception": true, "level": "MAY"}, {"spec": true, "citation": true, "implication": true, "test": true, "exception": true, "todo": true, "level": "MAY"}, {"level": "SHOULD"}, {"todo": true, "level": "SHOULD"}, {"exception": true, "level": "SHOULD"}, {"exception": true, "todo": true, "level": "SHOULD"}, {"test": true, "level": "SHOULD"}, {"test": true, "todo": true, "level": "SHOULD"}, {"test": true, "exception": true, "level": "SHOULD"}, {"test": true, "exception": true, "todo": true, "level": "SHOULD"}, {"implication": true, "level": "SHOULD"}, {"implication": true, "todo": true, "level": "SHOULD"}, {"implication": true, "exception": true, "level": "SHOULD"}, {"implication": true, "exception": true, "todo": true, "level": "SHOULD"}, {"implication": true, "test": true, "level": "SHOULD"}, {"implication": true, "test": true, "todo": true, "level": "SHOULD"}, {"implication": true, "test": true, "exception": true, "level": "SHOULD"}, {"implication": true, "test": true, "exception": true, "todo": true, "level": "SHOULD"}, {"citation": true, "level": "SHOULD"}, {"citation": true, "todo": true, "level": "SHOULD"}, {"citation": true, "exception": true, "level": "SHOULD"}, {"citation": true, "exception": true, "todo": true, "level": "SHOULD"}, {"citation": true, "test": true, "level": "SHOULD"}, {"citation": true, "test": true, "todo": true, "level": "SHOULD"}, {"citation": true, "test": true, "exception": true, "level": "SHOULD"}, {"citation": true, "test": true, "exception": true, "todo": true, "level": "SHOULD"}, {"citation": true, "implication": true, "level": "SHOULD"}, {"citation": true, "implication": true, "todo": true, "level": "SHOULD"}, {"citation": true, "implication": true, "exception": true, "level": "SHOULD"}, {"citation": true, "implication": true, "exception": true, "todo": true, "level": "SHOULD"}, {"citation": true, "implication": true, "test": true, "level": "SHOULD"}, {"citation": true, "implication": true, "test": true, "todo": true, "level": "SHOULD"}, {"citation": true, "implication": true, "test": true, "exception": true, "level": "SHOULD"}, {"citation": true, "implication": true, "test": true, "exception": true, "todo": true, "level": "SHOULD"}, {"spec": true, "level": "SHOULD"}, {"spec": true, "todo": true, "level": "SHOULD"}, {"spec": true, "exception": true, "level": "SHOULD"}, {"spec": true, "exception": true, "todo": true, "level": "SHOULD"}, {"spec": true, "test": true, "level": "SHOULD"}, {"spec": true, "test": true, "todo": true, "level": "SHOULD"}, {"spec": true, "test": true, "exception": true, "level": "SHOULD"}, {"spec": true, "test": true, "exception": true, "todo": true, "level": "SHOULD"}, {"spec": true, "implication": true, "level": "SHOULD"}, {"spec": true, "implication": true, "todo": true, "level": "SHOULD"}, {"spec": true, "implication": true, "exception": true, "level": "SHOULD"}, {"spec": true, "implication": true, "exception": true, "todo": true, "level": "SHOULD"}, {"spec": true, "implication": true, "test": true, "level": "SHOULD"}, {"spec": true, "implication": true, "test": true, "todo": true, "level": "SHOULD"}, {"spec": true, "implication": true, "test": true, "exception": true, "level": "SHOULD"}, {"spec": true, "implication": true, "test": true, "exception": true, "todo": true, "level": "SHOULD"}, {"spec": true, "citation": true, "level": "SHOULD"}, {"spec": true, "citation": true, "todo": true, "level": "SHOULD"}, {"spec": true, "citation": true, "exception": true, "level": "SHOULD"}, {"spec": true, "citation": true, "exception": true, "todo": true, "level": "SHOULD"}, {"spec": true, "citation": true, "test": true, "level": "SHOULD"}, {"spec": true, "citation": true, "test": true, "todo": true, "level": "SHOULD"}, {"spec": true, "citation": true, "test": true, "exception": true, "level": "SHOULD"}, {"spec": true, "citation": true, "test": true, "exception": true, "todo": true, "level": "SHOULD"}, {"spec": true, "citation": true, "implication": true, "level": "SHOULD"}, {"spec": true, "citation": true, "implication": true, "todo": true, "level": "SHOULD"}, {"spec": true, "citation": true, "implication": true, "exception": true, "level": "SHOULD"}, {"spec": true, "citation": true, "implication": true, "exception": true, "todo": true, "level": "SHOULD"}, {"spec": true, "citation": true, "implication": true, "test": true, "level": "SHOULD"}, {"spec": true, "citation": true, "implication": true, "test": true, "todo": true, "level": "SHOULD"}, {"spec": true, "citation": true, "implication": true, "test": true, "exception": true, "level": "SHOULD"}, {"spec": true, "citation": true, "implication": true, "test": true, "exception": true, "todo": true, "level": "SHOULD"}, {"level": "MUST"}, {"todo": true, "level": "MUST"}, {"exception": true, "level": "MUST"}, {"exception": true, "todo": true, "level": "MUST"}, {"test": true, "level": "MUST"}, {"test": true, "todo": true, "level": "MUST"}, {"test": true, "exception": true, "level": "MUST"}, {"test": true, "exception": true, "todo": true, "level": "MUST"}, {"implication": true, "level": "MUST"}, {"implication": true, "todo": true, "level": "MUST"}, {"implication": true, "exception": true, "level": "MUST"}, {"implication": true, "exception": true, "todo": true, "level": "MUST"}, {"implication": true, "test": true, "level": "MUST"}, {"implication": true, "test": true, "todo": true, "level": "MUST"}, {"implication": true, "test": true, "exception": true, "level": "MUST"}, {"implication": true, "test": true, "exception": true, "todo": true, "level": "MUST"}, {"citation": true, "level": "MUST"}, {"citation": true, "todo": true, "level": "MUST"}, {"citation": true, "exception": true, "level": "MUST"}, {"citation": true, "exception": true, "todo": true, "level": "MUST"}, {"citation": true, "test": true, "level": "MUST"}, {"citation": true, "test": true, "todo": true, "level": "MUST"}, {"citation": true, "test": true, "exception": true, "level": "MUST"}, {"citation": true, "test": true, "exception": true, "todo": true, "level": "MUST"}, {"citation": true, "implication": true, "level": "MUST"}, {"citation": true, "implication": true, "todo": true, "level": "MUST"}, {"citation": true, "implication": true, "exception": true, "level": "MUST"}, {"citation": true, "implication": true, "exception": true, "todo": true, "level": "MUST"}, {"citation": true, "implication": true, "test": true, "level": "MUST"}, {"citation": true, "implication": true, "test": true, "todo": true, "level": "MUST"}, {"citation": true, "implication": true, "test": true, "exception": true, "level": "MUST"}, {"citation": true, "implication": true, "test": true, "exception": true, "todo": true, "level": "MUST"}, {"spec": true, "level": "MUST"}, {"spec": true, "todo": true, "level": "MUST"}, {"spec": true, "exception": true, "level": "MUST"}, {"spec": true, "exception": true, "todo": true, "level": "MUST"}, {"spec": true, "test": true, "level": "MUST"}, {"spec": true, "test": true, "todo": true, "level": "MUST"}, {"spec": true, "test": true, "exception": true, "level": "MUST"}, {"spec": true, "test": true, "exception": true, "todo": true, "level": "MUST"}, {"spec": true, "implication": true, "level": "MUST"}, {"spec": true, "implication": true, "todo": true, "level": "MUST"}, {"spec": true, "implication": true, "exception": true, "level": "MUST"}, {"spec": true, "implication": true, "exception": true, "todo": true, "level": "MUST"}, {"spec": true, "implication": true, "test": true, "level": "MUST"}, {"spec": true, "implication": true, "test": true, "todo": true, "level": "MUST"}, {"spec": true, "implication": true, "test": true, "exception": true, "level": "MUST"}, {"spec": true, "implication": true, "test": true, "exception": true, "todo": true, "level": "MUST"}, {"spec": true, "citation": true, "level": "MUST"}, {"spec": true, "citation": true, "todo": true, "level": "MUST"}, {"spec": true, "citation": true, "exception": true, "level": "MUST"}, {"spec": true, "citation": true, "exception": true, "todo": true, "level": "MUST"}, {"spec": true, "citation": true, "test": true, "level": "MUST"}, {"spec": true, "citation": true, "test": true, "todo": true, "level": "MUST"}, {"spec": true, "citation": true, "test": true, "exception": true, "level": "MUST"}, {"spec": true, "citation": true, "test": true, "exception": true, "todo": true, "level": "MUST"}, {"spec": true, "citation": true, "implication": true, "level": "MUST"}, {"spec": true, "citation": true, "implication": true, "todo": true, "level": "MUST"}, {"spec": true, "citation": true, "implication": true, "exception": true, "level": "MUST"}, {"spec": true, "citation": true, "implication": true, "exception": true, "todo": true, "level": "MUST"}, {"spec": true, "citation": true, "implication": true, "test": true, "level": "MUST"}, {"spec": true, "citation": true, "implication": true, "test": true, "todo": true, "level": "MUST"}, {"spec": true, "citation": true, "implication": true, "test": true, "exception": true, "level": "MUST"}, {"spec": true, "citation": true, "implication": true, "test": true, "exception": true, "todo": true, "level": "MUST"}]}